{"version":3,"file":"static/js/202.28b1c6ee.chunk.js","mappings":"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","sources":["services/localDatabase.ts","services/syncService.ts","services/api.ts","components/AvatarImage.tsx","components/AppAvatar.tsx","webpack://client/./src/pages/inbox.module.css?4dab","pages/inbox-filters.tsx","pages/inbox.tsx","webpack://client/./src/components/TemplatesManager.module.css?e4f1","components/TemplatesManager.tsx","webpack://client/./src/pages/staffInbox.module.css?bcd7","pages/staffInbox.tsx","contexts/AuthContext.tsx","components/AppLayout.tsx","components/Layout.tsx","components/PrivateRoute.tsx","components/StaffRoute.tsx","components/AdminRoute.tsx","utils/officials.ts","components/StatsPanel.tsx","components/LoginForm.tsx","components/RegisterForm.tsx","webpack://client/./src/components/dashboard.module.css?bb7f","components/Dashboard.tsx","components/GuestDashboard.tsx","components/StaffDashboard.tsx","services/notificationSocket.ts","components/admin/AdminDashboard.tsx","components/admin/UserManagement.tsx","components/admin/ActivityLogs.tsx","components/admin/Statistics.tsx","components/TestEmailModal.tsx","config/defaultSystemSettings.ts","components/admin/SystemSettings.tsx","components/DocumentRequestForm.tsx","components/InquiryForm.tsx","components/Goodbye.tsx","components/Logout.tsx","pages/InquiryTracker.tsx","components/ResidentCreateModal.tsx","components/ResidentPortal.tsx","components/LandingPage.tsx","pages/ForgotPassword.tsx","pages/ResetPassword.tsx","components/admin/MessageInbox.tsx","webpack://client/./src/components/DocumentHistory.module.css?a59a","components/DocumentHistory.tsx","components/admin/Announcements.tsx","components/AnnouncementsList.tsx","components/admin/VerificationRequests.tsx","theme.ts","App.tsx","utils/formatDate.ts","webpack://client/./src/components/DocumentProcessing.module.css?53cb","components/DocumentProcessing.tsx","services/generateFilledDocx.ts"],"sourcesContent":["import { openDB, DBSchema, IDBPDatabase } from 'idb';\r\n\r\ninterface BarangayDB extends DBSchema {\r\n  users: {\r\n    key: string;\r\n    value: any;\r\n    indexes: { 'by-email': string };\r\n  };\r\n  documents: {\r\n    key: string;\r\n    value: any;\r\n    indexes: { 'by-user': string };\r\n  };\r\n  syncQueue: {\r\n    key: string;\r\n    value: {\r\n      operation: 'create' | 'update' | 'delete';\r\n      collection: string;\r\n      data: any;\r\n      timestamp: number;\r\n    };\r\n  };\r\n}\r\n\r\nclass LocalDatabase {\r\n  private db: IDBPDatabase<BarangayDB> | null = null;\r\n  private static instance: LocalDatabase;\r\n\r\n  private constructor() {}\r\n\r\n  static getInstance(): LocalDatabase {\r\n    if (!LocalDatabase.instance) {\r\n      LocalDatabase.instance = new LocalDatabase();\r\n    }\r\n    return LocalDatabase.instance;\r\n  }\r\n\r\n  async initialize(): Promise<void> {\r\n    this.db = await openDB<BarangayDB>('barangay-system', 1, {\r\n      upgrade(db) {\r\n        // Users store\r\n        if (!db.objectStoreNames.contains('users')) {\r\n          const userStore = db.createObjectStore('users', { keyPath: '_id' });\r\n          userStore.createIndex('by-email', 'email');\r\n        }\r\n\r\n        // Documents store\r\n        if (!db.objectStoreNames.contains('documents')) {\r\n          const docStore = db.createObjectStore('documents', { keyPath: '_id' });\r\n          docStore.createIndex('by-user', 'userId');\r\n        }\r\n\r\n        // Sync queue store\r\n        if (!db.objectStoreNames.contains('syncQueue')) {\r\n          db.createObjectStore('syncQueue', { \r\n            keyPath: '_id',\r\n            autoIncrement: true \r\n          });\r\n        }\r\n      },\r\n    });\r\n  }\r\n\r\n  async addToSyncQueue(operation: 'create' | 'update' | 'delete', collection: string, data: any): Promise<void> {\r\n    if (!this.db) await this.initialize();\r\n    await this.db!.add('syncQueue', {\r\n      operation,\r\n      collection,\r\n      data,\r\n      timestamp: Date.now()\r\n    });\r\n  }\r\n\r\n  async getAllFromSyncQueue(): Promise<any[]> {\r\n    if (!this.db) await this.initialize();\r\n    return this.db!.getAll('syncQueue');\r\n  }\r\n\r\n  async clearSyncQueue(): Promise<void> {\r\n    if (!this.db) await this.initialize();\r\n    const tx = this.db!.transaction('syncQueue', 'readwrite');\r\n    await tx.objectStore('syncQueue').clear();\r\n  }\r\n\r\n  // Users\r\n  async saveUser(user: any): Promise<void> {\r\n    if (!this.db) await this.initialize();\r\n    await this.db!.put('users', user);\r\n  }\r\n\r\n  async getUser(id: string): Promise<any | undefined> {\r\n    if (!this.db) await this.initialize();\r\n    return this.db!.get('users', id);\r\n  }\r\n\r\n  async getAllUsers(): Promise<any[]> {\r\n    if (!this.db) await this.initialize();\r\n    return this.db!.getAll('users');\r\n  }\r\n\r\n  async deleteUser(id: string): Promise<void> {\r\n    if (!this.db) await this.initialize();\r\n    await this.db!.delete('users', id);\r\n  }\r\n\r\n  // Documents\r\n  async saveDocument(document: any): Promise<void> {\r\n    if (!this.db) await this.initialize();\r\n    await this.db!.put('documents', document);\r\n  }\r\n\r\n  async getDocument(id: string): Promise<any | undefined> {\r\n    if (!this.db) await this.initialize();\r\n    return this.db!.get('documents', id);\r\n  }\r\n\r\n  async getAllDocuments(): Promise<any[]> {\r\n    if (!this.db) await this.initialize();\r\n    return this.db!.getAll('documents');\r\n  }\r\n\r\n  async deleteDocument(id: string): Promise<void> {\r\n    if (!this.db) await this.initialize();\r\n    await this.db!.delete('documents', id);\r\n  }\r\n\r\n  // Settings\r\n  async saveSettings(settings: any): Promise<void> {\r\n    if (!this.db) await this.initialize();\r\n    await this.db!.put('users', { _id: 'settings', ...settings });\r\n  }\r\n\r\n  async getSettings(): Promise<any | undefined> {\r\n    if (!this.db) await this.initialize();\r\n    return this.db!.get('users', 'settings');\r\n  }\r\n}\r\n\r\nexport const localDB = LocalDatabase.getInstance();\r\n","import { localDB } from './localDatabase';\r\nimport { axiosInstance } from './api';\r\n\r\nclass SyncService {\r\n  private static instance: SyncService;\r\n  private isOnline: boolean = navigator.onLine;\r\n  private syncInterval: NodeJS.Timeout | null = null;\r\n\r\n  private constructor() {\r\n    this.setupEventListeners();\r\n    this.startSyncInterval();\r\n  }\r\n\r\n  static getInstance(): SyncService {\r\n    if (!SyncService.instance) {\r\n      SyncService.instance = new SyncService();\r\n    }\r\n    return SyncService.instance;\r\n  }\r\n\r\n  private setupEventListeners(): void {\r\n    window.addEventListener('online', this.handleOnline);\r\n    window.addEventListener('offline', this.handleOffline);\r\n  }\r\n\r\n  private handleOnline = async (): Promise<void> => {\r\n    this.isOnline = true;\r\n    console.log('Connection restored. Starting sync...');\r\n    await this.syncWithServer();\r\n  };\r\n\r\n  private handleOffline = (): void => {\r\n    this.isOnline = false;\r\n    console.log('Connection lost. Operating in offline mode...');\r\n  };\r\n\r\n  private startSyncInterval(): void {\r\n    if (this.syncInterval) return;\r\n    \r\n    // Attempt to sync every 5 minutes when online\r\n    this.syncInterval = setInterval(async () => {\r\n      if (this.isOnline) {\r\n        await this.syncWithServer();\r\n      }\r\n    }, 5 * 60 * 1000);\r\n  }\r\n\r\n  private async syncWithServer(): Promise<void> {\r\n    try {\r\n      const pendingChanges = await localDB.getAllFromSyncQueue();\r\n      if (pendingChanges.length === 0) return;\r\n      console.log(`Syncing ${pendingChanges.length} pending changes...`);\r\n      for (const change of pendingChanges) {\r\n        try {\r\n          await this.processSyncItem(change);\r\n        } catch (error) {\r\n          if (error && typeof error === 'object' && 'message' in error && typeof (error as any).message === 'string') {\r\n            console.error(`Failed to sync item:`, change, error);\r\n            if ((error as any).message === 'Network Error') {\r\n              this.isOnline = false;\r\n              break;\r\n            }\r\n          } else {\r\n            console.error(`Failed to sync item:`, change, error);\r\n          }\r\n        }\r\n      }\r\n      // Clear successfully synced items\r\n      await localDB.clearSyncQueue();\r\n    } catch (error) {\r\n      if (error && typeof error === 'object' && 'message' in error && typeof (error as any).message === 'string') {\r\n        console.error('Sync failed:', (error as any).message);\r\n      } else {\r\n        console.error('Sync failed:', error);\r\n      }\r\n    }\r\n  }\r\n\r\n  private async processSyncItem(item: any): Promise<void> {\r\n    const { operation, collection, data } = item;\r\n    \r\n    switch (operation) {\r\n      case 'create':\r\n        await axiosInstance.post(`/${collection}`, data);\r\n        break;\r\n      \r\n      case 'update':\r\n        await axiosInstance.put(`/${collection}/${data._id}`, data);\r\n        break;\r\n      \r\n      case 'delete':\r\n        await axiosInstance.delete(`/${collection}/${data._id}`);\r\n        break;\r\n    }\r\n  }\r\n\r\n  public async performOperation(\r\n    operation: 'create' | 'update' | 'delete',\r\n    collection: string,\r\n    data: any\r\n  ): Promise<void> {\r\n    // Save to local database first\r\n    switch (operation) {\r\n      case 'create':\r\n      case 'update':\r\n        await localDB.saveUser(data);\r\n        break;\r\n      case 'delete':\r\n        await localDB.deleteUser(data._id);\r\n        break;\r\n    }\r\n\r\n    // Add to sync queue\r\n    await localDB.addToSyncQueue(operation, collection, data);\r\n\r\n    // If online, try to sync immediately\r\n    if (this.isOnline) {\r\n      await this.syncWithServer();\r\n    }\r\n  }\r\n\r\n  public cleanup(): void {\r\n    if (this.syncInterval) {\r\n      clearInterval(this.syncInterval);\r\n    }\r\n    window.removeEventListener('online', this.handleOnline);\r\n    window.removeEventListener('offline', this.handleOffline);\r\n  }\r\n}\r\n\r\nexport const syncService = SyncService.getInstance();\r\n","import axios from 'axios';\r\nimport { \r\n  SystemSettings,\r\n  User,\r\n  ActivityLog,\r\n  SystemStatistics\r\n} from '../types/admin';\r\nimport { Notification } from '../types/notification';\r\nimport { localDB } from './localDatabase';\r\nimport { syncService } from './syncService';\r\n// Fetch template text for a document type\r\nexport const getTemplateText = (type: string) =>\r\n  axiosInstance.get(`/templates/${type}`).then(res => res.data.text);\r\n\r\n// Notification API\r\nconst notificationAPI = {\r\n  // Get all notifications for current admin\r\n  getNotifications: async (): Promise<Notification[]> => {\r\n    try {\r\n      const response = await axiosInstance.get('/notifications');\r\n      // Normalize response to array\r\n      const data = Array.isArray(response.data) ? response.data : (response.data && response.data.data) ? response.data.data : [];\r\n      return data;\r\n    } catch (err: any) {\r\n      // If the primary endpoint fails (404 or auth), attempt public fallback which returns [] in server routes\r\n      try {\r\n        const fallback = await axiosInstance.get('/notifications/fallback');\r\n        return Array.isArray(fallback.data) ? fallback.data : (fallback.data && fallback.data.data) ? fallback.data.data : [];\r\n      } catch (err2) {\r\n        // As a last resort, return empty array so UI remains functional\r\n        console.error('notificationAPI.getNotifications failed:', err);\r\n        return [];\r\n      }\r\n    }\r\n  },\r\n  // Approve staff request\r\n  approveStaff: async (userId: string, notificationId: string) => {\r\n    const response = await axiosInstance.post('/notifications/approve', { userId, notificationId });\r\n    return response.data;\r\n  },\r\n  // Reject staff request\r\n  rejectStaff: async (notificationId: string, reason?: string) => {\r\n    const response = await axiosInstance.post('/notifications/reject', { notificationId, reason });\r\n    return response.data;\r\n  },\r\n  // Mark notification as read\r\n  markAsRead: async (notificationId: string) => {\r\n    const response = await axiosInstance.post('/notifications/read', { notificationId });\r\n    return response.data;\r\n  },\r\n};\r\n\r\n// Staff registration API\r\nexport const staffRegister = async (data: any) => {\r\n  const response = await axiosInstance.post('/auth/register/staff', data);\r\n  return response.data;\r\n};\r\n\r\n// Use a relative API base so the dev server proxy and production deployment\r\n// both route requests correctly (avoids hard-coded localhost which can\r\n// cause CORS or incorrect-host issues). The CRA dev server has a proxy\r\n// set to http://localhost:5000 in client/package.json, so using '/api'\r\n// will be forwarded to the backend during development.\r\n// Allow an override via REACT_APP_API_URL for cases where the API is hosted\r\n// on a different origin (useful for staging). Default to the relative `/api`\r\n// so the CRA dev proxy forwards requests to the backend in development.\r\n// Resolve API URL in this order:\r\n// 1. runtime config served from /config.json (globalThis.__APP_CONFIG__.API_BASE)\r\n// 2. build-time env var REACT_APP_API_URL\r\n// 3. fallback to relative '/api' so dev proxy works\r\nconst runtimeCfg = (globalThis as any).__APP_CONFIG__;\r\nexport const API_URL = (runtimeCfg && runtimeCfg.API_BASE) || process.env.REACT_APP_API_URL || '/api';\r\n\r\nexport const axiosInstance = axios.create({\r\n  baseURL: API_URL,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n  withCredentials: true, // Send cookies with every request\r\n});\r\n\r\n// Public axios instance (no credentials) that uses the same resolved API base.\r\n// Use this for public endpoints (guest views) so we don't send auth cookies\r\n// and avoid 401/redirect HTML pages that the client may try to parse as JSON.\r\nexport const axiosPublic = axios.create({\r\n  baseURL: API_URL,\r\n  headers: { 'Content-Type': 'application/json' },\r\n  withCredentials: false,\r\n});\r\n\r\n// Build an absolute URL to the API given a path (path may start with '/').\r\n// This normalizes the configured API base (runtime config -> REACT_APP_API_URL -> '/api')\r\n// and ensures requests to asset URLs (images/files) resolve to the correct origin.\r\nexport function getAbsoluteApiUrl(path: string) {\r\n  const cfg = (globalThis as any).__APP_CONFIG__;\r\n  const base = (cfg && cfg.API_BASE) || process.env.REACT_APP_API_URL || '/api';\r\n  let root = String(base).replace(/\\/$/, '');\r\n  // If the base includes the '/api' suffix, strip it to create a root host\r\n  if (root.endsWith('/api')) root = root.replace(/\\/api$/, '');\r\n  // Ensure path begins with a single '/'\r\n  const p = path.startsWith('/') ? path : `/${path}`;\r\n  // If caller already passed a path that starts with '/api', just join with root\r\n  if (p.startsWith('/api')) return `${root}${p}`;\r\n  // Otherwise prefix with /api\r\n  return `${root}/api${p}`;\r\n}\r\n\r\n\r\n// Auth service wrapper\r\nexport const authService = {\r\n  login: async (email: string, password: string) => {\r\n    const response = await axiosInstance.post('/auth/login', { email, password });\r\n    return response.data;\r\n  },\r\n  register: async (userData: any) => {\r\n    const response = await axiosInstance.post('/auth/register', userData);\r\n    return response.data;\r\n  },\r\n  logout: async () => {\r\n    await axiosInstance.post('/auth/logout');\r\n  },\r\n  // Fetch current authenticated user's full profile\r\n  getCurrentUser: async () => {\r\n    const response = await axiosInstance.get('/auth/me');\r\n    return response.data;\r\n  }\r\n};\r\n\r\n// Add auth token to requests\r\naxiosInstance.interceptors.request.use((config) => {\r\n  // Prefer the primary auth token (set at login). Fall back to a guest session\r\n  // token if present so guest users can make authenticated requests that the\r\n  // server accepts (the server issues `sessionToken` for guest flows).\r\n  const token = localStorage.getItem('token') || localStorage.getItem('guestSessionToken');\r\n  if (token && config.headers) {\r\n    config.headers.Authorization = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n});\r\n\r\n// Global response handler: if any request returns 401, clear auth and redirect to login\r\naxiosInstance.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    try {\r\n      const status = error?.response?.status;\r\n      if (status === 401) {\r\n        // Avoid redirect loops: only redirect if we're not already on the login page\r\n        // and the failed request was not the login attempt itself.\r\n        if (typeof window !== 'undefined') {\r\n          const currentPath = window.location.pathname || '';\r\n          const requestUrl = (error?.config && (error.config.url || '')) || (error?.request && error.request.responseURL) || '';\r\n          const isLoginRequest = requestUrl.includes('/auth/login') || requestUrl.includes('/auth/me');\r\n          const isLoginPage = currentPath === '/login' || currentPath.startsWith('/login');\r\n\r\n          if (!isLoginPage && !isLoginRequest) {\r\n            console.warn('API responded 401 Unauthorized  clearing auth and redirecting to login');\r\n            try {\r\n              localStorage.removeItem('token');\r\n              localStorage.removeItem('guestSessionToken');\r\n            } catch (e) {}\r\n\r\n            // Debounce multiple simultaneous 401s so we only force one navigation.\r\n            try {\r\n              if (!sessionStorage.getItem('redirectingToLogin')) {\r\n                sessionStorage.setItem('redirectingToLogin', '1');\r\n                // Small timeout so callers can finish their promise chains and avoid\r\n                // racing navigation that could otherwise produce reload storms.\r\n                setTimeout(() => {\r\n                  window.location.href = '/login';\r\n                }, 100);\r\n              } else {\r\n                // Already in the process of redirecting; no-op to avoid loops.\r\n              }\r\n            } catch (e) {\r\n              // sessionStorage may throw in some environments; fallback to immediate redirect\r\n              try {\r\n                window.location.href = '/login';\r\n              } catch (_e) {}\r\n            }\r\n          } else {\r\n            // If we're already on the login page or this was the login request,\r\n            // don't redirect  let the login UI display the error to the user.\r\n            // Also clear tokens in case they're present.\r\n            try { localStorage.removeItem('guestSessionToken'); } catch (e) {}\r\n          }\r\n        }\r\n      }\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// API interfaces\r\n\r\nexport const getInbox = async () => {\r\n  return axiosInstance.get('/messages/inbox');\r\n};\r\n\r\n// Verification API for admin actions\r\nexport const verificationAPI = {\r\n  getRequests: async () => axiosInstance.get('/verification/admin/requests').then(res => res.data),\r\n  verifyUser: async (userId: string, verified: boolean) => axiosInstance.post(`/verification/admin/verify-user/${userId}`, { verified }).then(res => res.data),\r\n  // URL to stream/download a verification file by GridFS id\r\n  getFileUrl: (fileId: string) => `${API_URL.replace(/\\/$/, '')}/verification/file/${fileId}`,\r\n  // Approve a verification request by request id (admin)\r\n  approveRequest: async (requestId: string) => axiosInstance.post(`/verification/admin/requests/${requestId}/approve`).then(res => res.data),\r\n  // Reject a verification request by request id (admin)\r\n  rejectRequest: async (requestId: string, reason?: string) => axiosInstance.post(`/verification/admin/requests/${requestId}/reject`, { reason }).then(res => res.data),\r\n  // Resident: cancel their own verification request\r\n  cancelRequest: async (requestId: string) => axiosInstance.delete(`/verification/requests/${requestId}`).then(res => res.data),\r\n  // Get current user's verification requests\r\n  getMyRequests: async () => axiosInstance.get('/verification/requests/my').then(res => res.data),\r\n  getRequestById: async (id: string) => axiosInstance.get(`/verification/requests/${id}`).then(res => res.data),\r\n};\r\ninterface LoginCredentials {\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\ninterface RegisterData {\r\n  firstName: string;\r\n  lastName: string;\r\n  email: string;\r\n  password: string;\r\n  address: string;\r\n  contactNumber: string;\r\n  barangayID: string;\r\n  fullName?: string;\r\n  username?: string;\r\n}\r\n\r\ninterface DocumentRequest {\r\n  type: string; // add this for backend compatibility\r\n  documentType: string;\r\n  purpose: string;\r\n  additionalDetails?: Record<string, any>;\r\n  barangayID?: string;\r\n}\r\n\r\n// (Removed unused interface `InquiryRequest` to reduce lint warnings)\r\n\r\n// API implementations\r\nconst auth = {\r\n  login: (credentials: LoginCredentials) => \r\n    axiosInstance.post('/auth/login', credentials).then(response => response.data),\r\n  register: (data: RegisterData) => \r\n    axiosInstance.post('/auth/register', data).then(response => response.data),\r\n};\r\n\r\nexport const documentsAPI = {\r\n  getMyDocuments: () => \r\n    axiosInstance.get('/document-requests/my-requests').then(response => response.data),\r\n  requestDocument: (data: DocumentRequest) => \r\n    axiosInstance.post('/document-requests', data).then(response => response.data),\r\n  getDocumentById: (id: string) => \r\n    axiosInstance.get(`/document-requests/${id}`).then(response => response.data),\r\n  getAllDocuments: () =>\r\n    axiosInstance.get('/document-requests/all')\r\n      .then(response => response.data)\r\n      .catch((err) => {\r\n        // If unauthenticated (401) return an empty list instead of throwing\r\n        // so public pages don't log parse errors or unhandled rejections.\r\n        const status = err?.response?.status;\r\n        if (status === 401) {\r\n          return [] as any[];\r\n        }\r\n        // Re-throw other errors so callers can handle them as before.\r\n        throw err;\r\n      }),\r\n  getDocumentRecords: () =>\r\n    axiosInstance.get('/document-requests/all').then(response => response.data),\r\n  updateDocumentStatus: (id: string, data: { status: string; notes?: string }) =>\r\n    axiosInstance.patch(`/document-requests/${id}/process`, data).then(response => response.data),\r\n  processDocument: (id: string) =>\r\n    axiosInstance.patch(`/document-requests/${id}/process`).then(response => response.data),\r\n  listFiles: () =>\r\n    axiosInstance.get('/documents/list').then(response => response.data),\r\n  deleteFile: (id: string) =>\r\n    axiosInstance.delete(`/documents/file/${id}`).then(response => response.data),\r\n  updateFileStatus: (id: string, data: { status: string }) =>\r\n    axiosInstance.patch(`/documents/file/${id}/status`, data).then(response => response.data),\r\n  getFilledDocument: (id: string) =>\r\n    axiosInstance.get(`/document-requests/${id}/filled`).then(response => response.data),\r\n  previewFilledDocument: (data: any) =>\r\n    axiosInstance.post('/document-requests/preview-filled', data).then(response => response.data),\r\n};\r\n\r\nconst contact = {\r\n  submitInquiry: (data: any) => {\r\n    // Support FormData (multipart) or JSON payloads\r\n    if (typeof FormData !== 'undefined' && data instanceof FormData) {\r\n      return axiosInstance.post('/inquiries', data, { headers: { 'Content-Type': 'multipart/form-data' } }).then(response => response.data);\r\n    }\r\n    return axiosInstance.post('/inquiries', data).then(response => response.data);\r\n  },\r\n  getMyInquiries: (username?: string, barangayID?: string) =>\r\n    axiosInstance.get('/inquiries/my-inquiries', {\r\n      params: username && barangayID ? { username, barangayID } : undefined\r\n    }).then(response => response.data),\r\n  getInquiryById: (id: string) =>\r\n    axiosInstance.get(`/inquiries/${id}`).then(response => response.data),\r\n  // Staff-specific endpoints\r\n  getAllInquiries: () =>\r\n  axiosInstance.get('/inquiries').then(response => response.data),\r\n  respondToInquiry: (id: string, data: { response: string }) =>\r\n    axiosInstance.post(`/inquiries/${id}/responses`, data).then(response => response.data),\r\n  // Mark an inquiry as resolved (admin/staff)\r\n  resolveInquiry: (id: string) =>\r\n    axiosInstance.patch(`/inquiries/${id}`, { status: 'resolved' }).then(response => response.data),\r\n  // Public announcements\r\n  getAnnouncements: () =>\r\n    axiosInstance.get('/announcements').then(response => response.data),\r\n  getAnnouncementById: (id: string) =>\r\n    axiosInstance.get(`/announcements/${id}`).then(response => response.data),\r\n};\r\n\r\n// Requests API (generic requests collection)\r\nexport const requestsAPI = {\r\n  // Get all requests (admin/staff)\r\n  getAllRequests: async () => axiosInstance.get('/requests').then(response => response.data),\r\n  // Get a single request by id\r\n  getRequestById: async (id: string) => axiosInstance.get(`/requests/${id}`).then(response => response.data),\r\n  // Get staff access requests only (client-side filter)\r\n  getStaffAccessRequests: async () => {\r\n    const all = await axiosInstance.get('/requests').then(response => response.data);\r\n    return Array.isArray(all)\r\n      ? all.filter((r: any) => (r.type || '').toString().toLowerCase() === 'staff_access' && (r.status || '').toString().toLowerCase() === 'pending')\r\n      : [];\r\n  }\r\n  ,\r\n  // Approve a request by id (admin)\r\n  approveRequest: async (id: string) => {\r\n    const response = await axiosInstance.post(`/requests/${id}/approve`);\r\n    return response.data;\r\n  }\r\n};\r\n\r\n// Admin API\r\nconst admin = {\r\n  createUser: async (userData: any): Promise<void> => {\r\n    try {\r\n      const response = await axiosInstance.post('/admin/users', userData);\r\n      if (response.data) {\r\n        await localDB.saveUser(response.data);\r\n        try {\r\n          // Notify listeners that a user profile was created/updated\r\n          const ev = new CustomEvent('userProfileUpdated', { detail: response.data });\r\n          window.dispatchEvent(ev);\r\n        } catch (err) {\r\n          // ignore\r\n        }\r\n      }\r\n    } catch (error) {\r\n      if (!navigator.onLine) {\r\n        await syncService.performOperation('create', 'users', userData);\r\n      }\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  updateUser: async (userId: string, userData: any): Promise<void> => {\r\n    try {\r\n      const response = await axiosInstance.put(`/admin/users/${userId}`, userData);\r\n      if (response.data) {\r\n        await localDB.saveUser(response.data);\r\n        try {\r\n          // Notify any listeners (e.g., AuthContext) that a user profile has updated\r\n          const ev = new CustomEvent('userProfileUpdated', { detail: response.data });\r\n          window.dispatchEvent(ev);\r\n        } catch (err) {\r\n          // ignore\r\n        }\r\n      }\r\n    } catch (error) {\r\n      if (!navigator.onLine) {\r\n        await syncService.performOperation('update', 'users', { ...userData, _id: userId });\r\n      }\r\n      throw error;\r\n    }\r\n  },\r\n  // Demote a staff user back to resident\r\n  demoteUser: async (userId: string) => {\r\n    try {\r\n      const response = await axiosInstance.put(`/admin/users/${userId}`, { role: 'resident' });\r\n      return response.data;\r\n    } catch (error) {\r\n      if (!navigator.onLine) {\r\n        // queue for sync if offline\r\n        await syncService.performOperation('update', 'users', { _id: userId, role: 'resident' });\r\n        return;\r\n      }\r\n      throw error;\r\n    }\r\n  },\r\n  // System Settings\r\n  getSystemSettings: async (): Promise<SystemSettings> => {\r\n    try {\r\n      // Try admin-only settings first\r\n      const response = await axiosInstance.get('/admin/settings');\r\n      return response.data;\r\n    } catch (error) {\r\n      // If offline, return cached settings\r\n      if (!navigator.onLine) {\r\n        const settings = await localDB.getSettings();\r\n        if (settings) return settings;\r\n      }\r\n      // If the dev proxy isn't forwarding (requests hit :3000 and return 404),\r\n      // try fallbacks in order: /settings (non-admin), then admin settings,\r\n      // then absolute /settings, and finally /settings/public if enabled on server.\r\n      try {\r\n        // try non-admin path on same base (/api/settings)\r\n        const resp = await axiosInstance.get('/settings');\r\n        return resp.data;\r\n      } catch (e1) {\r\n        try {\r\n          // attempt admin settings again via configured API base\r\n          const resp2 = await axiosInstance.get('/admin/settings');\r\n          return resp2.data;\r\n        } catch (e2) {\r\n          try {\r\n            const resp3 = await axiosInstance.get('/settings');\r\n            return resp3.data;\r\n          } catch (e3) {\r\n            try {\r\n              // try optional public endpoint if server enabled DEBUG_PUBLIC_SETTINGS\r\n              const resp4 = await axiosInstance.get('/settings/public');\r\n              return resp4.data;\r\n            } catch (e4) {\r\n              // As a last resort, return cached settings or a minimal default so UI does not crash\r\n              try {\r\n                const cached = await localDB.getSettings();\r\n                if (cached) return cached;\r\n              } catch (dbErr) {\r\n                // ignore\r\n              }\r\n              console.warn('getSystemSettings: all fallbacks failed; returning empty defaults. Original error:', error);\r\n              // Return a minimal default settings object to keep UI functional\r\n              const defaults: any = {\r\n                siteName: 'Barangay Information System',\r\n                contactEmail: '',\r\n                smtp: { passwordSet: false },\r\n              };\r\n              return defaults as SystemSettings;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  updateSystemSettings: async (settings: SystemSettings): Promise<void> => {\r\n    try {\r\n      const response = await axiosInstance.patch('/admin/settings', settings);\r\n      await localDB.saveSettings(settings);\r\n      return response.data;\r\n    } catch (error) {\r\n      // If offline, queue for sync and return\r\n      if (!navigator.onLine) {\r\n        await syncService.performOperation('update', 'settings', settings);\r\n        return;\r\n      }\r\n      // If the dev proxy isn't forwarding (requests hit :3000 and return 404),\r\n      // try a direct request to the backend API base as a fallback.\r\n      try {\r\n        // Attempt direct PATCH using configured API base\r\n        const resp = await axiosInstance.patch('/admin/settings', settings, { withCredentials: true });\r\n        // persist locally as well\r\n        try { await localDB.saveSettings(settings); } catch (e) {}\r\n        return resp.data;\r\n      } catch (fall) {\r\n        // rethrow original error so callers receive the initial failure context\r\n        throw error;\r\n      }\r\n    }\r\n  },\r\n\r\n  // Send test SMTP email using current system SMTP settings (server-side will decrypt)\r\n  testSmtp: async (to: string) => {\r\n    const response = await axiosInstance.post('/admin/settings/test-smtp', { to });\r\n    return response.data;\r\n  },\r\n\r\n  // User Management\r\n  getUsers: async (): Promise<User[]> => {\r\n    try {\r\n  const response = await axiosInstance.get('/auth/users');\r\n      const users = response.data;\r\n      // Cache users locally\r\n      for (const user of users) {\r\n        await localDB.saveUser(user);\r\n      }\r\n      return users;\r\n    } catch (error) {\r\n      if (!navigator.onLine) {\r\n        // Return cached users if offline\r\n        return localDB.getAllUsers();\r\n      }\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  updateUserStatus: async (userId: string, status: string): Promise<void> => {\r\n    try {\r\n      const response = await axiosInstance.put(`/admin/users/${userId}/status`, { status });\r\n      const user = await localDB.getUser(userId);\r\n      if (user) {\r\n        user.status = status;\r\n        await localDB.saveUser(user);\r\n        try {\r\n          // Notify listeners that a user's status has changed\r\n          const ev = new CustomEvent('userProfileUpdated', { detail: user });\r\n          window.dispatchEvent(ev);\r\n        } catch (err) {\r\n          // ignore\r\n        }\r\n      }\r\n      return response.data;\r\n    } catch (error) {\r\n      if (!navigator.onLine) {\r\n        // Update locally and queue for sync\r\n        const user = await localDB.getUser(userId);\r\n        if (user) {\r\n          user.status = status;\r\n          await syncService.performOperation('update', 'users', user);\r\n        }\r\n        return;\r\n      }\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  deleteUser: async (userId: string): Promise<void> => {\r\n    try {\r\n      await axiosInstance.delete(`/admin/users/${userId}`);\r\n      await localDB.deleteUser(userId);\r\n      try {\r\n        // Notify listeners that a user was deleted; include id so listeners can react\r\n        const ev = new CustomEvent('userProfileUpdated', { detail: { _id: userId, deleted: true } });\r\n        window.dispatchEvent(ev);\r\n      } catch (err) {\r\n        // ignore\r\n      }\r\n    } catch (error) {\r\n      if (!navigator.onLine) {\r\n        // Delete locally and queue for sync\r\n        await syncService.performOperation('delete', 'users', { _id: userId });\r\n        return;\r\n      }\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Activity Logs\r\n  getActivityLogs: (filters: { startDate?: string; endDate?: string; module?: string; userId?: string }): Promise<ActivityLog[]> =>\r\n    axiosInstance.get('/admin/logs', { params: filters }).then(response => response.data),\r\n\r\n  // Statistics\r\n  getSystemStatistics: (): Promise<SystemStatistics> =>\r\n    axiosInstance.get('/admin/statistics').then(response => response.data),\r\n\r\n  // Staff Applicants\r\n  getStaffApplicants: async (): Promise<{ count: number; applicants: any[] }> => {\r\n    const response = await axiosInstance.get('/admin/staff-applications');\r\n    return response.data;\r\n  },\r\n  // Get user with resident info (admin)\r\n  getUserWithResident: async (userId: string) => {\r\n    const response = await axiosInstance.get(`/admin/users/${userId}/with-resident`);\r\n    return response.data;\r\n  },\r\n  // Admin: lookup resident by barangayID\r\n  getResidentByBarangayID: async (barangayID: string) => {\r\n    const response = await axiosInstance.get(`/admin/resident/${encodeURIComponent(barangayID)}`);\r\n    return response.data;\r\n  },\r\n  // Admin: get resident by id\r\n  getResident: async (residentId: string) => {\r\n    const response = await axiosInstance.get(`/admin/resident/id/${residentId}`);\r\n    return response.data;\r\n  },\r\n  // Admin: update resident record\r\n  updateResident: async (residentId: string, data: any) => {\r\n    const response = await axiosInstance.put(`/admin/resident/${residentId}`, data);\r\n    return response.data;\r\n  },\r\n  // Admin: upload resident avatar (multipart/form-data)\r\n  uploadResidentAvatar: async (residentId: string, file: File) => {\r\n    const form = new FormData();\r\n    form.append('avatar', file);\r\n    const response = await axiosInstance.post(`/admin/resident/${residentId}/avatar`, form, {\r\n      // Let the browser/axios set the Content-Type including the multipart boundary\r\n    });\r\n    return response.data;\r\n  },\r\n  // Barangay Officials endpoints\r\n  getOfficials: async () => {\r\n    try {\r\n      const response = await axiosInstance.get('/admin/officials');\r\n      return response.data;\r\n    } catch (error) {\r\n      // If proxies/backends aren't responding or return 404, try a public backend URL\r\n      // This attempts the absolute API base (REACT_APP_API_URL or localhost fallback)\r\n      // and purposely omits credentials so public endpoints aren't blocked by auth/proxy.\r\n      // If that also fails, return an empty array so UI remains functional.\r\n      console.warn('getOfficials: primary request failed; attempting public backend fallback. Error:', error);\r\n      try {\r\n        const resp2 = await axiosPublic.get('/officials');\r\n        return Array.isArray(resp2.data) ? resp2.data : [];\r\n      } catch (pfall) {\r\n        return [];\r\n      }\r\n    }\r\n  },\r\n  createOfficial: async (data: any) => {\r\n    try {\r\n      const response = await axiosInstance.post('/admin/officials', data);\r\n      return response.data;\r\n    } catch (error) {\r\n      // Creating an official is an admin operation and should fail loudly if\r\n      // the authenticated request does not succeed. Rethrow the original\r\n      // error so callers can handle/show the proper message.\r\n      throw error;\r\n    }\r\n  },\r\n  updateOfficial: async (id: string, data: any) => {\r\n    try {\r\n      const response = await axiosInstance.put(`/admin/officials/${id}`, data);\r\n      return response.data;\r\n    } catch (error) {\r\n      // If offline, queue for sync\r\n      if (!navigator.onLine) {\r\n        await syncService.performOperation('update', 'officials', { ...data, _id: id });\r\n        return;\r\n      }\r\n      // Rethrow original error so callers can handle it; fallback to a\r\n      // direct backend URL is unnecessary when runtime `API_BASE` exists.\r\n      throw error;\r\n    }\r\n  },\r\n  deleteOfficial: async (id: string) => {\r\n    const response = await axiosInstance.delete(`/admin/officials/${id}`);\r\n    return response.data;\r\n  },\r\n  // Disable (optionally suspend until a date) a user\r\n  disableUser: async (userId: string, data?: { suspendedUntil?: string }) => {\r\n    const response = await axiosInstance.patch(`/admin/users/${userId}/disable`, data || {});\r\n    return response.data;\r\n  },\r\n  // Enable a previously disabled user\r\n  enableUser: async (userId: string) => {\r\n    const response = await axiosInstance.patch(`/admin/users/${userId}/enable`);\r\n    return response.data;\r\n  },\r\n  uploadOfficialPhoto: async (id: string, file: File) => {\r\n    const form = new FormData();\r\n    form.append('photo', file);\r\n    // Try the axios instance first (should let browser set multipart boundary).\r\n    try {\r\n      const response = await axiosInstance.post(`/admin/officials/${id}/photo`, form, { headers: {} });\r\n      return response.data;\r\n    } catch (err: any) {\r\n      // If server returned a 400 possibly due to malformed multipart headers,\r\n      // attempt a raw fetch fallback which uses the browser-native request\r\n      // (ensures proper Content-Type/boundary). Also surface server response\r\n      // where possible to aid debugging.\r\n      try {\r\n        if (err && err.response && err.response.data) {\r\n          console.error('uploadOfficialPhoto axios error response:', err.response.data);\r\n        } else {\r\n          console.error('uploadOfficialPhoto axios error', err);\r\n        }\r\n      } catch (e) {}\r\n\r\n      // Fallback to fetch with credentials so cookies/auth are sent\r\n      try {\r\n        const url = `${API_URL}/admin/officials/${id}/photo`;\r\n        const resp = await fetch(url, {\r\n          method: 'POST',\r\n          body: form,\r\n          credentials: 'include'\r\n        });\r\n        const data = await resp.json().catch(() => ({}));\r\n        if (!resp.ok) {\r\n          const msg = (data && data.message) ? data.message : `Upload failed with status ${resp.status}`;\r\n          const error = new Error(msg) as any;\r\n          error.response = { status: resp.status, data };\r\n          throw error;\r\n        }\r\n        return data;\r\n      } catch (fetchErr) {\r\n        throw fetchErr;\r\n      }\r\n    }\r\n  },\r\n  // Approve a staff applicant (server should expose this endpoint)\r\n  approveStaffApplicant: async (applicantId: string) => {\r\n    const response = await axiosInstance.post(`/admin/staff-applications/${applicantId}/approve`);\r\n    return response.data;\r\n  },\r\n  // Announcements\r\n  createAnnouncement: async (formData: FormData) => {\r\n    const response = await axiosInstance.post('/admin/announcements', formData, {\r\n      headers: { 'Content-Type': 'multipart/form-data' }\r\n    });\r\n    return response.data;\r\n  },\r\n  listAdminAnnouncements: async () => {\r\n    const response = await axiosInstance.get('/admin/announcements/list');\r\n    return response.data;\r\n  },\r\n  deleteAnnouncement: async (id: string) => {\r\n    const response = await axiosInstance.delete(`/admin/announcements/${id}`);\r\n    return response.data;\r\n  },\r\n  updateAnnouncement: async (id: string, formData: FormData) => {\r\n    const response = await axiosInstance.put(`/admin/announcements/${id}`, formData, {\r\n      headers: { 'Content-Type': 'multipart/form-data' }\r\n    });\r\n    return response.data;\r\n  },\r\n};\r\n\r\n// Resident Personal Info API\r\nconst residentPersonalInfoAPI = {\r\n  getPersonalInfo: async () => {\r\n    // Try several common endpoints used across versions of the server\r\n    const candidates = ['/resident/my-info', '/resident/personal-info', '/resident/profile'];\r\n    for (const path of candidates) {\r\n      try {\r\n        const resp = await axiosInstance.get(path);\r\n        if (resp && resp.data) return resp.data;\r\n      } catch (e) {\r\n        // continue to next candidate\r\n      }\r\n    }\r\n    // Last-resort: hit absolute API_URL to avoid using client origin (avoids 3000 -> 404)\r\n    try {\r\n      const resp = await axiosInstance.get('/resident/personal-info');\r\n      if (resp && resp.data) return resp.data;\r\n    } catch (e) {\r\n      // ignore and throw below\r\n    }\r\n    const err: any = new Error('Resident personal info not found');\r\n    // attach a pseudo-response to aid callers checking err.response?.status\r\n    err.response = { status: 404 };\r\n    throw err;\r\n  },\r\n  updatePersonalInfo: async (data: any) => {\r\n    const response = await axiosInstance.put('/resident/my-info', data);\r\n    return response.data;\r\n  },\r\n};\r\n\r\nexport const authAPI = {\r\n  ...auth,\r\n  getUsers: async (): Promise<User[]> => {\r\n    try {\r\n      const response = await axiosInstance.get('/auth/users');\r\n      return response.data;\r\n    } catch (error) {\r\n      // keep logging minimal and rethrow so callers can handle errors\r\n      // ...existing error handling might expect a thrown error\r\n      // eslint-disable-next-line no-console\r\n      console.error('authAPI.getUsers failed', error);\r\n      throw error;\r\n    }\r\n  }\r\n};\r\nexport { \r\n  contact as contactAPI, \r\n  admin as adminAPI,\r\n  notificationAPI,\r\n  residentPersonalInfoAPI,\r\n  axiosInstance as default\r\n};\r\n","import React, { useEffect, useState } from 'react';\r\nimport { getAbsoluteApiUrl } from '../services/api';\r\n\r\ntype AvatarSource = {\r\n  profileImage?: string | null;\r\n  profileImageId?: string | null;\r\n  profilePicture?: string | null; // legacy\r\n  fullName?: string | null;\r\n  username?: string | null;\r\n  email?: string | null;\r\n};\r\n\r\ntype Props = {\r\n  user?: AvatarSource | null;\r\n  src?: string | null;\r\n  profileImageId?: string | null;\r\n  size?: number;\r\n  alt?: string;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  cacheBust?: boolean;\r\n  cacheToken?: string | number;\r\n};\r\n\r\nconst AvatarImage: React.FC<Props> = ({ user, src, profileImageId, size = 40, alt = '', className, style, cacheBust = false, cacheToken }) => {\r\n  const u = user as any;\r\n  const id = profileImageId || u?.profileImageId || null;\r\n  const [errored, setErrored] = useState(false);\r\n  let imageSrc = src || u?.profileImage || u?.profilePicture || null;\r\n  // Normalize relative image paths to absolute API URLs so GridFS or server-hosted\r\n  // images are fetched from the configured API origin rather than the current origin.\r\n  try {\r\n    if (imageSrc && typeof imageSrc === 'string' && !imageSrc.startsWith('http')) {\r\n      // If it's an API path (starts with /resident or /api) or a root-relative path,\r\n      // convert it to an absolute API URL.\r\n      imageSrc = getAbsoluteApiUrl(imageSrc);\r\n    }\r\n  } catch (e) {\r\n    // ignore and keep original imageSrc\r\n  }\r\n\r\n  // Compute effective source URLs deterministically before using hooks\r\n  let base: string | null = null;\r\n  let srcUrl: string | null = null;\r\n  let finalSrc: string | null = null;\r\n  try {\r\n    if (id) {\r\n      base = getAbsoluteApiUrl(`/resident/personal-info/avatar/${id}`);\r\n      srcUrl = cacheBust ? `${base}${base.includes('?') ? '&' : '?'}t=${cacheToken ?? Date.now()}` : base;\r\n    }\r\n  } catch (e) {\r\n    // ignore\r\n  }\r\n\r\n  try {\r\n    if (!srcUrl && imageSrc && typeof imageSrc === 'string' && !imageSrc.startsWith('http')) {\r\n      finalSrc = getAbsoluteApiUrl(imageSrc);\r\n    } else if (!srcUrl && imageSrc) {\r\n      finalSrc = imageSrc as string;\r\n    }\r\n  } catch (e) {\r\n    // ignore\r\n  }\r\n\r\n  const currentSrc = srcUrl || finalSrc || null;\r\n\r\n  // Reset errored flag whenever the effective source changes\r\n  useEffect(() => {\r\n    setErrored(false);\r\n  }, [currentSrc]);\r\n\r\n  if (currentSrc && !errored) {\r\n    return (\r\n      <img\r\n        src={currentSrc}\r\n        alt={alt || u?.fullName || u?.username || u?.email || 'avatar'}\r\n        width={size}\r\n        height={size}\r\n        onError={() => setErrored(true)}\r\n        style={{ width: size, height: size, borderRadius: '50%', objectFit: 'cover', ...style }}\r\n        className={className}\r\n      />\r\n    );\r\n  }\r\n\r\n  // Fallback to ui-avatars (use a sensible default if no name available).\r\n  const rawName = (u?.fullName || u?.username || u?.email || '').toString().trim();\r\n  const name = rawName || 'User';\r\n  const avatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=2196F3&color=fff&size=${Math.max(Math.min(size, 256), 32)}`;\r\n  return (\r\n    <img\r\n      src={avatarUrl}\r\n      alt={alt || name || 'avatar'}\r\n      width={size}\r\n      height={size}\r\n      style={{ width: size, height: size, borderRadius: '50%', objectFit: 'cover', ...style }}\r\n      className={className}\r\n    />\r\n  );\r\n};\r\n\r\nexport default AvatarImage;\r\n","import React from 'react';\r\nimport AvatarImage from './AvatarImage';\r\nimport './AppAvatar.css';\r\n\r\ntype Size = number | 'small' | 'default' | 'large';\r\n\r\ntype Props = {\r\n  src?: string | null;\r\n  user?: any;\r\n  profileImageId?: string | null;\r\n  size?: Size;\r\n  alt?: string;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  children?: React.ReactNode;\r\n  icon?: React.ReactNode;\r\n  // background and text color for initials/icon badge\r\n  background?: string;\r\n  color?: string;\r\n};\r\n\r\nconst mapSize = (s: Size): number => {\r\n  if (typeof s === 'number') return s;\r\n  switch (s) {\r\n    case 'small':\r\n      return 24;\r\n    case 'large':\r\n      return 56;\r\n    default:\r\n      return 36;\r\n  }\r\n};\r\n\r\nconst AppAvatar: React.FC<Props> = ({ src, user, profileImageId, size = 'default', alt, className, style, children, icon, background = '#1890ff', color = '#fff' }) => {\r\n  const s = mapSize(size);\r\n\r\n  // If we have an image source or a user with an image id, render AvatarImage\r\n  const hasImage = Boolean(src || profileImageId || (user && (user.profileImage || user.profileImageId || user.profilePicture || user.avatar)));\r\n  const baseClass = 'app-avatar';\r\n  const sizeClass = typeof size === 'string' ? `app-avatar--${size}` : '';\r\n  const classes = [baseClass, sizeClass, className].filter(Boolean).join(' ');\r\n\r\n  if (hasImage) {\r\n    const img = <AvatarImage src={src} user={user} profileImageId={profileImageId} size={s} alt={alt} className=\"app-avatar__img\" />;\r\n    if (typeof size === 'number') {\r\n      const numericStyle: React.CSSProperties = {\r\n        width: s,\r\n        height: s,\r\n        borderRadius: 10,\r\n        overflow: 'hidden',\r\n        display: 'inline-block',\r\n        ...style,\r\n      };\r\n      return (\r\n        <div className={classes} style={numericStyle} aria-hidden>\r\n          {img}\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div className={classes} style={style} aria-hidden>\r\n        {img}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Render icon or initials inside a rounded-rectangle div\r\n  const content = icon ? (\r\n    <span className=\"app-avatar__content\">{icon}</span>\r\n  ) : (\r\n    <span className=\"app-avatar__content\">{children || (user && (user.fullName || user.username || user.email) ? String((user.fullName || user.username || user.email)[0]).toUpperCase() : 'U')}</span>\r\n  );\r\n\r\n  if (typeof size === 'number') {\r\n    const numericStyle: React.CSSProperties = {\r\n      width: s,\r\n      height: s,\r\n      borderRadius: 10,\r\n      display: 'inline-flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      background: background,\r\n      color: color,\r\n      fontSize: Math.max(12, Math.floor(s / 2.8)),\r\n      ...style,\r\n    };\r\n    return (\r\n      <div className={classes} style={numericStyle} aria-hidden>\r\n        {content}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={classes} style={style} aria-hidden>\r\n      {content}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AppAvatar;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"chat-bubble\":\"inbox_chat-bubble__Kxy7B\",\"message-container\":\"inbox_message-container__t-+It\",\"left\":\"inbox_left__WC9wt\",\"right\":\"inbox_right__VDE69\",\"timestamp\":\"inbox_timestamp__bi+Yz\",\"status-badge\":\"inbox_status-badge__xpiuO\",\"status-responded\":\"inbox_status-responded__PKbUX\",\"status-awaiting\":\"inbox_status-awaiting__+0Eei\",\"chatImage\":\"inbox_chatImage__mdXCC\",\"inboxPage\":\"inbox_inboxPage__6RJ+4\",\"conversationList\":\"inbox_conversationList__Dr31L\",\"conversationCard\":\"inbox_conversationCard__2H3bs\",\"replyBarWrap\":\"inbox_replyBarWrap__tXjyq\",\"replyBar\":\"inbox_replyBar__9ELnP\",\"sendButton\":\"inbox_sendButton__iAa0e\",\"ant-avatar\":\"inbox_ant-avatar__9Ho+F\",\"ant-list-item\":\"inbox_ant-list-item__8TAwg\",\"listItem\":\"inbox_listItem__KFqD6\",\"listItemInner\":\"inbox_listItemInner__ZK1Wy\",\"listItemMain\":\"inbox_listItemMain__Mik92\",\"listItemHeader\":\"inbox_listItemHeader__m0Q+o\",\"typeIcon\":\"inbox_typeIcon__HPABg\",\"listItemName\":\"inbox_listItemName__Msccr\",\"listItemSubject\":\"inbox_listItemSubject__o+JHz\",\"listItemTime\":\"inbox_listItemTime__OEVbB\",\"listItemPreview\":\"inbox_listItemPreview__lx6mS\",\"listItemPreviewText\":\"inbox_listItemPreviewText__9hDkk\",\"listItemResponses\":\"inbox_listItemResponses__2uyBs\",\"listItemAvatar\":\"inbox_listItemAvatar__64n2p\"};","import React from 'react';\r\nimport { Input, Select, Space } from 'antd';\r\n\r\nconst { Option } = Select;\r\n\r\nexport type FilterState = {\r\n  status: 'all' | 'pending' | 'responded' | 'closed';\r\n  search: string;\r\n};\r\n\r\nexport const defaultFilterState: FilterState = {\r\n  status: 'all',\r\n  search: '',\r\n};\r\n\r\nexport const InboxFilters: React.FC<{\r\n  filter: FilterState;\r\n  setFilter: (f: FilterState) => void;\r\n}> = ({ filter, setFilter }) => (\r\n  <Space style={{ marginBottom: 24, width: '100%' }} direction=\"horizontal\" size={16}>\r\n    <Select\r\n      value={filter.status}\r\n      style={{ width: 160 }}\r\n      onChange={status => setFilter({ ...filter, status })}\r\n    >\r\n      <Option value=\"all\">All</Option>\r\n      <Option value=\"pending\"> Pending</Option>\r\n      <Option value=\"responded\"> Responded</Option>\r\n      <Option value=\"closed\"> Closed</Option>\r\n    </Select>\r\n    <Input.Search\r\n      allowClear\r\n      placeholder=\"Search by date, name, or category\"\r\n      style={{ width: 320 }}\r\n      value={filter.search}\r\n      onChange={e => setFilter({ ...filter, search: e.target.value })}\r\n    />\r\n  </Space>\r\n);\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { Card, List, Typography, Spin, message as antdMessage, Divider, Row, Col, Select, Input, Button, Tag, Result, Tooltip } from 'antd';\r\nimport AppAvatar from '../components/AppAvatar';\r\nimport { InboxOutlined, SendOutlined, MenuFoldOutlined, MenuUnfoldOutlined } from '@ant-design/icons';\r\nimport styles from './inbox.module.css';\r\nimport { defaultFilterState, FilterState } from './inbox-filters';\r\nimport { contactAPI, getAbsoluteApiUrl } from '../services/api';\r\n\r\nconst Inbox: React.FC = () => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [inquiries, setInquiries] = useState<any[]>([]);\r\n  const [filter, setFilter] = useState<FilterState>(defaultFilterState);\r\n  const [category, setCategory] = useState<string>('All');\r\n  // reply text state\r\n  const [replyLoading, setReplyLoading] = useState<{ [id: string]: boolean }>({});\r\n  const [selectedInquiry, setSelectedInquiry] = useState<any | null>(null);\r\n  const [, setThreadVisible] = useState(false);\r\n  const [leftCollapsed, setLeftCollapsed] = useState(false);\r\n  // Make messages list fullscreen by default\r\n  const [listFullscreen, setListFullscreen] = useState(true);\r\n  const [isMobile, setIsMobile] = useState<boolean>(typeof window !== 'undefined' ? window.innerWidth <= 720 : false);\r\n  const [replyText, setReplyText] = useState<string>('');\r\n  // file list state removed (setter unused)\r\n  const [, setLoadingThread] = useState<boolean>(false);\r\n  // Ref for auto-scrolling message area\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  // read current user profile from localStorage so we can mark replies with the correct author/role\r\n  // Auto-scroll to bottom of message area when selectedInquiry or its responses change\r\n  const selectedResponsesLength = selectedInquiry?.responses?.length ?? 0;\r\n  useEffect(() => {\r\n    if (messagesEndRef.current) {\r\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\r\n    }\r\n  }, [selectedInquiry, selectedResponsesLength]);\r\n  const storedProfile = (() => {\r\n    try {\r\n      return localStorage.getItem('userProfile') ? JSON.parse(localStorage.getItem('userProfile') || 'null') : null;\r\n    } catch (err) {\r\n      return null;\r\n    }\r\n  })();\r\n\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    contactAPI.getMyInquiries()\r\n      .then(res => {\r\n        setInquiries(res || []);\r\n      })\r\n      .catch(() => {\r\n        antdMessage.error('Failed to load inbox.');\r\n      })\r\n      .finally(() => setLoading(false));\r\n  }, []);\r\n\r\n  // Track mobile breakpoint and auto-collapse the list on small screens\r\n  useEffect(() => {\r\n    const onResize = () => {\r\n      try {\r\n        setIsMobile(window.innerWidth <= 720);\r\n      } catch (e) {\r\n        // ignore\r\n      }\r\n    };\r\n    onResize();\r\n    window.addEventListener('resize', onResize);\r\n    return () => window.removeEventListener('resize', onResize);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isMobile) {\r\n      setLeftCollapsed(true);\r\n      // ensure when selecting a thread the conversation shows\r\n      setListFullscreen(false);\r\n    } else {\r\n      setLeftCollapsed(false);\r\n      setListFullscreen(true);\r\n    }\r\n  }, [isMobile]);\r\n\r\n  // Filtering and search logic\r\n  const filteredInquiries = inquiries.filter(inquiry => {\r\n    // Status filter\r\n    let statusMatch = true;\r\n    if (filter.status === 'pending') statusMatch = !inquiry.responses || inquiry.responses.length === 0;\r\n    // Treat \"responded\" filter as \"has responses OR explicitly resolved\"\r\n    if (filter.status === 'responded') statusMatch = inquiry.status === 'resolved' || (inquiry.responses && inquiry.responses.length > 0);\r\n    if (filter.status === 'closed') statusMatch = inquiry.status === 'closed';\r\n  // Category filter\r\n  let categoryMatch = true;\r\n  if (category && category !== 'All') categoryMatch = inquiry.category === category;\r\n    // Search filter\r\n    const search = filter.search.toLowerCase();\r\n    const searchMatch =\r\n      !search ||\r\n      (inquiry.residentName && inquiry.residentName.toLowerCase().includes(search)) ||\r\n      (inquiry.category && inquiry.category.toLowerCase().includes(search)) ||\r\n      (inquiry.subject && inquiry.subject.toLowerCase().includes(search)) ||\r\n      (inquiry.createdAt && new Date(inquiry.createdAt).toLocaleString().toLowerCase().includes(search));\r\n    return statusMatch && searchMatch && categoryMatch;\r\n  });\r\n\r\n  // Inline reply handler removed (unused stub)\r\n\r\n  const openThread = (inquiry: any) => {\r\n    // simulate loading the thread\r\n    setLoadingThread(true);\r\n    // ensure the conversation panel is visible when opening a thread\r\n    setListFullscreen(false);\r\n    // keep the left conversation list collapsed on mobile when a thread is opened\r\n    setLeftCollapsed(true);\r\n    setTimeout(() => {\r\n      setSelectedInquiry(inquiry);\r\n      setLoadingThread(false);\r\n      setThreadVisible(true);\r\n    }, 250);\r\n  };\r\n\r\n  const timeAgo = (iso?: string) => {\r\n    if (!iso) return '';\r\n    const diff = Date.now() - new Date(iso).getTime();\r\n    const mins = Math.floor(diff / 60000);\r\n    if (mins < 1) return 'just now';\r\n    if (mins < 60) return `${mins}m`;\r\n    const hrs = Math.floor(mins / 60);\r\n    if (hrs < 24) return `${hrs}h`;\r\n    const days = Math.floor(hrs / 24);\r\n    return `${days}d`;\r\n  };\r\n\r\n  // Lightweight replacement for AntD Comment to avoid import/type issues\r\n  const MessageComment: React.FC<{ author?: string; avatar?: React.ReactNode; content?: React.ReactNode; datetime?: React.ReactNode; align?: 'left'|'right' }> = ({ author, avatar, content, datetime, align = 'left' }) => (\r\n    <div style={{ display: 'flex', justifyContent: align === 'left' ? 'flex-start' : 'flex-end' }}>\r\n      <div className={styles['message-container']}>\r\n        {align === 'left' && avatar}\r\n        <div>\r\n          <div style={{ fontSize: 13, fontWeight: 600 }}>{author}</div>\r\n          <div style={{ marginTop: 6 }}>{content}</div>\r\n          {datetime && <div style={{ marginTop: 6, fontSize: 12, color: '#777' }}>{datetime}</div>}\r\n        </div>\r\n        {align === 'right' && avatar}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Helper to safely get the first initial from a name-like value\r\n  const getInitial = (val: any, fallback = '?') => {\r\n    if (!val) return fallback;\r\n    try {\r\n      const s = String(val).trim();\r\n      return s.length > 0 ? s.charAt(0).toUpperCase() : fallback;\r\n    } catch (e) {\r\n      return fallback;\r\n    }\r\n  };\r\n\r\n  return (\r\n  <div className={styles.inboxPage} style={{ minHeight: '100vh', background: '#f0f4f8', padding: '24px', fontFamily: 'Poppins, Arial, sans-serif', position: 'relative' }}>\r\n      <Card\r\n        style={{ maxWidth: 1200, margin: '0 auto', borderRadius: 18, boxShadow: '0 8px 32px 0 rgba(31, 38, 135, 0.08)', padding: 0, background: '#fff' }}\r\n              styles={{ body: { padding: 0, background: '#fff' } }}\r\n      >\r\n        <div style={{ padding: '24px 32px 0 32px' }}>\r\n          <Row gutter={[12, 12]} align=\"middle\" style={{ marginBottom: 12 }}>\r\n            <Col xs={24} sm={6}>\r\n              <Select value={category} onChange={(val) => setCategory(val)} style={{ width: '100%' }}>\r\n                <Select.Option value=\"All\">All</Select.Option>\r\n                <Select.Option value=\"Complaints\">Complaints</Select.Option>\r\n                <Select.Option value=\"Requests\">Requests</Select.Option>\r\n                <Select.Option value=\"Announcements\">Announcements</Select.Option>\r\n              </Select>\r\n            </Col>\r\n            <Col xs={24} sm={12}>\r\n              <Input.Search placeholder=\"Search by date, name, or category\" allowClear value={filter.search} onChange={(e) => setFilter(s => ({ ...s, search: e.target.value }))} onSearch={(val) => setFilter(s => ({ ...s, search: val }))} />\r\n            </Col>\r\n            <Col xs={24} sm={6} style={{ display: 'flex', alignItems: 'center', justifyContent: 'flex-end', gap: 8 }}>\r\n              <div style={{ flex: 1 }} />\r\n              <Button\r\n                type=\"text\"\r\n                onClick={() => setLeftCollapsed(v => !v)}\r\n                style={{ borderRadius: 8 }}\r\n                title={leftCollapsed ? 'Show conversation list' : 'Hide conversation list'}\r\n                icon={leftCollapsed ? <MenuUnfoldOutlined /> : <MenuFoldOutlined />}\r\n              />\r\n            </Col>\r\n          </Row>\r\n          <Typography.Title level={3} style={{ marginBottom: 0, color: '#1890ff', display: 'flex', alignItems: 'center', gap: 8, fontFamily: 'Poppins, Arial, sans-serif' }}>\r\n            <span role=\"img\" aria-label=\"inbox\"></span> Inbox\r\n          </Typography.Title>\r\n        </div>\r\n        <Divider style={{ margin: '16px 0 0 0' }} />\r\n        <div style={{ padding: '0 32px 32px 32px' }}>\r\n          {loading ? (\r\n            <Spin />\r\n          ) : filteredInquiries.length === 0 ? (\r\n            <Result\r\n              icon={<InboxOutlined />}\r\n              status=\"info\"\r\n              title=\"No messages yet\"\r\n              subTitle=\"There are no messages in your inbox.\"\r\n            />\r\n          ) : (\r\n            <div style={{ display: 'flex', gap: 16 }}>\r\n            {/* Conversation list (collapsible) */}\r\n            {!leftCollapsed ? (\r\n              <div className={styles.conversationList} style={{ flex: listFullscreen ? 1 : '0 0 300px', maxHeight: listFullscreen ? 'calc(100vh - 220px)' : 500, overflowY: 'auto', position: 'relative' }}>\r\n                <Button\r\n                  type=\"text\"\r\n                  onClick={() => setLeftCollapsed(true)}\r\n                  style={{ position: 'absolute', right: -12, top: -8, zIndex: 10, borderRadius: 8, background: '#fff', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}\r\n                  title=\"Collapse list\"\r\n                >\r\n                  <MenuFoldOutlined />\r\n                </Button>\r\n                <List\r\n                  itemLayout=\"vertical\"\r\n                  dataSource={filteredInquiries}\r\n                  renderItem={inquiry => {\r\n                // Prefer explicit 'resolved' status. If not resolved, fall back to checking responses.\r\n                const statusTag = inquiry.status === 'resolved' ? (\r\n                  <Tag color=\"green\">Resolved</Tag>\r\n                ) : Array.isArray(inquiry.responses) && inquiry.responses.length > 0 ? (\r\n                  null\r\n                ) : (\r\n                  <Tag color=\"gold\">Pending</Tag>\r\n                );\r\n\r\n                const typeIcon = (() => {\r\n                  switch ((inquiry.category || '').toLowerCase()) {\r\n                    case 'complaints': return '';\r\n                    case 'requests': return '';\r\n                    case 'announcements': return '';\r\n                    default: return '';\r\n                  }\r\n                })();\r\n\r\n                const isSelected = selectedInquiry && selectedInquiry._id === inquiry._id;\r\n\r\n                    return (\r\n                  <List.Item\r\n                    className={styles.listItem}\r\n                    style={{ marginBottom: 8, background: isSelected ? '#f7fbff' : '#fff', borderRadius: 12, border: '1px solid #e6edf3', boxShadow: '0 1px 4px rgba(31,38,135,0.04)', cursor: 'pointer' }}\r\n                    onClick={() => openThread(inquiry)}\r\n                  >\r\n                    <div className={styles.listItemInner}>\r\n                      <div className={styles.listItemMain}>\r\n                        <div className={styles.listItemHeader}>\r\n                          <span className={styles.typeIcon} aria-hidden>{typeIcon}</span>\r\n                          <Typography.Text strong className={styles.listItemName}>{inquiry.residentName || inquiry.username || (inquiry.createdBy && (inquiry.createdBy.fullName || inquiry.createdBy.username)) || 'Unknown'}</Typography.Text>\r\n                          <Typography.Text type=\"secondary\" className={styles.listItemSubject}> {inquiry.subject || 'No subject'}</Typography.Text>\r\n                          <span className={styles.listItemTime}>{inquiry.createdAt ? timeAgo(inquiry.createdAt) : ''}</span>\r\n                          {statusTag ? React.cloneElement(statusTag as any, { style: { fontSize: 11, padding: '0 6px', marginLeft: 8 } }) : null}\r\n                        </div>\r\n                        <div className={styles.listItemPreview}>\r\n                          <Typography.Text type=\"secondary\" className={styles.listItemPreviewText}>{inquiry.message}</Typography.Text>\r\n                        </div>\r\n                        <div className={styles.listItemResponses}>\r\n                          {Array.isArray(inquiry.responses) && inquiry.responses.length > 0 ? (\r\n                            <Typography.Text type=\"secondary\" style={{ fontSize: 12 }}>{inquiry.responses.length} response(s)</Typography.Text>\r\n                          ) : (\r\n                            <Typography.Text type=\"secondary\" style={{ fontSize: 12 }}>No responses yet</Typography.Text>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                      <div className={styles.listItemAvatar}>\r\n                        {(() => {\r\n                          const displayName = inquiry.residentName || inquiry.username || (inquiry.createdBy && (inquiry.createdBy.fullName || inquiry.createdBy.username)) || inquiry.subject || 'Unknown';\r\n                          const initial = (displayName && displayName !== 'Unknown') ? getInitial(displayName, '?') : '?';\r\n                          return (\r\n                            <AppAvatar style={{ background: '#1890ff', color: '#fff', fontWeight: 700 }} size={36}>\r\n                              {initial}\r\n                            </AppAvatar>\r\n                          );\r\n                        })()}\r\n                      </div>\r\n                    </div>\r\n                  </List.Item>\r\n                );\r\n              }}\r\n                />\r\n              </div>\r\n            ) : (\r\n              <div style={{ width: 72, maxHeight: 500, overflowY: 'auto', display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 8, paddingTop: 8 }}>\r\n                {/* collapse: show compact vertical icons similar to dashboard sidebar */}\r\n                <Button\r\n                  type=\"text\"\r\n                  onClick={() => setLeftCollapsed(false)}\r\n                  style={{ borderRadius: 8, background: '#fff', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}\r\n                  title=\"Show list\"\r\n                >\r\n                  <MenuUnfoldOutlined />\r\n                </Button>\r\n\r\n                <div style={{ width: '100%', display: 'flex', flexDirection: 'column', gap: 8, padding: 8 }}>\r\n                  {filteredInquiries.map(inquiry => {\r\n                    const displayName = inquiry.residentName || inquiry.username || (inquiry.createdBy && (inquiry.createdBy.fullName || inquiry.createdBy.username)) || inquiry.subject || 'Unknown';\r\n                    const initial = (displayName && displayName !== 'Unknown') ? getInitial(displayName, '?') : '?';\r\n                    const isSelected = selectedInquiry && selectedInquiry._id === inquiry._id;\r\n                    return (\r\n                      <Tooltip key={inquiry._id} title={`${displayName}  ${inquiry.subject || 'No subject'}`} placement=\"right\">\r\n                        <button\r\n                          onClick={() => openThread(inquiry)}\r\n                          style={{\r\n                            width: '100%',\r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            justifyContent: 'center',\r\n                            padding: 6,\r\n                            borderRadius: 8,\r\n                            border: isSelected ? '2px solid #1890ff' : '1px solid transparent',\r\n                            background: isSelected ? '#e6f7ff' : 'transparent',\r\n                            cursor: 'pointer'\r\n                          }}\r\n                          aria-label={displayName}\r\n                        >\r\n                          <AppAvatar style={{ background: '#1890ff', color: '#fff', fontWeight: 700 }} size={36}>{initial}</AppAvatar>\r\n                        </button>\r\n                      </Tooltip>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {!listFullscreen && (<div style={{ flex: 1 }}>)\r\n              {/* Make conversation panel visually blend into the page by removing card background/shadow */}\r\n              <Card className={styles.conversationCard}\r\n                style={{ borderRadius: 12, height: '100%', background: 'transparent', boxShadow: 'none', border: 'none' }}\r\n                styles={{ body: { display: 'flex', flexDirection: 'column', padding: 0, gap: 10, background: 'transparent' } }}\r\n              >\r\n                {selectedInquiry ? (\r\n                  <>\r\n                    <div style={{ display: 'flex', gap: 8, alignItems: 'center' }}>\r\n                      {/* Place staff/respondent info on the left and resident on the right to reflect message flow */}\r\n                      <div style={{ display: 'flex', gap: 6, alignItems: 'center' }}>\r\n                        {/* Removed General and Responded tags */}\r\n                        {selectedInquiry.status === 'resolved' ? (\r\n                          <Tag color=\"green\">Resolved</Tag>\r\n                        ) : (\r\n                          <Tag color=\"gold\">Pending</Tag>\r\n                        )}\r\n                      </div>\r\n                      <div style={{ flex: 1 }}>\r\n                        {(() => {\r\n                          const displayNameSelected = selectedInquiry.residentName || selectedInquiry.username || selectedInquiry.subject || 'Unknown';\r\n                          return (\r\n                            <>\r\n                              <Typography.Text strong style={{ display: 'block', textAlign: 'right', fontSize: 15 }}>{displayNameSelected}</Typography.Text>\r\n                              <Typography.Text type=\"secondary\" style={{ fontSize: 10, display: 'block', textAlign: 'right' }}>{selectedInquiry.createdAt ? new Date(selectedInquiry.createdAt).toLocaleString() : ''}</Typography.Text>\r\n                            </>\r\n                          );\r\n                        })()}\r\n                      </div>\r\n                      {(() => {\r\n                          const displayNameSelected = selectedInquiry.residentName || selectedInquiry.username || (selectedInquiry.createdBy && (selectedInquiry.createdBy.fullName || selectedInquiry.createdBy.username)) || selectedInquiry.subject || 'Unknown';\r\n                        const initial = (displayNameSelected && displayNameSelected !== 'Unknown') ? getInitial(displayNameSelected, '?') : '?';\r\n                        return <AppAvatar size={40} style={{ background: '#1890ff' }}>{initial}</AppAvatar>;\r\n                      })()}\r\n                    </div>\r\n\r\n                    <Divider />\r\n\r\n                    <div style={{ overflowY: 'auto', flex: 1, display: 'flex', flexDirection: 'column', gap: 10, paddingRight: 6, minHeight: 0, maxHeight: 220 }}>\r\n                      {/* Resident original message */}\r\n                      <div style={{ alignSelf: 'flex-end', maxWidth: '100%' }}>\r\n                        {(() => {\r\n                          const originalSenderName = selectedInquiry.residentName || selectedInquiry.username || (selectedInquiry.createdBy && (selectedInquiry.createdBy.fullName || selectedInquiry.createdBy.username)) || 'Resident';\r\n                          const originalInitial = (originalSenderName && originalSenderName !== 'Resident') ? getInitial(originalSenderName, 'U') : 'U';\r\n                          return (\r\n                            <MessageComment\r\n                              author={originalSenderName}\r\n                              avatar={<AppAvatar style={{ background: '#1890ff' }}>{originalInitial}</AppAvatar>}\r\n                              content={<div style={{ background: '#e6f7ff', padding: 10, borderRadius: 8 }}>\r\n                                <Typography.Paragraph style={{ margin: 0 }}>{selectedInquiry.message}</Typography.Paragraph>\r\n                                {selectedInquiry.attachments && selectedInquiry.attachments.length > 0 && (\r\n                                  <div style={{ marginTop: 8, display: 'flex', flexDirection: 'column', gap: 8 }}>\r\n                                    {selectedInquiry.attachments.map((a: any, i: number) => {\r\n                                      const url = a.url || a.path || '#';\r\n                                      const filename = a.name || a.filename || 'attachment';\r\n                                      const isImage = (a.contentType && a.contentType.startsWith('image/')) || /\\.(jpe?g|png|gif|webp)$/i.test(filename);\r\n                                      return (\r\n                                            <div key={i}>\r\n                                              {isImage ? (\r\n                                                <a href={typeof url === 'string' && !url.startsWith('http') ? getAbsoluteApiUrl(url) : url} target=\"_blank\" rel=\"noreferrer\">\r\n                                                  <img src={typeof url === 'string' && !url.startsWith('http') ? getAbsoluteApiUrl(url) : url} alt={filename} className={styles.chatImage} />\r\n                                                </a>\r\n                                              ) : (\r\n                                                <div>\r\n                                                  <a href={url} target=\"_blank\" rel=\"noreferrer\">{filename}</a>\r\n                                                  {a.size ? <span style={{ marginLeft: 8, color: '#888', fontSize: 12 }}>({Math.round(a.size/1024)} KB)</span> : null}\r\n                                                </div>\r\n                                              )}\r\n                                            </div>\r\n                                      );\r\n                                    })}\r\n                                  </div>\r\n                                )}\r\n                              </div>}\r\n                              datetime={<span style={{ fontSize: 12 }}>{selectedInquiry.createdAt ? new Date(selectedInquiry.createdAt).toLocaleString() : ''}</span>}\r\n                              align=\"right\"\r\n                            />\r\n                          );\r\n                        })()}\r\n                      </div>\r\n\r\n                      {/* Staff responses */}\r\n                      {Array.isArray(selectedInquiry.responses) && selectedInquiry.responses.map((r: any, idx: number) => {\r\n                        // Support multiple possible field shapes from server/client.\r\n                        // Primary: trust an explicit role field if present. Fallback: try to detect resident replies\r\n                        // by comparing createdBy id or author name to the selected inquiry's resident info.\r\n                        const roleRaw = r.role || r.authorRole || r.author_role || '';\r\n                        let role = (roleRaw || '').toString().toLowerCase();\r\n\r\n                        // Prefer explicit author name provided by the server (authorName).\r\n                        // Also accept several common alias fields that servers sometimes use.\r\n                        // Only fall back to 'You' when the response was created by the current user.\r\n                        const authorRaw = r.author || r.authorName || r.author_name || r.createdByName || r.createdByFullName || r.userName || r.user || '';\r\n                        const createdById = r.createdBy ? String(r.createdBy) : undefined;\r\n                        const currentUserId = storedProfile && (storedProfile._id || storedProfile.id) ? String(storedProfile._id || storedProfile.id) : undefined;\r\n\r\n                        // If role is missing, try a few heuristics to detect resident replies\r\n                        if (!role) {\r\n                          try {\r\n                            // resident id may be stored in selectedInquiry.createdBy (object or id) or selectedInquiry.residentId\r\n                            let residentId: string | undefined;\r\n                            if (selectedInquiry) {\r\n                              if (selectedInquiry.createdBy && typeof selectedInquiry.createdBy === 'string') residentId = String(selectedInquiry.createdBy);\r\n                              else if (selectedInquiry.createdBy && typeof selectedInquiry.createdBy === 'object' && (selectedInquiry.createdBy._id || selectedInquiry.createdBy.id)) residentId = String(selectedInquiry.createdBy._id || selectedInquiry.createdBy.id);\r\n                              else if (selectedInquiry.residentId) residentId = String(selectedInquiry.residentId);\r\n                            }\r\n\r\n                            const residentName = (selectedInquiry && (selectedInquiry.residentName || selectedInquiry.username || '')) ? String(selectedInquiry.residentName || selectedInquiry.username).toLowerCase() : '';\r\n                            const authorName = (authorRaw || r.authorName || '').toString().toLowerCase();\r\n\r\n                            if (residentId && createdById && residentId === createdById) {\r\n                              role = 'resident';\r\n                            } else if (residentName && authorName && residentName === authorName) {\r\n                              role = 'resident';\r\n                            }\r\n                          } catch (e) {\r\n                            // ignore heuristic errors and fall back to existing logic\r\n                          }\r\n                        }\r\n\r\n                        let authorDisplay: string;\r\n                        if (authorRaw && authorRaw.trim() !== '') {\r\n                          authorDisplay = authorRaw;\r\n                        } else if (currentUserId && createdById && currentUserId === createdById) {\r\n                          authorDisplay = 'You';\r\n                        } else if (r.authorName && r.authorName.trim() !== '') {\r\n                          authorDisplay = r.authorName;\r\n                        } else if (r.createdBy && typeof r.createdBy === 'object' && (r.createdBy.fullName || r.createdBy.username)) {\r\n                          authorDisplay = r.createdBy.fullName || r.createdBy.username;\r\n                        } else if (r.createdByName && typeof r.createdByName === 'string' && r.createdByName.trim() !== '') {\r\n                          authorDisplay = r.createdByName;\r\n                        } else if (r.user && typeof r.user === 'object' && (r.user.fullName || r.user.username)) {\r\n                          authorDisplay = r.user.fullName || r.user.username;\r\n                        } else {\r\n                          // Reasonable fallback depending on role. If this response appears to be from the resident\r\n                          // prefer the selected inquiry's resident name / username so the UI shows the sender's name.\r\n                          if (role === 'resident') {\r\n                            authorDisplay = (selectedInquiry && (selectedInquiry.residentName || selectedInquiry.username)) ? (selectedInquiry.residentName || selectedInquiry.username) : 'Resident';\r\n                          } else {\r\n                            // Try common places for staff name before falling back to 'Staff'\r\n                            // If responses don't include authorName but the inquiry has assignedTo populated,\r\n                            // try to match the response.createdBy id to an assigned staff to show their name.\r\n                            let staffNameFromAssigned: string | undefined;\r\n                            try {\r\n                              if (createdById && selectedInquiry && Array.isArray(selectedInquiry.assignedTo)) {\r\n                                const match = selectedInquiry.assignedTo.find((a: any) => String(a._id) === String(createdById));\r\n                                if (match) staffNameFromAssigned = match.fullName || match.username;\r\n                              }\r\n                            } catch (e) {\r\n                              // ignore\r\n                            }\r\n\r\n                            authorDisplay = r.staffName || r.staffFullName || (r.createdBy && typeof r.createdBy === 'object' && (r.createdBy.fullName || r.createdBy.username)) || staffNameFromAssigned || 'Staff';\r\n                          }\r\n                        }\r\n\r\n                        // Determine alignment: replies from the resident (or the current user) are shown on the right; staff on the left.\r\n                        const isResidentReply = role === 'resident' || role === 'user';\r\n                        const isCurrentUser = currentUserId && createdById && currentUserId === createdById;\r\n                        const align: 'left' | 'right' = (isResidentReply || isCurrentUser) ? 'right' : 'left';\r\n\r\n                        const avatarNode = (isResidentReply || isCurrentUser) ? (\r\n                          <AppAvatar style={{ background: '#1890ff' }}>{getInitial(authorDisplay, 'U')}</AppAvatar>\r\n                        ) : (\r\n                          <AppAvatar style={{ background: '#666' }}>{getInitial(authorDisplay, 'B')}</AppAvatar>\r\n                        );\r\n\r\n                        return (\r\n                          <div key={idx} style={{ alignSelf: (isResidentReply || isCurrentUser) ? 'flex-end' : 'flex-start', maxWidth: '100%' }}>\r\n                            <MessageComment\r\n                              author={isCurrentUser ? 'You' : authorDisplay}\r\n                              avatar={avatarNode}\r\n                              content={<div style={{ background: (isResidentReply || isCurrentUser) ? '#e6f7ff' : '#f6f6f6', padding: 10, borderRadius: 8 }}>\r\n                                <Typography.Paragraph style={{ margin: 0 }}>{r.text}</Typography.Paragraph>\r\n                                {r.attachments && r.attachments.length > 0 && (\r\n                                  <div style={{ marginTop: 8, display: 'flex', flexDirection: 'column', gap: 8 }}>\r\n                                    {r.attachments.map((a: any, i: number) => {\r\n                                      const url = a.url || a.path || '#';\r\n                                      const filename = a.name || a.filename || 'attachment';\r\n                                      const isImage = (a.contentType && a.contentType.startsWith('image/')) || /\\.(jpe?g|png|gif|webp)$/i.test(filename);\r\n                                      return (\r\n                                        <div key={i}>\r\n                                              {isImage ? (\r\n                                                  <a href={typeof url === 'string' && !url.startsWith('http') ? getAbsoluteApiUrl(url) : url} target=\"_blank\" rel=\"noreferrer\">\r\n                                                    <img src={typeof url === 'string' && !url.startsWith('http') ? getAbsoluteApiUrl(url) : url} alt={filename} className={styles.chatImage} />\r\n                                                  </a>\r\n                                              ) : (\r\n                                            <div>\r\n                                              <a href={url} target=\"_blank\" rel=\"noreferrer\">{filename}</a>\r\n                                              {a.size ? <span style={{ marginLeft: 8, color: '#888', fontSize: 12 }}>({Math.round(a.size/1024)} KB)</span> : null}\r\n                                            </div>\r\n                                              )}\r\n                                            </div>\r\n                                      );\r\n                                    })}\r\n                                  </div>\r\n                                )}\r\n                              </div>}\r\n                              datetime={<span style={{ fontSize: 12 }}>{r.createdAt ? new Date(r.createdAt).toLocaleString() : ''}</span>}\r\n                              align={align}\r\n                            />\r\n                          </div>\r\n                        );\r\n                      })}\r\n                      <div ref={messagesEndRef} />\r\n                    </div>\r\n\r\n                    <div style={{ marginTop: 0, flexShrink: 0 }} className={styles.replyBarWrap}>\r\n                      {/* Reply bar fixed at bottom of the conversation card */}\r\n                      <div className={styles.replyBar} style={{ background: '#fff', paddingTop: 4, paddingBottom: 4, borderTop: '1px solid #f0f0f0', display: 'flex', alignItems: 'flex-end', gap: 8 }}>\r\n                        {/* Auto-resizing textarea implemented with a controlled textarea and a simple resize handler */}\r\n                        <textarea\r\n                          value={replyText}\r\n                          onChange={e => {\r\n                            setReplyText(e.target.value);\r\n                            // auto-resize\r\n                            const el = e.target as HTMLTextAreaElement;\r\n                            el.style.height = 'auto';\r\n                            el.style.height = Math.min(200, el.scrollHeight) + 'px';\r\n                          }}\r\n                          onKeyDown={async (e) => {\r\n                            if (e.key === 'Enter' && !e.shiftKey) {\r\n                              e.preventDefault();\r\n                              // send\r\n                              if (!replyText || replyText.trim() === '') return antdMessage.warning('Reply cannot be empty');\r\n                              if (!selectedInquiry || !selectedInquiry._id) return antdMessage.error('No inquiry selected');\r\n                              const sendingKey = selectedInquiry._id;\r\n                              setReplyLoading(r => ({ ...r, [sendingKey]: true }));\r\n                              try {\r\n                                const resp = await contactAPI.respondToInquiry(selectedInquiry._id, { response: replyText.trim() });\r\n                                const updatedInquiry = resp;\r\n                                setInquiries(prev => prev.map(i => i._id === updatedInquiry._id ? updatedInquiry : i));\r\n                                setSelectedInquiry(updatedInquiry);\r\n                                setReplyText('');\r\n                                antdMessage.success('Reply sent');\r\n                              } catch (err) {\r\n                                console.error('Failed to send reply', err);\r\n                                antdMessage.error('Failed to send reply');\r\n                              } finally {\r\n                                setReplyLoading(r => ({ ...r, [sendingKey]: false }));\r\n                              }\r\n                            }\r\n                          }}\r\n                          placeholder=\"Type your reply...\"\r\n                          style={{\r\n                            width: '100%',\r\n                            minHeight: 40,\r\n                            maxHeight: 200,\r\n                            resize: 'none',\r\n                            padding: '10px 12px',\r\n                            borderRadius: 12,\r\n                            border: '1px solid #e6edf3',\r\n                            boxShadow: '0 1px 4px rgba(15, 23, 42, 0.04)',\r\n                            fontSize: 14,\r\n                            outline: 'none',\r\n                            fontFamily: 'Poppins, Arial, sans-serif',\r\n                            color: '#222'\r\n                          }}\r\n                        />\r\n\r\n                        <div style={{ display: 'flex', alignItems: 'center' }}>\r\n                          <button\r\n                            onClick={async () => {\r\n                              if (!replyText || replyText.trim() === '') return antdMessage.warning('Reply cannot be empty');\r\n                              if (!selectedInquiry || !selectedInquiry._id) return antdMessage.error('No inquiry selected');\r\n                              const sendingKey = selectedInquiry._id;\r\n                              setReplyLoading(r => ({ ...r, [sendingKey]: true }));\r\n                              try {\r\n                                const resp = await contactAPI.respondToInquiry(selectedInquiry._id, { response: replyText.trim() });\r\n                                const updatedInquiry = resp;\r\n                                setInquiries(prev => prev.map(i => i._id === updatedInquiry._id ? updatedInquiry : i));\r\n                                setSelectedInquiry(updatedInquiry);\r\n                                setReplyText('');\r\n                                antdMessage.success('Reply sent');\r\n                              } catch (err) {\r\n                                console.error('Failed to send reply', err);\r\n                                antdMessage.error('Failed to send reply');\r\n                              } finally {\r\n                                setReplyLoading(r => ({ ...r, [sendingKey]: false }));\r\n                              }\r\n                            }}\r\n                            className={styles.sendButton}\r\n                            style={{\r\n                              background: '#0ea5a3',\r\n                              color: '#fff',\r\n                              border: 'none',\r\n                              padding: '8px 14px',\r\n                              borderRadius: 10,\r\n                              cursor: 'pointer',\r\n                              fontSize: 18,\r\n                              fontWeight: 600,\r\n                              boxShadow: '0 4px 10px rgba(14,165,163,0.12)',\r\n                              display: 'flex',\r\n                              alignItems: 'center',\r\n                              justifyContent: 'center'\r\n                            }}\r\n                            title=\"Send Reply\"\r\n                            onMouseOver={(e) => (e.currentTarget.style.opacity = '0.95')}\r\n                            onMouseOut={(e) => (e.currentTarget.style.opacity = '1')}\r\n                            disabled={!!(selectedInquiry && replyLoading[selectedInquiry._id])}\r\n                          >\r\n                            <SendOutlined style={{ fontSize: 22, verticalAlign: 'middle' }} />\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <div style={{ textAlign: 'center', padding: 32 }}>\r\n                    <Typography.Text type=\"secondary\">Select a message to view the conversation</Typography.Text>\r\n                  </div>\r\n                )}\r\n              </Card>\r\n            </div>)}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Inbox;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"TemplatesManager_wrapper__cXZVs\",\"heading\":\"TemplatesManager_heading__7hfQa\",\"grid\":\"TemplatesManager_grid__M+Ctm\",\"card\":\"TemplatesManager_card__bxhju\",\"icon\":\"TemplatesManager_icon__Yw0ch\",\"cardBody\":\"TemplatesManager_cardBody__Fg4L0\",\"cardTitle\":\"TemplatesManager_cardTitle__Pj+E+\",\"actions\":\"TemplatesManager_actions__wTImq\",\"previewModal\":\"TemplatesManager_previewModal__0tqY2\",\"previewHeader\":\"TemplatesManager_previewHeader__5ZUMG\",\"previewTitle\":\"TemplatesManager_previewTitle__O4X25\",\"previewClose\":\"TemplatesManager_previewClose__4CQMo\",\"uploadWrap\":\"TemplatesManager_uploadWrap__8ryYH\"};","import React, { useState } from 'react';\r\nimport { Button, Tooltip, Upload, message } from 'antd';\r\nimport { UploadOutlined, EyeOutlined, DownloadOutlined, DeleteOutlined } from '@ant-design/icons';\r\nimport { axiosInstance, axiosPublic } from '../services/api';\r\nimport styles from './TemplatesManager.module.css';\r\n\r\nconst getLabel = (filename?: string) =>\r\n  filename ? filename.replace(/_/g, \" \").replace(/\\.docx$/, \"\") : \"Untitled\";\r\n\r\nconst TemplatesManager: React.FC = () => {\r\n  const [templateList, setTemplateList] = useState<any[]>([]);\r\n  const [previewId, setPreviewId] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [downloadError, setDownloadError] = useState<string | null>(null);\r\n  // previewType removed (unused)\r\n  const [htmlContent, setHtmlContent] = useState<string>('');\r\n\r\n  React.useEffect(() => {\r\n    const fetchTemplates = async () => {\r\n      setLoading(true);\r\n      setError(null);\r\n        try {\r\n          const res = await axiosPublic.get('/documents/list');\r\n          setTemplateList(res.data || []);\r\n        } catch (err) {\r\n          setError('Could not load templates.');\r\n        }\r\n      setLoading(false);\r\n    };\r\n    fetchTemplates();\r\n  }, []);\r\n\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      <h2 className={styles.heading}> Templates Manager</h2>\r\n      {/* GridFS Files Section */}\r\n      <div style={{ marginBottom: 32 }}>\r\n      {/* heading intentionally left out */}\r\n        {loading && <div>Loading templates...</div>}\r\n        {error && <div style={{ color: 'red' }}>{error}</div>}\r\n        <div className={styles.grid}>\r\n          {templateList.filter((file: any) => file && file.filename).map((file: any) => (\r\n            <div key={file._id} className={styles.card}>\r\n              <img src=\"/word.png\" alt=\"Word Icon\" className={styles.icon} />\r\n              <div className={styles.cardBody}>\r\n                <span className={styles.cardTitle}>{getLabel(file.filename)}</span>\r\n                <div className={styles.actions}>\r\n                  <Tooltip title=\"Preview\">\r\n                    <Button\r\n                      icon={<EyeOutlined />}\r\n                      onClick={async (e) => {\r\n                        e.stopPropagation();\r\n                        if (previewId === file._id) {\r\n                          setPreviewId(null);\r\n                          setHtmlContent('');\r\n                          return;\r\n                        }\r\n                        setPreviewId(file._id);\r\n                        setHtmlContent('');\r\n                          try {\r\n                            const res = await axiosPublic.get(`/documents/preview/${file._id}?format=html`, { responseType: 'text' });\r\n                            setHtmlContent(res.data || '');\r\n                          } catch (err) {\r\n                            setHtmlContent('<div style=\"color:red\">Failed to load preview.</div>');\r\n                          }\r\n                      }}\r\n                    >Preview</Button>\r\n                  </Tooltip>\r\n                  <Tooltip title=\"Download\">\r\n                    <Button\r\n                      type=\"primary\"\r\n                      icon={<DownloadOutlined />}\r\n                      onClick={async () => {\r\n                        setDownloadError(null);\r\n                        try {\r\n                          const res = await axiosInstance.get(`/documents/original/${file._id}`, { responseType: 'blob' });\r\n                          const blob = res.data;\r\n                          const url = window.URL.createObjectURL(blob);\r\n                          const a = document.createElement('a');\r\n                          a.href = url;\r\n                          a.download = file.filename;\r\n                          document.body.appendChild(a);\r\n                          a.click();\r\n                          a.remove();\r\n                          window.URL.revokeObjectURL(url);\r\n                        } catch (err) {\r\n                          setDownloadError(`Failed to download ${file.filename} from MongoDB.`);\r\n                        }\r\n                      }}\r\n                    >Download</Button>\r\n                  </Tooltip>\r\n                  <Tooltip title=\"Remove\">\r\n                    <Button\r\n                      danger\r\n                      icon={<DeleteOutlined />}\r\n                      onClick={async () => {\r\n                        setLoading(true);\r\n                        setError(null);\r\n                          try {\r\n                            const res = await axiosInstance.delete(`/documents/file/${file._id}`);\r\n                            const data = res.data;\r\n                            if (data && data.success) {\r\n                              // Refresh list\r\n                              const resList = await axiosPublic.get('/documents/list');\r\n                              setTemplateList(resList.data || []);\r\n                            } else {\r\n                              setError('Delete failed.');\r\n                            }\r\n                          } catch (err) {\r\n                            setError('Delete failed.');\r\n                          }\r\n                        setLoading(false);\r\n                      }}\r\n                    >Remove</Button>\r\n                  </Tooltip>\r\n                </div>\r\n                {previewId === file._id && htmlContent && (\r\n                  <div className={styles.previewModal}>\r\n                    <div className={styles.previewHeader}>\r\n                      <span className={styles.previewTitle}>Preview</span>\r\n                      <button className={styles.previewClose} onClick={() => { setPreviewId(null); setHtmlContent(''); }}>Close</button>\r\n                    </div>\r\n                    <div dangerouslySetInnerHTML={{ __html: htmlContent }} />\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n      {downloadError && (\r\n        <div style={{ color: 'red', marginBottom: 16 }}>{downloadError}</div>\r\n      )}\r\n      {/* Upload Section */}\r\n      <div className={styles.uploadWrap}>\r\n        <Upload\r\n          accept=\".docx\"\r\n          showUploadList={false}\r\n          customRequest={async ({ file, onSuccess, onError }) => {\r\n            setLoading(true);\r\n            setError(null);\r\n            const formData = new FormData();\r\n            formData.append('file', file);\r\n              try {\r\n              const res = await axiosInstance.post('/documents/upload', formData, {\r\n                headers: { 'Content-Type': 'multipart/form-data' }\r\n              });\r\n              const data = res.data;\r\n              if (data && data.success) {\r\n                // Refresh list\r\n                const resList = await axiosPublic.get('/documents/list');\r\n                setTemplateList(resList.data || []);\r\n                message.success('Upload successful');\r\n                onSuccess && onSuccess('ok');\r\n              } else {\r\n                setError('Upload failed.');\r\n                message.error('Upload failed');\r\n                onError && onError(new Error('Upload failed'));\r\n              }\r\n            } catch (err) {\r\n              setError('Upload failed.');\r\n              message.error('Upload failed');\r\n              onError && onError(new Error('Upload failed'));\r\n            }\r\n            setLoading(false);\r\n          }}\r\n        >\r\n          <Button icon={<UploadOutlined />} type=\"primary\">Upload .docx</Button>\r\n        </Upload>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TemplatesManager;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"staffInbox_container__m9fcV\",\"listPanel\":\"staffInbox_listPanel__C0rkD\",\"threadPanel\":\"staffInbox_threadPanel__OXVEN\",\"replyBar\":\"staffInbox_replyBar__KJlAw\",\"replyTextarea\":\"staffInbox_replyTextarea__b1z1p\",\"ant-list-item\":\"staffInbox_ant-list-item__E1ple\",\"ant-list-item-meta-title\":\"staffInbox_ant-list-item-meta-title__s1DSh\",\"ant-list-item-meta-description\":\"staffInbox_ant-list-item-meta-description__E+KF3\",\"ant-typography\":\"staffInbox_ant-typography__nWTvN\",\"ant-card-body\":\"staffInbox_ant-card-body__xqzAF\",\"ant-avatar\":\"staffInbox_ant-avatar__dYbeT\",\"ant-btn\":\"staffInbox_ant-btn__dxj1i\"};","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { Card, List, Typography, Spin, Result, Divider, Row, Col, Select, Tabs, Input, Button, Modal, message as antdMessage } from 'antd';\r\nimport AppAvatar from '../components/AppAvatar';\r\nimport styles from './staffInbox.module.css';\r\nimport { InboxOutlined, SendOutlined, CheckOutlined, PlusOutlined } from '@ant-design/icons';\r\nimport { contactAPI, adminAPI, getAbsoluteApiUrl } from '../services/api';\r\n\r\ntype FilterState = {\r\n  status: string;\r\n  search: string;\r\n};\r\n\r\nconst StaffInbox: React.FC = () => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [inquiries, setInquiries] = useState<any[]>([]);\r\n  const [filter, setFilter] = useState<FilterState>({ status: 'all', search: '' });\r\n  const [category, setCategory] = useState<string>('All');\r\n  const [selectedInquiry, setSelectedInquiry] = useState<any | null>(null);\r\n  const [replyText, setReplyText] = useState<string>('');\r\n  const [replyLoading, setReplyLoading] = useState<{ [id: string]: boolean }>({});\r\n  const [residentsModalVisible, setResidentsModalVisible] = useState(false);\r\n  const [residentsLoading, setResidentsLoading] = useState(false);\r\n  const [residents, setResidents] = useState<Array<{ label: string; username?: string; barangayID?: string }>>([]);\r\n  const location = useLocation();\r\n  const messagesEndRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  useEffect(() => {\r\n    // If navigation state contains an inquiry to open, fetch and try to open it.\r\n    // Prefer fetching all inquiries once and selecting the item; fall back to\r\n    // fetching a single inquiry if not found. This avoids polling and interval\r\n    // leaks and keeps dependencies simple (only depends on `location`).\r\n    const state: any = (location && (location as any).state) || {};\r\n    const openId = state && state.openInquiryId;\r\n\r\n    if (openId) {\r\n      (async () => {\r\n        setLoading(true);\r\n        try {\r\n          // try to load all inquiries first\r\n          const all = await contactAPI.getAllInquiries();\r\n          setInquiries(all || []);\r\n          const found = (all || []).find((i: any) => i._id === openId);\r\n          if (found) {\r\n            setSelectedInquiry(found);\r\n            return;\r\n          }\r\n          // fallback: fetch the single inquiry\r\n          try {\r\n            const single = await contactAPI.getInquiryById(openId);\r\n            if (single) setSelectedInquiry(single);\r\n          } catch (e) {\r\n            // ignore; nothing we can do\r\n          }\r\n        } catch (e) {\r\n          // If bulk fetch failed, still try single-inquiry fetch\r\n          try {\r\n            const single = await contactAPI.getInquiryById(openId);\r\n            if (single) {\r\n              setSelectedInquiry(single);\r\n              setInquiries(prev => [single, ...prev]);\r\n            }\r\n          } catch (err) {\r\n            // ignore\r\n          }\r\n        } finally {\r\n          setLoading(false);\r\n        }\r\n      })();\r\n    } else {\r\n      // no openId requested, perform a normal full load\r\n      fetchAll();\r\n    }\r\n    // only depends on location (i.e. navigation state)\r\n  }, [location]);\r\n\r\n  const fetchAll = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await contactAPI.getAllInquiries();\r\n      setInquiries(res || []);\r\n    } catch (e) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('Failed to load inquiries', e);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Extract number of responses into a stable variable so the effect dependency\r\n  // array is statically analyzable and ESLint won't complain about complex exprs.\r\n  const selectedResponsesLength = selectedInquiry?.responses?.length ?? 0;\r\n\r\n  useEffect(() => {\r\n    if (messagesEndRef.current) messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\r\n  }, [selectedInquiry, selectedResponsesLength]);\r\n\r\n  const timeAgo = (iso?: string) => {\r\n    if (!iso) return '';\r\n    const diff = Date.now() - new Date(iso).getTime();\r\n    const mins = Math.floor(diff / 60000);\r\n    if (mins < 1) return 'just now';\r\n    if (mins < 60) return `${mins}m`;\r\n    const hrs = Math.floor(mins / 60);\r\n    if (hrs < 24) return `${hrs}h`;\r\n    const days = Math.floor(hrs / 24);\r\n    return `${days}d`;\r\n  };\r\n\r\n  const getInitial = (val: any, fallback = '?') => {\r\n    if (!val) return fallback;\r\n    try { const s = String(val).trim(); return s.length ? s.charAt(0).toUpperCase() : fallback; } catch (e) { return fallback; }\r\n  };\r\n\r\n  // Lightweight message/comment renderer (keeps layout consistent with resident inbox)\r\n  const MessageComment: React.FC<{ author?: string; avatar?: React.ReactNode; content?: React.ReactNode; datetime?: React.ReactNode; align?: 'left'|'right' }> = ({ author, avatar, content, datetime, align = 'left' }) => (\r\n    <div style={{ display: 'flex', justifyContent: align === 'left' ? 'flex-start' : 'flex-end' }}>\r\n      <div style={{ display: 'flex', gap: 8, alignItems: 'flex-start', maxWidth: '80%' }}>\r\n        {align === 'left' && avatar}\r\n        <div>\r\n          <div style={{ fontSize: 13, fontWeight: 600 }}>{author}</div>\r\n          <div style={{ marginTop: 6 }}>{content}</div>\r\n          {datetime && <div style={{ marginTop: 6, fontSize: 12, color: '#888' }}>{datetime}</div>}\r\n        </div>\r\n        {align === 'right' && avatar}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const openThread = (inquiry: any) => {\r\n    setSelectedInquiry(inquiry);\r\n  };\r\n\r\n  const handleSendReply = async () => {\r\n    if (!replyText || !selectedInquiry || !selectedInquiry._id) return;\r\n    const id = selectedInquiry._id;\r\n    setReplyLoading(s => ({ ...s, [id]: true }));\r\n    try {\r\n      if (selectedInquiry.isNewThread) {\r\n  // Determine recipient username/barangayID from several possible places to avoid falling\r\n  // back to the current staff account (which would make the inquiry show up only on staff)\r\n  let recipientUsername = (selectedInquiry.residentUsername || selectedInquiry.username || selectedInquiry.userName || selectedInquiry.author || (selectedInquiry.createdBy && (selectedInquiry.createdBy.username || selectedInquiry.createdBy.userName)));\r\n  let recipientBarangayID = ((selectedInquiry as any).residentBarangayID || selectedInquiry.barangayID || (selectedInquiry.createdBy && selectedInquiry.createdBy.barangayID));\r\n\r\n        // If createdBy info exists, try its username/barangayID\r\n        if ((!recipientUsername || recipientUsername === '') && selectedInquiry.createdBy) {\r\n          if (typeof selectedInquiry.createdBy === 'string') {\r\n            recipientUsername = selectedInquiry.createdBy;\r\n          } else if (selectedInquiry.createdBy.username || selectedInquiry.createdBy.userName) {\r\n            recipientUsername = selectedInquiry.createdBy.username || selectedInquiry.createdBy.userName;\r\n          }\r\n          if (!recipientBarangayID && selectedInquiry.createdBy && (selectedInquiry.createdBy.barangayID)) {\r\n            recipientBarangayID = selectedInquiry.createdBy.barangayID;\r\n          }\r\n        }\r\n\r\n        // Try to resolve from the cached residents list by matching the display label if still missing\r\n        if ((!recipientUsername || recipientUsername === '') && Array.isArray(residents) && selectedInquiry.residentName) {\r\n          const match = residents.find(r => r.label && r.label.toString().toLowerCase() === (selectedInquiry.residentName || '').toString().toLowerCase());\r\n          if (match) {\r\n            recipientUsername = (match as any).username || recipientUsername;\r\n            recipientBarangayID = (match as any).barangayID || recipientBarangayID;\r\n          }\r\n        }\r\n\r\n        const payload: any = {\r\n          type: 'staff_message',\r\n          subject: `Message to ${selectedInquiry.residentName}`,\r\n          message: replyText.trim(),\r\n          // Include explicit recipient identifiers so resident's getMyInquiries will find it\r\n          ...(recipientUsername ? { username: recipientUsername } : {}),\r\n          ...(recipientBarangayID ? { barangayID: recipientBarangayID } : {}),\r\n          // optional: server may accept assignedTo / assignedRole depending on API\r\n        };\r\n\r\n        // If we couldn't resolve a recipient for a staff-created thread, block sending and show an error\r\n        if (!payload.username) {\r\n          antdMessage.error('Please select a resident to send this message to.');\r\n          // Also log for debugging\r\n          // eslint-disable-next-line no-console\r\n          console.warn('Blocked staff-created inquiry without recipient', { selectedInquiry, residents });\r\n          return;\r\n        }\r\n\r\n        // Log payload right before submitting so we can inspect what is being sent\r\n        // eslint-disable-next-line no-console\r\n        console.debug('Submitting staff-created inquiry payload', payload, { selectedInquirySummary: { residentName: selectedInquiry.residentName, residentUsername: selectedInquiry.residentUsername, residentBarangayID: (selectedInquiry as any).residentBarangayID } });\r\n\r\n        const created = await contactAPI.submitInquiry(payload);\r\n        antdMessage.success(`Message sent to ${selectedInquiry.residentName || payload.username}`);\r\n        // add to list and open created thread\r\n        setInquiries(prev => [created].concat(prev));\r\n        setSelectedInquiry(created);\r\n        setReplyText('');\r\n      } else {\r\n        const resp = await contactAPI.respondToInquiry(id, { response: replyText.trim() });\r\n        setInquiries(prev => prev.map(i => i._id === resp._id ? resp : i));\r\n        setSelectedInquiry(resp);\r\n        setReplyText('');\r\n      }\r\n    } catch (e) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('reply failed', e);\r\n    } finally {\r\n      setReplyLoading(s => ({ ...s, [id]: false }));\r\n    }\r\n  };\r\n\r\n  const handleResolve = async () => {\r\n    if (!selectedInquiry || !selectedInquiry._id) return;\r\n    const id = selectedInquiry._id;\r\n    try {\r\n      const resp = await contactAPI.resolveInquiry(id);\r\n      setInquiries(prev => prev.map(i => i._id === resp._id ? resp : i));\r\n      setSelectedInquiry(resp);\r\n    } catch (e) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('resolve failed', e);\r\n    }\r\n  };\r\n\r\n  const filtered = inquiries.filter((inquiry) => {\r\n    let statusMatch = true;\r\n    if (filter.status === 'pending') statusMatch = !inquiry.responses || inquiry.responses.length === 0;\r\n    if (filter.status === 'responded') statusMatch = inquiry.status === 'resolved' || (inquiry.responses && inquiry.responses.length > 0);\r\n    if (filter.status === 'closed') statusMatch = inquiry.status === 'closed';\r\n    let categoryMatch = true;\r\n    if (category && category !== 'All') categoryMatch = inquiry.category === category;\r\n    const search = (filter.search || '').toLowerCase();\r\n    const searchMatch = !search || (inquiry.residentName && inquiry.residentName.toLowerCase().includes(search)) || (inquiry.subject && inquiry.subject.toLowerCase().includes(search));\r\n    return statusMatch && categoryMatch && searchMatch;\r\n  });\r\n\r\n  return (\r\n    <div style={{ minHeight: '100vh', background: '#f7f9fb', padding: 24 }}>\r\n      <Card style={{ maxWidth: 1200, margin: '0 auto', borderRadius: 12 }} styles={{ body: { padding: 0 } }}>\r\n        <div style={{ padding: 20 }}>\r\n          <Row gutter={[12, 12]} align=\"middle\">\r\n            <Col xs={24} sm={6}>\r\n              <Select value={category} onChange={(v) => setCategory(v)} style={{ width: '100%' }}>\r\n                <Select.Option value=\"All\">All</Select.Option>\r\n                <Select.Option value=\"Complaints\">Complaints</Select.Option>\r\n                <Select.Option value=\"Requests\">Requests</Select.Option>\r\n                <Select.Option value=\"Announcements\">Announcements</Select.Option>\r\n              </Select>\r\n            </Col>\r\n            <Col xs={24} sm={12}>\r\n              <Input.Search\r\n                placeholder=\"Search by name or subject\"\r\n                allowClear\r\n                value={filter.search}\r\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\r\n                  setFilter((s: FilterState) => ({ ...s, search: e.target.value }))\r\n                }\r\n                onSearch={(v: string) =>\r\n                  setFilter((s: FilterState) => ({ ...s, search: v }))\r\n                }\r\n              />\r\n            </Col>\r\n            <Col xs={24} sm={6}>\r\n              <Tabs activeKey={filter.status || 'all'} onChange={(k) => setFilter(s => ({ ...s, status: k }))}>\r\n                <Tabs.TabPane tab=\"All\" key=\"all\" />\r\n                <Tabs.TabPane tab=\"Pending\" key=\"pending\" />\r\n                <Tabs.TabPane\r\n                  tab={\r\n                    <span>\r\n                      Responded{' '}\r\n                      <Button\r\n                        type=\"link\"\r\n                        size=\"small\"\r\n                        style={{ marginLeft: 20 }}\r\n                        icon={<PlusOutlined />}\r\n                        onClick={(e) => {\r\n                          // prevent tab change when clicking the icon\r\n                          e.stopPropagation();\r\n                          (async () => {\r\n                            setResidentsModalVisible(true);\r\n                            setResidentsLoading(true);\r\n                            try {\r\n                              const users: any[] = await adminAPI.getUsers();\r\n                              // Heuristic: users that appear to be residents\r\n                              const list = (users || []).filter(u => {\r\n                                const role = (u.role || u.type || '').toString().toLowerCase();\r\n                                return role.includes('resident') || (!role.includes('admin') && !role.includes('staff'));\r\n                              }).map(u => ({\r\n                                label: u.fullName || (u.firstName && u.lastName ? `${u.firstName} ${u.lastName}` : (u.username || u.email || u.name)),\r\n                                // Be liberal in picking a username-like identifier: username, userName, email, or _id\r\n                                username: u.username || u.userName || u.email || u._id,\r\n                                // Barangay ID may be stored in several fields depending on user record shape\r\n                                barangayID: u.barangayID || u.brgy || (u.barangay && (u.barangay.id || u.barangayID))\r\n                              }));\r\n                              setResidents(list.filter(r => r && r.label));\r\n                            } catch (err) {\r\n                              // fallback: empty list\r\n                              setResidents([]);\r\n                            } finally {\r\n                              setResidentsLoading(false);\r\n                            }\r\n                          })();\r\n                        }}\r\n                      />\r\n                    </span>\r\n                  }\r\n                  key=\"responded\"\r\n                />\r\n              </Tabs>\r\n            </Col>\r\n          </Row>\r\n        </div>\r\n        <Divider style={{ margin: 0 }} />\r\n        <Modal\r\n          title=\"Residents\"\r\n          open={residentsModalVisible}\r\n          onCancel={() => setResidentsModalVisible(false)}\r\n          footer={null}\r\n        >\r\n          {residentsLoading ? <div style={{ textAlign: 'center' }}><Spin /></div> : (\r\n            residents.length === 0 ? (\r\n              <Typography.Text type=\"secondary\">No residents found.</Typography.Text>\r\n            ) : (\r\n              <List\r\n                dataSource={residents}\r\n                renderItem={resident => (\r\n                    <List.Item style={{ cursor: 'pointer' }} onClick={() => {\r\n                    const name = resident.label;\r\n                    const username = resident.username;\r\n                    const barangayID = (resident as any).barangayID;\r\n                    // Try to find an existing inquiry for this resident by username or display name\r\n                    const found = inquiries.find(i => {\r\n                      const rn = ((i.username || i.residentName || (i.createdBy && (i.createdBy.username || '')) || '')).toString().toLowerCase();\r\n                      return rn && (username ? rn === (username || '').toString().toLowerCase() : rn === (name || '').toString().toLowerCase());\r\n                    });\r\n                    if (found) {\r\n                      setSelectedInquiry(found);\r\n                      setResidentsModalVisible(false);\r\n                    } else {\r\n                      // create a temporary thread object so staff can send a message\r\n                      const temp: any = {\r\n                        _id: `new-${Date.now()}`,\r\n                        residentName: name,\r\n                        residentUsername: username,\r\n                        residentBarangayID: barangayID,\r\n                        message: '',\r\n                        responses: [],\r\n                        isNewThread: true,\r\n                      };\r\n                      setSelectedInquiry(temp);\r\n                      // debug log the temp selection to ensure username/barangayID are present\r\n                      // eslint-disable-next-line no-console\r\n                      console.debug('Resident selected for new thread', temp);\r\n                      setResidentsModalVisible(false);\r\n                    }\r\n                  }}>\r\n                    <List.Item.Meta\r\n                      avatar={<AppAvatar style={{ background: '#1890ff' }}>{getInitial(resident.label)}</AppAvatar>}\r\n                      title={resident.label}\r\n                    />\r\n                  </List.Item>\r\n                )}\r\n              />\r\n            )\r\n          )}\r\n        </Modal>\r\n        <div style={{ padding: 16 }}>\r\n          {loading ? <Spin /> : filtered.length === 0 ? (\r\n            <Result icon={<InboxOutlined />} title=\"No inquiries\" subTitle=\"There are no inquiries to show.\" />\r\n          ) : (\r\n            <div className={styles.container}>\r\n              <div className={styles.listPanel}>\r\n                <List\r\n                  dataSource={filtered}\r\n                  renderItem={inquiry => (\r\n                    <List.Item onClick={() => openThread(inquiry)} style={{ cursor: 'pointer', marginBottom: 8, borderRadius: 8, padding: 8, border: selectedInquiry && selectedInquiry._id === inquiry._id ? '1px solid #1890ff' : '1px solid #eee' }}>\r\n                      <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>\r\n                        <AppAvatar style={{ background: '#1890ff' }}>{getInitial(inquiry.residentName || inquiry.username || inquiry.subject, '?')}</AppAvatar>\r\n                        <div style={{ flex: 1, minWidth: 0 }}>\r\n                          <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n                            <Typography.Text strong style={{ overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{inquiry.residentName || inquiry.username || 'Unknown'}</Typography.Text>\r\n                            <Typography.Text type=\"secondary\" style={{ fontSize: 12 }}> {inquiry.subject || 'No subject'}</Typography.Text>\r\n                            <span style={{ marginLeft: 'auto', fontSize: 11 }}>{inquiry.createdAt ? timeAgo(inquiry.createdAt) : ''}</span>\r\n                          </div>\r\n                          <Typography.Text type=\"secondary\" style={{ display: 'block', fontSize: 13, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{inquiry.message}</Typography.Text>\r\n                        </div>\r\n                      </div>\r\n                    </List.Item>\r\n                  )}\r\n                />\r\n              </div>\r\n\r\n              <div className={styles.threadPanel}>\r\n                <Card style={{ borderRadius: 8 }} styles={{ body: { display: 'flex', flexDirection: 'column', gap: 12, padding: 12 } }}>\r\n                  {selectedInquiry ? (\r\n                    <>\r\n                      <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>\r\n                        <div style={{ flex: 1 }}>\r\n                          <Typography.Text strong style={{ display: 'block' }}>{selectedInquiry.residentName || selectedInquiry.username || 'Unknown'}</Typography.Text>\r\n                          <Typography.Text type=\"secondary\">{selectedInquiry.createdAt ? new Date(selectedInquiry.createdAt).toLocaleString() : ''}</Typography.Text>\r\n                        </div>\r\n                        <AppAvatar size={48} style={{ background: '#1890ff' }}>{getInitial(selectedInquiry.residentName || selectedInquiry.username)}</AppAvatar>\r\n                      </div>\r\n                      <Divider />\r\n                      <div style={{ overflowY: 'auto', maxHeight: 340 }}>\r\n                        <div style={{ marginBottom: 8 }}>\r\n                          <Typography.Paragraph style={{ margin: 0 }}>{selectedInquiry.message}</Typography.Paragraph>\r\n                          {selectedInquiry.attachments && selectedInquiry.attachments.length > 0 && (\r\n                            <div style={{ marginTop: 8, display: 'flex', flexDirection: 'column', gap: 8 }}>\r\n                              {selectedInquiry.attachments.map((a: any, i: number) => {\r\n                                const url = a.url || a.path || '#';\r\n                                const filename = a.name || a.filename || 'attachment';\r\n                                const isImage = (a.contentType && a.contentType.startsWith('image/')) || /\\.(jpe?g|png|gif|webp)$/i.test(filename);\r\n                                return (\r\n                                  <div key={i}>\r\n                                      {isImage ? (\r\n                                      <a href={typeof url === 'string' && !url.startsWith('http') ? getAbsoluteApiUrl(url) : url} target=\"_blank\" rel=\"noreferrer\">\r\n                                        <img src={typeof url === 'string' && !url.startsWith('http') ? getAbsoluteApiUrl(url) : url} alt={filename} style={{ maxWidth: 220, maxHeight: 140, borderRadius: 8, objectFit: 'cover', border: '1px solid #f0f0f0' }} />\r\n                                      </a>\r\n                                    ) : (\r\n                                      <div>\r\n                                        <a href={url} target=\"_blank\" rel=\"noreferrer\">{filename}</a>\r\n                                        {a.size ? <span style={{ marginLeft: 8, color: '#888', fontSize: 12 }}>({Math.round(a.size/1024)} KB)</span> : null}\r\n                                      </div>\r\n                                    )}\r\n                                  </div>\r\n                                );\r\n                              })}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                        {Array.isArray(selectedInquiry.responses) && selectedInquiry.responses.map((r: any, idx: number) => {\r\n                          // Determine role heuristics similar to resident inbox to calculate alignment\r\n                          const roleRaw = r.role || r.authorRole || r.author_role || '';\r\n                          let role = (roleRaw || '').toString().toLowerCase();\r\n                          const authorRaw = r.author || r.authorName || r.author_name || r.createdByName || r.createdByFullName || r.userName || r.user || '';\r\n                          const createdById = r.createdBy ? String(r.createdBy) : undefined;\r\n                          // staff view does not mark current user specially here\r\n\r\n                          // Heuristic: if role missing, try to detect resident replies by matching selectedInquiry createdBy/residentId\r\n                          if (!role) {\r\n                            try {\r\n                              let residentId: string | undefined;\r\n                              if (selectedInquiry) {\r\n                                if (selectedInquiry.createdBy && typeof selectedInquiry.createdBy === 'string') residentId = String(selectedInquiry.createdBy);\r\n                                else if (selectedInquiry.createdBy && typeof selectedInquiry.createdBy === 'object' && (selectedInquiry.createdBy._id || selectedInquiry.createdBy.id)) residentId = String(selectedInquiry.createdBy._id || selectedInquiry.createdBy.id);\r\n                                else if (selectedInquiry.residentId) residentId = String(selectedInquiry.residentId);\r\n                              }\r\n                              const residentName = (selectedInquiry && (selectedInquiry.residentName || selectedInquiry.username || '')) ? String(selectedInquiry.residentName || selectedInquiry.username).toLowerCase() : '';\r\n                              const authorName = (authorRaw || r.authorName || '').toString().toLowerCase();\r\n                              if (residentId && createdById && residentId === createdById) {\r\n                                role = 'resident';\r\n                              } else if (residentName && authorName && residentName === authorName) {\r\n                                role = 'resident';\r\n                              }\r\n                            } catch (e) {\r\n                              // ignore\r\n                            }\r\n                          }\r\n\r\n                          let authorDisplay: string;\r\n                          if (authorRaw && authorRaw.trim() !== '') authorDisplay = authorRaw;\r\n                          else if (r.authorName && r.authorName.trim() !== '') authorDisplay = r.authorName;\r\n                          else if (r.createdBy && typeof r.createdBy === 'object' && (r.createdBy.fullName || r.createdBy.username)) authorDisplay = r.createdBy.fullName || r.createdBy.username;\r\n                          else authorDisplay = role === 'resident' ? (selectedInquiry && (selectedInquiry.residentName || selectedInquiry.username) ? (selectedInquiry.residentName || selectedInquiry.username) : 'Resident') : 'Staff';\r\n\r\n                          const isResidentReply = role === 'resident' || role === 'user';\r\n                          const align: 'left' | 'right' = isResidentReply ? 'right' : 'left';\r\n\r\n                          const avatarNode = isResidentReply ? (\r\n                            <AppAvatar style={{ background: '#1890ff' }}>{getInitial(authorDisplay, 'U')}</AppAvatar>\r\n                          ) : (\r\n                            <AppAvatar style={{ background: '#666' }}>{getInitial(authorDisplay, 'B')}</AppAvatar>\r\n                          );\r\n\r\n                          return (\r\n                            <div key={idx} style={{ alignSelf: isResidentReply ? 'flex-end' : 'flex-start', maxWidth: '100%' }}>\r\n                              <MessageComment\r\n                                author={authorDisplay}\r\n                                avatar={avatarNode}\r\n                                content={<div style={{ background: isResidentReply ? '#e6f7ff' : '#f6f6f6', padding: 10, borderRadius: 8 }}>\r\n                                  <Typography.Paragraph style={{ margin: 0 }}>{r.text}</Typography.Paragraph>\r\n                                  {r.attachments && r.attachments.length > 0 && (\r\n                                    <div style={{ marginTop: 8, display: 'flex', flexDirection: 'column', gap: 8 }}>\r\n                                      {r.attachments.map((a: any, j: number) => {\r\n                                        const url = a.url || a.path || '#';\r\n                                        const filename = a.name || a.filename || 'attachment';\r\n                                        const isImage = (a.contentType && a.contentType.startsWith('image/')) || /\\.(jpe?g|png|gif|webp)$/i.test(filename);\r\n                                        return (\r\n                                          <div key={j}>\r\n                                              {isImage ? (\r\n                                              <a href={typeof url === 'string' && !url.startsWith('http') ? getAbsoluteApiUrl(url) : url} target=\"_blank\" rel=\"noreferrer\">\r\n                                                <img src={typeof url === 'string' && !url.startsWith('http') ? getAbsoluteApiUrl(url) : url} alt={filename} style={{ maxWidth: 220, maxHeight: 140, borderRadius: 8, objectFit: 'cover', border: '1px solid #f0f0f0' }} />\r\n                                              </a>\r\n                                            ) : (\r\n                                              <div>\r\n                                                <a href={url} target=\"_blank\" rel=\"noreferrer\">{filename}</a>\r\n                                                {a.size ? <span style={{ marginLeft: 8, color: '#888', fontSize: 12 }}>({Math.round(a.size/1024)} KB)</span> : null}\r\n                                              </div>\r\n                                            )}\r\n                                          </div>\r\n                                        );\r\n                                      })}\r\n                                    </div>\r\n                                  )}\r\n                                </div>}\r\n                                datetime={<span style={{ fontSize: 12 }}>{r.createdAt ? new Date(r.createdAt).toLocaleString() : ''}</span>}\r\n                                align={align}\r\n                              />\r\n                            </div>\r\n                          );\r\n                        })}\r\n                        <div ref={messagesEndRef} />\r\n                      </div>\r\n\r\n                      <div className={styles.replyBar}>\r\n                        <textarea\r\n                          value={replyText}\r\n                          onChange={e => {\r\n                            setReplyText(e.target.value);\r\n                            const el = e.target as HTMLTextAreaElement;\r\n                            el.style.height = 'auto';\r\n                            el.style.height = Math.min(200, el.scrollHeight) + 'px';\r\n                          }}\r\n                          onKeyDown={async (e) => {\r\n                            if (e.key === 'Enter' && !e.shiftKey) {\r\n                              e.preventDefault();\r\n                              await handleSendReply();\r\n                            }\r\n                          }}\r\n                          placeholder=\"Type your reply...\"\r\n                          className={styles.replyTextarea}\r\n                        />\r\n                        <Button type=\"primary\" icon={<SendOutlined />} loading={!!(selectedInquiry && replyLoading[selectedInquiry._id])} onClick={handleSendReply} />\r\n                        <Button icon={<CheckOutlined />} onClick={handleResolve}>Resolve</Button>\r\n                      </div>\r\n                    </>\r\n                  ) : (\r\n                    <div style={{ textAlign: 'center', padding: 32 }}>\r\n                      <Typography.Text type=\"secondary\">Select an inquiry to view details</Typography.Text>\r\n                    </div>\r\n                  )}\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StaffInbox;\r\n","import React, { createContext, useContext, useReducer, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { authService } from '../services/api';\r\nimport { AuthState, User } from '../types/auth';\r\nimport { jwtDecode } from 'jwt-decode';\r\n\r\ninterface AuthContextType extends AuthState {\r\n  login: (token: string) => void;\r\n  logout: () => void;\r\n  isStaff: () => boolean;\r\n  isAdmin: () => boolean;\r\n  isResident: () => boolean;\r\n  mode: 'resident' | 'staff';\r\n  switchMode: (mode: 'resident' | 'staff') => void;\r\n  setUser?: (user: User | null) => void;\r\n}\r\n\r\nconst initialState: AuthState = {\r\n  isAuthenticated: false,\r\n  user: null,\r\n  token: null,\r\n};\r\n\r\nconst AuthContext = createContext<AuthContextType>({\r\n  ...initialState,\r\n  login: () => {},\r\n  logout: () => {},\r\n  isStaff: () => false,\r\n  isAdmin: () => false,\r\n  isResident: () => false,\r\n  mode: 'resident',\r\n  switchMode: () => {},\r\n});\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n\r\ntype AuthAction =\r\n  | { type: 'LOGIN'; payload: string }\r\n  | { type: 'LOGOUT' }\r\n  | { type: 'RESTORE_TOKEN'; payload: string };\r\n\r\n// Safely decode JWT payload to a User object. Returns null on invalid token.\r\nfunction safeDecodeJwt(token?: string | null): User | null {\r\n  if (!token || typeof token !== 'string') return null;\r\n  // JWT should have three parts separated by dots\r\n  const parts = token.split('.');\r\n  if (parts.length !== 3) {\r\n    console.warn('safeDecodeJwt: token does not have 3 parts, skipping decode');\r\n    return null;\r\n  }\r\n  try {\r\n    // jwtDecode will throw if token part is invalid\r\n    return jwtDecode<User>(token);\r\n  } catch (err) {\r\n    console.warn('safeDecodeJwt: failed to decode token', err);\r\n    return null;\r\n  }\r\n}\r\n\r\nconst authReducer = (state: AuthState, action: AuthAction): AuthState => {\r\n  switch (action.type) {\r\n    case 'LOGIN':\r\n    case 'RESTORE_TOKEN': {\r\n      let user: User | null = null;\r\n      // Only attempt decode when payload looks like a JWT\r\n      user = safeDecodeJwt(action.payload);\r\n      return {\r\n        isAuthenticated: !!user,\r\n        token: user ? action.payload : null,\r\n        user,\r\n      };\r\n    }\r\n    case 'LOGOUT':\r\n      return initialState;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const [state, dispatch] = useReducer(authReducer, initialState);\r\n  // If we have a cached full profile from previous session, hydrate it\r\n  useEffect(() => {\r\n    try {\r\n      const stored = localStorage.getItem('userProfile');\r\n      if (stored) {\r\n        const parsed = JSON.parse(stored);\r\n        if (parsed && parsed.username) {\r\n          const token = localStorage.getItem('token') || null;\r\n          // Only dispatch LOGIN if we have a valid-looking token\r\n          const decoded = safeDecodeJwt(token);\r\n          if (token && decoded) dispatch({ type: 'LOGIN', payload: token });\r\n          // Overwrite the decoded token user with the full profile\r\n          // Direct state mutation isn't exposed; we rely on components reading localStorage.userProfile when available.\r\n        }\r\n      }\r\n    } catch (err) {\r\n      // ignore\r\n    }\r\n  }, []);\r\n  const [mode, setMode] = React.useState<'resident' | 'staff'>('resident');\r\n  const navigate = useNavigate();\r\n\r\n  // Helper to check if JWT is expired\r\n  function isTokenValid(token: string): boolean {\r\n    try {\r\n      const decoded: any = safeDecodeJwt(token);\r\n      if (!decoded) return false;\r\n      if (!decoded.exp) return false;\r\n      const now = Date.now() / 1000;\r\n      return decoded.exp > now;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    if (token && isTokenValid(token)) {\r\n      // Restore token and fetch the full user profile from server to populate barangayID and other fields\r\n      dispatch({ type: 'RESTORE_TOKEN', payload: token });\r\n      // Fetch full profile asynchronously and update state\r\n      (async () => {\r\n        try {\r\n          // Import here to avoid circular import at module load\r\n          const { authService } = await import('../services/api');\r\n          const profile = await authService.getCurrentUser();\r\n          if (profile) {\r\n            // Replace token-decoded user with full profile\r\n            dispatch({ type: 'LOGIN', payload: token });\r\n            // Directly replace stored token user via local storage (AuthContext uses token->user decode),\r\n            // but we also want the richer profile available on context.user; we'll patch state by dispatching RESTORE_TOKEN again with the same token\r\n            // and rely on components reading from localStorage or triggering a reload. For now, we set user in localStorage for consumers.\r\n            localStorage.setItem('userProfile', JSON.stringify(profile));\r\n          }\r\n        } catch (err) {\r\n          // ignore profile fetch errors; UI will fallback to token-decoded values\r\n        }\r\n      })();\r\n    } else {\r\n      localStorage.removeItem('token');\r\n      dispatch({ type: 'LOGOUT' });\r\n    }\r\n  }, []);\r\n\r\n  // Listen for cross-component user updates dispatched as a CustomEvent\r\n  useEffect(() => {\r\n    const handler = (e: Event) => {\r\n      try {\r\n        const ce = e as CustomEvent;\r\n        let updatedUser = ce?.detail;\r\n        if (!updatedUser) return;\r\n        // Support nested shapes: { user: {...} } or { data: { user: {...} } }\r\n        if (updatedUser.user) updatedUser = updatedUser.user;\r\n        if (updatedUser.data && updatedUser.data.user) updatedUser = updatedUser.data.user;\r\n        // If it's a deletion notification, and it affects current user, log out\r\n        const current = state.user as any;\r\n        if (!current) return;\r\n        if (updatedUser.deleted && updatedUser._id && current._id && updatedUser._id === current._id) {\r\n          // If the current user was deleted by admin, force logout\r\n          setUser(null);\r\n          return;\r\n        }\r\n        // Only update if the updated user matches the current user's id or username\r\n        if (updatedUser._id && current._id && updatedUser._id === current._id) {\r\n          setUser(updatedUser as User);\r\n        } else if (updatedUser.username && current.username && updatedUser.username === current.username) {\r\n          setUser(updatedUser as User);\r\n        }\r\n      } catch (err) {\r\n        // ignore\r\n      }\r\n    };\r\n    window.addEventListener('userProfileUpdated', handler as EventListener);\r\n    return () => window.removeEventListener('userProfileUpdated', handler as EventListener);\r\n  }, [state.user]);\r\n\r\n  const login = (token: string) => {\r\n    localStorage.setItem('token', token);\r\n    // Set cookie for backend authentication (expires in 1 day)\r\n    document.cookie = `token=${token}; path=/; max-age=86400; SameSite=Lax`;\r\n    dispatch({ type: 'LOGIN', payload: token });\r\n    // Fetch and persist full profile after login\r\n    (async () => {\r\n      try {\r\n        const { authService } = await import('../services/api');\r\n        const profile = await authService.getCurrentUser();\r\n        if (profile) {\r\n          localStorage.setItem('userProfile', JSON.stringify(profile));\r\n          // update state by re-dispatching login (so token will decode) -- components should read latest profile from localStorage when available\r\n          dispatch({ type: 'LOGIN', payload: token });\r\n        }\r\n      } catch (err) {\r\n        // ignore\r\n      }\r\n    })();\r\n  };\r\n\r\n  const setUser = (user: User | null) => {\r\n    if (user) {\r\n      // persist richer profile\r\n      localStorage.setItem('userProfile', JSON.stringify(user));\r\n      // also re-dispatch LOGIN with existing token to keep state consistent\r\n      const token = localStorage.getItem('token');\r\n      if (token) dispatch({ type: 'LOGIN', payload: token });\r\n    } else {\r\n      localStorage.removeItem('userProfile');\r\n      dispatch({ type: 'LOGOUT' });\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    // Try to notify backend, but don't block logout on failure\r\n    authService.logout().catch(() => {});\r\n    localStorage.removeItem('token');\r\n    // Remove the token cookie\r\n    document.cookie = 'token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT;';\r\n    dispatch({ type: 'LOGOUT' });\r\n    navigate('/login', { replace: true });\r\n  };\r\n\r\n  const isStaff = () => state.user?.role === 'staff';\r\n  const isAdmin = () => state.user?.role === 'admin';\r\n  const isResident = () => state.user?.role === 'resident';\r\n\r\n  const switchMode = (newMode: 'resident' | 'staff') => {\r\n    setMode(newMode);\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ \r\n      ...state, \r\n      login, \r\n      logout,\r\n      isStaff,\r\n      isAdmin,\r\n      isResident,\r\n      mode,\r\n      switchMode,\r\n      setUser,\r\n    }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n","import './responsive-system-title.css';\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Layout, Menu, Button, Space, Dropdown } from 'antd';\r\nimport {\r\n  LogoutOutlined,\r\n  ClockCircleOutlined,\r\n  NotificationOutlined,\r\n  SettingOutlined,\r\n  HomeOutlined,\r\n  FileTextOutlined,\r\n  MessageOutlined,\r\n  InboxOutlined,\r\n  TeamOutlined,\r\n  BarChartOutlined,\r\n  HistoryOutlined,\r\n  FileDoneOutlined,\r\n  \r\n  FileProtectOutlined\r\n  ,MenuFoldOutlined, MenuUnfoldOutlined, MenuOutlined, UserOutlined\r\n} from '@ant-design/icons';\r\nimport { getAbsoluteApiUrl } from '../services/api';\r\nimport './AppLayoutSidebar.css';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\n\r\n// Date and Time display component (smaller, subtle, top-right)\r\nconst DateTimeDisplay: React.FC = () => {\r\n  const [now, setNow] = useState(new Date());\r\n  useEffect(() => {\r\n    const timer = setInterval(() => setNow(new Date()), 1000);\r\n    return () => clearInterval(timer);\r\n  }, []);\r\n  const pad = (n: number) => n.toString().padStart(2, '0');\r\n  const date = `${pad(now.getMonth() + 1)}/${pad(now.getDate())}/${now.getFullYear()}`;\r\n  const time = `${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;\r\n  return (\r\n    <span style={{ fontSize: 13, color: '#888', fontWeight: 500, letterSpacing: 0.5, marginRight: 8 }}>\r\n      <ClockCircleOutlined style={{ marginRight: 4 }} />\r\n      {date} {time}\r\n    </span>\r\n  );\r\n};\r\nconst { Header, Content, Sider } = Layout;\r\n\r\nconst SIDEBAR_WIDTH = 240;\r\nconst SIDEBAR_COLLAPSED_WIDTH = 64;\r\nconst HEADER_HEIGHT = 64;\r\n\r\nconst navConfig: {\r\n  resident: { key: string; icon: React.ReactNode; label: string }[];\r\n  admin: { key: string; icon: React.ReactNode; label: string }[];\r\n  staff: { key: string; icon: React.ReactNode; label: string }[];\r\n} = {\r\n  resident: [\r\n    {\r\n      key: '/home',\r\n      icon: <HomeOutlined />,\r\n      label: 'Home',\r\n    },\r\n    {\r\n      key: '/request',\r\n      icon: <FileTextOutlined />,\r\n      label: 'Request',\r\n    },\r\n    {\r\n      key: '/inquiries',\r\n      icon: <MessageOutlined />,\r\n      label: 'Inquiries',\r\n    },\r\n    {\r\n      key: '/inbox',\r\n      icon: <InboxOutlined />,\r\n      label: 'Inbox',\r\n    },\r\n  ],\r\n  admin: [\r\n    {\r\n      key: '/admin/dashboard',\r\n      icon: <HomeOutlined />,\r\n      label: 'Admin Dashboard',\r\n    },\r\n    {\r\n      key: '/admin/users',\r\n      icon: <TeamOutlined />,\r\n      label: 'User Management',\r\n    },\r\n    // Activity Logs menu removed from admin sidebar per request\r\n    {\r\n      key: '/admin/statistics',\r\n      icon: <BarChartOutlined />,\r\n      label: 'Statistics',\r\n    },\r\n    {\r\n      key: '/admin/settings',\r\n      icon: <SettingOutlined />,\r\n      label: 'System Settings',\r\n    },\r\n    {\r\n      key: '/admin/verification-requests',\r\n      icon: <FileProtectOutlined />,\r\n      label: 'Verification Requests',\r\n    },\r\n  ],\r\n  staff: [\r\n    {\r\n      key: '/staff-dashboard',\r\n      icon: <HomeOutlined />,\r\n      label: 'Staff Dashboard',\r\n    },\r\n    {\r\n      key: '/staff/inbox',\r\n      icon: <InboxOutlined />,\r\n      label: 'Staff Inbox',\r\n    },\r\n    {\r\n      key: '/templates-manager',\r\n      icon: <FileProtectOutlined />,\r\n      label: 'Templates Manager',\r\n    },\r\n    {\r\n      key: '/document-processing',\r\n      icon: <FileDoneOutlined />,\r\n      label: 'Document Processing',\r\n    },\r\n    {\r\n      key: '/document-history',\r\n      icon: <HistoryOutlined />,\r\n      label: 'Document History',\r\n    },\r\n  ],\r\n};\r\n\r\n\r\n\r\ntype AppLayoutProps = {\r\n  children: React.ReactNode;\r\n};\r\n\r\nconst AppLayout: React.FC<AppLayoutProps> = ({ children }) => {\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  // Prefer the richer persisted full profile in localStorage when available.\r\n  // AuthContext keeps a token-decoded user in context; the full profile fetched\r\n  // from the server is stored in `localStorage.userProfile`. Merge them so\r\n  // components like this can access avatar/profileImage fields.\r\n  let displayUser: any = user;\r\n  try {\r\n    const stored = localStorage.getItem('userProfile');\r\n    if (stored) {\r\n      const parsed = JSON.parse(stored);\r\n      // Merge token-decoded user with persisted profile, preferring stored values\r\n      displayUser = { ...(user || {}), ...(parsed || {}) };\r\n    }\r\n  } catch (err) {\r\n    // ignore parse errors and fall back to token-decoded `user`\r\n  }\r\n\r\n  // Utility bar quick actions removed: online/status and dark-mode switch removed\r\n  // You can expand these as needed for your system\r\n  const [residentImageSrc, setResidentImageSrc] = useState<string | null>(null);\r\n  \r\n  // Start collapsed by default so the navigation is compact on initial load.\r\n  const [collapsed, setCollapsed] = useState(true);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        const api = await import('../services/api');\r\n        try {\r\n          const data = await api.residentPersonalInfoAPI.getPersonalInfo();\r\n          if (data?.profileImage) {\r\n            const url = data.profileImage.startsWith('http') ? data.profileImage : `${window.location.origin}${data.profileImage}`;\r\n            setResidentImageSrc(url);\r\n            return;\r\n          }\r\n          if (data?.profileImageId) {\r\n            setResidentImageSrc(getAbsoluteApiUrl(`/resident/personal-info/avatar/${data.profileImageId}`));\r\n            return;\r\n          }\r\n        } catch (err) {\r\n          // ignore\r\n        }\r\n        try {\r\n          const resp = await api.default.get('/resident/profile');\r\n          const d = resp.data;\r\n          if (d?.profileImage) {\r\n            const url = d.profileImage.startsWith('http') ? d.profileImage : `${window.location.origin}${d.profileImage}`;\r\n            setResidentImageSrc(url);\r\n          } else if (d?.profileImageId) {\r\n            setResidentImageSrc(getAbsoluteApiUrl(`/resident/personal-info/avatar/${d.profileImageId}`));\r\n          }\r\n        } catch (err) {\r\n          // ignore\r\n        }\r\n      } catch (err) {\r\n        // ignore\r\n      }\r\n      // verification status intentionally omitted (feature temporarily disabled)\r\n    })();\r\n    const handler = (e: Event) => {\r\n      try {\r\n        const ce = e as CustomEvent;\r\n        const updated = ce?.detail;\r\n        if (!updated) return;\r\n        if (updated.profileImage) {\r\n          const url = updated.profileImage.startsWith('http') ? updated.profileImage : `${window.location.origin}${updated.profileImage}`;\r\n          setResidentImageSrc(url);\r\n        } else if (updated.profileImageId) {\r\n          setResidentImageSrc(getAbsoluteApiUrl(`/resident/personal-info/avatar/${updated.profileImageId}`));\r\n        }\r\n      } catch (err) {\r\n        // ignore\r\n      }\r\n    };\r\n    window.addEventListener('userProfileUpdated', handler as EventListener);\r\n    return () => {\r\n      window.removeEventListener('userProfileUpdated', handler as EventListener);\r\n      try { clearInterval((window as any).__verifPollId); } catch (e) {}\r\n    };\r\n  }, []);\r\n\r\n    // avatar icons are used instead of image Avatars; keep residentImageSrc for\r\n    // potential future uses but header will show icons (Menu and Person).\r\n\r\n  // SSE for verification/profile updates is disabled while feature is paused\r\n\r\n  // Close dropdown on outside click\r\n  // Removed notification dropdown logic\r\n\r\n  return (\r\n    <Layout style={{ minHeight: '100vh', background: '#000' }}>\r\n      {user && (\r\n        <Sider\r\n          width={SIDEBAR_WIDTH}\r\n          collapsed={collapsed}\r\n          collapsedWidth={SIDEBAR_COLLAPSED_WIDTH}\r\n          style={{\r\n            height: '100vh',\r\n            position: 'fixed',\r\n            left: 0,\r\n            top: 0,\r\n            background: 'linear-gradient(180deg, #40c9ff 0%, #e81cff 100%)', // Original vibrant blue to purple\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            padding: 0,\r\n            zIndex: 100,\r\n            boxShadow: '2px 0 16px 0 rgba(64,201,255,0.10)',\r\n            borderRight: 'none',\r\n            overflowX: 'hidden',\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              flex: 1,\r\n              overflowY: 'auto',\r\n              overflowX: 'hidden',\r\n              padding: '24px 0 0 0',\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n            }}\r\n          >\r\n            <Menu\r\n              theme=\"light\"\r\n              mode=\"inline\"\r\n              selectedKeys={[location.pathname]}\r\n              style={{\r\n                background: 'transparent',\r\n                fontWeight: 600,\r\n                fontSize: 17,\r\n                border: 'none',\r\n              }}\r\n              inlineCollapsed={collapsed}\r\n              items={\r\n                navConfig[\r\n                  user?.role === 'admin'\r\n                    ? 'admin'\r\n                    : user?.role === 'staff'\r\n                    ? 'staff'\r\n                    : 'resident'\r\n                ].map(item => ({\r\n                  ...item,\r\n                  className: location.pathname === item.key ? 'ant-menu-item-active-custom' : undefined\r\n                }))\r\n              }\r\n              onClick={({ key }) => {\r\n                if (location.pathname !== key) {\r\n                  navigate(key);\r\n                }\r\n              }}\r\n            />\r\n          </div>\r\n        </Sider>\r\n      )}\r\n  <Layout style={{ marginLeft: user ? (collapsed ? SIDEBAR_COLLAPSED_WIDTH : SIDEBAR_WIDTH) : 0 }}>\r\n        <Header\r\n          className=\"app-header\"\r\n          style={{\r\n            height: HEADER_HEIGHT,\r\n            background: '#fff',\r\n            display: 'flex',\r\n            flexWrap: 'nowrap',\r\n            alignItems: 'center',\r\n            justifyContent: 'space-between',\r\n            padding: '0 32px',\r\n            position: 'fixed',\r\n            left: user ? (collapsed ? SIDEBAR_COLLAPSED_WIDTH : SIDEBAR_WIDTH) : 0,\r\n            right: 0,\r\n            top: 0,\r\n            zIndex: 101,\r\n            boxShadow: '0 2px 8px #e3e6f3',\r\n          }}\r\n        >\r\n          <div\r\n            className=\"responsive-system-title\"\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: 12,\r\n              maxWidth: '100%',\r\n              overflow: 'hidden',\r\n              textOverflow: 'ellipsis',\r\n              whiteSpace: 'nowrap',\r\n            }}\r\n          >\r\n            {/* collapse button removed per design  sidebar remains static per current layout */}\r\n            {/* Logo icon (served from public/) */}\r\n            <img src={`${process.env.PUBLIC_URL}/logo-parian2.png`} alt=\"Logo\" style={{ width: 36, height: 36, marginRight: 4 }} />\r\n            <span style={{\r\n              fontSize: 26,\r\n              fontWeight: 400,\r\n              letterSpacing: 1,\r\n              background: 'linear-gradient(90deg, #40c9ff, #e81cff)',\r\n              WebkitBackgroundClip: 'text',\r\n              WebkitTextFillColor: 'transparent',\r\n              display: 'inline-block',\r\n              maxWidth: '100%',\r\n              overflow: 'hidden',\r\n              textOverflow: 'ellipsis',\r\n              whiteSpace: 'nowrap',\r\n            }}>\r\n              Barangay Information <span style={{ fontWeight: 800 }}>Management System</span>\r\n            </span>\r\n          </div>\r\n          <div className=\"header-controls\" style={{ display: 'flex', alignItems: 'center', gap: 16, position: 'relative', marginRight: 8 }}>\r\n            <span style={{ marginRight: 8 }}>\r\n              <DateTimeDisplay />\r\n            </span>\r\n            {/* Utility bar: quick actions */}\r\n            <Space size={12}>\r\n              {displayUser && (\r\n                // Route admins to admin management, others to public announcements\r\n                <Button size=\"small\" onClick={() => navigate(displayUser?.role === 'admin' ? '/admin/announcements' : '/announcements')}\r\n                  icon={<NotificationOutlined />}\r\n                />\r\n              )}\r\n            </Space>\r\n            {/* Verification status indicator removed while feature is paused */}\r\n            {/* profile/menu icons (uses icons instead of Avatar) */}\r\n            {(() => {\r\n              const items: any[] = [\r\n                { key: 'profile', icon: <UserOutlined />, label: 'Profile' },\r\n                ...(user?.role === 'admin' ? [{ key: 'settings', icon: <SettingOutlined />, label: 'Settings' }] : []),\r\n                { type: 'divider', key: 'divider-1' },\r\n                { key: 'logout', icon: <LogoutOutlined />, label: 'Logout' },\r\n              ];\r\n              return (\r\n                <Dropdown\r\n                  menu={{ items, onClick: ({ key }) => {\r\n                    if (key === 'profile') navigate('/profile');\r\n                    else if (key === 'settings') navigate('/admin/settings');\r\n                    else if (key === 'logout') navigate('/logout');\r\n                  }}}\r\n                  placement=\"bottomRight\"\r\n                  trigger={[\"click\"]}\r\n                >\r\n                  <div style={{ cursor: 'pointer', display: 'inline-flex', alignItems: 'center', gap: 8, padding: 2 }}>\r\n                    <Button type=\"default\" shape=\"circle\" size=\"small\" icon={<MenuOutlined />} />\r\n                  </div>\r\n                </Dropdown>\r\n              );\r\n            })()}\r\n            {/* Verification modal removed while feature is paused */}\r\n          </div>\r\n  </Header>\r\n  {/* Divider line below header */}\r\n  <div style={{ height: 1, background: '#f0f0f0', width: '100%', margin: 0, boxShadow: 'none' }} />\r\n        <Content\r\n          style={{\r\n            marginTop: HEADER_HEIGHT,\r\n            padding: 32,\r\n            background: 'linear-gradient(135deg, #e3f6fd 0%, #b3e0ff 60%,  #b3e0ff 100%)',\r\n            minHeight: `calc(100vh - ${HEADER_HEIGHT}px)`,\r\n          }}\r\n        >\r\n          {children}\r\n        </Content>\r\n      </Layout>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default AppLayout;\r\n","\r\nimport React from 'react';\r\nimport AppLayout from './AppLayout';\r\nimport { Outlet } from 'react-router-dom';\r\n\r\ninterface LayoutProps {\r\n  children?: React.ReactNode;\r\n}\r\n\r\nconst Layout: React.FC<LayoutProps> = ({ children }) => {\r\n  // If children are passed, render them (for legacy usage), otherwise render <Outlet /> for nested routes\r\n  return <AppLayout>{children || <Outlet />}</AppLayout>;\r\n};\r\n\r\nexport default Layout;\r\n","import React from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\n\r\ninterface PrivateRouteProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst PrivateRoute: React.FC<PrivateRouteProps> = ({ children }) => {\r\n  const { isAuthenticated, user } = useAuth();\r\n\r\n  // Allow access when a valid JWT-authenticated user exists OR when a guest profile is present\r\n  // Guest users are stored in context.user with role === 'guest' (set by LoginForm). We treat that as allowed.\r\n  if (!isAuthenticated && !(user && (user as any).role === 'guest')) {\r\n    return <Navigate to=\"/login\" replace />;\r\n  }\r\n\r\n  return <>{children}</>;\r\n};\r\n\r\nexport default PrivateRoute;\r\n","import React from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\n\r\ninterface StaffRouteProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst StaffRoute: React.FC<StaffRouteProps> = ({ children }) => {\r\n  const { isAuthenticated, user } = useAuth();\r\n\r\n  if (!isAuthenticated) {\r\n    return <Navigate to=\"/login\" replace />;\r\n  }\r\n\r\n  if (user?.role !== 'staff' && user?.role !== 'admin') {\r\n    return <Navigate to=\"/dashboard\" replace />;\r\n  }\r\n\r\n  return <>{children}</>;\r\n};\r\n\r\nexport default StaffRoute;\r\n","import React from 'react';\r\nimport { Navigate, useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { Spin, Result, Button } from 'antd';\r\n\r\ninterface AdminRouteProps {\r\n  children: React.ReactElement;\r\n}\r\n\r\nconst AdminRoute: React.FC<AdminRouteProps> = ({ children }) => {\r\n  const auth = useAuth();\r\n  const navigate = useNavigate();\r\n\r\n  const currentUser = auth?.user as any;\r\n  const isAdmin = typeof auth?.isAdmin === 'function' ? auth.isAdmin() : currentUser?.role === 'admin' || currentUser?.isAdmin === true;\r\n\r\n  // If no user but there is a token in storage, auth restore may be in progress  show a spinner\r\n  const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\r\n  if (!currentUser && token) {\r\n    return (\r\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%' }}>\r\n        <Spin size=\"large\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Not authenticated  redirect to login\r\n  if (!currentUser) {\r\n    return <Navigate to=\"/login\" replace />;\r\n  }\r\n\r\n  // Authenticated but not admin  show 403\r\n  if (!isAdmin) {\r\n    return (\r\n      <Result\r\n        status=\"403\"\r\n        title=\"403\"\r\n        subTitle=\"Sorry, you are not authorized to access this page.\"\r\n        extra={<Button type=\"primary\" onClick={() => navigate('/dashboard')}>Go to Dashboard</Button>}\r\n      />\r\n    );\r\n  }\r\n\r\n  return children;\r\n};\r\n\r\nexport default AdminRoute;\r\n","import { getAbsoluteApiUrl, axiosPublic } from '../services/api';\r\n\r\nexport interface OfficialLite {\r\n  _id?: string;\r\n  photo?: any;\r\n  photoUrl?: string;\r\n  photoPath?: string;\r\n  previewUrl?: string;\r\n}\r\n\r\nexport interface PublicOfficial {\r\n  _id: string;\r\n  name?: string;\r\n  title?: string;\r\n  term?: string;\r\n  hasPhoto?: boolean;\r\n}\r\n\r\n/**\r\n * Return a URL string to display for an official's photo.\r\n * Priority:\r\n * 1. previewUrl (object URL for immediate client preview)\r\n * 2. DB photo bytes served at /api/admin/officials/:id/photo when `photo` is present\r\n * 3. photoUrl (legacy full URL)\r\n * 4. photoPath (legacy disk path)\r\n * 5. default avatar\r\n */\r\n\r\nexport function getOfficialPhotoSrc(off: OfficialLite) {\r\n  // Small embedded PNG data-URI as a safe default (1x1 neutral placeholder)\r\n  const DEFAULT_PNG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=';\r\n  if (!off) return DEFAULT_PNG;\r\n  if (off.previewUrl) return off.previewUrl;\r\n  // If the document has raw photo bytes (admin view) prefer admin photo endpoint\r\n  if ((off as any).photo && off._id) return getAbsoluteApiUrl(`/admin/officials/${off._id}/photo`);\r\n  // If we're dealing with a public official object that only exposes a flag, use the public photo route\r\n  if ((off as any).hasPhoto && off._id) return getAbsoluteApiUrl(`/officials/${off._id}/photo`);\r\n  if (off.photoUrl) return off.photoUrl;\r\n  if (off.photoPath) return getAbsoluteApiUrl(`/${off.photoPath.replace(/^\\//, '')}`);\r\n  return DEFAULT_PNG;\r\n}\r\n\r\nexport default getOfficialPhotoSrc;\r\n\r\n/**\r\n * Fetch public barangay officials for display on unauthenticated pages.\r\n * Calls server public route GET /api/officials which returns minimal fields.\r\n*/\r\n\r\nexport async function fetchPublicOfficials(): Promise<PublicOfficial[]> {\r\n  try {\r\n    // Prefer the public axios instance which respects runtime API_BASE\r\n    const res = await axiosPublic.get('/officials');\r\n    let data: any = res.data;\r\n    // handle wrapped payloads like { data: [...] } or { officials: [...] }\r\n    if (data && Array.isArray(data.data)) data = data.data;\r\n    if (data && Array.isArray(data.officials)) data = data.officials;\r\n    if (!Array.isArray(data)) {\r\n      console.warn('fetchPublicOfficials: unexpected payload shape', data);\r\n      return [];\r\n    }\r\n    if (data.length === 0) console.info('fetchPublicOfficials: server returned empty list');\r\n    return data as PublicOfficial[];\r\n  } catch (err) {\r\n    console.error('fetchPublicOfficials error', err);\r\n    return [];\r\n  }\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\nimport { Card, Typography, Statistic, Row, Col, Spin } from 'antd';\r\nimport { UserOutlined, CrownOutlined, TeamOutlined, HomeOutlined, FileTextOutlined, NotificationOutlined } from '@ant-design/icons';\r\nimport { adminAPI, documentsAPI, contactAPI } from '../services/api';\r\n\r\nconst StatsPanel: React.FC = () => {\r\n  const [stats, setStats] = useState<any | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      try {\r\n        // Fetch supporting public resources in parallel (files, documents, announcements)\r\n        const [filesRes, docRequestsRes, announcementsRes] = await Promise.all([\r\n          documentsAPI.listFiles().catch(() => ([])),\r\n          documentsAPI.getAllDocuments().catch(() => ([])),\r\n          contactAPI.getAnnouncements().catch(() => ([]))\r\n        ]);\r\n\r\n        // Attempt to fetch admin statistics, but tolerate 401/unauthenticated errors\r\n        let resStats: any = null;\r\n        try {\r\n          resStats = await adminAPI.getSystemStatistics();\r\n        } catch (statErr) {\r\n          console.warn('Could not fetch admin statistics (likely unauthenticated):', String(statErr));\r\n          resStats = null;\r\n        }\r\n\r\n        if (mounted) {\r\n          // attach filesCount, docRequestsCount and announcementsCount to stats for display\r\n          const filesCount = Array.isArray(filesRes) ? filesRes.length : (filesRes && filesRes.length) || 0;\r\n          const docRequestsCount = Array.isArray(docRequestsRes) ? docRequestsRes.length : (docRequestsRes && docRequestsRes.length) || 0;\r\n          const announcementsCount = Array.isArray(announcementsRes) ? announcementsRes.length : (announcementsRes && announcementsRes.length) || 0;\r\n          setStats({ ...(resStats || {}), filesCount, docRequestsCount, announcementsCount });\r\n        }\r\n      } catch (err) {\r\n        console.error('Failed to load system statistics', err);\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    })();\r\n    return () => { mounted = false; };\r\n  }, []);\r\n\r\n  if (loading) return <div style={{ width: '100%', textAlign: 'center' }}><Spin /></div>;\r\n  if (!stats) return <div style={{ textAlign: 'center' }}><Typography.Text type=\"secondary\">No statistics available</Typography.Text></div>;\r\n\r\n  const users = stats.users || {};\r\n  const filesCount = stats.filesCount ?? 0;\r\n\r\n  // Arrange items so that with a 3-column layout the Documents tile falls under Admins\r\n  const items = [\r\n    { key: 'users', title: 'Total Users', value: users.total ?? 0, icon: <UserOutlined style={{ color: '#9254de', fontSize: 20 }} /> },\r\n    { key: 'admins', title: 'Admins', value: users.byRole?.admin ?? 0, icon: <CrownOutlined style={{ color: '#f5a623', fontSize: 20 }} /> },\r\n    { key: 'staff', title: 'Staff', value: users.byRole?.staff ?? 0, icon: <TeamOutlined style={{ color: '#1677ff', fontSize: 20 }} /> },\r\n    { key: 'residents', title: 'Residents', value: users.byRole?.resident ?? 0, icon: <HomeOutlined style={{ color: '#22c55e', fontSize: 20 }} /> },\r\n    { key: 'announcements', title: 'Announcements', value: stats.announcementsCount ?? 0, icon: <NotificationOutlined style={{ color: '#faad14', fontSize: 20 }} /> },\r\n    { key: 'docFiles', title: 'Documents Available', value: filesCount, icon: <FileTextOutlined style={{ color: '#0ea5e9', fontSize: 20 }} /> },\r\n  ];\r\n\r\n  return (\r\n    <Card className=\"glass-card stats-card\" style={{ width: '100%' }}>\r\n      <Typography.Title level={4}>Quick Stats</Typography.Title>\r\n      <div style={{ height: 6, background: 'linear-gradient(90deg, rgba(22,119,255,0.08), rgba(146,84,222,0.08))', borderRadius: 4, marginBottom: 12 }} />\r\n\r\n      <Row gutter={[12,12]} style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', flexWrap: 'wrap' }}>\r\n        {items.map(it => (\r\n          <Col key={it.key} xs={12} sm={8} md={8} lg={8} style={{ display: 'flex' }}>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: 12, width: '100%' }}>\r\n              <div style={{ width: 44, height: 44, display: 'flex', alignItems: 'center', justifyContent: 'center', background: 'rgba(255,255,255,0.9)', borderRadius: 8, boxShadow: '0 6px 14px rgba(2,6,23,0.06)' }}>\r\n                {it.icon}\r\n              </div>\r\n              <div style={{ flex: 1 }}>\r\n                <Statistic title={it.title} value={it.value} />\r\n              </div>\r\n            </div>\r\n          </Col>\r\n        ))}\r\n      </Row>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default StatsPanel;\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { Row, Col, Form, Input, Button, Card, Typography, message, Modal } from 'antd';\r\nimport { UserOutlined, LockOutlined } from '@ant-design/icons';\r\nimport { Link as RouterLink, useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { adminAPI, axiosPublic, axiosInstance } from '../services/api';\r\nimport getOfficialPhotoSrc, { fetchPublicOfficials, PublicOfficial } from '../utils/officials';\r\nimport StatsPanel from './StatsPanel';\r\nimport AvatarImage from './AvatarImage';\r\nimport './LoginForm.css';\r\nimport { LeftOutlined, RightOutlined } from '@ant-design/icons';\r\n\r\nconst LoginForm: React.FC = () => {\r\n    // Resident Avatars preview state\r\n    const [residentAvatars, setResidentAvatars] = useState<any[]>([]);\r\n    const [avatarsStatus, setAvatarsStatus] = useState<string>('loading');\r\n\r\n    // Fetch a few sample residents with avatars for preview\r\n    useEffect(() => {\r\n      let mounted = true;\r\n      (async () => {\r\n        setAvatarsStatus('loading');\r\n        try {\r\n          // Use public endpoint to fetch residents (limit to 5 with avatars)\r\n          const resp = await axiosPublic.get('/residents/with-avatars?limit=5');\r\n          let data = resp.data;\r\n          if (data && Array.isArray(data.data)) data = data.data;\r\n          if (!Array.isArray(data)) data = [];\r\n          // Only keep residents with a profileImageId\r\n          const filtered = data.filter((r: any) => r.profileImageId);\r\n          if (mounted) {\r\n            setResidentAvatars(filtered);\r\n            setAvatarsStatus(filtered.length > 0 ? 'ok' : 'empty');\r\n          }\r\n        } catch (e) {\r\n          setAvatarsStatus('error');\r\n        }\r\n      })();\r\n      return () => { mounted = false; };\r\n    }, []);\r\n  const { login, isAuthenticated, user, setUser } = useAuth() as any;\r\n  const [guestModalVisible, setGuestModalVisible] = useState(false);\r\n  const [emergencyModalVisible, setEmergencyModalVisible] = useState(false);\r\n  const [guestForm] = Form.useForm();\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState(false);\r\n  const [officials, setOfficials] = useState<PublicOfficial[]>([]);\r\n  const [, setOfficialsStatus] = useState<string>('loading');\r\n  const carouselRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (isAuthenticated && user) {\r\n      if (user.role === 'admin') navigate('/admin/dashboard');\r\n      else if (user.role === 'staff') navigate('/staff-dashboard');\r\n      else if ((user as any).role === 'guest') navigate('/guest/dashboard');\r\n      else navigate('/dashboard');\r\n    }\r\n  }, [isAuthenticated, user, navigate]);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      try {\r\n        setOfficialsStatus('fetching public');\r\n        const offs = await fetchPublicOfficials();\r\n        if (mounted && Array.isArray(offs) && offs.length > 0) {\r\n          setOfficials(offs);\r\n          setOfficialsStatus(`public:${offs.length}`);\r\n        } else {\r\n          // fallback attempt to admin endpoint (useful during local dev when auth may be present)\r\n          // Only attempt admin fallback if the current user is authenticated.\r\n          // Public (unauthenticated) visitors should not hit admin endpoints.\r\n          if (isAuthenticated) {\r\n            setOfficialsStatus('trying-admin-fallback');\r\n            try {\r\n              const adminOffs: any[] = await adminAPI.getOfficials();\r\n              if (mounted && Array.isArray(adminOffs) && adminOffs.length > 0) {\r\n                // normalize to PublicOfficial shape\r\n                const mapped = adminOffs.map(a => ({ _id: a._id, name: a.name, title: a.title, term: a.term, hasPhoto: !!a.photo || !!a.photoPath }));\r\n                setOfficials(mapped);\r\n                setOfficialsStatus(`admin:${mapped.length}`);\r\n              } else {\r\n                setOfficialsStatus('no-officials');\r\n              }\r\n            } catch (e) {\r\n              console.warn('Admin fallback failed', e);\r\n              setOfficialsStatus('error');\r\n            }\r\n          } else {\r\n            setOfficialsStatus('no-officials');\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.warn('Failed to fetch public officials for login preview', e);\r\n        setOfficialsStatus('error');\r\n      }\r\n    })();\r\n    return () => { mounted = false; };\r\n  }, [isAuthenticated]);\r\n\r\n  const onFinish = async (values: { username: string; password: string }) => {\r\n    setLoading(true);\r\n    try {\r\n      // Build payload: if the input looks like an email, send it as `email`.\r\n      // Otherwise send as `identifier` so backend can resolve by username.\r\n      const raw = (values.username || '').toString().trim();\r\n      const payload: any = raw.includes('@')\r\n        ? { email: raw, password: values.password }\r\n        : { identifier: raw, password: values.password };\r\n\r\n      // Use axiosInstance so runtime API_BASE is respected and credentials are sent\r\n      const resp = await axiosInstance.post('/auth/login', payload);\r\n      const data = resp && resp.data ? resp.data : {};\r\n\r\n      if (!resp || resp.status >= 400) {\r\n        console.error('Login response not OK:', { status: resp?.status, data });\r\n        throw new Error(data.message || 'Login failed');\r\n      }\r\n\r\n      if (!data.token) {\r\n        console.error('No token in response:', data);\r\n        throw new Error('Login failed - No token received');\r\n      }\r\n\r\n      login(data.token);\r\n      message.success(data.message || 'Login successful!');\r\n      // navigation will occur in the useEffect above after auth state updates\r\n    } catch (err: any) {\r\n      // Provide clearer messages based on server response\r\n      const respErr = err?.response;\r\n      if (respErr && respErr.status) {\r\n        if (respErr.status === 401) {\r\n          message.error('Invalid username/email or password');\r\n        } else if (respErr.status === 403) {\r\n          const msg = respErr.data?.message || 'Account is not allowed to login';\r\n          message.error(msg);\r\n        } else if (respErr.status === 404) {\r\n          message.error('Account not found');\r\n        } else {\r\n          message.error(respErr.data?.message || 'Login failed');\r\n        }\r\n      } else {\r\n        message.error(err.message || 'Error logging in');\r\n      }\r\n      console.error('Login error:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n    <div className=\"login-page\">\r\n      <div className=\"login-container two-pane\">\r\n        <Row gutter={24} align=\"stretch\" justify=\"center\" className=\"two-pane-row\">\r\n          {/* Left combined pane - stats + officials */}\r\n          <Col xs={24} md={12} className=\"pane left-pane combined-pane\">\r\n            <div className=\"pane-inner left-inner\">\r\n              <div style={{ width: '100%', display: 'flex', flexDirection: 'column', gap: 18 }}>\r\n                <StatsPanel />\r\n                <Card className=\"glass-card preview-card invisible\" variant=\"outlined\">\r\n                  <Typography.Title level={4} style={{ marginBottom: 8 }}>Barangay Officials</Typography.Title>\r\n                  <div style={{ height: 6, background: 'linear-gradient(90deg, rgba(22,119,255,0.12), rgba(146,84,222,0.12))', borderRadius: 4, marginBottom: 12 }} />\r\n\r\n                  <div className=\"carousel-wrap\">\r\n                    <Button className=\"carousel-arrow left\" icon={<LeftOutlined />} onClick={() => {\r\n                      if (!carouselRef.current) return; carouselRef.current.scrollBy({ left: -240, behavior: 'smooth' });\r\n                    }} />\r\n                    <div ref={carouselRef} className=\"carousel-scroll\">\r\n                      {officials.length === 0 ? (\r\n                        <Typography.Text type=\"secondary\">No officials to preview</Typography.Text>\r\n                      ) : (\r\n                        officials.map(off => (\r\n                          <div key={off._id} className=\"official-card\">\r\n                            <div className=\"official-avatar\">\r\n                              <img\r\n                                alt={off.name}\r\n                                src={getOfficialPhotoSrc(off as any)}\r\n                                style={{ width: '100%', height: '100%', objectFit: 'cover' }}\r\n                                onError={(e) => {\r\n                                  try {\r\n                                    const t = e.currentTarget as HTMLImageElement;\r\n                                    t.onerror = null;\r\n                                    // Use lightweight data-URI fallback to avoid missing static asset\r\n                                    t.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=';\r\n                                  } catch (err) {}\r\n                                }}\r\n                              />\r\n                            </div>\r\n                            <div style={{ fontWeight: 700 }}>{off.name}</div>\r\n                            <div style={{ color: '#666', fontSize: 13 }}>{off.title}</div>\r\n                            <div style={{ color: '#999', fontSize: 12 }}>{off.term}</div>\r\n                          </div>\r\n                        ))\r\n                      )}\r\n                    </div>\r\n                    <Button className=\"carousel-arrow right\" icon={<RightOutlined />} onClick={() => {\r\n                      if (!carouselRef.current) return; carouselRef.current.scrollBy({ left: 240, behavior: 'smooth' });\r\n                    }} />\r\n                  </div>\r\n\r\n                  {/* Resident Avatars Preview */}\r\n                  <div style={{ marginTop: 32 }}>\r\n                    <Typography.Title level={4} style={{ marginBottom: 8 }}>Resident Avatars</Typography.Title>\r\n                    <div style={{ height: 6, background: 'linear-gradient(90deg, rgba(146,84,222,0.12), rgba(22,119,255,0.12))', borderRadius: 4, marginBottom: 12 }} />\r\n                    <div style={{ display: 'flex', gap: 18, flexWrap: 'wrap', minHeight: 60 }}>\r\n                      {avatarsStatus === 'loading' && <Typography.Text type=\"secondary\">Loading avatars...</Typography.Text>}\r\n                      {avatarsStatus === 'error' && <Typography.Text type=\"danger\">Failed to load avatars</Typography.Text>}\r\n                      {avatarsStatus === 'empty' && <Typography.Text type=\"secondary\">No resident avatars to preview</Typography.Text>}\r\n                      {avatarsStatus === 'ok' && residentAvatars.map(r => (\r\n                        <div key={r._id} style={{ textAlign: 'center' }}>\r\n                          <AvatarImage user={r} size={56} />\r\n                          <div style={{ fontSize: 13, color: '#666', marginTop: 4 }}>{r.fullName || r.username || 'Resident'}</div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          </Col>\r\n\r\n\r\n          {/* Right pane - login */}\r\n          <Col xs={24} md={12} className=\"pane center-pane login-pane\">\r\n            <div className=\"pane-inner center-inner\">\r\n              <Card className=\"glass-card login-card\" variant=\"outlined\">\r\n               <Typography.Title level={2} className=\"title-blue\" style={{ textAlign: 'center', marginBottom: 6 }}>\r\n                Barangay Information System\r\n              </Typography.Title>\r\n              <Typography.Text style={{ display: 'block', textAlign: 'center', color: '#9254de', fontWeight: 500, marginBottom: 18 }}>\r\n                Sign In\r\n              </Typography.Text>\r\n\r\n              <Form name=\"login\" layout=\"vertical\" onFinish={onFinish} autoComplete=\"off\" requiredMark={false}>\r\n                <Form.Item label=\"Email or Username\" name=\"username\" rules={[{ required: true, message: 'Please input your email or username!' }]}>\r\n                  <Input prefix={<UserOutlined style={{ color: '#40a9ff' }} />} placeholder=\"Enter your email or username\" size=\"large\" />\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Password\" name=\"password\" rules={[{ required: true, message: 'Please input your password!' }, { min: 6, message: 'Password must be at least 6 characters' }]}>\r\n                  <Input.Password autoComplete=\"current-password\" prefix={<LockOutlined style={{ color: '#40a9ff' }} />} placeholder=\"Enter your password\" size=\"large\" />\r\n                </Form.Item>\r\n\r\n                <Form.Item>\r\n                  <Button htmlType=\"submit\" size=\"large\" loading={loading} className=\"signin-btn\">\r\n                    {loading ? 'Signing In...' : 'Sign In'}\r\n                  </Button>\r\n                </Form.Item>\r\n\r\n                <Form.Item>\r\n                  <Button onClick={() => setGuestModalVisible(true)} size=\"large\" className=\"guest-warm-btn\" block>\r\n                    Continue as Guest\r\n                  </Button>\r\n                </Form.Item>\r\n\r\n                <div className=\"links-row\">\r\n                  <RouterLink to=\"/forgot-password\"><Typography.Text type=\"secondary\">Forgot Password?</Typography.Text></RouterLink>\r\n                  <RouterLink to=\"/register\"><Typography.Text type=\"secondary\">Sign Up</Typography.Text></RouterLink>\r\n                </div>\r\n                <div style={{ marginTop: 8, textAlign: 'center' }}>\r\n                  <Button type=\"link\" onClick={() => setEmergencyModalVisible(true)}>\r\n                    <Typography.Text type=\"danger\">Emergency Hotline</Typography.Text>\r\n                  </Button>\r\n                </div>\r\n              </Form>\r\n              </Card>\r\n            </div>\r\n          </Col>\r\n        </Row>\r\n      </div>\r\n  </div>\r\n  <Modal\r\n      title=\"Continue as Guest\"\r\n      open={guestModalVisible}\r\n      onCancel={() => { setGuestModalVisible(false); guestForm.resetFields(); }}\r\n      onOk={async () => {\r\n        try {\r\n          const vals = await guestForm.validateFields();\r\n          // submit to server to persist in Guest collection\r\n          try {\r\n            // Use public axios instance so the request goes to the configured API base\r\n            // and does not include any auth cookies.\r\n            const resp = await axiosPublic.post('/auth/guest', { name: vals.name, contactNumber: vals.contactNumber, email: vals.email, intent: vals.intent });\r\n            const data = resp && resp.data ? resp.data : {};\r\n            if (!resp || resp.status >= 400) {\r\n              message.error(data.message || 'Failed to create guest');\r\n              return;\r\n            }\r\n            const guestProfile = {\r\n              _id: data._id,\r\n              username: (vals.name || 'guest').toString().toLowerCase().replace(/\\s+/g, '_'),\r\n              firstName: vals.name || 'Guest',\r\n              contactNumber: vals.contactNumber || '',\r\n              email: vals.email || '',\r\n              intent: vals.intent || '',\r\n              sessionToken: data.sessionToken,\r\n              expiresAt: data.expiresAt,\r\n              role: 'guest'\r\n            };\r\n            if (typeof setUser === 'function') setUser(guestProfile);\r\n            localStorage.setItem('guestInfo', JSON.stringify(guestProfile));\r\n            // Optionally persist sessionToken separately for server calls\r\n            localStorage.setItem('guestSessionToken', data.sessionToken);\r\n            // If the server returned a JWT token, sign in via auth context so PrivateRoute won't redirect\r\n            if (data.token && typeof login === 'function') {\r\n              try {\r\n                await login(data.token);\r\n              } catch (e) {\r\n                // ignore login failure, but keep guest info available locally\r\n                console.warn('Guest token login failed', e);\r\n              }\r\n            }\r\n            setGuestModalVisible(false);\r\n            guestForm.resetFields();\r\n            navigate('/guest/dashboard');\r\n          } catch (err) {\r\n            console.error('Failed to persist guest', err);\r\n            message.error('Failed to create guest account');\r\n          }\r\n        } catch (err) {\r\n          // validation failed\r\n        }\r\n      }}\r\n    >\r\n      <Form layout=\"vertical\" form={guestModalVisible ? guestForm : undefined}>\r\n        <Form.Item name=\"name\" label=\"Full name\" rules={[{ required: true, message: 'Please enter your name' }]}>\r\n          <Input placeholder=\"Your full name\" />\r\n        </Form.Item>\r\n        <Form.Item name=\"contactNumber\" label=\"Contact number\" rules={[{ required: true, message: 'Please enter a contact number' }]}>\r\n          <Input placeholder=\"0917...\" />\r\n        </Form.Item>\r\n        <Form.Item name=\"email\" label=\"Email (optional)\" rules={[{ type: 'email', message: 'Enter a valid email' }]}>\r\n          <Input placeholder=\"you@example.com\" />\r\n        </Form.Item>\r\n        <Form.Item name=\"intent\" label=\"Purpose / Intent\" rules={[{ required: true, message: 'Please tell us your intent' }]}>\r\n          <Input.TextArea placeholder=\"Why are you visiting (e.g., check documents, request info)\" rows={3} />\r\n        </Form.Item>\r\n      </Form>\r\n    </Modal>\r\n    <Modal\r\n      title=\"Emergency Hotlines\"\r\n      open={emergencyModalVisible}\r\n      onCancel={() => setEmergencyModalVisible(false)}\r\n      footer={null}\r\n    >\r\n      <div style={{ lineHeight: 1.6 }}>\r\n        <Typography.Paragraph>\r\n          For general emergencies: <strong>911</strong>\r\n        </Typography.Paragraph>\r\n        <Typography.Paragraph>\r\n          National Center for Mental Health (Crisis): <strong>0917-899-8727</strong>\r\n        </Typography.Paragraph>\r\n        <Typography.Paragraph>\r\n          Philippine National Police (Emergency Hotline): <strong>9-1-1</strong> / <strong>8723-0401</strong> / <strong>8537-4500</strong>\r\n        </Typography.Paragraph>\r\n      </div>\r\n    </Modal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default LoginForm;\r\n","import React from 'react';\r\nimport { useFormik } from 'formik';\r\nimport * as Yup from 'yup';\r\nimport { TextField, Button, Box, Link, Paper, Container, InputAdornment, Alert, Typography } from '@mui/material';\r\nimport { Upload as AntUpload, Progress as AntProgress, message as antdMessage, Button as AntButton, Tooltip, Steps } from 'antd';\r\nimport { UploadOutlined, InfoCircleOutlined } from '@ant-design/icons';\r\nimport type { UploadFile } from 'antd/es/upload/interface';\r\nimport type { AxiosProgressEvent } from 'axios';\r\nimport { Email, Lock, Home, Phone, Person, Visibility, VisibilityOff } from '@mui/icons-material';\r\nimport { Link as RouterLink, useNavigate } from 'react-router-dom';\r\nimport { axiosInstance } from '../services/api';\r\n\r\n// Server requires: min 6 chars, at least one number, one uppercase letter, and one special character\r\nconst PASSWORD_REGEX = /^(?=.*[A-Z])(?=.*\\d)(?=.*[^A-Za-z0-9]).{6,}$/;\r\n\r\n// Name regex: letters, spaces, apostrophe, hyphen only\r\nconst NAME_REGEX = /^[A-Za-z\\s'-]+$/;\r\n\r\nconst validationSchema = Yup.object({\r\n  username: Yup.string()\r\n    .matches(/^[a-zA-Z0-9]{4,20}$/, 'Username must be 4-20 characters and contain only letters and numbers')\r\n    .required('Username is required'),\r\n  email: Yup.string().email('Invalid email address').required('Email is required'),\r\n  password: Yup.string()\r\n    .matches(PASSWORD_REGEX, 'Password must be at least 6 characters long and contain at least one number, one uppercase letter, and one special character')\r\n    .required('Password is required'),\r\n  confirmPassword: Yup.string()\r\n    .oneOf([Yup.ref('password'), undefined], 'Passwords must match')\r\n    .required('Confirm Password is required'),\r\n  address: Yup.string().required('Address is required'),\r\n  contactNumber: Yup.string().matches(/^\\d+$/, 'Contact number must contain digits only').required('Contact Number is required'),\r\n  barangayID: Yup.string().required('Barangay ID is required'),\r\n});\r\n\r\nconst RegisterForm = () => {\r\n  const navigate = useNavigate();\r\n  const [error, setError] = React.useState('');\r\n  const [, setSuccess] = React.useState('');\r\n  // admin password state removed from public registration\r\n  const [adminUnlocked] = React.useState(false);\r\n  const [showPassword, setShowPassword] = React.useState(false);\r\n  const [showConfirmPassword,  setShowConfirmPassword] = React.useState(false);\r\n  const [fieldErrors, setFieldErrors] = React.useState<{ [key: string]: string }>({});\r\n  const [proofFile, setProofFile] = React.useState<File | null>(null);\r\n  const [govIdFile, setGovIdFile] = React.useState<File | null>(null);\r\n  const [proofList, setProofList] = React.useState<UploadFile[]>([]);\r\n  const [govIdList, setGovIdList] = React.useState<UploadFile[]>([]);\r\n  const [selfieList, setSelfieList] = React.useState<UploadFile[]>([]);\r\n  const previewUrlsRef = React.useRef<Set<string>>(new Set());\r\n  React.useEffect(() => {\r\n    const urls = previewUrlsRef.current;\r\n    return () => {\r\n      try {\r\n        urls.forEach((u) => {\r\n          try { URL.revokeObjectURL(u); } catch (e) {}\r\n        });\r\n      } catch (err) {}\r\n      try { urls.clear(); } catch (e) {}\r\n    };\r\n  }, []);\r\n  const [uploadProgress, setUploadProgress] = React.useState<number>(0);\r\n  const [uploading, setUploading] = React.useState<boolean>(false);\r\n  const [uploadStatus, setUploadStatus] = React.useState<string>('');\r\n  const [selfieFile, setSelfieFile] = React.useState<File | null>(null);\r\n  // Process UI for submit steps\r\n  const [processActive, setProcessActive] = React.useState(false);\r\n  const [processPercent, setProcessPercent] = React.useState(0);\r\n  const [processMessage, setProcessMessage] = React.useState('');\r\n\r\n  // Helper to generate a random unique Barangay ID\r\n  function generateBarangayID() {\r\n    // New format: brgyparian-<YEAR>-<6 chars alphanumeric mixed case>\r\n    const year = new Date().getFullYear();\r\n    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n    let rand = '';\r\n    for (let i = 0; i < 6; i++) rand += chars.charAt(Math.floor(Math.random() * chars.length));\r\n    return `brgyparian-${year}-${rand}`;\r\n  }\r\n\r\n  const formik = useFormik({\r\n    initialValues: {\r\n      firstName: '',\r\n      middleName: '',\r\n      lastName: '',\r\n      username: '',\r\n      email: '',\r\n      password: '',\r\n      confirmPassword: '',\r\n      address: '',\r\n      contactNumber: '',\r\n      barangayID: generateBarangayID(),\r\n      role: 'resident',\r\n    },\r\n    validationSchema: validationSchema.shape({\r\n      firstName: Yup.string().matches(NAME_REGEX, 'First name may only contain letters, spaces, hyphens, and apostrophes').required('First name is required'),\r\n      middleName: Yup.string().matches(NAME_REGEX, 'Middle name may only contain letters, spaces, hyphens, and apostrophes').notRequired(),\r\n      lastName: Yup.string().matches(NAME_REGEX, 'Last name may only contain letters, spaces, hyphens, and apostrophes').required('Last name is required'),\r\n      role: Yup.string().oneOf(['resident']).required('Role is required'),\r\n    }),\r\n    // enable realtime validation on change and blur\r\n    validateOnChange: true,\r\n    validateOnBlur: true,\r\n    onSubmit: async (values, { setSubmitting, resetForm }) => {\r\n  setError('');\r\n  setFieldErrors({});\r\n  // start process UI\r\n  setProcessActive(true);\r\n  setProcessPercent(5);\r\n  setProcessMessage('Checking information fields...');\r\n\r\n      // Prevent submission if there are validation errors\r\n      const formErrors = await formik.validateForm();\r\n      if (Object.keys(formErrors).length > 0) {\r\n        setError('Please correct the highlighted errors before submitting.');\r\n        setSubmitting(false);\r\n        setProcessMessage('Validation failed. Please correct the highlighted fields.');\r\n        setProcessPercent(0);\r\n        setProcessActive(false);\r\n        return;\r\n      }\r\n\r\n      // Validate availability (username, email, contact) before saving\r\n      setProcessPercent(15);\r\n      setProcessMessage('Validating availability of username, email and contact number...');\r\n      try {\r\n        const [uRes, eRes, cRes] = await Promise.all([\r\n          axiosInstance.get('/auth/check-username', { params: { username: values.username } }),\r\n          axiosInstance.get('/auth/check-email', { params: { email: values.email } }),\r\n          axiosInstance.get('/auth/check-contact', { params: { contact: values.contactNumber } }),\r\n        ]);\r\n        const uAvail = Boolean(uRes?.data?.available);\r\n        const eAvail = Boolean(eRes?.data?.available);\r\n        const cAvail = Boolean(cRes?.data?.available);\r\n        if (!uAvail || !eAvail || !cAvail) {\r\n          const fe: any = {};\r\n          if (!uAvail) fe.username = 'Username already in use';\r\n          if (!eAvail) fe.email = 'Email already registered';\r\n          if (!cAvail) fe.contactNumber = 'Contact number already registered';\r\n          setFieldErrors(fe);\r\n          setError('Please correct the highlighted errors before submitting.');\r\n          setSubmitting(false);\r\n          setProcessMessage('Some fields are already in use. Fix them and try again.');\r\n          setProcessPercent(0);\r\n          setProcessActive(false);\r\n          return;\r\n        }\r\n      } catch (checkErr) {\r\n        // If availability check fails, continue but inform user\r\n        console.warn('Availability checks failed', checkErr);\r\n        setProcessMessage('Availability checks could not be completed  proceeding with submission.');\r\n        setProcessPercent(30);\r\n      }\r\n\r\n      // role is constrained to 'resident' on the client; admin/staff registration is not exposed here\r\n      try {\r\n        const fullName = [values.firstName, values.middleName, values.lastName].filter(Boolean).join(' ');\r\n\r\n        setProcessPercent(40);\r\n        setProcessMessage('Saving account...');\r\n        const resp = await axiosInstance.post('/auth/register', {\r\n          fullName,\r\n          firstName: values.firstName,\r\n          middleName: values.middleName,\r\n          lastName: values.lastName,\r\n          username: values.username,\r\n          email: values.email,\r\n          password: values.password,\r\n          address: values.address,\r\n          contactNumber: values.contactNumber,\r\n          barangayID: values.barangayID,\r\n          role: values.role,\r\n        });\r\n        let data: any = {};\r\n        try {\r\n          data = resp && resp.data ? resp.data : {};\r\n        } catch (jsonErr) {\r\n          setError('Server error: Could not parse response');\r\n          return;\r\n        }\r\n        if (resp && resp.status >= 200 && resp.status < 300) {\r\n          // Registration succeeded. If server returned a token, attach it and\r\n          // upload verification files (if provided) to the verification upload endpoint.\r\n          setSuccess('Registration successful!');\r\n          // Attempt to parse returned data/token\r\n          const returnedToken = (data && data.token) ? data.token : null;\r\n          // If files were selected, upload them now using the returned token\r\n          if (returnedToken && (proofFile || govIdFile || selfieFile)) {\r\n            try {\r\n              setUploadStatus('Uploading verification documents...');\r\n              setProcessPercent(60);\r\n              setProcessMessage('Uploading verification documents...');\r\n              setUploading(true);\r\n              setUploadProgress(0);\r\n              // Ensure axios has Authorization header for the upload\r\n              const headers: any = { 'Content-Type': 'multipart/form-data', Authorization: `Bearer ${returnedToken}` };\r\n              const formData = new FormData();\r\n              // verification upload route expects field name 'ids' (array)\r\n              if (proofFile) formData.append('ids', proofFile, proofFile.name);\r\n              if (govIdFile) formData.append('ids', govIdFile, govIdFile.name);\r\n              if (selfieFile) formData.append('ids', selfieFile, selfieFile.name);\r\n              // include barangayID so server-side metadata/request can record it (server prefers authenticated user value)\r\n              if (values.barangayID) formData.append('barangayID', values.barangayID);\r\n              await axiosInstance.post('/verification/upload', formData, {\r\n                headers,\r\n                onUploadProgress: (progressEvent: AxiosProgressEvent) => {\r\n                  const loaded = typeof progressEvent?.loaded === 'number' ? progressEvent!.loaded : 0;\r\n                  const total = typeof progressEvent?.total === 'number' ? progressEvent!.total : 0;\r\n                  if (total > 0) {\r\n                    const percentCompleted = Math.round((loaded * 100) / total);\r\n                    setUploadProgress(percentCompleted);\r\n                    // reflect upload progress on processPercent\r\n                    setProcessPercent(60 + Math.round((percentCompleted / 100) * 30));\r\n                  }\r\n                },\r\n              });\r\n              setUploadStatus('Upload complete');\r\n              setProcessPercent(95);\r\n              setProcessMessage('Finalizing verification request...');\r\n              antdMessage.success('Verification documents uploaded successfully');\r\n              setSuccess('Registration complete. Verification documents uploaded.');\r\n            } catch (uploadErr) {\r\n              console.warn('Verification upload failed after registration', uploadErr);\r\n              setUploadStatus('Upload failed');\r\n              antdMessage.error('Uploading verification documents failed. You can upload them later from your profile.');\r\n              setError('Registration succeeded but uploading verification documents failed. You can upload them later from your profile.');\r\n            } finally {\r\n              setUploading(false);\r\n            }\r\n          }\r\n\r\n          // complete process\r\n          setProcessPercent(100);\r\n          setProcessMessage('Done');\r\n          setTimeout(() => {\r\n            setProcessActive(false);\r\n            setProcessPercent(0);\r\n            setProcessMessage('');\r\n          }, 800);\r\n\r\n          // Reset form and navigate to login (or dashboard if you prefer automatic login)\r\n          resetForm();\r\n          setTimeout(() => navigate('/login'), 1500);\r\n        } else {\r\n          // Try to extract field-specific errors if present\r\n          if (data.errors && typeof data.errors === 'object') {\r\n            setFieldErrors(data.errors);\r\n            setError('Please correct the highlighted errors before submitting.');\r\n            setSubmitting(false);\r\n            return;\r\n          } else if (data.message) {\r\n            setError(data.message);\r\n          } else if (data.error) {\r\n            setError(data.error);\r\n          } else {\r\n            setError('Registration failed');\r\n          }\r\n        }\r\n      } catch (err: any) {\r\n        // Network or server error - try to extract useful validation messages\r\n        const respErr = err?.response;\r\n        if (respErr && respErr.data) {\r\n          const data = respErr.data as any;\r\n          // Duplicate key / already exists\r\n          if (respErr.status === 409 || (data.message && /already/i.test(String(data.message)))) {\r\n            const fe: any = {};\r\n            if (data.keyValue) {\r\n              if (data.keyValue.username) fe.username = 'Username already in use';\r\n              if (data.keyValue.email) fe.email = 'Email already registered';\r\n            } else {\r\n              if (/email/i.test(String(data.message))) fe.email = data.message;\r\n              if (/username/i.test(String(data.message))) fe.username = data.message;\r\n            }\r\n            if (Object.keys(fe).length) {\r\n              setFieldErrors(fe);\r\n              setError('Please correct the highlighted errors before submitting.');\r\n              setSubmitting(false);\r\n              return;\r\n            }\r\n          }\r\n          // Validation error from server\r\n          if (respErr.status === 400) {\r\n            setError(data.message || 'Invalid input');\r\n            setSubmitting(false);\r\n            return;\r\n          }\r\n        }\r\n        setError('Network or server error. Please try again later.');\r\n      } finally {\r\n        setSubmitting(false);\r\n      }\r\n    },\r\n  });\r\n\r\n  // Real-time availability/status states for username/email\r\n  const [usernameAvailable, setUsernameAvailable] = React.useState<boolean | null>(null);\r\n  const [emailAvailable, setEmailAvailable] = React.useState<boolean | null>(null);\r\n  const [checkingUsername, setCheckingUsername] = React.useState(false);\r\n  const [checkingEmail, setCheckingEmail] = React.useState(false);\r\n  const [checkingContact, setCheckingContact] = React.useState(false);\r\n  const [contactAvailable, setContactAvailable] = React.useState<boolean | null>(null);\r\n  const contactTimerRef = React.useRef<NodeJS.Timeout | null>(null);\r\n  const usernameTimerRef = React.useRef<NodeJS.Timeout | null>(null);\r\n  const emailTimerRef = React.useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // Debounced username availability check\r\n  React.useEffect(() => {\r\n    const username = String(formik.values.username || '').trim();\r\n    setUsernameAvailable(null);\r\n    if (usernameTimerRef.current) {\r\n      clearTimeout(usernameTimerRef.current);\r\n    }\r\n    if (!username || username.length < 3) {\r\n      setCheckingUsername(false);\r\n      return;\r\n    }\r\n    setCheckingUsername(true);\r\n    usernameTimerRef.current = setTimeout(async () => {\r\n      try {\r\n        const resp = await axiosInstance.get('/auth/check-username', { params: { username } });\r\n        setUsernameAvailable(Boolean(resp?.data?.available));\r\n      } catch (err) {\r\n        // On error, don't block user; leave as unknown (null)\r\n        setUsernameAvailable(null);\r\n      } finally {\r\n        setCheckingUsername(false);\r\n      }\r\n    }, 500);\r\n    return () => {\r\n      if (usernameTimerRef.current) clearTimeout(usernameTimerRef.current);\r\n    };\r\n  }, [formik.values.username]);\r\n\r\n  // Debounced email availability check\r\n  React.useEffect(() => {\r\n    const email = String(formik.values.email || '').trim();\r\n    setEmailAvailable(null);\r\n    if (emailTimerRef.current) {\r\n      clearTimeout(emailTimerRef.current);\r\n    }\r\n    if (!email || !/^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(email)) {\r\n      setCheckingEmail(false);\r\n      return;\r\n    }\r\n    setCheckingEmail(true);\r\n    emailTimerRef.current = setTimeout(async () => {\r\n      try {\r\n        const resp = await axiosInstance.get('/auth/check-email', { params: { email } });\r\n        setEmailAvailable(Boolean(resp?.data?.available));\r\n      } catch (err) {\r\n        setEmailAvailable(null);\r\n      } finally {\r\n        setCheckingEmail(false);\r\n      }\r\n    }, 500);\r\n    return () => {\r\n      if (emailTimerRef.current) clearTimeout(emailTimerRef.current);\r\n    };\r\n  }, [formik.values.email]);\r\n\r\n  // Debounced contact availability check (realtime)\r\n  React.useEffect(() => {\r\n    const contact = String(formik.values.contactNumber || '').trim();\r\n    setContactAvailable(null);\r\n    if (contactTimerRef.current) clearTimeout(contactTimerRef.current);\r\n    if (!contact || contact.length < 6) {\r\n      setCheckingContact(false);\r\n      return;\r\n    }\r\n    setCheckingContact(true);\r\n    contactTimerRef.current = setTimeout(async () => {\r\n      try {\r\n        const resp = await axiosInstance.get('/auth/check-contact', { params: { contact } });\r\n        setContactAvailable(Boolean(resp?.data?.available));\r\n      } catch (err) {\r\n        setContactAvailable(null);\r\n      } finally {\r\n        setCheckingContact(false);\r\n      }\r\n    }, 500);\r\n    return () => {\r\n      if (contactTimerRef.current) clearTimeout(contactTimerRef.current);\r\n    };\r\n  }, [formik.values.contactNumber]);\r\n\r\n  // Password strength helper\r\n  const getPasswordStrength = React.useCallback((pwd: string) => {\r\n    let score = 0;\r\n    if (!pwd) return { percent: 0, label: 'Too short' };\r\n    if (pwd.length >= 6) score += 1;\r\n    if (/[A-Z]/.test(pwd)) score += 1;\r\n    if (/\\d/.test(pwd)) score += 1;\r\n    if (/[^A-Za-z0-9]/.test(pwd)) score += 1;\r\n    const percent = Math.min(100, Math.round((score / 4) * 100));\r\n    const label = score <= 1 ? 'Weak' : score === 2 ? 'Fair' : score === 3 ? 'Good' : 'Strong';\r\n    return { percent, label };\r\n  }, []);\r\n\r\n  // Helper to compute completion percentage for a simple progress tracker\r\n  const percentComplete = React.useMemo(() => {\r\n    const requiredFields = [\r\n      formik.values.firstName,\r\n      formik.values.lastName,\r\n      formik.values.username,\r\n      formik.values.email,\r\n      formik.values.password,\r\n      formik.values.confirmPassword,\r\n      formik.values.address,\r\n      formik.values.contactNumber,\r\n    ];\r\n    const filled = requiredFields.filter((v) => Boolean(v && String(v).trim().length > 0)).length;\r\n    // include files as bonus completion\r\n    const fileCount = Number(!!proofFile) + Number(!!govIdFile) + Number(!!selfieFile);\r\n    const total = requiredFields.length + 3; // include 3 files\r\n    const val = Math.round(((filled + fileCount) / total) * 100);\r\n    return val;\r\n  }, [formik.values, proofFile, govIdFile, selfieFile]);\r\n\r\n  const currentStep = percentComplete < 34 ? 0 : percentComplete < 67 ? 1 : 2;\r\n\r\n  const renderLabelWithTooltip = (label: React.ReactNode, tip: string) => (\r\n    <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n      <span>{label}</span>\r\n      <Tooltip title={tip} placement=\"right\">\r\n        <InfoCircleOutlined style={{ color: '#888' }} />\r\n      </Tooltip>\r\n    </div>\r\n  );\r\n\r\n  // Input sanitizers to prevent invalid characters\r\n  const sanitizeName = (v: string) => v.replace(/[^A-Za-z\\s'-]/g, '');\r\n  const sanitizeContact = (v: string) => v.replace(/\\D/g, '');\r\n\r\n\r\n  return (\r\n    <Box sx={{\r\n      minHeight: '100vh',\r\n      background: 'linear-gradient(135deg, #40c9ff 0%, #e81cff 100%)',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      py: 6,\r\n    }}>\r\n      <Container maxWidth=\"sm\">\r\n        <Paper elevation={6} sx={{\r\n          borderRadius: 5,\r\n          p: 4,\r\n          background: 'rgba(255,255,255,0.95)',\r\n          boxShadow: '0 8px 32px 0 rgba(64,201,255,0.15)',\r\n        }}>\r\n          <Box sx={{ textAlign: 'center', mb: 3 }}>\r\n            <Box sx={{\r\n              fontWeight: 800,\r\n              fontSize: 32,\r\n              letterSpacing: 1,\r\n              background: 'linear-gradient(90deg, #40c9ff, #e81cff)',\r\n              WebkitBackgroundClip: 'text',\r\n              WebkitTextFillColor: 'transparent',\r\n              display: 'inline-block',\r\n            }}>\r\n              Create Account\r\n            </Box>\r\n          </Box>\r\n          {/* Progress tracker and steps (Ant Design) */}\r\n          <Box sx={{ maxWidth: 560, mx: 'auto', mb: 3 }}>\r\n            <Steps current={currentStep} size=\"small\">\r\n              <Steps.Step title=\"Account\" />\r\n              <Steps.Step title=\"Personal\" />\r\n              <Steps.Step title=\"Verification\" />\r\n            </Steps>\r\n            <div style={{ marginTop: 8 }}>\r\n              <AntProgress percent={percentComplete} showInfo strokeColor={{ '0%': '#e81cff', '100%': '#40c9ff' }} />\r\n            </div>\r\n          </Box>\r\n          <form onSubmit={formik.handleSubmit}>\r\n            {/* Processing overlay shown while submission steps run */}\r\n            {processActive && (\r\n              <div style={{ position: 'absolute', left: 0, top: 0, right: 0, bottom: 0, zIndex: 40, display: 'flex', alignItems: 'center', justifyContent: 'center', background: 'rgba(0,0,0,0.35)' }}>\r\n                <div style={{ width: 460, padding: 20, borderRadius: 8, background: '#fff', boxShadow: '0 6px 24px rgba(0,0,0,0.2)' }}>\r\n                  <Typography variant=\"h6\" sx={{ mb: 1, fontWeight: 700 }}>Processing</Typography>\r\n                  <Typography variant=\"body2\" sx={{ mb: 2 }}>{processMessage}</Typography>\r\n                  <AntProgress percent={processPercent} status={processPercent < 100 ? 'active' : 'success'} />\r\n                </div>\r\n              </div>\r\n            )}\r\n            {/* ...existing fields... */}\r\n            <TextField\r\n              fullWidth\r\n              margin=\"normal\"\r\n              label={renderLabelWithTooltip('First Name', 'Enter your given/first name. Use letters, spaces, hyphens and apostrophes only.')}\r\n              name=\"firstName\"\r\n              value={formik.values.firstName}\r\n              onChange={(e) => { formik.setFieldValue('firstName', sanitizeName(e.target.value)); }}\r\n              error={formik.touched.firstName && Boolean(formik.errors.firstName)}\r\n              helperText={formik.touched.firstName && formik.errors.firstName}\r\n              sx={{ borderRadius: 3, background: '#f4f6fa', mb: 2 }}\r\n            />\r\n            <TextField\r\n              fullWidth\r\n              margin=\"normal\"\r\n              label={renderLabelWithTooltip('Middle Name (optional)', 'Middle name is optional. Use letters, spaces, hyphens and apostrophes only.')}\r\n              name=\"middleName\"\r\n              value={formik.values.middleName}\r\n              onChange={(e) => { formik.setFieldValue('middleName', sanitizeName(e.target.value)); }}\r\n              error={formik.touched.middleName && Boolean(formik.errors.middleName)}\r\n              helperText={formik.touched.middleName && formik.errors.middleName}\r\n              sx={{ borderRadius: 3, background: '#f4f6fa', mb: 2 }}\r\n            />\r\n            <TextField\r\n              fullWidth\r\n              margin=\"normal\"\r\n              label={renderLabelWithTooltip('Last Name', 'Enter your family/last name.')}\r\n              name=\"lastName\"\r\n              value={formik.values.lastName}\r\n              onChange={(e) => { formik.setFieldValue('lastName', sanitizeName(e.target.value)); }}\r\n              error={formik.touched.lastName && Boolean(formik.errors.lastName)}\r\n              helperText={formik.touched.lastName && formik.errors.lastName}\r\n              sx={{ borderRadius: 3, background: '#f4f6fa', mb: 2 }}\r\n            />\r\n            <TextField\r\n              fullWidth\r\n              margin=\"normal\"\r\n              label={renderLabelWithTooltip('Username', 'Choose a unique username (4-20 letters or numbers).')}\r\n              name=\"username\"\r\n              value={formik.values.username}\r\n              onChange={formik.handleChange}\r\n              error={\r\n                (formik.touched.username && Boolean(formik.errors.username)) ||\r\n                Boolean(fieldErrors.username) ||\r\n                usernameAvailable === false\r\n              }\r\n              helperText={\r\n                (formik.touched.username && formik.errors.username) ||\r\n                fieldErrors.username ||\r\n                (checkingUsername ? 'Checking availability...' : usernameAvailable === false ? 'Username already taken' : usernameAvailable === true ? 'Username available' : 'Username must be at least 4 characters long and contain only letters and numbers.')\r\n              }\r\n              InputProps={{\r\n                startAdornment: (\r\n                  <InputAdornment position=\"start\">\r\n                    <Person color=\"primary\" />\r\n                  </InputAdornment>\r\n                ),\r\n              }}\r\n              sx={{ borderRadius: 3, background: '#f4f6fa', mb: 2 }}\r\n            />\r\n            <TextField\r\n              fullWidth\r\n              margin=\"normal\"\r\n              label={renderLabelWithTooltip('Email', 'Enter a valid email address used for account recovery and notifications.')}\r\n              name=\"email\"\r\n              value={formik.values.email}\r\n              onChange={formik.handleChange}\r\n              error={\r\n                (formik.touched.email && Boolean(formik.errors.email)) ||\r\n                Boolean(fieldErrors.email) ||\r\n                emailAvailable === false\r\n              }\r\n              helperText={\r\n                (formik.touched.email && formik.errors.email) ||\r\n                fieldErrors.email ||\r\n                (checkingEmail ? 'Checking email...' : emailAvailable === false ? 'Email already registered' : emailAvailable === true ? 'Email looks available' : '')\r\n              }\r\n              InputProps={{\r\n                startAdornment: (\r\n                  <InputAdornment position=\"start\">\r\n                    <Email color=\"primary\" />\r\n                  </InputAdornment>\r\n                ),\r\n              }}\r\n              sx={{ borderRadius: 3, background: '#f4f6fa', mb: 2 }}\r\n            />\r\n            {/* Password Field with Show/Hide */}\r\n            <TextField\r\n              fullWidth\r\n              margin=\"normal\"\r\n              label={renderLabelWithTooltip('Password', 'At least 6 characters, include uppercase, number and special character.')}\r\n              name=\"password\"\r\n              type={showPassword ? \"text\" : \"password\"}\r\n              value={formik.values.password}\r\n              onChange={formik.handleChange}\r\n              error={formik.touched.password && Boolean(formik.errors.password)}\r\n              helperText={\r\n                (formik.touched.password && formik.errors.password) ||\r\n                fieldErrors.password ||\r\n                'Password must be at least 6 characters long and contain at least one number, one uppercase letter, and one special character.'\r\n              }\r\n              InputProps={{\r\n                startAdornment: (\r\n                  <InputAdornment position=\"start\">\r\n                    <Lock color=\"primary\" />\r\n                  </InputAdornment>\r\n                ),\r\n                endAdornment: (\r\n                  <InputAdornment position=\"end\">\r\n                    <Button\r\n                      onClick={() => setShowPassword((prev) => !prev)}\r\n                      tabIndex={-1}\r\n                      sx={{ minWidth: 0, p: 0, color: 'inherit' }}\r\n                    >\r\n                      {showPassword ? <VisibilityOff /> : <Visibility />}\r\n                    </Button>\r\n                  </InputAdornment>\r\n                ),\r\n              }}\r\n              sx={{ borderRadius: 3, background: '#f4f6fa', mb: 2 }}\r\n            />\r\n            {/* Password strength indicator (client-side heuristic) */}\r\n            <div style={{ marginTop: -8, marginBottom: 12 }}>\r\n              {(() => {\r\n                const { percent, label } = getPasswordStrength(String(formik.values.password || ''));\r\n                return (\r\n                  <div>\r\n                    <AntProgress percent={percent} showInfo={false} strokeColor={percent < 34 ? '#ff4d4f' : percent < 67 ? '#faad14' : '#52c41a'} />\r\n                    <Typography variant=\"caption\" sx={{ display: 'block', mt: 0.5 }}>{label}</Typography>\r\n                  </div>\r\n                );\r\n              })()}\r\n            </div>\r\n            {/* Confirm Password Field with Show/Hide */}\r\n            <TextField\r\n              fullWidth\r\n              margin=\"normal\"\r\n              label={renderLabelWithTooltip('Confirm Password', 'Re-enter your password to confirm.')}\r\n              name=\"confirmPassword\"\r\n              type={showConfirmPassword ? \"text\" : \"password\"}\r\n              value={formik.values.confirmPassword}\r\n              onChange={formik.handleChange}\r\n              error={formik.touched.confirmPassword && Boolean(formik.errors.confirmPassword)}\r\n              helperText={formik.touched.confirmPassword && formik.errors.confirmPassword}\r\n              InputProps={{\r\n                startAdornment: (\r\n                  <InputAdornment position=\"start\">\r\n                    <Lock color=\"primary\" />\r\n                  </InputAdornment>\r\n                ),\r\n                endAdornment: (\r\n                  <InputAdornment position=\"end\">\r\n                    <Button\r\n                      onClick={() => setShowConfirmPassword((prev) => !prev)}\r\n                      tabIndex={-1}\r\n                      sx={{ minWidth: 0, p: 0, color: 'inherit' }}\r\n                    >\r\n                      {showConfirmPassword ? <VisibilityOff /> : <Visibility />}\r\n                    </Button>\r\n                  </InputAdornment>\r\n                ),\r\n              }}\r\n              sx={{ borderRadius: 3, background: '#f4f6fa', mb: 2 }}\r\n            />\r\n            <TextField\r\n              fullWidth\r\n              margin=\"normal\"\r\n              label={renderLabelWithTooltip('Permanent Address', 'Street, barangay, city  used for official correspondence and verification.')}\r\n              name=\"address\"\r\n              value={formik.values.address}\r\n              onChange={formik.handleChange}\r\n              error={formik.touched.address && Boolean(formik.errors.address)}\r\n              helperText={formik.touched.address && formik.errors.address}\r\n              InputProps={{\r\n                startAdornment: (\r\n                  <InputAdornment position=\"start\">\r\n                    <Home color=\"primary\" />\r\n                  </InputAdornment>\r\n                ),\r\n              }}\r\n              sx={{ borderRadius: 3, background: '#f4f6fa', mb: 2 }}\r\n            />\r\n            <TextField\r\n              fullWidth\r\n              margin=\"normal\"\r\n              label={renderLabelWithTooltip('Contact Number', 'Enter digits only. Include area code if applicable.')}\r\n              name=\"contactNumber\"\r\n              value={formik.values.contactNumber}\r\n              onChange={(e) => { formik.setFieldValue('contactNumber', sanitizeContact(e.target.value)); }}\r\n              error={formik.touched.contactNumber && Boolean(formik.errors.contactNumber)}\r\n              helperText={formik.touched.contactNumber && formik.errors.contactNumber}\r\n              InputProps={{\r\n                startAdornment: (\r\n                  <InputAdornment position=\"start\">\r\n                    <Phone color=\"primary\" />\r\n                  </InputAdornment>\r\n                ),\r\n              }}\r\n              sx={{ borderRadius: 3, background: '#f4f6fa', mb: 2 }}\r\n            />\r\n            {/* File uploads for verification during registration */}\r\n            <Box sx={{ mb: 2 }}>\r\n              <Typography component=\"label\" sx={{ display: 'block', fontWeight: 600, mb: 1 }}>\r\n                {renderLabelWithTooltip('Proof of Residency', 'Upload a document showing your address (e.g., utility bill, lease, or bank statement).')}\r\n              </Typography>\r\n              <AntUpload\r\n                accept=\"image/*,application/pdf\"\r\n                fileList={proofList}\r\n                beforeUpload={(file) => {\r\n                  // prevent auto upload\r\n                  return false;\r\n                }}\r\n                onChange={({ fileList }) => {\r\n                  // revoke any existing preview for this slot\r\n                  proofList.forEach((pf) => {\r\n                    if (pf && (pf as any).thumbUrl) {\r\n                      try { URL.revokeObjectURL(String((pf as any).thumbUrl)); } catch (e) {}\r\n                      previewUrlsRef.current.delete(String((pf as any).thumbUrl));\r\n                    }\r\n                  });\r\n                  // create preview for images\r\n                  const list = (fileList || []).slice(-1);\r\n                  list.forEach((f) => {\r\n                    if (f.originFileObj && !f.thumbUrl && f.type && f.type.startsWith('image/')) {\r\n                      const url = URL.createObjectURL(f.originFileObj as Blob);\r\n                      f.thumbUrl = url;\r\n                      previewUrlsRef.current.add(url);\r\n                    }\r\n                  });\r\n                  setProofList(list as UploadFile[]);\r\n                  setProofFile((list[0] && (list[0].originFileObj as File)) || null);\r\n                }}\r\n                listType=\"picture-card\"\r\n                showUploadList={{ showPreviewIcon: true, showRemoveIcon: true }}\r\n                maxCount={1}\r\n              >\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n                  <UploadOutlined /> <span style={{ fontWeight: 600 }}>Select Proof</span>\r\n                </div>\r\n              </AntUpload>\r\n            </Box>\r\n            <Box sx={{ mb: 2 }}>\r\n              <Typography component=\"label\" sx={{ display: 'block', fontWeight: 600, mb: 1 }}>\r\n                {renderLabelWithTooltip('Government-issued ID', 'Upload a government-issued ID such as passport, driver\\'s license, or national ID.')}\r\n              </Typography>\r\n              <AntUpload\r\n                accept=\"image/*,application/pdf\"\r\n                fileList={govIdList}\r\n                beforeUpload={(file) => false}\r\n                onChange={({ fileList }) => {\r\n                  // revoke existing preview\r\n                  govIdList.forEach((gf) => {\r\n                    if (gf && (gf as any).thumbUrl) {\r\n                      try { URL.revokeObjectURL(String((gf as any).thumbUrl)); } catch (e) {}\r\n                      previewUrlsRef.current.delete(String((gf as any).thumbUrl));\r\n                    }\r\n                  });\r\n                  const list = (fileList || []).slice(-1);\r\n                  list.forEach((f) => {\r\n                    if (f.originFileObj && !f.thumbUrl && f.type && f.type.startsWith('image/')) {\r\n                      const url = URL.createObjectURL(f.originFileObj as Blob);\r\n                      f.thumbUrl = url;\r\n                      previewUrlsRef.current.add(url);\r\n                    }\r\n                  });\r\n                  setGovIdList(list as UploadFile[]);\r\n                  setGovIdFile((list[0] && (list[0].originFileObj as File)) || null);\r\n                }}\r\n                listType=\"picture-card\"\r\n                showUploadList={{ showPreviewIcon: true, showRemoveIcon: true }}\r\n                maxCount={1}\r\n              >\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n                  <UploadOutlined /> <span style={{ fontWeight: 600 }}>Select ID</span>\r\n                </div>\r\n              </AntUpload>\r\n            </Box>\r\n            <Box sx={{ mb: 2 }}>\r\n              <Typography component=\"label\" sx={{ display: 'block', fontWeight: 600, mb: 1 }}>\r\n                {renderLabelWithTooltip('Selfie with Government-issued ID', 'Take a clear photo of yourself holding your government ID next to your face.')}\r\n              </Typography>\r\n              <AntUpload\r\n                accept=\"image/*\"\r\n                fileList={selfieList}\r\n                beforeUpload={(file) => false}\r\n                onChange={({ fileList }) => {\r\n                  // revoke existing preview\r\n                  selfieList.forEach((sf) => {\r\n                    if (sf && (sf as any).thumbUrl) {\r\n                      try { URL.revokeObjectURL(String((sf as any).thumbUrl)); } catch (e) {}\r\n                      previewUrlsRef.current.delete(String((sf as any).thumbUrl));\r\n                    }\r\n                  });\r\n                  const list = (fileList || []).slice(-1);\r\n                  list.forEach((f) => {\r\n                    if (f.originFileObj && !f.thumbUrl && f.type && f.type.startsWith('image/')) {\r\n                      const url = URL.createObjectURL(f.originFileObj as Blob);\r\n                      f.thumbUrl = url;\r\n                      previewUrlsRef.current.add(url);\r\n                    }\r\n                  });\r\n                  setSelfieList(list as UploadFile[]);\r\n                  setSelfieFile((list[0] && (list[0].originFileObj as File)) || null);\r\n                }}\r\n                listType=\"picture-card\"\r\n                showUploadList={{ showPreviewIcon: true, showRemoveIcon: true }}\r\n                maxCount={1}\r\n              >\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n                  <UploadOutlined /> <span style={{ fontWeight: 600 }}>Select Selfie with ID</span>\r\n                </div>\r\n              </AntUpload>\r\n            </Box>\r\n            {uploading && (\r\n              <Box sx={{ mb: 2 }}>\r\n                <Typography sx={{ fontSize: 14, mb: 1 }}>Uploading verification documents</Typography>\r\n                <AntProgress percent={uploadProgress} />\r\n                <Typography variant=\"caption\" sx={{ display: 'block', mt: 1 }}>{uploadStatus}</Typography>\r\n              </Box>\r\n            )}\r\n            {/* Keep Barangay ID out of the visible form but include it as a hidden field so it's submitted */}\r\n            <input type=\"hidden\" name=\"barangayID\" value={formik.values.barangayID} />\r\n\r\n            {/* Role is fixed to resident during public registration (hidden) */}\r\n            <input type=\"hidden\" name=\"role\" value=\"resident\" />\r\n              {/* admin/staff registration is not available through this public form */}\r\n            <Button\r\n              type=\"submit\"\r\n              fullWidth\r\n              variant=\"contained\"\r\n              sx={{\r\n                mt: 3, mb: 2, borderRadius: 3, fontWeight: 700, fontSize: '1.1rem',\r\n                background: 'linear-gradient(90deg, #e81cff 0%, #40c9ff 100%)',\r\n                color: '#fff',\r\n                boxShadow: '0 2px 8px #e81cff44',\r\n                transition: 'background 0.3s',\r\n                '&:hover': {\r\n                  background: 'linear-gradient(90deg, #40c9ff 0%, #e81cff 100%)',\r\n                },\r\n              }}\r\n              disabled={formik.isSubmitting}\r\n            >\r\n              Register\r\n            </Button>\r\n            {error && <Alert severity=\"error\" sx={{ mt: 2 }}>{error}</Alert>}\r\n            {/* Show field-specific errors in a list if present and not already shown in helperText */}\r\n            {Object.keys(fieldErrors).length > 0 && !error && (\r\n              <Alert severity=\"error\" sx={{ mt: 2 }}>\r\n                {Object.entries(fieldErrors).map(([field, msg]) => (\r\n                  <div key={field}>{msg}</div>\r\n                ))}\r\n              </Alert>\r\n            )}\r\n            {/* Optionally, show a message or unlock admin features if adminUnlocked is true */}\r\n            {adminUnlocked && (\r\n              <Alert severity=\"info\" sx={{ mt: 2 }}>\r\n                Admin access is now unlocked! Redirecting to admin dashboard...\r\n              </Alert>\r\n            )}\r\n            <Box sx={{ textAlign: 'center', mt: 2 }}>\r\n              <Link component={RouterLink} to=\"/login\" variant=\"body2\" sx={{ color: '#e81cff', fontWeight: 600 }}>\r\n                Already have an account? <span style={{ textDecoration: 'underline' }}>Sign In</span>\r\n              </Link>\r\n            </Box>\r\n          </form>\r\n        </Paper>\r\n      </Container>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default RegisterForm;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"heroRow\":\"dashboard_heroRow__Ta3S-\",\"avatarContainer\":\"dashboard_avatarContainer__RF-88\",\"avatarImg\":\"dashboard_avatarImg__Lx9VC\",\"editButton\":\"dashboard_editButton__+iZH5\",\"userInfo\":\"dashboard_userInfo__d2Eky\",\"userName\":\"dashboard_userName__iIjBt\",\"userMeta\":\"dashboard_userMeta__e+UY0\",\"ant-col\":\"dashboard_ant-col__R+6Am\"};","\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Row, Col, Card, Typography, Button, Badge, Modal, Table, Tooltip, Checkbox } from 'antd';\r\nimport { FileTextOutlined, MailOutlined, NotificationOutlined, QuestionCircleOutlined } from '@ant-design/icons';\r\nimport AvatarImage from './AvatarImage';\r\nimport styles from './dashboard.module.css';\r\nimport { getAbsoluteApiUrl } from '../services/api';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { documentsAPI, contactAPI } from '../services/api';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\ninterface DocumentRequest {\r\n  _id: string;\r\n  documentType: string;\r\n  status: 'PENDING' | 'APPROVED' | 'REJECTED';\r\n  dateRequested: string;\r\n  requesterId?: {\r\n    fullName?: string;\r\n    username?: string;\r\n  };\r\n}\r\n\r\nconst Dashboard: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [residentImageSrc, setResidentImageSrc] = useState<string | null>(null);\r\n  const [, setCurrentTime] = useState<string>(() => new Date().toLocaleString());\r\n  const [documents, setDocuments] = useState<DocumentRequest[]>([]);\r\n  const [, setLoading] = useState(true);\r\n  const [announcementsCount, setAnnouncementsCount] = useState<number>(0);\r\n  const [, setAnnouncementsLoading] = useState<boolean>(false);\r\n  const [inquiriesCount, setInquiriesCount] = useState<number>(0);\r\n  const [pendingModalVisible, setPendingModalVisible] = useState(false);\r\n  const [pendingRequestsList, setPendingRequestsList] = useState<any[]>([]);\r\n  const [pendingLoading, setPendingLoading] = useState(false);\r\n  const [approvedModalVisible, setApprovedModalVisible] = useState(false);\r\n  const [approvedRequestsList, setApprovedRequestsList] = useState<any[]>([]);\r\n  const [approvedLoading, setApprovedLoading] = useState(false);\r\n  const [tipsModalVisible, setTipsModalVisible] = useState(false);\r\n  const [hideTips, setHideTips] = useState<boolean>(() => {\r\n    try {\r\n      return localStorage.getItem('residentTips.hide') === 'true';\r\n    } catch (err) {\r\n      return false;\r\n    }\r\n  });\r\n  const [helpHover, setHelpHover] = useState(false);\r\n\r\n  const formatDate = (val?: any) => {\r\n    if (!val) return '';\r\n    try {\r\n      return new Date(val).toLocaleString();\r\n    } catch (err) {\r\n      return String(val);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchDocuments = async () => {\r\n      try {\r\n        let response;\r\n        if (user?.role === 'admin' || user?.role === 'staff') {\r\n          response = await documentsAPI.getAllDocuments();\r\n        } else {\r\n          response = await documentsAPI.getMyDocuments();\r\n        }\r\n        setDocuments(response);\r\n      } catch (error) {\r\n        console.error('Error fetching documents:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchDocuments();\r\n  // Fetch resident personal info image so dashboard can prefer resident container avatar\r\n    (async () => {\r\n      try {\r\n        // Prefer resident personal-info container image (use axios instance so cookies/token are sent)\r\n        try {\r\n          const r1 = await (await import('../services/api')).residentPersonalInfoAPI.getPersonalInfo();\r\n          const data = r1;\r\n          if (data?.profileImage) {\r\n            const url = data.profileImage.startsWith('http') ? data.profileImage : getAbsoluteApiUrl(data.profileImage);\r\n            setResidentImageSrc(url);\r\n            return;\r\n          }\r\n          if (data?.profileImageId) {\r\n            setResidentImageSrc(getAbsoluteApiUrl(`/resident/personal-info/avatar/${data.profileImageId}`));\r\n            return;\r\n          }\r\n        } catch (err) {\r\n          // ignore per-endpoint errors\r\n        }\r\n        // If no resident image, try the user profile endpoint via axios instance\r\n        try {\r\n          const api = await import('../services/api');\r\n          const r2 = await api.default.get('/resident/profile');\r\n          const data2 = r2.data;\r\n          if (data2?.profileImage) {\r\n            const url2 = data2.profileImage.startsWith('http') ? data2.profileImage : getAbsoluteApiUrl(data2.profileImage);\r\n            setResidentImageSrc(url2);\r\n          } else if (data2?.profileImageId) {\r\n            setResidentImageSrc(getAbsoluteApiUrl(`/resident/personal-info/avatar/${data2.profileImageId}`));\r\n          }\r\n        } catch (err) {\r\n          // ignore\r\n        }\r\n      } catch (err) {\r\n        // ignore\r\n      }\r\n    })();\r\n    // Live timestamp updater\r\n    const tick = () => setCurrentTime(new Date().toLocaleString());\r\n    const timer = setInterval(tick, 1000);\r\n    return () => clearInterval(timer);\r\n    // TODO: Fetch unread notifications count\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    const fetchInquiries = async () => {\r\n      try {\r\n        let res;\r\n        if (user?.role === 'admin' || user?.role === 'staff') {\r\n          res = await contactAPI.getAllInquiries();\r\n        } else {\r\n          res = await contactAPI.getMyInquiries();\r\n        }\r\n        // API may return array or object with count\r\n        if (Array.isArray(res)) setInquiriesCount(res.length);\r\n        else if (res && typeof res.count === 'number') setInquiriesCount(res.count);\r\n        else setInquiriesCount((res && res.length) || 0);\r\n      } catch (err) {\r\n        console.error('Failed to load inquiries:', err);\r\n        setInquiriesCount(0);\r\n      }\r\n    };\r\n    fetchInquiries();\r\n    // Fetch announcements count for the announcements card\r\n    const fetchAnnouncements = async () => {\r\n      setAnnouncementsLoading(true);\r\n      try {\r\n        const res = await contactAPI.getAnnouncements();\r\n        if (Array.isArray(res)) setAnnouncementsCount(res.length);\r\n        else if (res && typeof res.count === 'number') setAnnouncementsCount(res.count);\r\n        else setAnnouncementsCount((res && res.length) || 0);\r\n      } catch (err) {\r\n        console.error('Failed to fetch announcements:', err);\r\n        setAnnouncementsCount(0);\r\n      } finally {\r\n        setAnnouncementsLoading(false);\r\n      }\r\n    };\r\n    fetchAnnouncements();\r\n  }, [user]);\r\n\r\n  const pendingCount = documents.filter(doc => (doc.status || '').toString().toLowerCase() === 'pending').length;\r\n  const approvedCount = documents.filter(doc => (doc.status || '').toString().toLowerCase() === 'approved').length;\r\n\r\n  return (\r\n    <>\r\n      <div style={{ maxWidth: 1200, margin: '40px auto', padding: '0 16px', position: 'relative' }}>\r\n        {/* Breadcrumb Navigation */}\r\n        <div style={{ marginBottom: 18 }}>\r\n          <Row align=\"middle\">\r\n            <Col>\r\n              <Typography.Text style={{ fontSize: 16, color: '#888' }}>\r\n                <span style={{ marginRight: 8 }}>\r\n                  <span style={{ color: '#1890ff', fontWeight: 600 }}>Dashboard</span> {'>'} Home\r\n                </span>\r\n              </Typography.Text>\r\n            </Col>\r\n          </Row>\r\n        </div>\r\n        {/* Hero Card Section */}\r\n        {user?.role === 'resident' && (\r\n          <Card\r\n            className={styles.residentCard}\r\n            style={{\r\n              width: '100%',\r\n              margin: '0 auto 32px',\r\n              borderRadius: 32,\r\n              boxShadow: '0 8px 32px #bfc7d6cc',\r\n              background: 'linear-gradient(120deg, #e3e6f3 0%, #f8fafc 60%, #f6f1f7 100%)',\r\n              border: 'none',\r\n              padding: 0,\r\n              position: 'relative',\r\n              overflow: 'hidden',\r\n              minHeight: 170\r\n            }}\r\n            styles={{ body: { padding: 0 } }}\r\n          >\r\n            {/* Subtle pattern/gradient background */}\r\n            <div style={{\r\n              position: 'absolute',\r\n              top: 0,\r\n              left: 0,\r\n              height: '100%',\r\n              background: 'radial-gradient(circle at 80% 20%, #e3e6f3 0%, #f8fafc 60%, #f6f1f7 100%)',\r\n              opacity: 0.18,\r\n              zIndex: 0\r\n            }} />\r\n            <Row align=\"middle\" className={styles.heroRow} style={{ minHeight: 170, padding: '32px 32px', position: 'relative', zIndex: 1 }} justify=\"space-between\">\r\n              <Col xs={24} md={14} style={{ display: 'flex', alignItems: 'center', gap: 24 }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 18, width: '100%', justifyContent: 'space-between' }}>\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: 18 }}>\r\n                    <div className={styles.avatarContainer}>\r\n                      {residentImageSrc ? (\r\n                        <img className={styles.avatarImg} src={residentImageSrc} alt={user?.fullName || user?.username || 'avatar'} />\r\n                      ) : (\r\n                        <AvatarImage user={(() => {\r\n                          let displayUser = user;\r\n                          if (!displayUser) {\r\n                            try {\r\n                              const stored = localStorage.getItem('userProfile');\r\n                              if (stored) displayUser = JSON.parse(stored);\r\n                            } catch (err) {}\r\n                          }\r\n                          return displayUser;\r\n                        })()} size={96} />\r\n                      )}\r\n                      <button\r\n                        onClick={() => navigate('/profile')}\r\n                        title=\"Edit profile\"\r\n                        className={styles.editButton}\r\n                      >\r\n                        <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                          <path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z\" fill=\"#595959\"/>\r\n                          <path d=\"M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\" fill=\"#595959\"/>\r\n                        </svg>\r\n                      </button>\r\n                    </div>\r\n                    <div className={styles.userInfo}>\r\n                      <Typography.Title level={3} className={styles.userName} style={{ marginBottom: 0, fontWeight: 800 }}>{user?.fullName ?? user?.username ?? user?.email ?? ''}</Typography.Title>\r\n                      <Typography.Text type=\"secondary\" className={styles.userMeta}>\r\n                        Barangay ID: {user?.barangayID ?? (() => {\r\n                          try {\r\n                            const stored = localStorage.getItem('userProfile');\r\n                            if (stored) {\r\n                              const p = JSON.parse(stored);\r\n                              return p?.barangayID || 'N/A';\r\n                            }\r\n                          } catch (e) {}\r\n                          return 'N/A';\r\n                        })()}\r\n                      </Typography.Text>\r\n                      <div style={{ marginTop: 8 }}><Typography.Text type=\"secondary\" className={styles.userMeta}>{new Date().toLocaleString()}</Typography.Text></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            {/* help button moved to floating bottom-right */}\r\n          </Card>\r\n        )}\r\n\r\n        {/* Statistics Grid */}\r\n        <Row gutter={[32, 32]} justify=\"center\" style={{ marginBottom: 40 }}>\r\n          <Col xs={24} sm={12} md={6}>\r\n            <Card\r\n              hoverable\r\n              style={{\r\n                borderRadius: 20,\r\n                minHeight: 170,\r\n                boxShadow: '0 2px 12px #faad1444',\r\n                transition: 'box-shadow 0.2s, transform 0.2s',\r\n                padding: 0,\r\n                cursor: 'pointer'\r\n              }}\r\n              onClick={async () => {\r\n                setPendingModalVisible(true);\r\n                setPendingLoading(true);\r\n                try {\r\n                  let res;\r\n                  if (user?.role === 'admin' || user?.role === 'staff') {\r\n                    res = await documentsAPI.getAllDocuments();\r\n                    res = (res || []).filter((r: any) => (r.status || '').toString().toLowerCase() === 'pending');\r\n                  } else {\r\n                    res = await documentsAPI.getMyDocuments();\r\n                    res = (res || []).filter((r: any) => (r.status || '').toString().toLowerCase() === 'pending');\r\n                  }\r\n                  setPendingRequestsList(res || []);\r\n                } catch (err) {\r\n                  setPendingRequestsList([]);\r\n                } finally {\r\n                  setPendingLoading(false);\r\n                }\r\n              }}\r\n              styles={{ body: { padding: 24 } }}\r\n              onMouseEnter={e => e.currentTarget.style.transform = 'translateY(-6px) scale(1.03)'}\r\n              onMouseLeave={e => e.currentTarget.style.transform = 'none'}\r\n            >\r\n              <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 12 }}>\r\n                <div style={{ background: '#faad14', borderRadius: '50%', width: 54, height: 54, display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: 8 }}>\r\n                  <MailOutlined style={{ color: '#fff', fontSize: 28, transition: 'transform 0.2s' }} />\r\n                </div>\r\n                <Typography.Title level={2} style={{ margin: 0, fontWeight: 800 }}>{pendingCount}</Typography.Title>\r\n                <Typography.Text style={{ fontSize: 18, color: '#faad14', fontWeight: 700 }}>Pending Requests</Typography.Text>\r\n                {/* subtitle and action button removed */}\r\n              </div>\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} md={6}>\r\n            <Card\r\n              hoverable\r\n              style={{\r\n                borderRadius: 20,\r\n                minHeight: 170,\r\n                boxShadow: '0 2px 12px #52c41a44',\r\n                transition: 'box-shadow 0.2s, transform 0.2s',\r\n                padding: 0,\r\n                cursor: 'pointer'\r\n              }}\r\n              styles={{ body: { padding: 24 } }}\r\n              onClick={async () => {\r\n                setApprovedModalVisible(true);\r\n                setApprovedLoading(true);\r\n                try {\r\n                  let res;\r\n                  if (user?.role === 'admin' || user?.role === 'staff') {\r\n                    res = await documentsAPI.getAllDocuments();\r\n                    res = (res || []).filter((r: any) => (r.status || '').toString().toLowerCase() === 'approved');\r\n                  } else {\r\n                    res = await documentsAPI.getMyDocuments();\r\n                    res = (res || []).filter((r: any) => (r.status || '').toString().toLowerCase() === 'approved');\r\n                  }\r\n                  setApprovedRequestsList(res || []);\r\n                } catch (err) {\r\n                  setApprovedRequestsList([]);\r\n                } finally {\r\n                  setApprovedLoading(false);\r\n                }\r\n              }}\r\n              onMouseEnter={e => e.currentTarget.style.transform = 'translateY(-6px) scale(1.03)'}\r\n              onMouseLeave={e => e.currentTarget.style.transform = 'none'}\r\n            >\r\n              <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 12 }}>\r\n                <div style={{ background: '#52c41a', borderRadius: '50%', width: 54, height: 54, display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: 8 }}>\r\n                  <FileTextOutlined style={{ color: '#fff', fontSize: 28, transition: 'transform 0.2s' }} />\r\n                </div>\r\n                <Typography.Title level={2} style={{ margin: 0, fontWeight: 800 }}>{approvedCount}</Typography.Title>\r\n                <Typography.Text style={{ fontSize: 18, color: '#52c41a', fontWeight: 700 }}>Approved Documents</Typography.Text>\r\n                {/* subtitle and action button removed */}\r\n              </div>\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} md={6}>\r\n            <Card\r\n              hoverable\r\n              style={{\r\n                borderRadius: 20,\r\n                minHeight: 170,\r\n                boxShadow: '0 2px 12px #1890ff44',\r\n                transition: 'box-shadow 0.2s, transform 0.2s',\r\n                padding: 0,\r\n                cursor: 'pointer'\r\n              }}\r\n              onClick={() => navigate('/inbox')}\r\n              styles={{ body: { padding: 24 } }}\r\n              onMouseEnter={e => e.currentTarget.style.transform = 'translateY(-6px) scale(1.03)'}\r\n              onMouseLeave={e => e.currentTarget.style.transform = 'none'}\r\n            >\r\n              <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 12 }}>\r\n                <div style={{ background: '#1890ff', borderRadius: '50%', width: 54, height: 54, display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: 8 }}>\r\n                  <MailOutlined style={{ color: '#fff', fontSize: 28, transition: 'transform 0.2s' }} />\r\n                </div>\r\n                <Typography.Title level={2} style={{ margin: 0, fontWeight: 800 }}>{inquiriesCount}</Typography.Title>\r\n                <Typography.Text style={{ fontSize: 18, color: '#1890ff', fontWeight: 700 }}>Active Inquiries</Typography.Text>\r\n                {/* subtitle and action button removed */}\r\n              </div>\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} md={6}>\r\n            <Card\r\n              onClick={() => navigate('/announcements')}\r\n              hoverable\r\n              style={{\r\n                borderRadius: 20,\r\n                minHeight: 170,\r\n                boxShadow: '0 2px 12px #eb2f9644',\r\n                transition: 'box-shadow 0.2s, transform 0.2s',\r\n                padding: 0,\r\n                cursor: 'pointer'\r\n              }}\r\n              styles={{ body: { padding: 24 } }}\r\n              onMouseEnter={e => e.currentTarget.style.transform = 'translateY(-6px) scale(1.03)'}\r\n              onMouseLeave={e => e.currentTarget.style.transform = 'none'}\r\n            >\r\n              <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 12 }}>\r\n                <div style={{ background: '#eb2f96', borderRadius: '50%', width: 54, height: 54, display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: 8 }}>\r\n                  <Badge count={announcementsCount} offset={[8, 0]}>\r\n                    <NotificationOutlined style={{ color: '#fff', fontSize: 28, transition: 'transform 0.2s' }} />\r\n                  </Badge>\r\n                </div>\r\n                <Typography.Title level={2} style={{ margin: 0, fontWeight: 800 }}>{announcementsCount}</Typography.Title>\r\n                <Typography.Text style={{ fontSize: 18, color: '#eb2f96', fontWeight: 700 }}>Announcements</Typography.Text>\r\n                {/* subtitle and action button removed */}\r\n              </div>\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n        \r\n        {/* Pending Requests Modal */}\r\n        <Modal\r\n          title=\"Pending Requests\"\r\n          open={pendingModalVisible}\r\n          onCancel={() => setPendingModalVisible(false)}\r\n          footer={null}\r\n          width={800}\r\n        >\r\n          <Table\r\n            dataSource={pendingRequestsList}\r\n            loading={pendingLoading}\r\n            rowKey={(record: any) => record._id}\r\n            pagination={{ pageSize: 8 }}\r\n            columns={[\r\n              {\r\n                title: 'First Name',\r\n                dataIndex: 'fieldValues',\r\n                key: 'firstName',\r\n                render: (fv: any, record: any) => fv?.firstName || record.username || 'Unknown'\r\n              },\r\n              {\r\n                title: 'Doc Type',\r\n                dataIndex: 'type',\r\n                key: 'type',\r\n                render: (text: string) => text || 'Unknown'\r\n              },\r\n              {\r\n                title: 'Status',\r\n                dataIndex: 'status',\r\n                key: 'status',\r\n                render: (text: string) => (text || '').toString().toLowerCase()\r\n              }\r\n            ]}\r\n          />\r\n        </Modal>\r\n        {/* Approved Requests Modal */}\r\n        <Modal\r\n          title=\"Approved Documents\"\r\n          open={approvedModalVisible}\r\n          onCancel={() => setApprovedModalVisible(false)}\r\n          footer={null}\r\n          width={1000}\r\n        >\r\n          <Table\r\n            dataSource={approvedRequestsList}\r\n            loading={approvedLoading}\r\n            rowKey={(record: any) => record._id}\r\n            pagination={{ pageSize: 8 }}\r\n            columns={[\r\n              {\r\n                title: 'First Name',\r\n                dataIndex: 'fieldValues',\r\n                key: 'firstName',\r\n                render: (fv: any, record: any) => fv?.firstName || record.username || 'Unknown'\r\n              },\r\n              {\r\n                title: 'Doc Type',\r\n                dataIndex: 'type',\r\n                key: 'type',\r\n                render: (text: string) => text || 'Unknown'\r\n              },\r\n              {\r\n                title: 'Date Requested',\r\n                dataIndex: 'dateRequested',\r\n                key: 'dateRequested',\r\n                render: (_: any, record: any) => formatDate(record.dateRequested || record.requestedAt || record.createdAt)\r\n              },\r\n              {\r\n                title: 'Date Approved',\r\n                dataIndex: 'dateApproved',\r\n                key: 'dateApproved',\r\n                render: (_: any, record: any) => formatDate(record.dateApproved || record.approvedAt || record.approvedOn || record.updatedAt)\r\n              },\r\n              {\r\n                title: 'Status',\r\n                dataIndex: 'status',\r\n                key: 'status',\r\n                render: (text: string) => (text || '').toString().toLowerCase()\r\n              }\r\n            ]}\r\n          />\r\n        </Modal>\r\n        {/* Resident Tool Tips Modal */}\r\n        <Modal\r\n          title=\"Resident Tool Tips\"\r\n          open={tipsModalVisible}\r\n          onCancel={() => setTipsModalVisible(false)}\r\n          footer={(\r\n            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', width: '100%' }}>\r\n              <Checkbox\r\n                checked={hideTips}\r\n                onChange={e => {\r\n                  const val = e.target.checked;\r\n                  setHideTips(val);\r\n                  try { localStorage.setItem('residentTips.hide', val ? 'true' : 'false'); } catch (err) {}\r\n                }}\r\n              >Don't show again</Checkbox>\r\n              <div>\r\n                <Button onClick={() => setTipsModalVisible(false)} style={{ marginRight: 8 }}>Cancel</Button>\r\n                <Button type=\"primary\" onClick={() => { setTipsModalVisible(false); }}>Got it</Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n          width={720}\r\n        >\r\n          <ul style={{ paddingLeft: 20 }}>\r\n            <li>Use the Request Document button to apply for barangay certificates and permits.</li>\r\n            <li>Check your profile information regularly to ensure accuracy.</li>\r\n            <li>Contact barangay staff for assistance with business registration or solo parent certification.</li>\r\n            <li>For lost documents, use the Inquiry form to request help.</li>\r\n            <li>All document requests are processed during office hours only.</li>\r\n          </ul>\r\n        </Modal>\r\n        {/* Floating help button (bottom-right) */}\r\n        <div style={{ position: 'fixed', right: 20, bottom: 24, zIndex: 1050 }}>\r\n          <Tooltip title={hideTips ? 'Tips hidden (will remain hidden if checked)' : 'Resident Tool Tips'}>\r\n            <Button\r\n              type=\"primary\"\r\n              shape=\"circle\"\r\n              size=\"large\"\r\n              onClick={() => setTipsModalVisible(true)}\r\n              onMouseEnter={() => setHelpHover(true)}\r\n              onMouseLeave={() => setHelpHover(false)}\r\n              icon={<QuestionCircleOutlined style={{ color: '#fff', fontSize: 20 }} />}\r\n              style={{\r\n                width: 56,\r\n                height: 56,\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                boxShadow: helpHover ? '0 10px 30px rgba(24,144,255,0.22)' : '0 6px 18px rgba(0,0,0,0.12)',\r\n                transform: helpHover ? 'translateY(-4px) scale(1.03)' : 'none',\r\n                transition: 'transform 160ms cubic-bezier(.2,.8,.2,1), box-shadow 160ms',\r\n              }}\r\n            />\r\n          </Tooltip>\r\n        </div>\r\n        {/* ...other dashboard sections... */}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n                \r\n","import React, { useState, useEffect } from 'react';\r\nimport { Row, Col, Card, Typography, Button, Badge, Modal, Table, Tooltip, Checkbox, Dropdown } from 'antd';\r\nimport { NotificationOutlined, QuestionCircleOutlined, UploadOutlined, MenuOutlined, UserOutlined, SettingOutlined, LogoutOutlined } from '@ant-design/icons';\r\nimport { getAbsoluteApiUrl } from '../services/api';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { documentsAPI, contactAPI } from '../services/api';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\ninterface DocumentRequest {\r\n\t_id: string;\r\n\tdocumentType: string;\r\n\tstatus: 'PENDING' | 'APPROVED' | 'REJECTED';\r\n\tdateRequested: string;\r\n\trequesterId?: {\r\n\t\tfullName?: string;\r\n\t\tusername?: string;\r\n\t};\r\n}\r\n\r\nconst GuestDashboard: React.FC = () => {\r\n\tconst { user } = useAuth();\r\n\tconst navigate = useNavigate();\r\n\tconst [residentImageSrc, setResidentImageSrc] = useState<string | null>(null);\r\n\tconst [, setCurrentTime] = useState<string>(() => new Date().toLocaleString());\r\n\tconst [, setDocuments] = useState<DocumentRequest[]>([]);\r\n\tconst [, setLoading] = useState(true);\r\n\tconst [announcementsCount, setAnnouncementsCount] = useState<number>(0);\r\n\tconst [, setAnnouncementsLoading] = useState<boolean>(false);\r\n\tconst [pendingModalVisible, setPendingModalVisible] = useState(false);\r\n\tconst pendingRequestsList: any[] = [];\r\n\tconst pendingLoading = false;\r\n\tconst [approvedModalVisible, setApprovedModalVisible] = useState(false);\r\n\tconst approvedRequestsList: any[] = [];\r\n\tconst approvedLoading = false;\r\n\tconst [tipsModalVisible, setTipsModalVisible] = useState(false);\r\n\tconst [hideTips, setHideTips] = useState<boolean>(() => {\r\n\t\ttry {\r\n\t\t\treturn localStorage.getItem('residentTips.hide') === 'true';\r\n\t\t} catch (err) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t});\r\n\tconst [helpHover, setHelpHover] = useState(false);\r\n\r\n\tconst formatDate = (val?: any) => {\r\n\t\tif (!val) return '';\r\n\t\ttry {\r\n\t\t\treturn new Date(val).toLocaleString();\r\n\t\t} catch (err) {\r\n\t\t\treturn String(val);\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tconst fetchDocuments = async () => {\r\n\t\t\ttry {\r\n\t\t\t\tlet response;\r\n\t\t\t\tif (user?.role === 'admin' || user?.role === 'staff') {\r\n\t\t\t\t\tresponse = await documentsAPI.getAllDocuments();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresponse = await documentsAPI.getMyDocuments();\r\n\t\t\t\t}\r\n\t\t\t\tsetDocuments(response);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('Error fetching documents:', error);\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t};\r\n\t\tfetchDocuments();\r\n\t\t// Fetch resident personal info image so dashboard can prefer resident container avatar\r\n\t\t(async () => {\r\n\t\t\ttry {\r\n\t\t\t\t// Prefer resident personal-info container image (use axios instance so cookies/token are sent)\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst r1 = await (await import('../services/api')).residentPersonalInfoAPI.getPersonalInfo();\r\n\t\t\t\t\tconst data = r1;\r\n\t\t\t\t\tif (data?.profileImage) {\r\n\t\t\t\t\t\tconst url = data.profileImage.startsWith('http') ? data.profileImage : getAbsoluteApiUrl(data.profileImage);\r\n\t\t\t\t\t\tsetResidentImageSrc(url);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (data?.profileImageId) {\r\n\t\t\t\t\t\tsetResidentImageSrc(getAbsoluteApiUrl(`/resident/personal-info/avatar/${data.profileImageId}`));\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\t// ignore per-endpoint errors\r\n\t\t\t\t}\r\n\t\t\t\t// If no resident image, try the user profile endpoint via axios instance\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst api = await import('../services/api');\r\n\t\t\t\t\tconst r2 = await api.default.get('/resident/profile');\r\n\t\t\t\t\tconst data2 = r2.data;\r\n\t\t\t\t\tif (data2?.profileImage) {\r\n\t\t\t\t\t\tconst url2 = data2.profileImage.startsWith('http') ? data2.profileImage : getAbsoluteApiUrl(data2.profileImage);\r\n\t\t\t\t\t\tsetResidentImageSrc(url2);\r\n\t\t\t\t\t} else if (data2?.profileImageId) {\r\n\t\t\t\t\t\tsetResidentImageSrc(getAbsoluteApiUrl(`/resident/personal-info/avatar/${data2.profileImageId}`));\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\t// ignore\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\t// ignore\r\n\t\t\t}\r\n\t\t})();\r\n\t\t// Live timestamp updater\r\n\t\tconst tick = () => setCurrentTime(new Date().toLocaleString());\r\n\t\tconst timer = setInterval(tick, 1000);\r\n\t\treturn () => clearInterval(timer);\r\n\t\t// TODO: Fetch unread notifications count\r\n\t}, [user]);\r\n\r\n\t// We previously toggled a document-level CSS class from this component to hide\r\n\t// the global sider, but AppLayout now respects the `guest` role directly and\r\n\t// does not render the sider for guest users. Remove the injected-class logic\r\n\t// to avoid duplication. (Left the modal/state intact elsewhere.)\r\n\r\n\tuseEffect(() => {\r\n\t\t// Fetch announcements count for the announcements card\r\n\t\tconst fetchAnnouncements = async () => {\r\n\t\t\tsetAnnouncementsLoading(true);\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await contactAPI.getAnnouncements();\r\n\t\t\t\tif (Array.isArray(res)) setAnnouncementsCount(res.length);\r\n\t\t\t\telse if (res && typeof res.count === 'number') setAnnouncementsCount(res.count);\r\n\t\t\t\telse setAnnouncementsCount((res && res.length) || 0);\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('Failed to fetch announcements:', err);\r\n\t\t\t\tsetAnnouncementsCount(0);\r\n\t\t\t} finally {\r\n\t\t\t\tsetAnnouncementsLoading(false);\r\n\t\t\t}\r\n\t\t};\r\n\t\tfetchAnnouncements();\r\n\t}, [user]);\r\n\r\n\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div style={{ maxWidth: 1200, margin: '40px auto', padding: '0 16px', position: 'relative' }}>\r\n\t\t\t\t{/* Breadcrumb Navigation */}\r\n\t\t\t\t<div style={{ marginBottom: 18 }}>\r\n\t\t\t\t\t<Row align=\"middle\">\r\n\t\t\t\t\t\t<Col>\r\n\t\t\t\t\t\t\t<Typography.Text style={{ fontSize: 16, color: '#888' }}>\r\n\t\t\t\t\t\t\t\t<span style={{ marginRight: 8 }}>\r\n\t\t\t\t\t\t\t\t\t<span style={{ color: '#1890ff', fontWeight: 600 }}>Dashboard</span> {'>'} Home\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</Typography.Text>\r\n\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</div>\r\n\t\t\t\t{/* Hero Card Section */}\r\n\t\t\t\t{user?.role === 'resident' && (\r\n\t\t\t\t\t<Card\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\twidth: '100%',\r\n\t\t\t\t\t\t\tmargin: '0 auto 32px',\r\n\t\t\t\t\t\t\tborderRadius: 32,\r\n\t\t\t\t\t\t\tboxShadow: '0 8px 32px #bfc7d6cc',\r\n\t\t\t\t\t\t\tbackground: 'linear-gradient(120deg, #e3e6f3 0%, #f8fafc 60%, #f6f1f7 100%)',\r\n\t\t\t\t\t\t\tborder: 'none',\r\n\t\t\t\t\t\t\tpadding: 0,\r\n\t\t\t\t\t\t\tposition: 'relative',\r\n\t\t\t\t\t\t\toverflow: 'hidden',\r\n\t\t\t\t\t\t\tminHeight: 170\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tstyles={{ body: { padding: 0 } }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{/* Subtle pattern/gradient background */}\r\n\t\t\t\t\t\t<div style={{\r\n\t\t\t\t\t\t\tposition: 'absolute',\r\n\t\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\t\tleft: 0,\r\n\t\t\t\t\t\t\theight: '100%',\r\n\t\t\t\t\t\t\tbackground: 'radial-gradient(circle at 80% 20%, #e3e6f3 0%, #f8fafc 60%, #f6f1f7 100%)',\r\n\t\t\t\t\t\t\topacity: 0.18,\r\n\t\t\t\t\t\t\tzIndex: 0\r\n\t\t\t\t\t\t}} />\r\n\t\t\t\t\t\t<Row align=\"middle\" style={{ minHeight: 170, padding: '32px 32px', position: 'relative', zIndex: 1 }} justify=\"space-between\">\r\n\t\t\t\t\t\t\t<Col xs={24} md={14} style={{ display: 'flex', alignItems: 'center', gap: 24 }}>\r\n\t\t\t\t\t\t\t\t<div style={{ display: 'flex', alignItems: 'center', gap: 18, width: '100%', justifyContent: 'space-between' }}>\r\n\t\t\t\t\t\t\t\t\t<div style={{ display: 'flex', alignItems: 'center', gap: 18 }}>\r\n\t\t\t\t\t\t\t\t\t\t<div style={{ width: 96, height: 96, borderRadius: 12, overflow: 'hidden', background: '#fff', display: 'flex', alignItems: 'center', justifyContent: 'center', position: 'relative' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t{residentImageSrc ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img src={residentImageSrc} alt={user?.fullName || user?.username || 'avatar'} style={{ width: 96, height: 96, objectFit: 'cover', borderRadius: 12 }} />\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ width: 96, height: 96, display: 'flex', alignItems: 'center', justifyContent: 'center', background: '#1890ff', borderRadius: 12 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<UserOutlined style={{ color: '#fff', fontSize: 44 }} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Menu icon (left/top) - single control that opens profile/actions */}\r\n\t\t\t\t\t\t\t\t\t\t\t{(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst items: any[] = [\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ key: 'profile', icon: <UserOutlined />, label: 'Profile' },\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t...((user?.role as any) === 'admin' ? [{ key: 'settings', icon: <SettingOutlined />, label: 'Settings' }] : []),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ type: 'divider', key: 'divider-1' },\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ key: 'tips', icon: <QuestionCircleOutlined />, label: 'Tips' },\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ key: 'logout', icon: <LogoutOutlined />, label: 'Logout' },\r\n\t\t\t\t\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Dropdown\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmenu={{ items, onClick: ({ key }) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (key === 'profile') navigate('/profile');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse if (key === 'settings') navigate('/admin/settings');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse if (key === 'logout') navigate('/logout');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse if (key === 'tips') setTipsModalVisible(true);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tplacement=\"bottomLeft\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrigger={[\"click\"]}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"default\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshape=\"circle\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Menu\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={<MenuOutlined />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ position: 'absolute', left: -12, top: -12, width: 36, height: 36, display: 'flex', alignItems: 'center', justifyContent: 'center' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Dropdown>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{ marginBottom: 0, fontWeight: 800 }}>{user?.fullName ?? user?.username ?? user?.email ?? ''}</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t\t<Typography.Text type=\"secondary\" style={{ fontSize: 18 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\tBarangay ID: {user?.barangayID ?? (() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst stored = localStorage.getItem('userProfile');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (stored) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst p = JSON.parse(stored);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn p?.barangayID || 'N/A';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} catch (e) {}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn 'N/A';\r\n\t\t\t\t\t\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t\t\t\t\t\t</Typography.Text>\r\n\t\t\t\t\t\t\t\t\t\t\t<div style={{ marginTop: 8 }}><Typography.Text type=\"secondary\">{new Date().toLocaleString()}</Typography.Text></div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t{/* help button moved to floating bottom-right */}\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Statistics Grid */}\r\n\t\t\t\t<Row gutter={[32, 32]} justify=\"center\" style={{ marginBottom: 40 }}>\r\n\r\n\t\t\t\t\t{/* Inquiries / Inbox removed for guest dashboard per request */}\r\n\t\t\t\t\t{/* Request Document card - restored per user's request */}\r\n\t\t\t\t\t<Col xs={24} sm={12} md={6}>\r\n\t\t\t\t\t\t<Card\r\n\t\t\t\t\t\t\tonClick={() => navigate('/request')}\r\n\t\t\t\t\t\t\thoverable\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\tborderRadius: 20,\r\n\t\t\t\t\t\t\t\tminHeight: 170,\r\n\t\t\t\t\t\t\t\tboxShadow: '0 2px 12px #1890ff44',\r\n\t\t\t\t\t\t\t\ttransition: 'box-shadow 0.2s, transform 0.2s',\r\n\t\t\t\t\t\t\t\tpadding: 0,\r\n\t\t\t\t\t\t\t\tcursor: 'pointer'\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tstyles={{ body: { padding: 24 } }}\r\n\t\t\t\t\t\t\tonMouseEnter={e => e.currentTarget.style.transform = 'translateY(-6px) scale(1.03)'}\r\n\t\t\t\t\t\t\tonMouseLeave={e => e.currentTarget.style.transform = 'none'}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 12 }}>\r\n\t\t\t\t\t\t\t\t<div style={{ background: '#1890ff', borderRadius: '50%', width: 54, height: 54, display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: 8 }}>\r\n\t\t\t\t\t\t\t\t\t<UploadOutlined style={{ color: '#fff', fontSize: 28, transition: 'transform 0.2s' }} />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<Typography.Title level={2} style={{ margin: 0, fontWeight: 800 }}>Request</Typography.Title>\r\n\t\t\t\t\t\t\t\t<Typography.Text style={{ fontSize: 18, color: '#1890ff', fontWeight: 700 }}>Request Document</Typography.Text>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t\t<Col xs={24} sm={12} md={6}>\r\n\t\t\t\t\t\t<Card\r\n\t\t\t\t\t\t\tonClick={() => navigate('/announcements')}\r\n\t\t\t\t\t\t\thoverable\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\tborderRadius: 20,\r\n\t\t\t\t\t\t\t\tminHeight: 170,\r\n\t\t\t\t\t\t\t\tboxShadow: '0 2px 12px #eb2f9644',\r\n\t\t\t\t\t\t\t\ttransition: 'box-shadow 0.2s, transform 0.2s',\r\n\t\t\t\t\t\t\t\tpadding: 0,\r\n\t\t\t\t\t\t\t\tcursor: 'pointer'\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tstyles={{ body: { padding: 24 } }}\r\n\t\t\t\t\t\t\tonMouseEnter={e => e.currentTarget.style.transform = 'translateY(-6px) scale(1.03)'}\r\n\t\t\t\t\t\t\tonMouseLeave={e => e.currentTarget.style.transform = 'none'}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 12 }}>\r\n\t\t\t\t\t\t\t\t<div style={{ background: '#eb2f96', borderRadius: '50%', width: 54, height: 54, display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: 8 }}>\r\n\t\t\t\t\t\t\t\t\t<Badge count={announcementsCount} offset={[8, 0]}>\r\n\t\t\t\t\t\t\t\t\t\t<NotificationOutlined style={{ color: '#fff', fontSize: 28, transition: 'transform 0.2s' }} />\r\n\t\t\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<Typography.Title level={2} style={{ margin: 0, fontWeight: 800 }}>{announcementsCount}</Typography.Title>\r\n\t\t\t\t\t\t\t\t<Typography.Text style={{ fontSize: 18, color: '#eb2f96', fontWeight: 700 }}>Announcements</Typography.Text>\r\n\t\t\t\t\t\t\t\t{/* subtitle and action button removed */}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t</Row>\r\n        \r\n\t\t\t\t{/* Pending Requests Modal */}\r\n\t\t\t\t<Modal\r\n\t\t\t\t\ttitle=\"Pending Requests\"\r\n\t\t\t\t\topen={pendingModalVisible}\r\n\t\t\t\t\tonCancel={() => setPendingModalVisible(false)}\r\n\t\t\t\t\tfooter={null}\r\n\t\t\t\t\twidth={800}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Table\r\n\t\t\t\t\t\tdataSource={pendingRequestsList}\r\n\t\t\t\t\t\tloading={pendingLoading}\r\n\t\t\t\t\t\trowKey={(record: any) => record._id}\r\n\t\t\t\t\t\tpagination={{ pageSize: 8 }}\r\n\t\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttitle: 'First Name',\r\n\t\t\t\t\t\t\t\tdataIndex: 'fieldValues',\r\n\t\t\t\t\t\t\t\tkey: 'firstName',\r\n\t\t\t\t\t\t\t\trender: (fv: any, record: any) => fv?.firstName || record.username || 'Unknown'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttitle: 'Doc Type',\r\n\t\t\t\t\t\t\t\tdataIndex: 'type',\r\n\t\t\t\t\t\t\t\tkey: 'type',\r\n\t\t\t\t\t\t\t\trender: (text: string) => text || 'Unknown'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttitle: 'Status',\r\n\t\t\t\t\t\t\t\tdataIndex: 'status',\r\n\t\t\t\t\t\t\t\tkey: 'status',\r\n\t\t\t\t\t\t\t\trender: (text: string) => (text || '').toString().toLowerCase()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Modal>\r\n\t\t\t\t{/* Approved Requests Modal */}\r\n\t\t\t\t<Modal\r\n\t\t\t\t\ttitle=\"Approved Documents\"\r\n\t\t\t\t\topen={approvedModalVisible}\r\n\t\t\t\t\tonCancel={() => setApprovedModalVisible(false)}\r\n\t\t\t\t\tfooter={null}\r\n\t\t\t\t\twidth={1000}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Table\r\n\t\t\t\t\t\tdataSource={approvedRequestsList}\r\n\t\t\t\t\t\tloading={approvedLoading}\r\n\t\t\t\t\t\trowKey={(record: any) => record._id}\r\n\t\t\t\t\t\tpagination={{ pageSize: 8 }}\r\n\t\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttitle: 'First Name',\r\n\t\t\t\t\t\t\t\tdataIndex: 'fieldValues',\r\n\t\t\t\t\t\t\t\tkey: 'firstName',\r\n\t\t\t\t\t\t\t\trender: (fv: any, record: any) => fv?.firstName || record.username || 'Unknown'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttitle: 'Doc Type',\r\n\t\t\t\t\t\t\t\tdataIndex: 'type',\r\n\t\t\t\t\t\t\t\tkey: 'type',\r\n\t\t\t\t\t\t\t\trender: (text: string) => text || 'Unknown'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttitle: 'Date Requested',\r\n\t\t\t\t\t\t\t\tdataIndex: 'dateRequested',\r\n\t\t\t\t\t\t\t\tkey: 'dateRequested',\r\n\t\t\t\t\t\t\t\trender: (_: any, record: any) => formatDate(record.dateRequested || record.requestedAt || record.createdAt)\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttitle: 'Date Approved',\r\n\t\t\t\t\t\t\t\tdataIndex: 'dateApproved',\r\n\t\t\t\t\t\t\t\tkey: 'dateApproved',\r\n\t\t\t\t\t\t\t\trender: (_: any, record: any) => formatDate(record.dateApproved || record.approvedAt || record.approvedOn || record.updatedAt)\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttitle: 'Status',\r\n\t\t\t\t\t\t\t\tdataIndex: 'status',\r\n\t\t\t\t\t\t\t\tkey: 'status',\r\n\t\t\t\t\t\t\t\trender: (text: string) => (text || '').toString().toLowerCase()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Modal>\r\n\t\t\t\t{/* Resident Tool Tips Modal */}\r\n\t\t\t\t<Modal\r\n\t\t\t\t\ttitle=\"Resident Tool Tips\"\r\n\t\t\t\t\topen={tipsModalVisible}\r\n\t\t\t\t\tonCancel={() => setTipsModalVisible(false)}\r\n\t\t\t\t\tfooter={(\r\n\t\t\t\t\t\t<div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', width: '100%' }}>\r\n\t\t\t\t\t\t\t<Checkbox\r\n\t\t\t\t\t\t\t\tchecked={hideTips}\r\n\t\t\t\t\t\t\t\tonChange={e => {\r\n\t\t\t\t\t\t\t\t\tconst val = e.target.checked;\r\n\t\t\t\t\t\t\t\t\tsetHideTips(val);\r\n\t\t\t\t\t\t\t\t\ttry { localStorage.setItem('residentTips.hide', val ? 'true' : 'false'); } catch (err) {}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>Don't show again</Checkbox>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<Button onClick={() => setTipsModalVisible(false)} style={{ marginRight: 8 }}>Cancel</Button>\r\n\t\t\t\t\t\t\t\t<Button type=\"primary\" onClick={() => { setTipsModalVisible(false); }}>Got it</Button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\twidth={720}\r\n\t\t\t\t>\r\n\t\t\t\t\t<ul style={{ paddingLeft: 20 }}>\r\n\t\t\t\t\t\t<li>Use the Request Document button to apply for barangay certificates and permits.</li>\r\n\t\t\t\t\t\t<li>Check your profile information regularly to ensure accuracy.</li>\r\n\t\t\t\t\t\t<li>Contact barangay staff for assistance with business registration or solo parent certification.</li>\r\n\t\t\t\t\t\t<li>For lost documents, contact barangay staff or visit the office for assistance.</li>\r\n\t\t\t\t\t\t<li>All document requests are processed during office hours only.</li>\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</Modal>\r\n\t\t\t\t{/* Floating help button (bottom-right) */}\r\n\t\t\t\t<div style={{ position: 'fixed', right: 20, bottom: 24, zIndex: 1050 }}>\r\n\t\t\t\t\t<Tooltip title={hideTips ? 'Tips hidden (will remain hidden if checked)' : 'Resident Tool Tips'}>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\ttype=\"primary\"\r\n\t\t\t\t\t\t\tshape=\"circle\"\r\n\t\t\t\t\t\t\tsize=\"large\"\r\n\t\t\t\t\t\t\tonClick={() => setTipsModalVisible(true)}\r\n\t\t\t\t\t\t\tonMouseEnter={() => setHelpHover(true)}\r\n\t\t\t\t\t\t\tonMouseLeave={() => setHelpHover(false)}\r\n\t\t\t\t\t\t\ticon={<QuestionCircleOutlined style={{ color: '#fff', fontSize: 20 }} />}\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\twidth: 56,\r\n\t\t\t\t\t\t\t\theight: 56,\r\n\t\t\t\t\t\t\t\tdisplay: 'flex',\r\n\t\t\t\t\t\t\t\talignItems: 'center',\r\n\t\t\t\t\t\t\t\tjustifyContent: 'center',\r\n\t\t\t\t\t\t\t\tboxShadow: helpHover ? '0 10px 30px rgba(24,144,255,0.22)' : '0 6px 18px rgba(0,0,0,0.12)',\r\n\t\t\t\t\t\t\t\ttransform: helpHover ? 'translateY(-4px) scale(1.03)' : 'none',\r\n\t\t\t\t\t\t\t\ttransition: 'transform 160ms cubic-bezier(.2,.8,.2,1), box-shadow 160ms',\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t</div>\r\n\t\t\t\t{/* ...other dashboard sections... */}\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default GuestDashboard;\r\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { Card, Row, Col, Statistic, List, Typography, Space, Spin, Button, Modal, Input, Collapse, Tag, Empty, Badge, Drawer, Table, notification, Grid } from 'antd';\r\nimport AppAvatar from './AppAvatar';\r\nimport {\r\n  HourglassOutlined,\r\n  CaretUpOutlined,\r\n  FolderOutlined,\r\n  DatabaseOutlined,\r\n  CheckCircleOutlined,\r\n  CheckOutlined,\r\n  InboxOutlined,\r\n  RightOutlined,\r\n  FileTextOutlined,\r\n  \r\n  ExclamationCircleOutlined,\r\n  FileDoneOutlined,\r\n  MessageOutlined,\r\n  SafetyCertificateOutlined,\r\n  ProfileOutlined,\r\n  FileSearchOutlined,\r\n  MailOutlined,\r\n} from '@ant-design/icons';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { documentsAPI, contactAPI, getAbsoluteApiUrl, axiosInstance } from '../services/api';\r\n\r\n\r\ninterface DocumentRequest {\r\n  _id?: string;\r\n  type?: string;\r\n  title?: string;\r\n  description?: string;\r\n  username?: string;\r\n  barangayID?: string;\r\n  dateRequested?: string;\r\n  status?: string;\r\n  [key: string]: any;\r\n}\r\n\r\nconst StaffDashboard: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState(false);\r\n  const [documentRequests, setDocumentRequests] = useState<DocumentRequest[]>([]);\r\n  const [inquiries, setInquiries] = useState<any[]>([]);\r\n  const [inboxInquiries, setInboxInquiries] = useState<any[]>([]);\r\n  const [viewedInquiryIds, setViewedInquiryIds] = useState<Set<string>>(() => {\r\n    try {\r\n      const raw = localStorage.getItem('viewedInquiries');\r\n      const arr = raw ? JSON.parse(raw) as string[] : [];\r\n      return new Set(arr || []);\r\n    } catch (e) {\r\n      return new Set<string>();\r\n    }\r\n  });\r\n\r\n  const markInquiryViewed = (id?: string) => {\r\n    if (!id) return;\r\n    setViewedInquiryIds(prev => {\r\n      const next = new Set(Array.from(prev));\r\n      next.add(String(id));\r\n      try { localStorage.setItem('viewedInquiries', JSON.stringify(Array.from(next))); } catch (e) {}\r\n      return next;\r\n    });\r\n  };\r\n\r\n  // Handle responding to an inquiry from the Inquiry Response modal\r\n  const handleInquiryResponse = async () => {\r\n    if (!selectedInquiry) return;\r\n    const id = selectedInquiry._id || selectedInquiry.id;\r\n    if (!id) return;\r\n    try {\r\n      notification.info({ message: 'Sending response', description: 'Posting your reply...', duration: 1.2 });\r\n      await contactAPI.respondToInquiry(id, { response: responseText });\r\n      // Update local inquiries list if present\r\n      setInquiries(prev => (prev || []).map(q => (q && (q._id === id || q.id === id)) ? { ...q, status: 'resolved' } : q));\r\n      notification.success({ message: 'Response sent', description: 'Inquiry has been updated' });\r\n      setSelectedInquiry(null);\r\n      setResponseText('');\r\n    } catch (err: any) {\r\n      console.error('Failed to send inquiry response', err);\r\n      const msg = err?.response?.data?.message || err?.message || 'Failed to send response';\r\n      notification.error({ message: 'Error', description: msg });\r\n    }\r\n  };\r\n  \r\n  // Mini announcements (replace Recent Activity)\r\n  const [miniAnns, setMiniAnns] = useState<any[]>([]);\r\n  const [miniLoading, setMiniLoading] = useState(false);\r\n  const [miniSelected, setMiniSelected] = useState<any | null>(null);\r\n  const [drawerVisible, setDrawerVisible] = useState(false);\r\n  const [selectedDocument, setSelectedDocument] = useState<DocumentRequest | null>(null);\r\n  const [selectedInquiry, setSelectedInquiry] = useState<any>(null);\r\n  const [manageModalVisible, setManageModalVisible] = useState(false);\r\n  const [manageTableData, setManageTableData] = useState<any[] | null>(null);\r\n  const [responseText, setResponseText] = useState('');\r\n  const [documentStatus, setDocumentStatus] = useState('');\r\n  const [responding] = useState(false);\r\n  const [completedModalVisible, setCompletedModalVisible] = useState(false);\r\n  // Documents modal state\r\n  const [docsModalVisible, setDocsModalVisible] = useState(false);\r\n  const [allDocuments, setAllDocuments] = useState<any[]>([]);\r\n  const [docsLoading, setDocsLoading] = useState(false);\r\n  const [previewVisible, setPreviewVisible] = useState(false);\r\n  const [previewDoc, setPreviewDoc] = useState<any | null>(null);\r\n  const [docsSearch, setDocsSearch] = useState<string>('');\r\n  const screens = Grid.useBreakpoint();\r\n\r\n  // Group document requests by type for processing\r\n  const requestsByCategory: { [type: string]: DocumentRequest[] } = {};\r\n  documentRequests.forEach((req) => {\r\n    const docType = req.type || 'Unknown';\r\n    if (!requestsByCategory[docType]) requestsByCategory[docType] = [];\r\n    requestsByCategory[docType].push(req);\r\n  });\r\n\r\n  // Example stats for staff\r\n  const [stats, setStats] = useState({\r\n    pendingRequests: 0,\r\n    totalDocuments: 0,\r\n    completedRequests: 0,\r\n  });\r\n\r\n  // Group requests by category\r\n  const categorizeRequests = (requests: DocumentRequest[]) => {\r\n    const categories = {\r\n      'Certificates': {\r\n        icon: <SafetyCertificateOutlined style={{ fontSize: '18px', color: '#1890ff' }} />,\r\n        items: [] as DocumentRequest[],\r\n        color: '#1890ff',\r\n        description: 'Birth, Death, Residency Certificates and more'\r\n      },\r\n      'Permits': {\r\n        icon: <ProfileOutlined style={{ fontSize: '18px', color: '#52c41a' }} />,\r\n        items: [] as DocumentRequest[],\r\n        color: '#52c41a',\r\n        description: 'Building, Business, and Special Event Permits'\r\n      }\r\n      ,\r\n      'Complete': {\r\n        icon: <FileDoneOutlined style={{ fontSize: '18px', color: '#52c41a' }} />,\r\n        items: [] as DocumentRequest[],\r\n        color: '#52c41a',\r\n        description: 'All completed and approved document requests'\r\n      }\r\n    };\r\n\r\n    requests.forEach(req => {\r\n      const type = (req.type || '').toLowerCase();\r\n      const status = (req.status || '').toLowerCase();\r\n      if (type.includes('certificate') || type.includes('certification')) {\r\n        categories['Certificates'].items.push(req);\r\n      } else if (type.includes('permit')) {\r\n        categories['Permits'].items.push(req);\r\n      }\r\n\r\n      // Add to Complete category if status is approved/completed\r\n      if (status === 'approved' || status === 'completed') {\r\n        categories['Complete'].items.push(req);\r\n      }\r\n    });\r\n\r\n    return categories;\r\n  };\r\n\r\n  // Download processed document (handles both metadata id and direct GridFS file id)\r\n  const handleDownloadProcessed = async (rec: any) => {\r\n    try {\r\n      // Follow TemplatesManager behavior: fetch the raw endpoint, convert to blob, and save using the server-provided filename when available.\r\n      // Try metadata id first, then fall back to gridFsFileId if present and the first attempt 404s.\r\n      const normalizeId = (v: any): string | null => {\r\n        if (!v && v !== 0) return null;\r\n        if (typeof v === 'string') return v;\r\n        if (typeof v === 'object') {\r\n          // Mongoose ObjectId-like objects may expose $oid (BSON) or toString()\r\n          if (typeof v.$oid === 'string') return v.$oid;\r\n          try {\r\n            const s = (v as any).toString();\r\n            if (s && s !== '[object Object]') return s;\r\n          } catch (e) {}\r\n          return null;\r\n        }\r\n        return String(v);\r\n      };\r\n\r\n      const tryIds = [] as string[];\r\n      const nid = normalizeId(rec && rec._id);\r\n      const ngfid = normalizeId(rec && rec.gridFsFileId);\r\n      if (nid) tryIds.push(nid);\r\n      if (ngfid) tryIds.push(ngfid);\r\n      // de-dupe\r\n      const ids = Array.from(new Set(tryIds));\r\n      \r\n      let usedId: string | null = null;\r\n      let lastError: any = null;\r\n\r\n      console.debug('[handleDownloadProcessed] record:', rec, 'candidateIds:', ids);\r\n      let finalBlob: Blob | null = null;\r\n      let finalHeaders: any = null;\r\n      for (const id of ids) {\r\n        try {\r\n          console.debug('[handleDownloadProcessed] attempting id=', id);\r\n          const r = await (await import('../services/api')).axiosInstance.get(`/processed-documents/${id}/raw`, { responseType: 'blob' });\r\n          if (r && r.status >= 200 && r.status < 300) {\r\n            finalBlob = r.data as Blob;\r\n            finalHeaders = r.headers || {};\r\n            usedId = id;\r\n            break;\r\n          }\r\n        } catch (err: any) {\r\n          const status = err && err.response && err.response.status ? err.response.status : null;\r\n          if (status === 404) {\r\n            lastError = { status: 404, body: err.response && err.response.data ? err.response.data : null };\r\n            continue;\r\n          }\r\n          notification.error({ message: 'Download failed', description: status ? `Server returned ${status}` : String(err) });\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (!finalBlob) {\r\n        const msg = lastError && lastError.body && lastError.body.message ? lastError.body.message : (lastError && lastError.message) ? lastError.message : 'File not found';\r\n        notification.error({ message: 'Download failed', description: msg });\r\n        return;\r\n      }\r\n\r\n      const blob = finalBlob;\r\n\r\n      // Prefer filename from Content-Disposition header if provided\r\n      let filename: string | null = null;\r\n      const cd = (finalHeaders && (finalHeaders['content-disposition'] || finalHeaders['Content-Disposition'])) || null;\r\n      if (cd) {\r\n        const m = cd.match(/filename\\*=UTF-8''([^;\\n\\r]+)/i);\r\n        if (m && m[1]) filename = decodeURIComponent(m[1]);\r\n        else {\r\n          const m2 = cd.match(/filename=\"?([^\";]+)\"?/i);\r\n          if (m2 && m2[1]) filename = m2[1];\r\n        }\r\n      }\r\n      // Fallback to X-Processed headers or record fields\r\n      if (!filename) filename = (finalHeaders && (finalHeaders['x-processed-transactioncode'] || finalHeaders['X-Processed-TransactionCode'])) || rec.filename || rec.name || `document_${usedId || rec._id}.docx`;\r\n\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      const downloadName = filename || `document_${usedId || rec._id}.docx`;\r\n      a.download = downloadName;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      a.remove();\r\n      window.URL.revokeObjectURL(url);\r\n    } catch (err) {\r\n      console.error('Download error', err);\r\n      notification.error({ message: 'Download error', description: String(err) });\r\n    }\r\n  };\r\n\r\n  const getStatusTag = (status?: string) => {\r\n    const statusColors: { [key: string]: string } = {\r\n      'pending': 'gold',\r\n      'approved': 'success',\r\n      'rejected': 'error',\r\n      'processing': 'processing'\r\n    };\r\n\r\n    return (\r\n      <Tag color={statusColors[status?.toLowerCase() || 'default']}>\r\n        {status?.toUpperCase() || 'UNKNOWN'}\r\n      </Tag>\r\n    );\r\n  };\r\n\r\n  \r\n\r\n  const fetchData = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      // Fetch document records from /documents (not /document-requests/all)\r\n      const [docRecords, inq] = await Promise.all([\r\n        documentsAPI.getDocumentRecords(),\r\n        contactAPI.getAllInquiries()\r\n      ]);\r\n      setDocumentRequests(docRecords);\r\n      setInquiries(inq);\r\n      // Filter for inbox: assignedRole matches user.role or assignedTo includes user._id\r\n      const filtered = inq.filter((inq: any) =>\r\n        (inq.assignedRole && user && inq.assignedRole === user.role) ||\r\n        (inq.assignedTo && Array.isArray(inq.assignedTo) && user && inq.assignedTo.includes(user._id))\r\n      );\r\n      setInboxInquiries(filtered);\r\n      // Attempt to get count of processed documents from server-side processed_documents metadata\r\n      let processedCount = docRecords.length;\r\n      try {\r\n        const resp = await axiosInstance.get('/processed-documents', { params: { page: 1, limit: 1 } });\r\n        const j = resp && resp.data ? resp.data : null;\r\n        if (j && typeof j.total === 'number') processedCount = j.total;\r\n      } catch (e) {\r\n        // ignore and fall back to docRecords.length\r\n      }\r\n\r\n      setStats({\r\n        pendingRequests: docRecords.filter((d: any) => d.status === 'pending').length,\r\n        totalDocuments: processedCount,\r\n        completedRequests: docRecords.filter((d: any) => d.status === 'approved').length,\r\n      });\r\n    } catch (error) {\r\n      console.error('Error fetching data:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user]);\r\n\r\n  const fetchMiniAnnouncements = useCallback(async () => {\r\n    setMiniLoading(true);\r\n    try {\r\n      const data = await contactAPI.getAnnouncements();\r\n      setMiniAnns(Array.isArray(data) ? data.slice(0, 6) : []);\r\n    } catch (err) {\r\n      console.error('Failed to load mini announcements', err);\r\n      setMiniAnns([]);\r\n    } finally {\r\n      setMiniLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n    fetchMiniAnnouncements();\r\n  }, [fetchData, fetchMiniAnnouncements]);\r\n\r\n  // Fetch processed documents (from documents collection) and open modal\r\n  const fetchAllProcessedDocuments = async () => {\r\n    setDocsLoading(true);\r\n    try {\r\n      // Prefer processed_documents metadata endpoint; fallback to older documents listing\r\n      let processedItems: any[] = [];\r\n      try {\r\n        const resp = await axiosInstance.get('/processed-documents', { params: { page: 1, limit: 200 } });\r\n        const j = resp && resp.data ? resp.data : null;\r\n        if (j && Array.isArray(j.items)) {\r\n          processedItems = j.items;\r\n        } else if (Array.isArray(j)) {\r\n          processedItems = j as any[];\r\n        }\r\n      } catch (e) {\r\n        // fallback to older endpoints\r\n        try {\r\n          const files: any = await documentsAPI.listFiles();\r\n          const arr = Array.isArray(files) ? files : (files && files.data) ? files.data : [];\r\n          processedItems = arr.filter((d: any) => {\r\n            const s = (d.status || '').toString().toLowerCase();\r\n            return ['processed', 'approved', 'completed'].includes(s) || d.processed === true;\r\n          });\r\n        } catch (e2) {\r\n          processedItems = [];\r\n        }\r\n      }\r\n\r\n      setAllDocuments(processedItems || []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch documents for modal', err);\r\n      setAllDocuments([]);\r\n    } finally {\r\n      setDocsLoading(false);\r\n      setDocsModalVisible(true);\r\n    }\r\n  };\r\n\r\n  \r\n\r\n  // Handle approve/reject/other document actions from Document Response modal\r\n  const handleDocumentAction = async () => {\r\n    if (!selectedDocument) return;\r\n    const id = selectedDocument._id || selectedDocument.id;\r\n    if (!id) return;\r\n    try {\r\n      // Use documentsAPI to update status; server expects lowercase status strings\r\n      const payload = { status: (documentStatus || '').toString().toLowerCase(), notes: responseText };\r\n      // Show a short in-UI indicator using notification\r\n      notification.info({ message: 'Processing', description: `Updating document status to ${payload.status}...`, duration: 1.2 });\r\n      await documentsAPI.updateDocumentStatus(id, payload);\r\n      // Update local list if present\r\n      setDocumentRequests(prev => (prev || []).map(d => d && (d._id === id || d.id === id) ? { ...d, status: payload.status } : d));\r\n      notification.success({ message: 'Success', description: `Document marked ${payload.status}` });\r\n      // Clear modal and fields\r\n      setSelectedDocument(null);\r\n      setResponseText('');\r\n      setDocumentStatus('');\r\n    } catch (err: any) {\r\n      console.error('Failed to update document status', err);\r\n      const msg = err?.response?.data?.message || err?.message || 'Failed to update document';\r\n      notification.error({ message: 'Error', description: msg });\r\n    }\r\n  };\r\n\r\n  // Format helpers\r\n  // Helper to format document type for display\r\n  function formatDocumentType(type?: string) {\r\n    if (!type) return 'Unknown';\r\n    // If you have a typeToCategory mapping, use it here\r\n    // let name = typeToCategory[type] || type;\r\n    let name = type;\r\n    // Remove 'Other' prefix and extra spaces\r\n    name = name.replace(/^Other\\s*/i, '').trim();\r\n    // Replace underscores with spaces and capitalize each word\r\n    return name\r\n      .split('_')\r\n      .map(word => {\r\n        const w = word || '';\r\n        return w.length > 0 ? (w.charAt(0).toUpperCase() + w.slice(1).toLowerCase()) : '';\r\n      })\r\n      .filter(Boolean)\r\n      .join(' ');\r\n  }\r\n\r\n  // Helper to format date for display\r\n  function formatDate(dateString?: string) {\r\n    if (!dateString) return '';\r\n    const date = new Date(dateString);\r\n    return date.toLocaleString();\r\n  }\r\n\r\n  // Sort an array of inquiries/documents by createdAt descending (newest first)\r\n  const sortByDateDesc = (arr: any[] = []) => {\r\n    return (arr || []).slice().sort((a: any, b: any) => {\r\n      const ta = a && a.createdAt ? new Date(a.createdAt).getTime() : 0;\r\n      const tb = b && b.createdAt ? new Date(b.createdAt).getTime() : 0;\r\n      return tb - ta;\r\n    });\r\n  };\r\n\r\n  // Only one List for Document Categories will be rendered below in the Card section\r\n  // (Card/Col/Row structure continues below)\r\n\r\n  const goWithState = (path: string, state?: any) => {\r\n    navigate(path, { state });\r\n  };\r\n\r\n  const go = (path: string) => {\r\n    try {\r\n      navigate(path);\r\n    } catch (e) {\r\n      window.location.href = path;\r\n    }\r\n  };\r\n\r\n  // No replacement needed - removing the duplicate function\r\n\r\n  return (\r\n    <Spin spinning={loading} tip=\"Loading...\">\r\n      <div>\r\n        {/* KPI Cards Row */}\r\n        <Row gutter={[16, 16]} style={{ marginBottom: 24 }}>\r\n          <Col xs={24} sm={12} md={6}>\r\n            <Card \r\n              hoverable \r\n              bordered={false}\r\n              size=\"small\"\r\n              onClick={() => {\r\n                // If there are pending requests, navigate to document processing and open the first one\r\n                const pending = documentRequests.find(d => d.status === 'pending');\r\n                if (pending && pending._id) {\r\n                  goWithState('/document-processing', { openRequestId: pending._id });\r\n                } else {\r\n                  goWithState('/document-processing');\r\n                }\r\n              }} \r\n              style={{ \r\n                cursor: 'pointer',\r\n                transition: 'all 0.3s',\r\n                boxShadow: '0 1px 2px rgba(0,0,0,0.05)'\r\n              }}\r\n            >\r\n              <Statistic\r\n                title={\r\n                  <Space>\r\n                    <AppAvatar size=\"small\" background=\"#fff7e6\" color=\"#faad14\" icon={<HourglassOutlined style={{ fontSize: '14px' }} />} />\r\n                    <span>Pending Requests</span>\r\n                  </Space>\r\n                }\r\n                value={stats.pendingRequests}\r\n                valueStyle={{ color: '#faad14', fontSize: '28px', marginBottom: '4px' }}\r\n                prefix={<CaretUpOutlined style={{ fontSize: '16px' }} />}\r\n              />\r\n              <Typography.Link style={{ fontSize: '13px', color: '#faad14' }}>\r\n                View Pending Requests\r\n                <RightOutlined style={{ fontSize: '11px', marginLeft: '4px' }} />\r\n              </Typography.Link>\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} md={6}>\r\n            <Card \r\n              hoverable \r\n              bordered={false}\r\n              size=\"small\"\r\n              onClick={() => fetchAllProcessedDocuments()} \r\n              style={{ \r\n                cursor: 'pointer',\r\n                transition: 'all 0.3s',\r\n                boxShadow: '0 1px 2px rgba(0,0,0,0.05)'\r\n              }}\r\n            >\r\n              <Statistic\r\n                title={\r\n                  <Space>\r\n                    <AppAvatar size=\"small\" background=\"#e6f7ff\" color=\"#1890ff\" icon={<FolderOutlined style={{ fontSize: '14px' }} />} />\r\n                    <span>Total Documents</span>\r\n                  </Space>\r\n                }\r\n                value={stats.totalDocuments}\r\n                valueStyle={{ color: '#1890ff', fontSize: '28px', marginBottom: '4px' }}\r\n                prefix={<DatabaseOutlined style={{ fontSize: '16px' }} />}\r\n              />\r\n              <Typography.Link style={{ fontSize: '13px', color: '#1890ff' }}>\r\n                Browse Documents\r\n                <RightOutlined style={{ fontSize: '11px', marginLeft: '4px' }} />\r\n              </Typography.Link>\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} md={6}>\r\n            <Card \r\n              hoverable \r\n              bordered={false}\r\n              size=\"small\"\r\n              onClick={() => setCompletedModalVisible(true)} \r\n              style={{ \r\n                cursor: 'pointer',\r\n                transition: 'all 0.3s',\r\n                boxShadow: '0 1px 2px rgba(0,0,0,0.05)'\r\n              }}\r\n            >\r\n              <Statistic\r\n                title={\r\n                  <Space>\r\n                    <AppAvatar size=\"small\" background=\"#f6ffed\" color=\"#52c41a\" icon={<CheckCircleOutlined style={{ fontSize: '14px' }} />} />\r\n                    <span>Completed Requests</span>\r\n                  </Space>\r\n                }\r\n                value={stats.completedRequests}\r\n                valueStyle={{ color: '#52c41a', fontSize: '28px', marginBottom: '4px' }}\r\n                prefix={<CheckOutlined style={{ fontSize: '16px' }} />}\r\n              />\r\n              <Typography.Link style={{ fontSize: '13px', color: '#52c41a' }}>\r\n                View Completed\r\n                <RightOutlined style={{ fontSize: '11px', marginLeft: '4px' }} />\r\n              </Typography.Link>\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} sm={12} md={6}>\r\n            <Card \r\n              hoverable \r\n              bordered={false}\r\n              size=\"small\"\r\n              onClick={() => go('/staff/inbox')} \r\n              style={{ \r\n                cursor: 'pointer',\r\n                transition: 'all 0.3s',\r\n                boxShadow: '0 1px 2px rgba(0,0,0,0.05)'\r\n              }}\r\n            >\r\n              <Statistic\r\n                title={\r\n                  <Space>\r\n                    <AppAvatar size=\"small\" background=\"#f9f0ff\" color=\"#722ed1\" icon={<InboxOutlined style={{ fontSize: '14px' }} />} />\r\n                    <span>Staff Inbox</span>\r\n                  </Space>\r\n                }\r\n                value={inboxInquiries.length}\r\n                valueStyle={{ color: '#722ed1', fontSize: '28px', marginBottom: '4px' }}\r\n                prefix={<MessageOutlined style={{ fontSize: '16px' }} />}\r\n              />\r\n              <Typography.Link style={{ fontSize: '13px', color: '#722ed1' }}>\r\n                Open Inbox\r\n                <RightOutlined style={{ fontSize: '11px', marginLeft: '4px' }} />\r\n              </Typography.Link>\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n        {/* Main Content Cards */}\r\n        <Row gutter={[16, 16]}>\r\n          <Col xs={24} lg={8}>\r\n            <Card \r\n              title={<Space><FileSearchOutlined /> Document Categories</Space>} \r\n              hoverable\r\n              bordered={false}\r\n              size=\"small\"\r\n              className=\"dashboard-card\"\r\n              style={{ \r\n                transition: 'all 0.3s',\r\n                boxShadow: '0 1px 2px rgba(0,0,0,0.05)'\r\n              }}\r\n              styles={{ body: { \r\n                padding: '0',\r\n                height: '400px',\r\n                maxHeight: '400px',\r\n                overflow: 'hidden'\r\n              } }}\r\n            >\r\n              <Collapse\r\n                defaultActiveKey={['Certificates']}\r\n                expandIcon={({ isActive }) => <RightOutlined rotate={isActive ? 90 : 0} />}\r\n                style={{ \r\n                  background: 'white',\r\n                  height: '400px',\r\n                  overflowY: 'auto'\r\n                }}\r\n              >\r\n                {Object.entries(categorizeRequests(documentRequests)).map(([category, data]) => {\r\n                  const pendingCount = data.items.filter((req: DocumentRequest) => req.status?.toLowerCase() === 'pending').length;\r\n                  return (\r\n                    <Collapse.Panel\r\n                      key={category}\r\n                      header={\r\n                        <div style={{ display: 'flex', alignItems: 'center', width: '100%' }}>\r\n                          <Space align=\"center\">\r\n                            <AppAvatar size=\"small\" background={data.color + '15'} color={data.color} icon={data.icon} />\r\n                            <span style={{ fontWeight: 500, fontSize: '14px' }}>{category}</span>\r\n                          </Space>\r\n                          <div style={{ marginLeft: 'auto', display: 'flex', gap: '8px', alignItems: 'center' }}>\r\n                            {pendingCount > 0 && (\r\n                              <Tag color=\"gold\" style={{ marginRight: 0 }}>\r\n                                {pendingCount} pending\r\n                              </Tag>\r\n                            )}\r\n                            <Badge \r\n                              count={data.items.length} \r\n                              style={{ backgroundColor: data.color }}\r\n                              size=\"small\"\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      }\r\n                    >\r\n                      <div style={{ marginBottom: '16px' }}>\r\n                        <Typography.Text type=\"secondary\" style={{ fontSize: '13px' }}>\r\n                          {data.description}\r\n                        </Typography.Text>\r\n                      </div>\r\n                      \r\n                      <List\r\n                        size=\"small\"\r\n                        dataSource={data.items.slice(0, 5)}\r\n                        split={true}\r\n                        renderItem={request => {\r\n                          const statusColors = {\r\n                            PENDING: { color: '#faad14', bg: '#fff7e6' },\r\n                            APPROVED: { color: '#52c41a', bg: '#f6ffed' },\r\n                            REJECTED: { color: '#ff4d4f', bg: '#fff1f0' },\r\n                            DEFAULT: { color: '#8c8c8c', bg: '#f5f5f5' }\r\n                          };\r\n                          \r\n                          const status = request.status?.toUpperCase() || 'DEFAULT';\r\n                          const statusStyle = statusColors[status as keyof typeof statusColors] || statusColors.DEFAULT;\r\n\r\n                          return (\r\n                            <List.Item\r\n                              onClick={() => navigate('/document-processing', { state: { openRequestId: request._id } })}\r\n                              actions={[\r\n                                request.status === 'PENDING' && (\r\n                                  <Space size={4}>\r\n                                    <Button\r\n                                      type=\"text\"\r\n                                      size=\"small\"\r\n                                      icon={<CheckOutlined style={{ color: '#52c41a' }} />}\r\n                                      onClick={(e) => { e.stopPropagation(); setSelectedDocument(request); setDocumentStatus('APPROVED'); }}\r\n                                    />\r\n                                    <Button\r\n                                      type=\"text\"\r\n                                      size=\"small\"\r\n                                      icon={<ExclamationCircleOutlined style={{ color: '#ff4d4f' }} />}\r\n                                      onClick={(e) => { e.stopPropagation(); setSelectedDocument(request); setDocumentStatus('REJECTED'); }}\r\n                                    />\r\n                                  </Space>\r\n                                )\r\n                              ].filter(Boolean)}\r\n                              style={{ padding: '12px 0' }}\r\n                            >\r\n                              <List.Item.Meta\r\n                                avatar={\r\n                                  <AppAvatar\r\n                                    size={36}\r\n                                    background={statusStyle.bg}\r\n                                    color={statusStyle.color}\r\n                                    icon={<FileTextOutlined />}\r\n                                  />\r\n                                }\r\n                                title={\r\n                                  <Space size={8} style={{ marginBottom: 4 }}>\r\n                                    <Typography.Text strong style={{ fontSize: '14px' }}>\r\n                                      {formatDocumentType(request.type || request.title)}\r\n                                    </Typography.Text>\r\n                                    <Tag\r\n                                      color={statusStyle.color}\r\n                                      style={{ \r\n                                        margin: 0,\r\n                                        padding: '0 6px',\r\n                                        fontSize: '12px',\r\n                                        lineHeight: '18px'\r\n                                      }}\r\n                                    >\r\n                                      {status}\r\n                                    </Tag>\r\n                                  </Space>\r\n                                }\r\n                                description={\r\n                                  <Space direction=\"vertical\" size={0}>\r\n                                    <Typography.Text type=\"secondary\" style={{ fontSize: '13px' }}>\r\n                                      Requested by: {request.username || 'Unknown'}\r\n                                    </Typography.Text>\r\n                                    <Typography.Text type=\"secondary\" style={{ fontSize: '12px' }}>\r\n                                      {formatDate(request.dateRequested || '')}\r\n                                    </Typography.Text>\r\n                                  </Space>\r\n                                }\r\n                              />\r\n                            </List.Item>\r\n                          );\r\n                        }}\r\n                        locale={{ \r\n                          emptyText: (\r\n                            <Empty \r\n                              image={Empty.PRESENTED_IMAGE_SIMPLE} \r\n                              description={\r\n                                <Typography.Text type=\"secondary\">\r\n                                  No {category.toLowerCase()} requests\r\n                                </Typography.Text>\r\n                              }\r\n                            />\r\n                          )\r\n                        }}\r\n                      />\r\n                      {data.items.length > 0 && (\r\n                        <div style={{ \r\n                          textAlign: 'center', \r\n                          marginTop: '16px',\r\n                          paddingTop: '16px',\r\n                          borderTop: '1px solid #f0f0f0'\r\n                        }}>\r\n                          <Button\r\n                            type=\"link\"\r\n                            size=\"small\"\r\n                            icon={data.icon}\r\n                            onClick={() => go('/documents')}\r\n                          >\r\n                            View All {category}\r\n                          </Button>\r\n                        </div>\r\n                      )}\r\n                    </Collapse.Panel>\r\n                  );\r\n                })}\r\n              </Collapse>\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} lg={8}>\r\n              <Card \r\n              title={\r\n                <Space>\r\n                  <MailOutlined />\r\n                  <span>Inquiries Inbox</span>\r\n                  <Badge \r\n                    count={inboxInquiries.filter(i => i.status === 'open' || i.status === 'PENDING').length} \r\n                    style={{ backgroundColor: '#722ed1' }}\r\n                  />\r\n                </Space>\r\n              }\r\n              extra={\r\n                <Space>\r\n                  <Statistic\r\n                    value={inboxInquiries.length}\r\n                    suffix=\"total\"\r\n                    valueStyle={{ fontSize: '14px', color: '#8c8c8c' }}\r\n                  />\r\n                </Space>\r\n              }\r\n              hoverable\r\n              bordered={false}\r\n              size=\"small\"\r\n              className=\"dashboard-card\"\r\n              style={{ \r\n                transition: 'all 0.3s',\r\n                boxShadow: '0 1px 2px rgba(0,0,0,0.05)',\r\n                position: 'relative'\r\n              }}\r\n              styles={{ body: { \r\n                height: '400px',\r\n                maxHeight: '400px',\r\n                padding: 0,\r\n                overflow: 'hidden'\r\n              } }}\r\n            >\r\n              <div style={{ padding: '0 12px' }}>\r\n                <Collapse\r\n                  accordion={false}\r\n                  defaultActiveKey={[ 'open' ]}\r\n                  expandIcon={({ isActive }) => <RightOutlined rotate={isActive ? 90 : 0} />}\r\n                  style={{ background: 'white' }}\r\n                >\r\n                  <Collapse.Panel\r\n                    key=\"open\"\r\n                    header={\r\n                      <div style={{ display: 'flex', alignItems: 'center', width: '100%' }}>\r\n                        <Space align=\"center\">\r\n                          <MailOutlined style={{ color: '#722ed1', fontSize: '16px' }} />\r\n                          <Typography.Text strong>Open Inquiries</Typography.Text>\r\n                          <Badge count={inboxInquiries.filter(i => i.status === 'PENDING' || i.status === 'open').length} style={{ backgroundColor: '#722ed1' }} />\r\n                        </Space>\r\n                      </div>\r\n                    }\r\n                  >\r\n                    <div style={{ maxHeight: 300, overflowY: 'auto', paddingRight: 8 }}>\r\n                      {inboxInquiries.filter(i => i.status === 'PENDING' || i.status === 'open').length === 0 ? (\r\n                        <Empty image={Empty.PRESENTED_IMAGE_SIMPLE} description={<Typography.Text type=\"secondary\">No open inquiries</Typography.Text>} />\r\n                      ) : (\r\n            <List\r\n                size=\"large\"\r\n              dataSource={sortByDateDesc(inboxInquiries.filter(i => i.status === 'PENDING' || i.status === 'open'))}\r\n                          renderItem={inquiry => {\r\n                  const isOpen = inquiry.status === 'PENDING' || inquiry.status === 'open';\r\n          const avatarColor = isOpen ? '#722ed1' : '#8c8c8c';\r\n          const avatarBg = isOpen ? '#f9f0ff' : '#f5f5f5';\r\n          const isViewed = inquiry._id && viewedInquiryIds.has(String(inquiry._id));\r\n\r\n          const displayName = inquiry.username || inquiry.residentName || inquiry.subject || 'Unknown';\r\n          const letter = (displayName && displayName !== 'Unknown' && displayName.length > 0) ? displayName.charAt(0).toUpperCase() : '?';\r\n\r\n                      return (\r\n                        <List.Item\r\n                      style={{ \r\n                        padding: '18px 20px',\r\n                        minHeight: 72,\r\n                        borderBottom: '1px solid #f0f0f0',\r\n                        transition: 'all 0.3s ease',\r\n                        cursor: 'pointer',\r\n                        backgroundColor: 'white'\r\n                      }}\r\n                      onClick={() => {\r\n                        // mark as viewed locally so the dot color changes (persisted)\r\n                        if (inquiry._id) markInquiryViewed(String(inquiry._id));\r\n                        navigate('/staff/inbox', { state: { openInquiryId: inquiry._id } });\r\n                      }}\r\n                      onMouseEnter={(e) => {\r\n                        e.currentTarget.style.backgroundColor = '#fafafa';\r\n                      }}\r\n                      onMouseLeave={(e) => {\r\n                        e.currentTarget.style.backgroundColor = 'white';\r\n                      }}\r\n                      \r\n                      >\r\n                      <List.Item.Meta\r\n                        avatar={\r\n                          <Badge dot={isOpen} color={isOpen && !isViewed ? '#faad14' : '#722ed1'} offset={[-6, 6]}>\r\n                            <AppAvatar\r\n                              size={40}\r\n                              style={{\r\n                                backgroundColor: avatarBg,\r\n                                color: avatarColor,\r\n                                fontSize: '15px',\r\n                                fontWeight: 600\r\n                              }}\r\n                            >\r\n                              {letter}\r\n                            </AppAvatar>\r\n                          </Badge>\r\n                        }\r\n                        title={\r\n                          <div style={{ \r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            gap: '8px',\r\n                            marginBottom: 0\r\n                          }}>\r\n                            <div style={{ \r\n                              fontSize: '14px',\r\n                              fontWeight: 600,\r\n                              color: 'rgba(0, 0, 0, 0.85)'\r\n                            }}>\r\n                              {inquiry.username || 'Unknown User'}\r\n                            </div>\r\n                            <Tag \r\n                              color={isOpen ? 'gold' : 'success'}\r\n                              style={{ \r\n                                margin: 0,\r\n                                fontSize: '12px',\r\n                                lineHeight: '20px',\r\n                                height: '22px',\r\n                                padding: '0 10px',\r\n                                fontWeight: 'normal',\r\n                                borderRadius: '4px'\r\n                              }}\r\n                            >\r\n                              {isOpen ? 'PENDING' : 'RESOLVED'}\r\n                            </Tag>\r\n                            {isOpen && !isViewed && (\r\n                              <Tag\r\n                                color=\"default\"\r\n                                onClick={(e) => { e.stopPropagation(); if (inquiry._id) markInquiryViewed(String(inquiry._id)); }}\r\n                                style={{ marginLeft: 8, cursor: 'pointer', background: '#fff7e6', color: '#d48806', border: '1px solid #ffd591' }}\r\n                              >\r\n                                UNREAD\r\n                              </Tag>\r\n                            )}\r\n                          </div>\r\n                        }\r\n                        description={\r\n                          <div style={{ display: 'flex', alignItems: 'center', gap: '12px', width: '100%' }}>\r\n                            <Typography.Text\r\n                              style={{ \r\n                                fontSize: '13px',\r\n                                color: 'rgba(0, 0, 0, 0.65)',\r\n                                flexGrow: 1,\r\n                                whiteSpace: 'nowrap',\r\n                                overflow: 'hidden',\r\n                                textOverflow: 'ellipsis',\r\n                                lineHeight: '1.5'\r\n                              }}\r\n                            >\r\n                              {inquiry.message}\r\n                            </Typography.Text>\r\n                            <Typography.Text \r\n                              type=\"secondary\" \r\n                              style={{ \r\n                                fontSize: '12px', \r\n                                flexShrink: 0,\r\n                                color: '#8c8c8c'\r\n                              }}\r\n                            >\r\n                              {formatDate(inquiry.createdAt)}\r\n                            </Typography.Text>\r\n                          </div>\r\n                        }\r\n                      />\r\n                    </List.Item>\r\n                          );\r\n                        }}\r\n                      />\r\n                    )}\r\n                  </div>\r\n                </Collapse.Panel>\r\n                <Collapse.Panel\r\n                  key=\"resolved\"\r\n                  header={\r\n                    <div style={{ display: 'flex', alignItems: 'center', width: '100%' }}>\r\n                      <Space align=\"center\">\r\n                        <MailOutlined style={{ color: '#52c41a', fontSize: '16px' }} />\r\n                        <Typography.Text strong>Resolved Inquiries</Typography.Text>\r\n                        <Badge count={inboxInquiries.filter(i => !(i.status === 'PENDING' || i.status === 'open')).length} style={{ backgroundColor: '#52c41a' }} />\r\n                      </Space>\r\n                    </div>\r\n                  }\r\n                >\r\n                  <div style={{ maxHeight: 220, overflowY: 'auto', paddingRight: 8 }}>\r\n                    {inboxInquiries.filter(i => !(i.status === 'PENDING' || i.status === 'open')).length === 0 ? (\r\n                      <Empty image={Empty.PRESENTED_IMAGE_SIMPLE} description={<Typography.Text type=\"secondary\">No resolved inquiries</Typography.Text>} />\r\n                    ) : (\r\n                      <List\r\n                        size=\"small\"\r\n                        dataSource={sortByDateDesc(inboxInquiries.filter(i => !(i.status === 'PENDING' || i.status === 'open')))}\r\n                        renderItem={inquiry => {\r\n                          const avatarColor = '#8c8c8c';\r\n                          const avatarBg = '#f5f5f5';\r\n\r\n                          return (\r\n                            <List.Item\r\n                              style={{ padding: '12px 0', borderBottom: '1px solid #f0f0f0' }}\r\n                            onClick={() => {\r\n                              if (inquiry._id) markInquiryViewed(String(inquiry._id));\r\n                              setSelectedInquiry(inquiry);\r\n                            }}\r\n                            >\r\n                              <List.Item.Meta\r\n                                avatar={<AppAvatar size={40} style={{ backgroundColor: avatarBg, color: avatarColor, fontSize: 14 }}>{(inquiry.username || 'Unknown').charAt(0).toUpperCase()}</AppAvatar>}\r\n                                title={<div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n                                  <div style={{ fontSize: 13, fontWeight: 600 }}>{inquiry.username || 'Unknown User'}</div>\r\n                                  <Tag color=\"success\" style={{ margin: 0, fontSize: 12 }}>{'RESOLVED'}</Tag>\r\n                                </div>}\r\n                                description={<div style={{ fontSize: 12, color: '#888' }}>{inquiry.message}</div>}\r\n                              />\r\n                            </List.Item>\r\n                          );\r\n                        }}\r\n                      />\r\n                    )}\r\n                  </div>\r\n                </Collapse.Panel>\r\n              </Collapse>\r\n              {/* Manage button positioned at bottom-right of the card */}\r\n              <div style={{ position: 'absolute', right: 12, bottom: 12, zIndex: 40 }}>\r\n                <Button\r\n                  type=\"link\"\r\n                  style={{ position: 'absolute', right: 16, bottom: 0, fontSize: 13, color: '#1890ff', zIndex: 50, pointerEvents: 'auto' }}\r\n                  onClick={(e) => { try { e.stopPropagation(); } catch (err) {} ; navigate('/inquiry-tracker'); }}\r\n                >\r\n                  Expand\r\n                </Button>\r\n              </div>\r\n            </div>\r\n            </Card>\r\n          </Col>\r\n          <Col xs={24} lg={8}>\r\n            <Card\r\n              title={<Space><FileTextOutlined /> Announcements</Space>}\r\n              style={{ marginTop: 0, background: '#fafbfc', borderRadius: 12, boxShadow: '0 2px 8px #d9d9d933', border: '1px solid #f0f0f0', position: 'relative' }}\r\n              styles={{ body: { padding: 12 } }}\r\n              size=\"small\"\r\n              hoverable={false}\r\n            >\r\n              {miniAnns.length === 0 ? (\r\n                <Empty\r\n                  image={<FileTextOutlined style={{ fontSize: 42, color: '#d9d9d9' }} />}\r\n                  description={<span style={{ color: '#888' }}>No announcements</span>}\r\n                />\r\n              ) : (\r\n                <div style={{ maxHeight: 320, overflowY: 'auto', paddingRight: 6 }}>\r\n                  <List\r\n                    loading={miniLoading}\r\n                    dataSource={miniAnns}\r\n                    renderItem={(item) => (\r\n                      <List.Item style={{ cursor: 'pointer', padding: '10px 8px', alignItems: 'center' }} onClick={() => { setMiniSelected(item); setDrawerVisible(true); }}>\r\n                        <List.Item.Meta\r\n                          title={<div style={{ display: 'flex', alignItems: 'flex-start', gap: 8 }}>\r\n                            <div style={{ flex: 1, minWidth: 0 }}>\r\n                              <div style={{ fontWeight: 600, fontSize: 13, display: '-webkit-box', WebkitLineClamp: 3, WebkitBoxOrient: 'vertical', overflow: 'hidden', textOverflow: 'ellipsis', lineHeight: '1.2em' }}>{item.text || 'Untitled'}</div>\r\n                              <div style={{ fontSize: 12, color: '#888', marginTop: 6 }}>{new Date(item.createdAt).toLocaleString()}</div>\r\n                            </div>\r\n                          </div>}\r\n                          description={null}\r\n                        />\r\n                        {item.imagePath && (\r\n                          <div style={{ marginLeft: 12, width: 92, display: 'flex', justifyContent: 'flex-end', flexShrink: 0 }}>\r\n                            <img loading=\"lazy\" className=\"rounded-img\" src={getAbsoluteApiUrl(`/announcements/${item._id}/image`)} alt=\"ann\" style={{ width: 92, height: 60, objectFit: 'cover', borderRadius: 6, background: '#f0f0f0' }} />\r\n                          </div>\r\n                        )}\r\n                      </List.Item>\r\n                    )}\r\n                    size=\"small\"\r\n                  />\r\n                </div>\r\n              )}\r\n              <Button type=\"link\" style={{ position: 'absolute', right: 16, bottom: 0, fontSize: 13, color: '#1890ff' }} onClick={() => navigate('/admin/announcements')}>Manage</Button>\r\n\r\n              <Drawer open={drawerVisible} onClose={() => { setDrawerVisible(false); setMiniSelected(null); }} title=\"Announcement\" width={720} placement=\"right\">\r\n                {miniSelected && (\r\n                  <div>\r\n                    <Typography.Text style={{ display: 'block', marginBottom: 12, whiteSpace: 'pre-wrap' }}>{miniSelected.text}</Typography.Text>\r\n                    {miniSelected.imagePath && (\r\n                      <img loading=\"lazy\" className=\"rounded-img rounded-img-lg\" src={getAbsoluteApiUrl(`/announcements/${miniSelected._id}/image`)} alt=\"announcement\" style={{ width: '100%', height: 'auto', borderRadius: 8, background: '#f6f6f6' }} />\r\n                    )}\r\n                    <div style={{ marginTop: 8, color: '#888' }}>{new Date(miniSelected.createdAt).toLocaleString()}</div>\r\n                  </div>\r\n                )}\r\n              </Drawer>\r\n            </Card>\r\n\r\n            {/* Completed Requests card removed per user request */}\r\n          </Col>\r\n        </Row>\r\n        {/* Documents Modal - shows processed documents from documents collection */}\r\n        <Modal\r\n          open={docsModalVisible}\r\n          title={`Processed Documents (${allDocuments.length})`}\r\n          onCancel={() => { setDocsModalVisible(false); }}\r\n          footer={null}\r\n          width={screens.xs ? '95%' : screens.md ? 1000 : 1200}\r\n          styles={{ body: { padding: '12px 18px' } }}\r\n        >\r\n          <Spin spinning={docsLoading}>\r\n            <div style={{ display: 'flex', gap: 12, marginBottom: 12, flexDirection: screens.xs ? 'column' : 'row', alignItems: screens.xs ? 'stretch' : 'center' }}>\r\n              <Input.Search\r\n                placeholder=\"Search by title, filename, transaction code or uploader\"\r\n                allowClear\r\n                enterButton={false}\r\n                onSearch={(v) => setDocsSearch(String(v || '').trim())}\r\n                onChange={(e) => setDocsSearch(e.target.value)}\r\n                style={{ maxWidth: 420, flex: 1 }}\r\n                value={docsSearch}\r\n              />\r\n              <div style={{ marginLeft: 'auto', display: 'flex', gap: 8 }}>\r\n                <Button onClick={() => { setDocsSearch(''); }}>Clear</Button>\r\n                <Button type=\"primary\" onClick={() => { setAllDocuments(allDocuments.slice().sort((a,b) => new Date(b.createdAt||0).getTime() - new Date(a.createdAt||0).getTime())); }}>Sort Newest</Button>\r\n              </div>\r\n            </div>\r\n\r\n            <Table\r\n              dataSource={allDocuments.filter(d => {\r\n                if (!docsSearch) return true;\r\n                const q = docsSearch.toLowerCase();\r\n                const candidates = [d.title, d.filename, d.name, d.transactionCode, d.transactioncode, (d.uploadedBy && (d.uploadedBy.username || d.uploadedBy.name)) || d.uploadedBy || ''];\r\n                return candidates.some((c: any) => c && String(c).toLowerCase().includes(q));\r\n              })}\r\n              rowKey={(r: any) => r._id || r.id || r.filename}\r\n              pagination={{ pageSize: 10 }}\r\n              scroll={{ x: 'max-content' }}\r\n              columns={[\r\n                {\r\n                  title: 'Title',\r\n                  dataIndex: 'title',\r\n                  key: 'title',\r\n                  render: (t: any, r: any) => (\r\n                    <div style={{ display: 'flex', gap: 10, alignItems: 'center' }}>\r\n                      <AppAvatar size={36} icon={<FileTextOutlined />} />\r\n                      <div style={{ minWidth: 0 }}>\r\n                        <div style={{ fontWeight: 600, whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>{t || r.filename || r.name || 'Untitled'}</div>\r\n                        <div style={{ fontSize: 12, color: '#888' }}>{r.sourceTemplateName || r.templateName || ''}</div>\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                },\r\n                { title: 'Transaction', dataIndex: 'transactionCode', key: 'transactionCode', responsive: ['sm'], render: (v: any) => v || '-' },\r\n                { title: 'Uploaded By', dataIndex: 'uploadedBy', key: 'uploadedBy', responsive: ['md'], render: (u: any) => (u && (u.username || u.name)) || (typeof u === 'string' ? u : '-') },\r\n                { title: 'Date', dataIndex: 'createdAt', key: 'createdAt', responsive: ['sm'], render: (d: any) => formatDate(d) },\r\n                {\r\n                  title: 'Actions',\r\n                  key: 'action',\r\n                  width: 220,\r\n                  render: (_: any, rec: any) => (\r\n                    <Space>\r\n                      <Button size=\"small\" onClick={() => handleDownloadProcessed(rec)}>Download</Button>\r\n                      <Button size=\"small\" onClick={() => { setPreviewDoc(rec); setPreviewVisible(true); }}>Preview</Button>\r\n                      { (rec.transactionCode || rec.transactioncode) && (\r\n                        <Button size=\"small\" onClick={() => { navigator.clipboard?.writeText(rec.transactionCode || rec.transactioncode || ''); notification.success({ message: 'Copied', description: 'Transaction code copied to clipboard' }); }}>Copy TX</Button>\r\n                      ) }\r\n                    </Space>\r\n                  )\r\n                }\r\n              ]}\r\n            />\r\n          </Spin>\r\n          {/* Preview Drawer for a processed document */}\r\n          <Drawer\r\n            title={previewDoc ? (previewDoc.title || previewDoc.filename || 'Document') : 'Document'}\r\n            placement=\"right\"\r\n            onClose={() => { setPreviewVisible(false); setPreviewDoc(null); }}\r\n            open={previewVisible}\r\n            width={screens.xs ? '95%' : 560}\r\n          >\r\n            {previewDoc ? (\r\n              <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                  <div>\r\n                    <div style={{ fontWeight: 700 }}>{previewDoc.title || previewDoc.filename || 'Untitled'}</div>\r\n                    <div style={{ fontSize: 12, color: '#888' }}>{previewDoc.sourceTemplateName || previewDoc.templateName || ''}</div>\r\n                  </div>\r\n                  <div>\r\n                    <Button onClick={() => handleDownloadProcessed(previewDoc)} type=\"primary\">Download</Button>\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{ display: 'flex', gap: 8, flexWrap: 'wrap' }}>\r\n                  <Tag color=\"blue\">Created: {formatDate(previewDoc.createdAt)}</Tag>\r\n                  {previewDoc.transactionCode && <Tag color=\"purple\">TX: {previewDoc.transactionCode}</Tag>}\r\n                  {previewDoc.uploadedBy && <Tag>By: {(previewDoc.uploadedBy.username || previewDoc.uploadedBy.name) || previewDoc.uploadedBy}</Tag>}\r\n                </div>\r\n\r\n                <div style={{ color: '#444', fontSize: 13 }}>\r\n                  <div style={{ marginBottom: 8 }}>{previewDoc.description || previewDoc.notes || ''}</div>\r\n                  <div style={{ marginTop: 8 }}>\r\n                    <Button type=\"link\" onClick={() => { navigator.clipboard?.writeText(previewDoc.transactionCode || ''); notification.success({ message: 'Copied', description: 'Transaction code copied' }); }}>Copy Transaction Code</Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div>No document selected</div>\r\n            )}\r\n          </Drawer>\r\n          <Modal\r\n            title=\"Manage Inquiries\"\r\n            open={manageModalVisible}\r\n            onCancel={() => { setManageModalVisible(false); setManageTableData(null); }}\r\n            footer={null}\r\n            width={900}\r\n          >\r\n            <Table\r\n              dataSource={manageTableData !== null ? manageTableData : sortByDateDesc(inquiries)}\r\n              rowKey={(r: any) => r._id}\r\n              pagination={{ pageSize: 10 }}\r\n              onRow={(record) => ({\r\n                onClick: () => {\r\n                  // mark viewed and navigate to the thread\r\n                  if (record && record._id) markInquiryViewed(String(record._id));\r\n                  setManageModalVisible(false);\r\n                  navigate('/staff/inbox', { state: { openInquiryId: record._id } });\r\n                }\r\n              })}\r\n            >\r\n              <Table.Column\r\n                title=\"Name\"\r\n                dataIndex=\"username\"\r\n                key=\"username\"\r\n                render={(v: any, r: any) => v || r.residentName || r.subject || 'Unknown'}\r\n              />\r\n              <Table.Column\r\n                title=\"Type of Inquiry\"\r\n                dataIndex=\"type\"\r\n                key=\"type\"\r\n                render={(t: any) => (t ? String(t) : 'General')}\r\n              />\r\n              <Table.Column\r\n                title=\"Status\"\r\n                dataIndex=\"status\"\r\n                key=\"status\"\r\n                render={(s: any) => getStatusTag(s)}\r\n              />\r\n              <Table.Column\r\n                title=\"Date Inquired\"\r\n                dataIndex=\"createdAt\"\r\n                key=\"createdAt\"\r\n                render={(d: any) => formatDate(d)}\r\n              />\r\n            </Table>\r\n          </Modal>\r\n        </Modal>\r\n\r\n        {/* Document Response Modal */}\r\n        <Modal\r\n          open={!!selectedDocument}\r\n          title={selectedDocument ? `${documentStatus} Document Request` : ''}\r\n          onCancel={() => { setSelectedDocument(null); setResponseText(''); setDocumentStatus(''); }}\r\n          footer={selectedDocument ? [\r\n            <Input.TextArea\r\n              key=\"notes\"\r\n              rows={4}\r\n              value={responseText}\r\n              onChange={e => setResponseText(e.target.value)}\r\n              placeholder=\"Type notes...\"\r\n            />,\r\n            <Button\r\n              key=\"submit\"\r\n              type=\"primary\"\r\n              disabled={!responseText.trim()}\r\n              onClick={handleDocumentAction}\r\n            >Submit</Button>\r\n          ] : null}\r\n        >\r\n          {selectedDocument && (\r\n            <div>\r\n              <Typography.Text strong>Type:</Typography.Text> {formatDocumentType(selectedDocument.type || selectedDocument.title)}<br />\r\n              <Typography.Text strong>Description:</Typography.Text> {selectedDocument.description || ''}<br />\r\n              <Typography.Text strong>Requested by:</Typography.Text> {selectedDocument.username || 'Unknown'}<br />\r\n              <Typography.Text strong>Barangay ID:</Typography.Text> {selectedDocument.barangayID || 'Unknown'}<br />\r\n              <Typography.Text strong>Date:</Typography.Text> {formatDate(selectedDocument.dateRequested || '')}<br />\r\n            </div>\r\n          )}\r\n        </Modal>\r\n        {/* Inquiry Response Modal */}\r\n        <Modal\r\n          open={!!selectedInquiry}\r\n          title={selectedInquiry ? `Respond to Inquiry: ${selectedInquiry.subject}` : ''}\r\n          onCancel={() => { setSelectedInquiry(null); setResponseText(''); }}\r\n          footer={selectedInquiry ? [\r\n            <Input.TextArea\r\n              key=\"response\"\r\n              rows={4}\r\n              value={responseText}\r\n              onChange={e => setResponseText(e.target.value)}\r\n              placeholder=\"Type your response...\"\r\n              disabled={responding}\r\n            />,\r\n            <Button\r\n              key=\"send\"\r\n              type=\"primary\"\r\n              loading={responding}\r\n              disabled={!responseText.trim()}\r\n              onClick={handleInquiryResponse}\r\n            >Send Response</Button>\r\n          ] : null}\r\n        >\r\n          {selectedInquiry && (\r\n            <div>\r\n              <Typography.Text strong>Type:</Typography.Text> {selectedInquiry.type}<br />\r\n              <Typography.Text strong>Message:</Typography.Text> {selectedInquiry.message}<br />\r\n              <Typography.Text strong>From:</Typography.Text> {selectedInquiry.username ? `${selectedInquiry.username} (Barangay ID: ${selectedInquiry.barangayID || 'Unknown'})` : 'Unknown'}<br />\r\n              <Typography.Text strong>Date:</Typography.Text> {formatDate(selectedInquiry.createdAt)}<br />\r\n            </div>\r\n          )}\r\n        </Modal>\r\n        {/* Completed Requests Modal */}\r\n        <Modal\r\n          open={completedModalVisible}\r\n          title={`Completed Requests (${stats.completedRequests || 0})`}\r\n          onCancel={() => setCompletedModalVisible(false)}\r\n          footer={null}\r\n          width={1100}\r\n          styles={{ body: { padding: 12 } }}\r\n        >\r\n          <div style={{ overflowX: 'auto' }}>\r\n            {/* Table of completed document requests (horizontally scrollable) */}\r\n            <Table\r\n              dataSource={documentRequests.filter(d => (d.status || '').toLowerCase() === 'approved' || (d.status || '').toLowerCase() === 'completed')}\r\n              rowKey={(record: any) => record._id}\r\n              pagination={{ pageSize: 10 }}\r\n              scroll={{ x: 1000 }}\r\n              columns={[\r\n                {\r\n                  title: 'Requester',\r\n                  dataIndex: 'username',\r\n                  key: 'username',\r\n                  width: 200,\r\n                  render: (val: any, rec: any) => val || rec.requesterId?.fullName || 'Unknown'\r\n                },\r\n                {\r\n                  title: 'Document',\r\n                  dataIndex: 'type',\r\n                  key: 'type',\r\n                  width: 220,\r\n                  render: (val: any, rec: any) => formatDocumentType(val || rec.title)\r\n                },\r\n                {\r\n                  title: 'Description',\r\n                  dataIndex: 'description',\r\n                  key: 'description',\r\n                  width: 300,\r\n                  render: (val: any) => val || '-'\r\n                },\r\n                {\r\n                  title: 'Date Requested',\r\n                  dataIndex: 'dateRequested',\r\n                  key: 'dateRequested',\r\n                  width: 180,\r\n                  render: (val: any) => formatDate(val)\r\n                },\r\n                {\r\n                  title: 'Status',\r\n                  dataIndex: 'status',\r\n                  key: 'status',\r\n                  width: 120,\r\n                  render: (val: any) => getStatusTag(val)\r\n                },\r\n                {\r\n                  title: 'Action',\r\n                  key: 'action',\r\n                  width: 120,\r\n                  render: (_: any, rec: any) => (\r\n                    <Button type=\"link\" onClick={() => { setSelectedDocument(rec); setCompletedModalVisible(false); setDocumentStatus(''); }}>\r\n                      View\r\n                    </Button>\r\n                  )\r\n                }\r\n              ]}\r\n            />\r\n          </div>\r\n        </Modal>\r\n      </div>\r\n    </Spin>\r\n\r\n  );\r\n}\r\n\r\nexport default StaffDashboard;\r\n","\r\nimport io from 'socket.io-client';\r\ntype SocketType = ReturnType<typeof io>;\r\n\r\nlet socket: SocketType | null = null;\r\n\r\n/**\r\n * Initialize the notification socket.\r\n * Priority for endpoint resolution:\r\n * 1. runtime config `__APP_CONFIG__.SOCKET_URL`\r\n * 2. runtime config `__APP_CONFIG__.API_BASE`\r\n * 3. build-time `REACT_APP_API_URL`\r\n * 4. fallback to relative '/' (dev proxy will route to backend)\r\n */\r\nexport function initNotificationSocket(token?: string) {\r\n  if (socket) return socket;\r\n  const cfg = (globalThis as any).__APP_CONFIG__ || {};\r\n  const envApi = process.env.REACT_APP_API_URL;\r\n  let base = cfg.SOCKET_URL || cfg.API_BASE || envApi || '/api';\r\n  let root = String(base).replace(/\\/$/, '');\r\n  // If base is an API path that contains '/api', strip it to get the host root\r\n  if (root.endsWith('/api')) root = root.replace(/\\/api$/, '');\r\n\r\n  // If root is just '/api' (dev), use empty string so socket.io connects to current origin\r\n  if (root === '/api') root = '';\r\n\r\n  socket = io(root || '/', {\r\n    path: '/socket.io',\r\n    transports: ['websocket'],\r\n    auth: token ? { token } : undefined,\r\n    autoConnect: true,\r\n  });\r\n  return socket;\r\n}\r\n\r\nexport function onNotificationEvent(event: string, handler: (...args: any[]) => void) {\r\n  if (!socket) return;\r\n  socket.on(event, handler);\r\n}\r\n\r\nexport function offNotificationEvent(event: string, handler: (...args: any[]) => void) {\r\n  if (!socket) return;\r\n  socket.off(event, handler);\r\n}\r\n\r\nexport function getSocket() {\r\n  return socket;\r\n}\r\n","\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Card, Row, Col, List, Typography, Space, Spin, Button, Drawer, Table, Empty, Modal } from 'antd';\r\nimport AppAvatar from '../AppAvatar';\r\nimport {\r\n  UserOutlined,\r\n  BellOutlined,\r\n  FileTextOutlined,\r\n  TeamOutlined,\r\n  \r\n  CheckOutlined,\r\n  ExclamationCircleOutlined\r\n} from '@ant-design/icons';\r\nimport { adminAPI, notificationAPI, contactAPI, requestsAPI, verificationAPI, getAbsoluteApiUrl } from '../../services/api';\r\nimport { documentsAPI } from '../../services/api';\r\nimport { initNotificationSocket, onNotificationEvent, offNotificationEvent } from '../../services/notificationSocket';\r\nimport { Notification } from '../../types/notification';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\n\r\n// Color palette for SVG pie chart slices\r\nconst pieColors = [\r\n  '#6366F1', // Indigo\r\n  '#22C55E', // Green\r\n  '#F59E42', // Orange\r\n  '#EF4444', // Red\r\n  '#3B82F6', // Blue\r\n  '#FBBF24', // Yellow\r\n  '#A21CAF', // Purple\r\n  '#14B8A6', // Teal\r\n];\r\n\r\nconst { Title, Text } = Typography;\r\n\r\ninterface DashboardStats {\r\n  totalUsers: number;\r\n  activeUsers: number;\r\n  pendingRequests: number;\r\n  totalDocuments: number;\r\n  completedRequests: number;\r\n  unreadMessages: number;\r\n}\r\n\r\ninterface Activity {\r\n  id: string;\r\n  type: 'document' | 'user' | 'system';\r\n  description: string;\r\n  timestamp: string;\r\n  user?: string;\r\n}\r\n\r\nconst AdminDashboard: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const [loading, setLoading] = useState(false);\r\n  const [, setDocumentRequests] = useState<any[]>([]);\r\n  const [stats, setStats] = useState<DashboardStats>({\r\n    totalUsers: 0,\r\n    activeUsers: 0,\r\n    pendingRequests: 0,\r\n    totalDocuments: 0,\r\n    completedRequests: 0,\r\n    unreadMessages: 0\r\n  });\r\n  const [notifications, setNotifications] = useState<Notification[]>([]);\r\n  const [, setStaffAccessNotifs] = useState<Notification[]>([]);\r\n  const [staffRequests, setStaffRequests] = useState<any[]>([]);\r\n  const [, setRecentActivity] = useState<Activity[]>([]);\r\n  const [verifs, setVerifs] = useState<any[]>([]);\r\n  const [verifsLoading, setVerifsLoading] = useState(false);\r\n  const [verifModalVisible, setVerifModalVisible] = useState(false);\r\n  const [selectedVerif, setSelectedVerif] = useState<any | null>(null);\r\n  const [, setInquiries] = useState<any[]>([]);\r\n  const [, setInboxInquiries] = useState<any[]>([]);\r\n  // Demo data for mini charts\r\n  const usersTrend = [3, 5, 4, 6, 7, 8, 10]; // last 7 days\r\n  const requestsByType = [\r\n    { type: 'Clearance', value: 12 },\r\n    { type: 'Certificate', value: 8 },\r\n    { type: 'Permit', value: 5 },\r\n    { type: 'Other', value: 3 },\r\n  ];\r\n  const documentCategoryData = [\r\n    { type: 'Clearance', value: 27 },\r\n    { type: 'Certificate', value: 18 },\r\n    { type: 'Permit', value: 12 },\r\n    { type: 'Other', value: 8 },\r\n  ];\r\n\r\n  // (Removed unused PieChartSVG helper to silence ESLint unused-symbol warnings)\r\n\r\n\r\n\r\n  const fetchDashboardData = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const statsRes = await adminAPI.getSystemStatistics();\r\n      // Fetch document requests for modal\r\n  // Fetch document requests for modal\r\n      try {\r\n  const docs = await documentsAPI.getDocumentRecords();\r\n        setDocumentRequests(docs);\r\n      } catch (err) {\r\n        setDocumentRequests([]);\r\n      }\r\n\r\n  const notificationsRes = await notificationAPI.getNotifications();\r\n\r\n  // Only show unread notifications in the dashboard\r\n  const unreadNotifs = notificationsRes.filter((n: Notification) => !n.read);\r\n  setNotifications(unreadNotifs.slice(0, 10)); // show up to 10 unread notifications\r\n\r\n  // Define staff access notifications for pendingRequests calculation (accept both types used in DB)\r\n  const staffApprovalNotifs = unreadNotifs.filter((n: Notification) => (n.type || '').toString().toLowerCase().includes('staff'));\r\n  setStaffAccessNotifs(staffApprovalNotifs);\r\n\r\n  // Fetch staff access Requests from the requests collection\r\n  try {\r\n    const sreqs = await requestsAPI.getStaffAccessRequests();\r\n    setStaffRequests(sreqs || []);\r\n  } catch (err) {\r\n    setStaffRequests([]);\r\n  }\r\n\r\n  // Transform system statistics\r\n  const systemPending = (statsRes.documents?.pending || 0) + staffApprovalNotifs.length;\r\n      const systemTotalDocs = statsRes.documents?.total || 0;\r\n\r\n      // Try to fetch document requests directly and derive pending count to ensure accuracy\r\n      let directPending = 0;\r\n      try {\r\n        const allReqs = await documentsAPI.getDocumentRecords();\r\n        const arr: any[] = Array.isArray(allReqs) ? allReqs : (allReqs && allReqs.data) ? allReqs.data : [];\r\n        directPending = (arr || []).filter(r => (r.status || '').toString().toLowerCase() === 'pending').length;\r\n      } catch (e) {\r\n        directPending = systemPending;\r\n      }\r\n\r\n      const totalPending = directPending + (staffApprovalNotifs ? staffApprovalNotifs.length : 0);\r\n      setStats({\r\n        totalUsers: statsRes.users?.total || 0,\r\n        activeUsers: statsRes.users?.active || 0,\r\n        // Combine pending document requests with unread staff access notifications\r\n        pendingRequests: totalPending,\r\n        totalDocuments: systemTotalDocs,\r\n        completedRequests: statsRes.documents?.completed || 0,\r\n        unreadMessages: 0 // Set to 0 or fetch from a valid source if available\r\n      });\r\n\r\n      // Fetch all resident inquiries for admin inbox\r\n      const inquiriesRes = await contactAPI.getAllInquiries();\r\n      setInquiries(inquiriesRes);\r\n      // Filter for inbox: assignedRole matches user.role or assignedTo includes user._id\r\n      const filtered = inquiriesRes.filter((inq: any) =>\r\n        (inq.assignedRole && user && inq.assignedRole === user.role) ||\r\n        (inq.assignedTo && Array.isArray(inq.assignedTo) && user && inq.assignedTo.includes(user._id))\r\n      );\r\n      setInboxInquiries(filtered);\r\n\r\n      // Fetch real recent activity logs\r\n      const activityRes = await adminAPI.getActivityLogs({});\r\n      // Map backend ActivityLog[] to local Activity[]\r\n      setRecentActivity(activityRes.map((log: any) => ({\r\n        id: log.id,\r\n        type: log.module || 'system',\r\n        description: log.description || log.action,\r\n        timestamp: log.timestamp,\r\n        user: log.userName || log.userId\r\n      })));\r\n    } catch (error) {\r\n      console.error('Error fetching dashboard data:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user]);\r\n\r\n\r\n  useEffect(() => {\r\n    // initial fetch\r\n    fetchDashboardData();\r\n\r\n    // Initialize socket and listen for document-related events to refresh dashboard\r\n    try {\r\n      initNotificationSocket();\r\n      const handler = (payload: any) => {\r\n        console.log('Received document socket event, refreshing dashboard', payload);\r\n        fetchDashboardData();\r\n      };\r\n      onNotificationEvent('documentStatusUpdate', handler);\r\n      onNotificationEvent('documentCreated', handler);\r\n      onNotificationEvent('documentDeleted', handler);\r\n      onNotificationEvent('documents-updated', handler);\r\n\r\n      // Poll as a fallback for environments without sockets\r\n      const pollInterval = setInterval(() => {\r\n        fetchDashboardData();\r\n      }, 30000);\r\n\r\n      return () => {\r\n        offNotificationEvent('documentStatusUpdate', handler);\r\n        offNotificationEvent('documentCreated', handler);\r\n        offNotificationEvent('documentDeleted', handler);\r\n        offNotificationEvent('documents-updated', handler);\r\n        clearInterval(pollInterval);\r\n      };\r\n    } catch (err) {\r\n      // If sockets fail, still keep polling\r\n      const pollInterval = setInterval(() => {\r\n        fetchDashboardData();\r\n      }, 30000);\r\n      return () => clearInterval(pollInterval);\r\n    }\r\n  }, [fetchDashboardData]);\r\n\r\n  // Load verification requests (separate from main fetch to keep concerns isolated)\r\n  const loadVerifs = async () => {\r\n    setVerifsLoading(true);\r\n    try {\r\n      const res = await verificationAPI.getRequests();\r\n      setVerifs(Array.isArray(res) ? res : []);\r\n    } catch (err) {\r\n      console.error('Failed to load verification requests', err);\r\n      setVerifs([]);\r\n    } finally {\r\n      setVerifsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => { loadVerifs(); }, []);\r\n\r\n  // Fetch users count explicitly from User Management and keep it refreshed\r\n  const fetchUsersCount = async () => {\r\n    try {\r\n      const users = await adminAPI.getUsers();\r\n      const usersAny: any = users;\r\n      const count = Array.isArray(usersAny) ? usersAny.length : (usersAny && typeof usersAny.length === 'number' ? usersAny.length : 0);\r\n      setStats(prev => ({ ...prev, totalUsers: count }));\r\n    } catch (err) {\r\n      console.error('Failed to fetch users list for count:', err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    // initial fetch\r\n    fetchUsersCount();\r\n    // poll every 30 seconds to keep the count up-to-date\r\n    const interval = setInterval(fetchUsersCount, 30000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  // handleMarkAsRead removed (not referenced in this component)\r\n\r\n  // Approve staff request\r\n  const handleApproveStaff = async (notif: Notification) => {\r\n    if (!notif.data?.userId || !notif._id) return;\r\n    try {\r\n      setLoading(true);\r\n      await notificationAPI.approveStaff(notif.data.userId, notif._id);\r\n      await fetchDashboardData();\r\n    } catch (err) {\r\n      console.error('Failed to approve staff:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Reject staff request\r\n  const handleRejectStaff = async (notif: Notification) => {\r\n    if (!notif._id) return;\r\n    const reason = window.prompt('Enter a brief reason for rejection (optional):');\r\n    try {\r\n      setLoading(true);\r\n      await notificationAPI.rejectStaff(notif._id, reason || undefined);\r\n      await fetchDashboardData();\r\n    } catch (err) {\r\n      console.error('Failed to reject staff request:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Simple UnreadBadge component for displaying a red dot\r\n  const UnreadBadge: React.FC = () => (\r\n    <span\r\n      style={{\r\n        display: 'inline-block',\r\n        width: 8,\r\n        height: 8,\r\n        borderRadius: '50%',\r\n        background: '#ff4d4f',\r\n        marginLeft: 6,\r\n        verticalAlign: 'middle',\r\n      }}\r\n      aria-label=\"Unread\"\r\n    />\r\n  );\r\n\r\n  const kpiCards = [\r\n    {\r\n      label: 'Users',\r\n      value: stats.totalUsers,\r\n      icon: '',\r\n      bg: 'linear-gradient(90deg, #1890ff 0%, #40a9ff 100%)',\r\n      color: '#1890ff',\r\n      labelColor: '#e6f7ff',\r\n      onClick: undefined,\r\n      chart: (\r\n                <div style={{ width: '100%', marginTop: 8, height: 32 }}>\r\n                  {/* Pure SVG sparkline for Users */}\r\n                  <svg width=\"100%\" height=\"40\" viewBox=\"0 0 100 40\" preserveAspectRatio=\"none\">\r\n                    <polyline\r\n                      fill=\"none\"\r\n                      stroke=\"#4F46E5\"\r\n                      strokeWidth=\"2\"\r\n                      points={usersTrend.map((d, i) => `${i * (100 / (usersTrend.length - 1))},${40 - (d / Math.max(...usersTrend)) * 35}`).join(' ')}\r\n                    />\r\n                  </svg>\r\n                </div>\r\n      ),\r\n    },\r\n    {\r\n      label: 'Pending Requests',\r\n      value: stats.pendingRequests,\r\n      icon: '',\r\n      bg: 'linear-gradient(90deg, #faad14 0%, #ffe58f 100%)',\r\n      color: '#faad14',\r\n      labelColor: '#fffbe6',\r\n      onClick: undefined,\r\n      chart: (\r\n                <div style={{ width: '100%', marginTop: 8, height: 32 }}>\r\n                  {/* Pure SVG bar chart for Requests */}\r\n                  <svg width=\"100%\" height=\"40\" viewBox=\"0 0 100 40\" preserveAspectRatio=\"none\">\r\n                    {requestsByType.map((d, i) => {\r\n                      const barWidth = 100 / requestsByType.length - 2;\r\n                      const barHeight = (d.value / Math.max(...requestsByType.map(r => r.value))) * 35;\r\n                      return (\r\n                        <rect\r\n                          key={i}\r\n                          x={i * (100 / requestsByType.length) + 1}\r\n                          y={40 - barHeight}\r\n                          width={barWidth}\r\n                          height={barHeight}\r\n                          fill=\"#22C55E\"\r\n                          rx=\"2\"\r\n                        />\r\n                      );\r\n                    })}\r\n                  </svg>\r\n                </div>\r\n      ),\r\n    },\r\n    {\r\n      label: 'Documents',\r\n      value: stats.totalDocuments,\r\n      icon: '',\r\n      bg: 'linear-gradient(90deg, #52c41a 0%, #b7eb8f 100%)',\r\n      color: '#52c41a',\r\n      labelColor: '#f6ffed',\r\n      onClick: undefined,\r\n      chart: (\r\n                <div style={{ width: '100%', marginTop: 8, height: 32, display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\r\n                  {/* Pure SVG pie chart for Documents */}\r\n                  <svg width=\"40\" height=\"40\" viewBox=\"0 0 40 40\">\r\n                    {(() => {\r\n                      const total = documentCategoryData.reduce((sum, d) => sum + d.value, 0);\r\n                      let startAngle = 0;\r\n                      return documentCategoryData.map((d, i) => {\r\n                        const angle = (d.value / total) * 360;\r\n                        const endAngle = startAngle + angle;\r\n                        const largeArc = angle > 180 ? 1 : 0;\r\n                        const x1 = 20 + 18 * Math.cos((Math.PI * (startAngle - 90)) / 180);\r\n                        const y1 = 20 + 18 * Math.sin((Math.PI * (startAngle - 90)) / 180);\r\n                        const x2 = 20 + 18 * Math.cos((Math.PI * (endAngle - 90)) / 180);\r\n                        const y2 = 20 + 18 * Math.sin((Math.PI * (endAngle - 90)) / 180);\r\n                        const path = `M20,20 L${x1},${y1} A18,18 0 ${largeArc} 1 ${x2},${y2} Z`;\r\n                        const el = (\r\n                          <path\r\n                            key={i}\r\n                            d={path}\r\n                            fill={pieColors[i % pieColors.length]}\r\n                          />\r\n                        );\r\n                        startAngle += angle;\r\n                        return el;\r\n                      });\r\n                    })()}\r\n                  </svg>\r\n                </div>\r\n      ),\r\n    },\r\n    {\r\n      label: <span>Messages <UnreadBadge /></span>,\r\n      value: stats.unreadMessages,\r\n      icon: '',\r\n      bg: 'linear-gradient(90deg, #722ed1 0%, #b37feb 100%)',\r\n      color: '#722ed1',\r\n      labelColor: '#f9f0ff',\r\n      onClick: () => navigate('/admin/messages'),\r\n      chart: null,\r\n    },\r\n  ];\r\n\r\n  const statCardSubtitles = [\r\n    'Total Users',\r\n    'Pending Requests',\r\n    'Total Documents',\r\n    'Unread Messages',\r\n  ];\r\n\r\n  const renderStatCards = () => (\r\n    <Row gutter={[24, 24]} style={{ marginBottom: 32 }}>\r\n      {kpiCards.map((card, idx) => (\r\n        <Col xs={24} sm={12} md={6} key={typeof card.label === 'string' ? card.label : String(idx)}>\r\n          <Card\r\n            hoverable\r\n            onClick={card.onClick}\r\n            style={{\r\n              background: card.bg,\r\n              color: '#fff',\r\n              borderRadius: 20,\r\n              minHeight: 170,\r\n              boxShadow: '0 2px 8px 0 rgba(0,0,0,0.08)',\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              cursor: card.onClick ? 'pointer' : 'default',\r\n              transition: 'box-shadow 0.2s, transform 0.2s',\r\n              position: 'relative',\r\n              marginBottom: 8,\r\n              padding: 24,\r\n            }}\r\n            styles={{\r\n              body: {\r\n                width: '100%',\r\n                padding: 0,\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                background: 'transparent',\r\n              }\r\n            }}\r\n            onMouseEnter={e => {\r\n              e.currentTarget.style.boxShadow = '0 8px 32px 0 rgba(0,0,0,0.18)';\r\n              e.currentTarget.style.transform = 'translateY(-4px)';\r\n            }}\r\n            onMouseLeave={e => {\r\n              e.currentTarget.style.boxShadow = '0 2px 8px 0 rgba(0,0,0,0.08)';\r\n              e.currentTarget.style.transform = 'none';\r\n            }}\r\n          >\r\n            <span style={{ fontSize: 40, marginBottom: 8, opacity: 0.92 }}>{card.icon}</span>\r\n            <span style={{ fontSize: 38, fontWeight: 700, lineHeight: 1 }}>{card.value}</span>\r\n            <span style={{ fontSize: 15, color: card.labelColor, fontWeight: 500, marginTop: 2, letterSpacing: 0.5 }}>{card.label}</span>\r\n            <span style={{ fontSize: 13, color: 'rgba(255,255,255,0.7)', marginTop: 2, fontWeight: 400 }}>{statCardSubtitles[idx]}</span>\r\n            {card.chart}\r\n          </Card>\r\n        </Col>\r\n      ))}\r\n    </Row>\r\n  );\r\n\r\n  // documentColumns removed (was used only by the removed inbox rendering block)\r\n\r\n  const renderNotifications = () => (\r\n    <Card\r\n      title={<Space><BellOutlined /> Staff Access Approval</Space>}\r\n      style={{ marginTop: 0, background: '#fafbfc', borderRadius: 12, boxShadow: '0 2px 8px #d9d9d933', border: '1px solid #f0f0f0', position: 'relative' }}\r\n  styles={{ body: { padding: 16 } }}\r\n      size=\"small\"\r\n      hoverable={false}\r\n    >\r\n  {/* Render a dedicated table for unread staff access approval requests */}\r\n      {staffRequests && staffRequests.length > 0 ? (\r\n        <Table\r\n          size=\"small\"\r\n          pagination={{ pageSize: 5 }}\r\n          dataSource={staffRequests}\r\n          rowKey={r => r._id || String(r.createdAt)}\r\n          columns={[\r\n            {\r\n              title: 'Name',\r\n              dataIndex: 'requestedBy',\r\n              key: 'requestedBy',\r\n              render: (text: any, record: any) => {\r\n                // requestedBy may be a string id, an object, or missing. Prefer data.fullName, requestedByName, then requestedBy.fullName/username, then fallback to string or 'Unknown'\r\n                const nameFromData = record?.data?.fullName;\r\n                const nameFromRequestedByName = record?.requestedByName;\r\n                let nameFromRequestedBy: any = null;\r\n                if (record?.requestedBy) {\r\n                  if (typeof record.requestedBy === 'string') nameFromRequestedBy = record.requestedBy;\r\n                  else if (typeof record.requestedBy === 'object') nameFromRequestedBy = record.requestedBy.fullName || record.requestedBy.username || record.requestedBy._id;\r\n                }\r\n                const displayName = nameFromData || nameFromRequestedByName || nameFromRequestedBy || 'Unknown';\r\n                return <span style={{ fontWeight: 600 }}>{displayName}</span>;\r\n              }\r\n            },\r\n            \r\n            {\r\n              title: 'Requested At',\r\n              dataIndex: 'createdAt',\r\n              key: 'createdAt',\r\n              render: (val: any) => <span style={{ fontSize: 12, color: '#888' }}>{new Date(val).toLocaleString()}</span>\r\n            },\r\n            {\r\n              title: 'Actions',\r\n              key: 'actions',\r\n              render: (_: any, record: any) => (\r\n                <Space>\r\n                  {/* If the row is a Request (has _id and type), call requestsAPI.approveRequest */}\r\n                  <Button\r\n                    type=\"primary\"\r\n                    size=\"small\"\r\n                    onClick={async () => {\r\n                      try {\r\n                        setLoading(true);\r\n                        if (record && record.type === 'staff_access' && record._id) {\r\n                          await requestsAPI.approveRequest(record._id);\r\n                        } else {\r\n                          // fallback to notification-based approve\r\n                          await handleApproveStaff(record as Notification);\r\n                        }\r\n                        await fetchDashboardData();\r\n                      } catch (err) {\r\n                        console.error('Approve action failed', err);\r\n                      } finally {\r\n                        setLoading(false);\r\n                      }\r\n                    }}\r\n                    icon={<CheckOutlined />}\r\n                  >\r\n                    Approve\r\n                  </Button>\r\n                  <Button danger size=\"small\" onClick={() => handleRejectStaff(record)} icon={<ExclamationCircleOutlined />}>Reject</Button>\r\n                </Space>\r\n              )\r\n            }\r\n          ]}\r\n        />\r\n      ) : (\r\n        // Fallback: show recent notifications list for other notification types\r\n        (notifications.length === 0) ? (\r\n          <Empty\r\n            image={<BellOutlined style={{ fontSize: 48, color: '#d9d9d9' }} />}\r\n            description={<span style={{ color: '#888' }}>No notifications</span>}\r\n          />\r\n        ) : (\r\n          <List\r\n            dataSource={notifications}\r\n            renderItem={(notification) => (\r\n              <List.Item\r\n                actions={[\r\n                  (notification.type || '').toString().toLowerCase().includes('staff') && !notification.read && (\r\n                    <Button\r\n                      type=\"primary\"\r\n                      size=\"small\"\r\n                      icon={<CheckOutlined />}\r\n                      onClick={() => handleApproveStaff(notification)}\r\n                    >\r\n                      Approve\r\n                    </Button>\r\n                  ),\r\n                  // removed Mark Read action per design\r\n                ].filter(Boolean)}\r\n              >\r\n                <List.Item.Meta\r\n                  avatar={<AppAvatar icon={(notification.type || '').toString().toLowerCase().includes('staff') ? <TeamOutlined /> : <BellOutlined />} style={{ backgroundColor: notification.read ? '#8c8c8c' : ((notification.type || '').toString().toLowerCase().includes('staff') ? '#faad14' : '#1890ff') }} />}\r\n                  title={<Text strong={(notification.type || '').toString().toLowerCase().includes('staff')}>{notification.message}</Text>}\r\n                  description={\r\n                    <div>\r\n                      <Text type=\"secondary\">{new Date(notification.createdAt).toLocaleString()}</Text>\r\n                      {((notification.type || '').toString().toLowerCase().includes('staff') && notification.data) && (\r\n                        <div style={{ marginTop: 8 }}>\r\n                          <Text strong>Full Name:</Text> {notification.data.fullName || 'N/A'}<br />\r\n                          <Text strong>Email:</Text> {notification.data.email || 'N/A'}<br />\r\n                          <Text strong>Username:</Text> {notification.data.username || 'N/A'}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  }\r\n                />\r\n              </List.Item>\r\n            )}\r\n            size=\"small\"\r\n          />\r\n        )\r\n      )}\r\n  <Button type=\"link\" style={{ position: 'absolute', right: 16, bottom: 8, fontSize: 13, color: '#1890ff' }} onClick={() => navigate('/admin/notifications')}>View all</Button>\r\n    </Card>\r\n  );\r\n\r\n  // Verification widget for admin dashboard\r\n  const handleApproveVerif = async (arg: any) => {\r\n    // arg may be a userId string or the verification request object\r\n    try {\r\n      setVerifsLoading(true);\r\n      if (arg && typeof arg === 'object') {\r\n        const reqId = arg._id;\r\n        const userId = arg.userId?._id || arg.userId;\r\n        // mark request approved on server (if endpoint exists)\r\n        try { await verificationAPI.approveRequest(reqId); } catch (e) { /* best-effort */ }\r\n        // set the user verified\r\n        if (userId) await verificationAPI.verifyUser(userId, true);\r\n      } else if (typeof arg === 'string') {\r\n        await verificationAPI.verifyUser(arg, true);\r\n      }\r\n      await loadVerifs();\r\n    } catch (err) {\r\n      console.error('Failed to verify user', err);\r\n    } finally {\r\n      setVerifsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRejectVerif = async (arg: any) => {\r\n    try {\r\n      setVerifsLoading(true);\r\n      if (arg && typeof arg === 'object') {\r\n        const reqId = arg._id;\r\n        const userId = arg.userId?._id || arg.userId;\r\n        try { await verificationAPI.rejectRequest(reqId); } catch (e) { /* best-effort */ }\r\n        if (userId) await verificationAPI.verifyUser(userId, false);\r\n      } else if (typeof arg === 'string') {\r\n        // no request id available; just flip user verified to false\r\n        await verificationAPI.verifyUser(arg, false);\r\n      }\r\n      await loadVerifs();\r\n    } catch (err) {\r\n      console.error('Failed to reject verification', err);\r\n    } finally {\r\n      setVerifsLoading(false);\r\n    }\r\n  };\r\n\r\n  const openCheckId = (req: any) => {\r\n    setSelectedVerif(req);\r\n    setVerifModalVisible(true);\r\n  };\r\n\r\n  const renderVerificationWidget = () => (\r\n    <Card\r\n      title={<Space><UserOutlined /> Verification Requests</Space>}\r\n      style={{ marginTop: 0, background: '#fff', borderRadius: 12, boxShadow: '0 2px 8px #d9d9d933', border: '1px solid #f0f0f0' }}\r\n      size=\"small\"\r\n      hoverable={false}\r\n    >\r\n      {verifsLoading ? (\r\n        <div style={{ textAlign: 'center', padding: 24 }}><Spin /></div>\r\n      ) : (!verifs || verifs.length === 0) ? (\r\n        <Empty description=\"No verification requests\" />\r\n      ) : (\r\n        <List\r\n          dataSource={verifs.slice(0, 6)}\r\n          renderItem={(item: any) => (\r\n            <List.Item\r\n              actions={[\r\n                <Button key=\"view\" size=\"small\" onClick={() => openCheckId(item)}>Check ID</Button>,\r\n                <Button key=\"verify\" type=\"primary\" size=\"small\" onClick={() => handleApproveVerif(item.userId?._id || item.userId)}>Verify</Button>,\r\n                <Button key=\"reject\" danger size=\"small\" onClick={() => handleRejectVerif(item.userId?._id || item.userId)}>Reject</Button>\r\n              ]}\r\n            >\r\n              <List.Item.Meta\r\n                title={<span style={{ fontWeight: 600 }}>{(item.userId && (item.userId.fullName || item.userId.username)) || 'Unknown Resident'}</span>}\r\n                description={<span style={{ color: '#888' }}>{item.status || 'pending'}  {new Date(item.createdAt).toLocaleString()}</span>}\r\n              />\r\n            </List.Item>\r\n          )}\r\n          size=\"small\"\r\n        />\r\n      )}\r\n\r\n      <Button type=\"link\" style={{ marginTop: 12 }} onClick={() => navigate('/admin/verification-requests')}>View all</Button>\r\n\r\n      <Modal\r\n        title=\"Verification Files\"\r\n        open={verifModalVisible}\r\n        onCancel={() => setVerifModalVisible(false)}\r\n        footer={null}\r\n        width={720}\r\n      >\r\n        {selectedVerif ? (\r\n          <div>\r\n            <p><strong>Resident:</strong> {(selectedVerif.userId && (selectedVerif.userId.fullName || selectedVerif.userId.username)) || 'Unknown'}</p>\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>\r\n              {(selectedVerif.gridFileIds || []).map((id: string) => (\r\n                <div key={id} style={{ border: '1px solid #f0f0f0', padding: 8, borderRadius: 6 }}>\r\n                    <div style={{ marginBottom: 8 }}>\r\n                      <a href={getAbsoluteApiUrl(`/verification/file/${id}`)} target=\"_blank\" rel=\"noreferrer\">Open file in new tab</a>\r\n                    </div>\r\n                  {/* inline preview for images if possible */}\r\n                    <div>\r\n                      <img src={getAbsoluteApiUrl(`/verification/file/${id}`)} alt=\"id\" style={{ maxWidth: '100%', maxHeight: 400 }} onError={() => { /* ignore errors for non-images */ }} />\r\n                    </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <Empty description=\"No files\" />\r\n        )}\r\n      </Modal>\r\n    </Card>\r\n  );\r\n\r\n  // Mini announcements viewer to replace Recent Activity\r\n  const [miniAnns, setMiniAnns] = useState<any[]>([]);\r\n  const [miniLoading, setMiniLoading] = useState(false);\r\n  const [miniSelected, setMiniSelected] = useState<any | null>(null);\r\n  const [drawerVisible, setDrawerVisible] = useState(false);\r\n\r\n  const fetchMiniAnnouncements = async () => {\r\n    setMiniLoading(true);\r\n    try {\r\n      const data = await contactAPI.getAnnouncements();\r\n      setMiniAnns(Array.isArray(data) ? data.slice(0, 6) : []); // show up to 6\r\n    } catch (err) {\r\n      console.error('Failed to load mini announcements', err);\r\n      setMiniAnns([]);\r\n    } finally {\r\n      setMiniLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => { fetchMiniAnnouncements(); }, []);\r\n\r\n  // helper: simple time-ago\r\n  const timeAgo = (iso?: string) => {\r\n    if (!iso) return ''; \r\n    const d = new Date(iso);\r\n    const diff = Math.floor((Date.now() - d.getTime()) / 1000);\r\n    if (diff < 60) return `${diff}s ago`;\r\n    if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\r\n    if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\r\n    if (diff < 604800) return `${Math.floor(diff / 86400)}d ago`;\r\n    return d.toLocaleDateString();\r\n  };\r\n\r\n  const renderRecentActivity = () => (\r\n    <Card\r\n      title={<Space><FileTextOutlined /> Announcements</Space>}\r\n      style={{ marginTop: 0, background: '#fafbfc', borderRadius: 12, boxShadow: '0 2px 8px #d9d9d933', border: '1px solid #f0f0f0', position: 'relative' }}\r\n      styles={{ body: { padding: 12 } }}\r\n      size=\"small\"\r\n      hoverable={false}\r\n    >\r\n      {miniAnns.length === 0 ? (\r\n        <Empty\r\n          image={<FileTextOutlined style={{ fontSize: 42, color: '#d9d9d9' }} />}\r\n          description={<span style={{ color: '#888' }}>No announcements</span>}\r\n        />\r\n      ) : (\r\n  <div style={{ maxHeight: 320, overflowY: 'auto', paddingRight: 6, paddingBottom: 48 }}>\r\n          <List\r\n            loading={miniLoading}\r\n            dataSource={miniAnns}\r\n            renderItem={(item) => (\r\n              <List.Item style={{ cursor: 'pointer', padding: '10px 8px', alignItems: 'center' }} onClick={() => { setMiniSelected(item); setDrawerVisible(true); }}>\r\n                <List.Item.Meta\r\n                  title={<div style={{ display: 'flex', alignItems: 'flex-start', gap: 8 }}>\r\n                    <div style={{ flex: 1, minWidth: 0 }}>\r\n                      <div style={{ fontWeight: 600, fontSize: 13, display: '-webkit-box', WebkitLineClamp: 3, WebkitBoxOrient: 'vertical', overflow: 'hidden', textOverflow: 'ellipsis', lineHeight: '1.2em' }}>{item.text || 'Untitled'}</div>\r\n                      <div style={{ fontSize: 12, color: '#888', marginTop: 6 }}>{timeAgo(item.createdAt)}</div>\r\n                    </div>\r\n                  </div>}\r\n                  description={null}\r\n                />\r\n                  {item.imagePath && (\r\n                    <div style={{ marginLeft: 12, width: 92, display: 'flex', justifyContent: 'flex-end', flexShrink: 0 }}>\r\n                      <img loading=\"lazy\" className=\"rounded-img\" src={getAbsoluteApiUrl(`/announcements/${item._id}/image`)} alt=\"ann\" style={{ width: 92, height: 60, objectFit: 'cover', borderRadius: 6, background: '#f0f0f0' }} />\r\n                    </div>\r\n                  )}\r\n              </List.Item>\r\n            )}\r\n            size=\"small\"\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* Footer area to host Manage link and avoid overlapping the scrollable list */}\r\n      <div style={{ marginTop: 8, display: 'flex', justifyContent: 'flex-end' }}>\r\n        <Button type=\"link\" style={{ fontSize: 13, color: '#1890ff' }} onClick={() => navigate('/admin/announcements')}>Manage</Button>\r\n      </div>\r\n\r\n      <Drawer open={drawerVisible} onClose={() => { setDrawerVisible(false); setMiniSelected(null); }} title=\"Announcement\" width={720} placement=\"right\">\r\n        {miniSelected && (\r\n          <div>\r\n            <Text style={{ display: 'block', marginBottom: 12, whiteSpace: 'pre-wrap' }}>{miniSelected.text}</Text>\r\n                    {miniSelected.imagePath && (\r\n                      <img loading=\"lazy\" className=\"rounded-img rounded-img-lg\" src={getAbsoluteApiUrl(`/announcements/${miniSelected._id}/image`)} alt=\"announcement\" style={{ width: '100%', height: 'auto', borderRadius: 8, background: '#f6f6f6' }} />\r\n                    )}\r\n            <div style={{ marginTop: 8, color: '#888' }}>{timeAgo(miniSelected.createdAt)}</div>\r\n          </div>\r\n        )}\r\n      </Drawer>\r\n    </Card>\r\n  );\r\n\r\n  // renderInbox removed (not referenced in this component)\r\n\r\n  return (\r\n    <Spin spinning={loading}>\r\n      <div style={{ padding: 24, backgroundColor: '#f0f2f5', minHeight: '100vh' }}>\r\n        <Title level={4} style={{ marginBottom: 24 }}>Admin Dashboard</Title>\r\n        {renderStatCards()}\r\n        <Row gutter={[24, 24]} style={{ marginTop: 0 }}>\r\n          <Col xs={24} lg={12}>\r\n            {renderNotifications()}\r\n          </Col>\r\n          <Col xs={24} lg={12}>\r\n            {renderRecentActivity()}\r\n          </Col>\r\n        </Row>\r\n        <Row gutter={[24, 24]} style={{ marginTop: 24 }}>\r\n          <Col xs={24}>\r\n            {renderVerificationWidget()}\r\n          </Col>\r\n        </Row>\r\n        {/* Modal is rendered inside renderInbox above */}\r\n      </div>\r\n    </Spin>\r\n  );\r\n};\r\n\r\nexport default AdminDashboard;\r\n","\r\nimport React, { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  Table,\r\n  Button,\r\n  Space,\r\n  Tag,\r\n  Typography,\r\n  Spin,\r\n  Form,\r\n  Input,\r\n  message,\r\n  Select,\r\n  Drawer,\r\n  Dropdown,\r\n  Menu,\r\n  DatePicker,\r\n  Row,\r\n  Col,\r\n  Breadcrumb,\r\n  Popconfirm,\r\n  Modal,\r\n  Tabs,\r\n  Upload,\r\n} from 'antd';\r\nimport AppAvatar from '../AppAvatar';\r\nimport { EditOutlined, DeleteOutlined, MoreOutlined, EyeOutlined, StopOutlined, CheckOutlined, ReloadOutlined } from '@ant-design/icons';\r\nimport type { SortOrder } from 'antd/es/table/interface';\r\nimport { adminAPI } from '../../services/api';\r\nimport dayjs from 'dayjs';\r\nimport { getAbsoluteApiUrl } from '../../services/api';\r\n\r\nconst roleOptions = [\r\n  { text: 'Admin', value: 'admin' },\r\n  { text: 'Staff', value: 'staff' },\r\n  { text: 'Resident', value: 'resident' },\r\n];\r\nconst statusOptions = [\r\n  { text: 'Active', value: true },\r\n  { text: 'Inactive', value: false },\r\n];\r\n\r\n// ...existing code...\r\n// Columns will be defined inside the component to access state/handlers\r\n\r\n\r\nconst UserManagement: React.FC = () => {\r\n  const [users, setUsers] = useState<any[]>([]);\r\n  const [search, setSearch] = useState('');\r\n  const [roleFilter, setRoleFilter] = useState<string | undefined>(undefined);\r\n  const [statusFilter, setStatusFilter] = useState<boolean | undefined>(undefined);\r\n  const [dateRange, setDateRange] = useState<any>(null);\r\n  const [page, setPage] = useState(1);\r\n  const [pageSize, setPageSize] = useState(10);\r\n  const [selectedRowKeys, setSelectedRowKeys] = useState<React.Key[]>([]);\r\n  const [drawerOpen, setDrawerOpen] = useState(false);\r\n  const [selectedUser, setSelectedUser] = useState<any | null>(null);\r\n  const [selectedResident, setSelectedResident] = useState<any | null>(null);\r\n  const [residentLoading, setResidentLoading] = useState(false);\r\n  const [editModalOpen, setEditModalOpen] = useState(false);\r\n  const [editUserModalOpen, setEditUserModalOpen] = useState(false);\r\n  const [userFormValues, setUserFormValues] = useState<any>({});\r\n  const [uploading, setUploading] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n  const [uploadPreview, setUploadPreview] = useState<string | null>(null);\r\n  const pendingUploadRef = React.useRef<Promise<any> | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [editFormValues, setEditFormValues] = useState<any>({});\r\n  // Helper to generate a random unique Barangay ID\r\n  \r\n\r\n  const fetchUsers = () => {\r\n    setLoading(true);\r\n    adminAPI.getUsers()\r\n      .then((data: any[]) => {\r\n        setUsers(data.map((user, idx) => ({\r\n          key: user._id || idx,\r\n          _id: user._id || null,\r\n          fullName: user.fullName || user.username || '',\r\n          email: user.email,\r\n          role: user.role,\r\n          isActive: user.isActive,\r\n          verified: !!user.verified,\r\n          createdAt: user.createdAt,\r\n          lastLogin: user.lastLogin,\r\n          avatar: user.avatar || null,\r\n          barangayId: user.barangayId || user.barangayID || user.barangay_id || null,\r\n        })));\r\n      })\r\n      .catch(() => setUsers([]))\r\n      .finally(() => setLoading(false));\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, []);\r\n\r\n  // Fetch resident info for a user when drawer opens\r\n  const fetchResidentForUser = async (user: any) => {\r\n    if (!user) return;\r\n    setResidentLoading(true);\r\n    try {\r\n      // Prefer fetching by barangayId when available\r\n      const barangayId = user.barangayId || user.barangayID || user.barangay_id;\r\n      if (barangayId) {\r\n        const resp: any = await adminAPI.getResidentByBarangayID(barangayId);\r\n        // server returns { resident, user }\r\n        setSelectedResident(resp?.resident || null);\r\n      } else if (user._id) {\r\n        const resp: any = await adminAPI.getUserWithResident(user._id);\r\n        setSelectedResident(resp?.resident || null);\r\n      } else {\r\n        setSelectedResident(null);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to fetch resident for user', err);\r\n      setSelectedResident(null);\r\n    } finally {\r\n      setResidentLoading(false);\r\n    }\r\n  };\r\n\r\n  // Disable a user (optionally suspend until a date). Updates UI after success.\r\n  const handleDisableUser = async (userId: string, suspendedUntil?: string | null) => {\r\n    if (!userId) return;\r\n    try {\r\n      message.loading({ content: 'Disabling user...', key: 'disable' });\r\n      const payload = suspendedUntil ? { suspendedUntil } : {};\r\n      const res: any = await adminAPI.disableUser(userId, payload);\r\n      message.success({ content: 'User disabled', key: 'disable', duration: 2 });\r\n      // Refresh list and selected user\r\n      await fetchUsers();\r\n      if (selectedUser && selectedUser._id === userId) {\r\n        setSelectedUser(res.user || res);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to disable user', err);\r\n      message.error('Failed to disable user');\r\n    }\r\n  };\r\n\r\n  const handleEnableUser = async (userId: string) => {\r\n    if (!userId) return;\r\n    try {\r\n      message.loading({ content: 'Enabling user...', key: 'enable' });\r\n      const res: any = await adminAPI.enableUser(userId);\r\n      message.success({ content: 'User enabled', key: 'enable', duration: 2 });\r\n      await fetchUsers();\r\n      if (selectedUser && selectedUser._id === userId) {\r\n        setSelectedUser(res.user || res);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to enable user', err);\r\n      message.error('Failed to enable user');\r\n    }\r\n  };\r\n\r\n  // Demote a staff user back to resident\r\n  const handleDemoteUser = async (userId: string) => {\r\n    if (!userId) return;\r\n    try {\r\n      message.loading({ content: 'Demoting user...', key: 'demote' });\r\n      const res: any = await adminAPI.demoteUser(userId);\r\n      message.success({ content: 'User demoted to resident', key: 'demote', duration: 2 });\r\n      await fetchUsers();\r\n      if (selectedUser && selectedUser._id === userId) {\r\n        setSelectedUser(res.user || res);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to demote user', err);\r\n      message.error('Failed to demote user');\r\n    }\r\n  };\r\n\r\n  // Toggle verified flag for a user (admin action)\r\n  const handleToggleVerified = async (userId: string, currentVerified: boolean) => {\r\n    if (!userId) return;\r\n    try {\r\n      const action = currentVerified ? 'Unverify' : 'Mark as Verified';\r\n      message.loading({ content: `${action}...`, key: 'verify' });\r\n      // Use verificationAPI to toggle verified flag on server\r\n      await (await import('../../services/api')).verificationAPI.verifyUser(userId, !currentVerified);\r\n      message.success({ content: `${action} succeeded`, key: 'verify', duration: 2 });\r\n      // Refresh user list and selected user view\r\n      await fetchUsers();\r\n      if (selectedUser && selectedUser._id === userId) {\r\n        setSelectedUser((prev: any) => prev ? { ...prev, verified: !currentVerified } : prev);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to toggle verified', err);\r\n      message.error('Failed to update verification status');\r\n    }\r\n  };\r\n\r\n  // add-user helpers removed (UI buttons were removed)\r\n\r\n  // (registration helpers removed  staff registration handled elsewhere)\r\n\r\n  // Filtered and searched users\r\n  const filteredUsers = users.filter(user => {\r\n    const matchesSearch =\r\n      user.fullName.toLowerCase().includes(search.toLowerCase()) ||\r\n      user.email.toLowerCase().includes(search.toLowerCase());\r\n    const matchesRole = roleFilter ? user.role === roleFilter : true;\r\n    const matchesStatus = statusFilter !== undefined ? user.isActive === statusFilter : true;\r\n    const matchesDate = dateRange && dateRange.length === 2\r\n      ? dayjs(user.createdAt).isAfter(dateRange[0], 'day') && dayjs(user.createdAt).isBefore(dateRange[1], 'day')\r\n      : true;\r\n    return matchesSearch && matchesRole && matchesStatus && matchesDate;\r\n  });\r\n\r\n  // Table columns with avatar, tags, actions, sticky header, selection\r\n  const columns = [\r\n    {\r\n      title: 'Name',\r\n      dataIndex: 'fullName',\r\n      key: 'fullName',\r\n      render: (text: string, record: any) => (\r\n        <Space>\r\n          {(() => {\r\n            let displayUser = record as any;\r\n            try {\r\n              const stored = localStorage.getItem('userProfile');\r\n              if (stored) displayUser = JSON.parse(stored);\r\n            } catch (err) {}\r\n            return (\r\n              <AppAvatar\r\n                style={{ backgroundColor: '#1890ff', verticalAlign: 'middle' }}\r\n                src={record.avatar}\r\n                user={displayUser}\r\n                size={36}\r\n              >\r\n                {(text && text.length > 0) ? text.charAt(0).toUpperCase() : '?'}\r\n              </AppAvatar>\r\n            );\r\n          })()}\r\n          <b>{text}</b>\r\n        </Space>\r\n      ),\r\n      sorter: (a: any, b: any) => a.fullName.localeCompare(b.fullName),\r\n      sortDirections: ['ascend' as SortOrder, 'descend' as SortOrder],\r\n      fixed: 'left' as const,\r\n    },\r\n    {\r\n      title: 'Barangay ID',\r\n      dataIndex: 'barangayId',\r\n      key: 'barangayId',\r\n      render: (id: string) => id || '',\r\n      width: 160,\r\n    },\r\n    {\r\n      title: 'Email',\r\n      dataIndex: 'email',\r\n      key: 'email',\r\n      sorter: (a: any, b: any) => a.email.localeCompare(b.email),\r\n      sortDirections: ['ascend' as SortOrder, 'descend' as SortOrder],\r\n    },\r\n    {\r\n      title: 'Role',\r\n      dataIndex: 'role',\r\n      key: 'role',\r\n      render: (role: string) => {\r\n        const r = role || '';\r\n        return <Tag color={r === 'admin' ? 'magenta' : r === 'staff' ? 'blue' : 'green'}>{r ? (r.charAt(0).toUpperCase() + r.slice(1)) : ''}</Tag>;\r\n      },\r\n      filters: roleOptions,\r\n      onFilter: (value: any, record: any) => record.role === value,\r\n    },\r\n    {\r\n      title: 'Status',\r\n      dataIndex: 'isActive',\r\n      key: 'isActive',\r\n      render: (active: boolean) => <Tag color={active ? 'green' : 'red'}>{active ? 'Active' : 'Inactive'}</Tag>,\r\n      filters: statusOptions,\r\n      onFilter: (value: any, record: any) => record.isActive === value,\r\n    },\r\n    {\r\n      title: 'Created',\r\n      dataIndex: 'createdAt',\r\n      key: 'createdAt',\r\n      render: (date: string) => dayjs(date).format('YYYY-MM-DD'),\r\n      sorter: (a: any, b: any) => new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime(),\r\n      sortDirections: ['ascend' as SortOrder, 'descend' as SortOrder],\r\n    },\r\n    {\r\n      title: 'Actions',\r\n      key: 'actions',\r\n      fixed: 'right' as const,\r\n      render: (_: any, record: any) => (\r\n        <Dropdown\r\n          popupRender={() => (\r\n            <Menu>\r\n              <Menu.Item key=\"edit\" icon={<EditOutlined />} onClick={() => { setSelectedUser(record); setDrawerOpen(true); }}>\r\n                Edit\r\n              </Menu.Item>\r\n              <Menu.Item key=\"logs\" icon={<EyeOutlined />} onClick={() => { /* View logs logic */ }}>\r\n                View Logs\r\n              </Menu.Item>\r\n              <Menu.Item key=\"deactivate\" icon={<StopOutlined />} onClick={() => { /* Deactivate logic */ }}>\r\n                Deactivate\r\n              </Menu.Item>\r\n              <Menu.Item key=\"toggleVerified\" icon={<CheckOutlined />} onClick={async () => {\r\n                if (!record || !record._id) { message.error('No user selected'); return; }\r\n                const confirmText = record.verified ? `Mark ${record.fullName || record.email} as unverified?` : `Mark ${record.fullName || record.email} as verified?`;\r\n                Modal.confirm({\r\n                  title: record.verified ? 'Unverify user' : 'Verify user',\r\n                  content: confirmText,\r\n                  onOk: async () => { await handleToggleVerified(record._id, !!record.verified); }\r\n                });\r\n              }}>\r\n                {record.verified ? 'Unverify' : 'Verify'}\r\n              </Menu.Item>\r\n              <Menu.Item key=\"disable_now\" icon={<StopOutlined />} onClick={async () => {\r\n                if (!record || !record._id) { message.error('No user selected'); return; }\r\n                // confirm and disable immediately\r\n                Modal.confirm({\r\n                  title: 'Disable user',\r\n                  content: `Are you sure you want to disable ${record.fullName || record.email || record._id}?`,\r\n                  onOk: async () => { await handleDisableUser(record._id); }\r\n                });\r\n              }}>\r\n                Disable\r\n              </Menu.Item>\r\n              {record.role === 'staff' && (\r\n                <Menu.Item key=\"demote\" icon={<ReloadOutlined />} onClick={async () => {\r\n                  if (!record || !record._id) { message.error('No user selected'); return; }\r\n                  Modal.confirm({\r\n                    title: 'Demote user',\r\n                    content: `Are you sure you want to demote ${record.fullName || record.email || record._id} to resident?`,\r\n                    onOk: async () => { await handleDemoteUser(record._id); }\r\n                  });\r\n                }}>\r\n                  Demote to Resident\r\n                </Menu.Item>\r\n              )}\r\n              <Menu.Item key=\"enable_now\" icon={<CheckOutlined />} onClick={async () => {\r\n                if (!record || !record._id) { message.error('No user selected'); return; }\r\n                Modal.confirm({\r\n                  title: 'Enable user',\r\n                  content: `Are you sure you want to enable ${record.fullName || record.email || record._id}?`,\r\n                  onOk: async () => { await handleEnableUser(record._id); }\r\n                });\r\n              }}>\r\n                Enable\r\n              </Menu.Item>\r\n              <Menu.Item key=\"delete\" icon={<DeleteOutlined />} danger onClick={() => { /* Delete logic */ }}>\r\n                Delete\r\n              </Menu.Item>\r\n            </Menu>\r\n          )}\r\n          trigger={['click']}\r\n        >\r\n          <Button icon={<MoreOutlined />} size=\"small\" />\r\n        </Dropdown>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  // Bulk actions bar\r\n  const hasSelection = selectedRowKeys.length > 0;\r\n  const bulkBar = hasSelection && (\r\n    <Space style={{ marginBottom: 16 }}>\r\n      <Button icon={<CheckOutlined />} onClick={() => {/* bulk activate */}}>Activate</Button>\r\n      <Button icon={<StopOutlined />} onClick={() => {/* bulk deactivate */}}>Deactivate</Button>\r\n      <Popconfirm title=\"Are you sure to delete selected users?\" onConfirm={() => {/* bulk delete */}} okText=\"Yes\" cancelText=\"No\">\r\n        <Button icon={<DeleteOutlined />} danger>Delete</Button>\r\n      </Popconfirm>\r\n      <span style={{ marginLeft: 8 }}>{`Selected ${selectedRowKeys.length} users`}</span>\r\n    </Space>\r\n  );\r\n\r\n  // Pagination info\r\n  const startIdx = (page - 1) * pageSize + 1;\r\n  const endIdx = Math.min(page * pageSize, filteredUsers.length);\r\n\r\n  return (\r\n    <div>\r\n      <Card\r\n        style={{ marginBottom: 16, borderRadius: 8, background: '#fff' }}\r\n        styles={{ body: { padding: 0 } }}\r\n        bordered={false}\r\n        title={\r\n          <Row align=\"middle\" justify=\"space-between\">\r\n            <Col>\r\n              <Typography.Title level={4} style={{ margin: 0 }}>User Management</Typography.Title>\r\n              <Breadcrumb>\r\n                <Breadcrumb.Item>Admin</Breadcrumb.Item>\r\n                <Breadcrumb.Item>User Management</Breadcrumb.Item>\r\n              </Breadcrumb>\r\n            </Col>\r\n            <Col>\r\n              <Space>\r\n                {/* Add-user buttons removed per request */}\r\n              </Space>\r\n            </Col>\r\n          </Row>\r\n        }\r\n      />\r\n      <Card style={{ borderRadius: 16, boxShadow: '0 2px 16px #40c9ff11' }}>\r\n        <Row gutter={16} style={{ marginBottom: 16 }} align=\"middle\">\r\n          <Col>\r\n            <Input.Search\r\n              placeholder=\"Search by name or email\"\r\n              value={search}\r\n              onChange={e => setSearch(e.target.value)}\r\n              allowClear\r\n              style={{ width: 200 }}\r\n            />\r\n          </Col>\r\n          <Col>\r\n            <Select\r\n              placeholder=\"Role\"\r\n              allowClear\r\n              style={{ width: 120 }}\r\n              value={roleFilter}\r\n              onChange={setRoleFilter}\r\n              options={roleOptions}\r\n            />\r\n          </Col>\r\n          <Col>\r\n            <Select\r\n              placeholder=\"Status\"\r\n              allowClear\r\n              style={{ width: 120 }}\r\n              value={statusFilter}\r\n              onChange={setStatusFilter}\r\n              options={statusOptions}\r\n            />\r\n          </Col>\r\n          <Col>\r\n            <DatePicker.RangePicker\r\n              value={dateRange}\r\n              onChange={setDateRange}\r\n              style={{ width: 220 }}\r\n              allowClear\r\n            />\r\n          </Col>\r\n          <Col>\r\n            <Button icon={<ReloadOutlined />} onClick={() => {\r\n              setSearch('');\r\n              setRoleFilter(undefined);\r\n              setStatusFilter(undefined);\r\n              setDateRange(null);\r\n            }}>Reset Filters</Button>\r\n          </Col>\r\n        </Row>\r\n        {bulkBar}\r\n        {loading ? <Spin size=\"large\" /> : (\r\n          <Table\r\n            columns={columns}\r\n            dataSource={filteredUsers}\r\n            rowSelection={{\r\n              selectedRowKeys,\r\n              onChange: setSelectedRowKeys,\r\n            }}\r\n            pagination={{\r\n              pageSize,\r\n              current: page,\r\n              onChange: setPage,\r\n              showSizeChanger: true,\r\n              pageSizeOptions: ['10', '20', '50', '100'],\r\n              onShowSizeChange: (_current, size) => setPageSize(size),\r\n              showTotal: (total) => `Showing ${startIdx}${endIdx} of ${total} users`,\r\n            }}\r\n            onRow={record => ({\r\n              onClick: () => {\r\n                setSelectedUser(record);\r\n                setDrawerOpen(true);\r\n                fetchResidentForUser(record);\r\n              },\r\n            })}\r\n            style={{ cursor: 'pointer' }}\r\n            scroll={{ x: 'max-content' }}\r\n            sticky\r\n          />\r\n        )}\r\n      </Card>\r\n\r\n      <Drawer\r\n        title={selectedUser ? selectedUser.fullName : 'User Profile'}\r\n        open={drawerOpen}\r\n        onClose={() => setDrawerOpen(false)}\r\n        width={400}\r\n      >\r\n        {selectedUser && (\r\n          <Space direction=\"vertical\" size=\"middle\" style={{ width: '100%' }}>\r\n            <Row align=\"middle\" gutter={16}>\r\n              <Col>\r\n                {(() => {\r\n                  let displayUser = selectedUser as any;\r\n                  try {\r\n                    const stored = localStorage.getItem('userProfile');\r\n                    if (stored) displayUser = JSON.parse(stored);\r\n                  } catch (err) {}\r\n                  const src = selectedResident && (selectedResident.profileImage || selectedResident.profileImageId)\r\n                    ? (selectedResident.profileImage ? selectedResident.profileImage : getAbsoluteApiUrl(`/resident/personal-info/avatar/${selectedResident.profileImageId}`))\r\n                    : (selectedUser.avatar || null);\r\n                  return (\r\n                    <AppAvatar size={64} style={{ backgroundColor: '#1890ff' }} src={src} user={displayUser}>\r\n                      {(selectedUser.fullName && selectedUser.fullName.length > 0) ? selectedUser.fullName.charAt(0).toUpperCase() : '?'}\r\n                    </AppAvatar>\r\n                  );\r\n                })()}\r\n              </Col>\r\n              <Col>\r\n                <Typography.Title level={5} style={{ margin: 0 }}>{selectedUser.fullName}</Typography.Title>\r\n                <div style={{ marginTop: 4 }}>\r\n                  <Tag color={selectedUser.isActive ? 'green' : 'red'} style={{ marginRight: 8 }}>{selectedUser.isActive ? 'Active' : 'Inactive'}</Tag>\r\n                  <Tag color={selectedUser.verified ? 'green' : 'default'} style={{ marginRight: 8 }}>{selectedUser.verified ? 'Verified' : 'Unverified'}</Tag>\r\n                  <Tag color={selectedUser.role === 'admin' ? 'magenta' : selectedUser.role === 'staff' ? 'blue' : 'green'}>{(selectedUser.role ? (selectedUser.role.charAt(0).toUpperCase() + selectedUser.role.slice(1)) : '')}</Tag>\r\n                </div>\r\n                {selectedUser.barangayId && (\r\n                  <div style={{ marginTop: 8 }}>\r\n                    <Typography.Text type=\"secondary\">Barangay ID: </Typography.Text>\r\n                    <Typography.Text copyable>{selectedUser.barangayId}</Typography.Text>\r\n                  </div>\r\n                )}\r\n              </Col>\r\n            </Row>\r\n            <Typography.Text strong>Email:</Typography.Text>\r\n            <Typography.Text>{selectedUser.email}</Typography.Text>\r\n\r\n            {/* Resident Information section (prefer resident container) */}\r\n            <Typography.Title level={5} style={{ marginTop: 12 }}>Resident Information</Typography.Title>\r\n            {residentLoading ? (\r\n              <Spin />\r\n            ) : selectedResident ? (\r\n              <>\r\n                {/* Personal / Identity */}\r\n                <Typography.Title level={5}>Personal Information</Typography.Title>\r\n                <Row gutter={[8, 8]}>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Full Name:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{`${selectedResident.firstName || ''} ${selectedResident.middleName || ''} ${selectedResident.lastName || ''}`.trim() || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Barangay ID:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.barangayID || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Username:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.username || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Email:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.email || selectedUser.email || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Phone:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.contactNumber || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Landline:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.landlineNumber || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n\r\n                  <Col span={24}>\r\n                    <Typography.Text strong>Address:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.address || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>DOB:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.birthDate ? dayjs(selectedResident.birthDate).format('YYYY-MM-DD') : (selectedResident.birthDate || 'N/A')}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Sex/Gender:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.sex || selectedResident.gender || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Civil/Marital Status:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.civilStatus || selectedResident.maritalStatus || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Nationality:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.nationality || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Occupation:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.occupation || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Education:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.educationalAttainment || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                </Row>\r\n\r\n                {/* Identification & IDs */}\r\n                <Typography.Title level={5} style={{ marginTop: 12 }}>Identification</Typography.Title>\r\n                <Row gutter={[8, 8]}>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Passport #:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.passportNumber || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Gov ID #:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.governmentIdNumber || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>TIN:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.tin || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Barangay Clearance #:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.barangayClearanceNumber || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                </Row>\r\n\r\n                {/* Family */}\r\n                <Typography.Title level={5} style={{ marginTop: 12 }}>Family</Typography.Title>\r\n                <Row gutter={[8, 8]}>\r\n                  <Col span={24}>\r\n                    <Typography.Text strong>Spouse:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.spouseName ? `${selectedResident.spouseName} ${selectedResident.spouseLastName || ''}` : 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Number of Children:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{(selectedResident.numberOfChildren || selectedResident.numberOfChildren === 0) ? selectedResident.numberOfChildren : 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Children Names/Ages:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.childrenNames ? `${selectedResident.childrenNames} (${selectedResident.childrenAges || ''})` : 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Mother:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.motherName || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Father:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.fatherName || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                </Row>\r\n\r\n                {/* Emergency */}\r\n                <Typography.Title level={5} style={{ marginTop: 12 }}>Emergency Contact</Typography.Title>\r\n                <Row gutter={[8, 8]}>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Contact Name:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.emergencyContactName || selectedResident.emergencyContact || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Relationship:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.emergencyContactRelationship || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Emergency Phone:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.emergencyContact || selectedResident.spouseContactNumber || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                </Row>\r\n\r\n                {/* Business */}\r\n                <Typography.Title level={5} style={{ marginTop: 12 }}>Business / Employment</Typography.Title>\r\n                <Row gutter={[8, 8]}>\r\n                  <Col span={24}>\r\n                    <Typography.Text strong>Business Name:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.businessName || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Business Type:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.businessType || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Business Contact:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.businessContactNumber || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={24}>\r\n                    <Typography.Text strong>Business Address:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.businessAddress || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                </Row>\r\n\r\n                {/* Other fields / meta */}\r\n                <Typography.Title level={5} style={{ marginTop: 12 }}>Other</Typography.Title>\r\n                <Row gutter={[8, 8]}>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Blood Type:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.bloodType || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Disability Status:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.disabilityStatus || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                </Row>\r\n\r\n                <Row style={{ marginTop: 12 }} gutter={[8, 8]}>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Created At:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.createdAt ? dayjs(selectedResident.createdAt).format('YYYY-MM-DD HH:mm') : 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                  <Col span={12}>\r\n                    <Typography.Text strong>Last Login:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedUser.lastLogin ? dayjs(selectedUser.lastLogin).format('YYYY-MM-DD HH:mm') : 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                </Row>\r\n\r\n                <Typography.Title level={5} style={{ marginTop: 12 }}>Social Media / Links</Typography.Title>\r\n                <Row gutter={[8, 8]}>\r\n                  <Col span={24}>\r\n                    <Typography.Text strong>Facebook:</Typography.Text>\r\n                    {selectedResident.facebook ? (\r\n                      <Typography.Text style={{ display: 'block' }}>\r\n                        <a href={selectedResident.facebook} target=\"_blank\" rel=\"noreferrer\">{selectedResident.facebook}</a>\r\n                      </Typography.Text>\r\n                    ) : <Typography.Text style={{ display: 'block' }}>N/A</Typography.Text>}\r\n                  </Col>\r\n                  <Col span={24}>\r\n                    <Typography.Text strong>Instagram:</Typography.Text>\r\n                    {selectedResident.instagram ? (\r\n                      <Typography.Text style={{ display: 'block' }}>\r\n                        <a href={selectedResident.instagram} target=\"_blank\" rel=\"noreferrer\">{selectedResident.instagram}</a>\r\n                      </Typography.Text>\r\n                    ) : <Typography.Text style={{ display: 'block' }}>N/A</Typography.Text>}\r\n                  </Col>\r\n                  <Col span={24}>\r\n                    <Typography.Text strong>Other Link:</Typography.Text>\r\n                    <Typography.Text style={{ display: 'block' }}>{selectedResident.website || 'N/A'}</Typography.Text>\r\n                  </Col>\r\n                </Row>\r\n              </>\r\n            ) : (\r\n              <Typography.Text type=\"warning\">This resident doesn't have resident info yet.</Typography.Text>\r\n            )}\r\n\r\n            {/* Social Media section */}\r\n            <Typography.Title level={5} style={{ marginTop: 12 }}>Social Media</Typography.Title>\r\n            <Row gutter={[8, 8]}>\r\n              <Col span={24}>\r\n                <Typography.Text strong>Facebook:</Typography.Text>\r\n                {selectedUser.facebook ? (\r\n                  <Typography.Text style={{ display: 'block' }}>\r\n                    <a href={selectedUser.facebook} target=\"_blank\" rel=\"noreferrer\">{selectedUser.facebook}</a>\r\n                  </Typography.Text>\r\n                ) : <Typography.Text style={{ display: 'block' }}>N/A</Typography.Text>}\r\n              </Col>\r\n              <Col span={24}>\r\n                <Typography.Text strong>Twitter:</Typography.Text>\r\n                {selectedUser.twitter ? (\r\n                  <Typography.Text style={{ display: 'block' }}>\r\n                    <a href={selectedUser.twitter} target=\"_blank\" rel=\"noreferrer\">{selectedUser.twitter}</a>\r\n                  </Typography.Text>\r\n                ) : <Typography.Text style={{ display: 'block' }}>N/A</Typography.Text>}\r\n              </Col>\r\n              <Col span={24}>\r\n                <Typography.Text strong>Instagram:</Typography.Text>\r\n                {selectedUser.instagram ? (\r\n                  <Typography.Text style={{ display: 'block' }}>\r\n                    <a href={selectedUser.instagram} target=\"_blank\" rel=\"noreferrer\">{selectedUser.instagram}</a>\r\n                  </Typography.Text>\r\n                ) : <Typography.Text style={{ display: 'block' }}>N/A</Typography.Text>}\r\n              </Col>\r\n            </Row>\r\n\r\n            <div style={{ marginTop: 16, display: 'flex', flexDirection: 'column', gap: 8 }}>\r\n              <Space>\r\n                <Button icon={<EditOutlined />} onClick={() => {\r\n                  setUserFormValues(selectedUser || {});\r\n                  setEditUserModalOpen(true);\r\n                }}>Edit User</Button>\r\n                <Button onClick={() => {\r\n                  if (selectedResident) {\r\n                    setEditFormValues(selectedResident || {});\r\n                    setEditModalOpen(true);\r\n                  } else {\r\n                    message.warning('No resident data to edit');\r\n                  }\r\n                }}>Edit Resident</Button>\r\n              </Space>\r\n\r\n              <Space>\r\n                <Button icon={<EyeOutlined />} onClick={() => { /* view logs action (kept as placeholder) */ }}>View Logs</Button>\r\n                {selectedUser && selectedUser.role === 'staff' && (\r\n                  <Popconfirm\r\n                    title={`Demote ${selectedUser.fullName || selectedUser.email}?`}\r\n                    onConfirm={async () => { if (selectedUser) await handleDemoteUser(selectedUser._id); }}\r\n                    okText=\"Yes\"\r\n                    cancelText=\"No\"\r\n                  >\r\n                    <Button icon={<ReloadOutlined />}>Demote</Button>\r\n                  </Popconfirm>\r\n                )}\r\n                {selectedUser && selectedUser.isActive ? (\r\n                  <Popconfirm\r\n                    title={`Disable ${selectedUser.fullName || selectedUser.email}?`}\r\n                    onConfirm={async () => { await handleDisableUser(selectedUser._id); }}\r\n                    okText=\"Yes\"\r\n                    cancelText=\"No\"\r\n                  >\r\n                    <Button icon={<StopOutlined />} danger>Deactivate</Button>\r\n                  </Popconfirm>\r\n                ) : (\r\n                  <Button icon={<CheckOutlined />} onClick={async () => { if (selectedUser) await handleEnableUser(selectedUser._id); }}>Enable</Button>\r\n                )}\r\n              </Space>\r\n            </div>\r\n            {/* Full resident JSON view removed per design */}\r\n          </Space>\r\n        )}\r\n      </Drawer>\r\n\r\n      <Modal\r\n        title=\"Edit Resident\"\r\n        open={editModalOpen}\r\n        onCancel={() => setEditModalOpen(false)}\r\n        onOk={async () => {\r\n          if (!selectedResident) return;\r\n          try {\r\n            // merge existing resident with form changes; server will whitelist allowed fields\r\n            const payload: any = { ...selectedResident, ...editFormValues };\r\n            const res = await adminAPI.updateResident(selectedResident._id, payload);\r\n            message.success('Resident updated');\r\n            setSelectedResident(res?.resident || { ...selectedResident, ...payload });\r\n            setEditModalOpen(false);\r\n          } catch (err: any) {\r\n            console.error('Failed to save resident', err);\r\n            message.error('Failed to update resident.');\r\n          }\r\n        }}\r\n        width={900}\r\n      >\r\n        {/* Tabbed structured form with validation and avatar upload */}\r\n        <Form\r\n          layout=\"vertical\"\r\n          initialValues={{ ...(selectedResident || {}), barangayID: selectedResident?.barangayID || selectedUser?.barangayId }}\r\n          onValuesChange={(_, values) => setEditFormValues(values as any)}\r\n        >\r\n          <Tabs defaultActiveKey=\"personal\">\r\n            <Tabs.TabPane tab=\"Personal\" key=\"personal\">\r\n              <Row gutter={8}>\r\n                <Col span={8}><Form.Item name=\"firstName\" label=\"First Name\" rules={[{ required: true, message: 'First name is required' }]}><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"middleName\" label=\"Middle Name\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"lastName\" label=\"Last Name\" rules={[{ required: true, message: 'Last name is required' }]}><Input /></Form.Item></Col>\r\n              </Row>\r\n              <Row gutter={8}>\r\n                <Col span={8}><Form.Item name=\"username\" label=\"Username\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"barangayID\" label=\"Barangay ID\" rules={[{ required: true, message: 'Barangay ID is required' }]}><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"email\" label=\"Email\" rules={[{ type: 'email', message: 'Enter a valid email' }]}><Input /></Form.Item></Col>\r\n              </Row>\r\n              <Row gutter={8}>\r\n                <Col span={8}><Form.Item name=\"contactNumber\" label=\"Contact Number\" rules={[{ pattern: /^[0-9+\\-() ]{6,20}$/, message: 'Enter a valid phone number' }]}><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"landlineNumber\" label=\"Landline\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"address\" label=\"Address\"><Input /></Form.Item></Col>\r\n              </Row>\r\n              <Row gutter={8}>\r\n                <Col span={8}><Form.Item name=\"birthDate\" label=\"Birth Date\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"placeOfBirth\" label=\"Place of Birth\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"age\" label=\"Age\"><Input type=\"number\" /></Form.Item></Col>\r\n              </Row>\r\n            </Tabs.TabPane>\r\n\r\n            <Tabs.TabPane tab=\"IDs\" key=\"ids\">\r\n              <Row gutter={8}>\r\n                <Col span={8}><Form.Item name=\"passportNumber\" label=\"Passport #\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"governmentIdNumber\" label=\"Government ID #\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"tin\" label=\"TIN\"><Input /></Form.Item></Col>\r\n              </Row>\r\n              <Row gutter={8}>\r\n                <Col span={8}><Form.Item name=\"bloodType\" label=\"Blood Type\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"disabilityStatus\" label=\"Disability Status\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"educationalAttainment\" label=\"Education\"><Input /></Form.Item></Col>\r\n              </Row>\r\n            </Tabs.TabPane>\r\n\r\n            <Tabs.TabPane tab=\"Family\" key=\"family\">\r\n              <Row gutter={8}>\r\n                <Col span={8}><Form.Item name=\"spouseName\" label=\"Spouse Name\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"spouseMiddleName\" label=\"Spouse Middle\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"spouseLastName\" label=\"Spouse Last\"><Input /></Form.Item></Col>\r\n              </Row>\r\n              <Row gutter={8}>\r\n                <Col span={8}><Form.Item name=\"spouseAge\" label=\"Spouse Age\"><Input type=\"number\" /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"spouseBirthDate\" label=\"Spouse DOB\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"spouseOccupation\" label=\"Spouse Occupation\"><Input /></Form.Item></Col>\r\n              </Row>\r\n              <Row gutter={8}>\r\n                <Col span={8}><Form.Item name=\"numberOfChildren\" label=\"# Children\"><Input type=\"number\" /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"childrenNames\" label=\"Children Names\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"childrenAges\" label=\"Children Ages\"><Input /></Form.Item></Col>\r\n              </Row>\r\n              <Row gutter={8}>\r\n                <Col span={12}><Form.Item name=\"motherName\" label=\"Mother's Name\"><Input /></Form.Item></Col>\r\n                <Col span={12}><Form.Item name=\"fatherName\" label=\"Father's Name\"><Input /></Form.Item></Col>\r\n              </Row>\r\n            </Tabs.TabPane>\r\n\r\n            <Tabs.TabPane tab=\"Business\" key=\"business\">\r\n              <Row gutter={8}>\r\n                <Col span={12}><Form.Item name=\"businessName\" label=\"Business Name\"><Input /></Form.Item></Col>\r\n                <Col span={12}><Form.Item name=\"businessType\" label=\"Business Type\"><Input /></Form.Item></Col>\r\n              </Row>\r\n              <Row gutter={8}>\r\n                <Col span={12}><Form.Item name=\"businessContactNumber\" label=\"Business Contact\"><Input /></Form.Item></Col>\r\n                <Col span={12}><Form.Item name=\"businessEmail\" label=\"Business Email\"><Input /></Form.Item></Col>\r\n              </Row>\r\n              <Row gutter={8}>\r\n                <Col span={24}><Form.Item name=\"businessAddress\" label=\"Business Address\"><Input /></Form.Item></Col>\r\n              </Row>\r\n              <Row gutter={8}>\r\n                <Col span={8}><Form.Item name=\"registrationNumber\" label=\"Registration #\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"businessPermitNumber\" label=\"Business Permit #\"><Input /></Form.Item></Col>\r\n                <Col span={8}><Form.Item name=\"barangayClearanceNumber\" label=\"Barangay Clearance #\"><Input /></Form.Item></Col>\r\n              </Row>\r\n            </Tabs.TabPane>\r\n\r\n            <Tabs.TabPane tab=\"Avatar / Media\" key=\"media\">\r\n              <Row gutter={8}>\r\n                <Col span={12}>\r\n                  <Form.Item label=\"Upload Profile Image\">\r\n                    <Upload\r\n                      accept=\"image/*\"\r\n                      showUploadList={false}\r\n                      beforeUpload={() => false}\r\n                      customRequest={(options: any) => {\r\n                        if (!selectedResident) return;\r\n                        const file = options.file as File;\r\n                        setUploading(true);\r\n                        setUploadProgress(10);\r\n                        // create a pending upload promise so modal save can await it\r\n                        const p = (async () => {\r\n                          try {\r\n                            // small simulated progress\r\n                            setUploadProgress(30);\r\n                            const resp: any = await adminAPI.uploadResidentAvatar(selectedResident._id, file);\r\n                            setUploadProgress(80);\r\n                            if (resp?.resident) {\r\n                              setSelectedResident(resp.resident);\r\n                              setEditFormValues((prev: any) => ({ ...prev, profileImage: resp.resident.profileImage, profileImageId: resp.resident.profileImageId }));\r\n                              setUploadPreview(resp.resident.profileImage || `${getAbsoluteApiUrl(`/resident/personal-info/avatar/${resp.fileId}`)}?t=${Date.now()}`);\r\n                            } else if (resp?.fileId) {\r\n                              setEditFormValues((prev: any) => ({ ...prev, profileImage: getAbsoluteApiUrl(`/resident/personal-info/avatar/${resp.fileId}`), profileImageId: resp.fileId }));\r\n                              setUploadPreview(`${getAbsoluteApiUrl(`/resident/personal-info/avatar/${resp.fileId}`)}?t=${Date.now()}`);\r\n                            }\r\n                            setUploadProgress(100);\r\n                            message.success('Avatar uploaded');\r\n                            return resp;\r\n                          } catch (e: any) {\r\n                            console.error('Avatar upload failed', e);\r\n                            message.error(e?.message || 'Avatar upload failed');\r\n                            throw e;\r\n                          } finally {\r\n                            setUploading(false);\r\n                          }\r\n                        })();\r\n                        pendingUploadRef.current = p;\r\n                        return p as any;\r\n                      }}\r\n                    >\r\n                      <Button type=\"default\">Choose Image</Button>\r\n                    </Upload>\r\n                    {uploading && <div style={{ marginTop: 8 }}>Uploading: {uploadProgress}%</div>}\r\n                    {uploadPreview && <div style={{ marginTop: 8 }}><img src={typeof uploadPreview === 'string' && !uploadPreview.startsWith('http') ? getAbsoluteApiUrl(uploadPreview) : uploadPreview} alt=\"preview\" style={{ maxWidth: 120, maxHeight: 120, borderRadius: 6 }} /></div>}\r\n                  </Form.Item>\r\n                </Col>\r\n                <Col span={12}>\r\n                  <Form.Item name=\"profileImage\" label=\"Profile Image URL\"><Input /></Form.Item>\r\n                  <Form.Item name=\"profileImageId\" label=\"Profile Image ID\"><Input /></Form.Item>\r\n                </Col>\r\n              </Row>\r\n            </Tabs.TabPane>\r\n          </Tabs>\r\n        </Form>\r\n      </Modal>\r\n\r\n      {/* Edit User Modal */}\r\n      <Modal\r\n        title=\"Edit User\"\r\n        open={editUserModalOpen}\r\n        onCancel={() => setEditUserModalOpen(false)}\r\n        onOk={async () => {\r\n          try {\r\n            // Do not allow changing barangayId or role from this modal (read-only shown)\r\n            const payload = { ...userFormValues };\r\n            // Remove non-editable fields if present\r\n            delete payload.barangayId;\r\n            delete payload.role;\r\n            // Call admin API to update user\r\n            await adminAPI.updateUser(selectedUser._id, payload);\r\n            message.success('User updated');\r\n            // Update local list and selectedUser\r\n            const updatedUsers = users.map(u => u._id === selectedUser._id ? { ...u, ...payload } : u);\r\n            setUsers(updatedUsers);\r\n            setSelectedUser((prev: any) => prev ? { ...prev, ...payload } : prev);\r\n            setEditUserModalOpen(false);\r\n          } catch (err) {\r\n            console.error('Failed to update user', err);\r\n            message.error('Failed to update user');\r\n          }\r\n        }}\r\n        width={600}\r\n      >\r\n        <Form layout=\"vertical\" initialValues={userFormValues} onValuesChange={(_, vals) => setUserFormValues(vals)}>\r\n          <Row gutter={8}>\r\n            <Col span={12}>\r\n              <Form.Item name=\"fullName\" label=\"Full Name\" rules={[{ required: true, message: 'Full name required' }]}>\r\n                <Input />\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={12}>\r\n              <Form.Item name=\"email\" label=\"Email\" rules={[{ type: 'email', message: 'Enter a valid email' }]}>\r\n                <Input />\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <Row gutter={8}>\r\n            <Col span={12}>\r\n              <Form.Item name=\"isActive\" label=\"Active\">\r\n                <Select options={[{ label: 'Active', value: true }, { label: 'Inactive', value: false }]} />\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={12}>\r\n              <Form.Item label=\"Role\">\r\n                <Input value={selectedUser?.role} disabled />\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n          <Row gutter={8}>\r\n            <Col span={24}>\r\n              <Form.Item label=\"Barangay ID\">\r\n                <Input value={selectedUser?.barangayId || selectedUser?.barangayID || ''} disabled />\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n        </Form>\r\n      </Modal>\r\n\r\n      {/* Staff Registration Modal */}\r\n      {/* Staff Registration Modal removed */}\r\n\r\n      {/* User Registration Modal */}\r\n      {/* User Registration Modal removed */}\r\n  </div>\r\n  );\r\n};\r\n\r\nexport default UserManagement;\r\n","\r\n// Activity logs temporarily disabled per request.\r\n// The original implementation was removed to prevent the system from using activity logs.\r\nimport React from 'react';\r\n\r\nconst ActivityLogs: React.FC = () => {\r\n  // Return a minimal placeholder so the route/component can remain mounted safely.\r\n  return (\r\n    <div style={{ padding: 20 }}>\r\n      <h3>Activity Logs Disabled</h3>\r\n      <p>The Activity Logs feature has been temporarily disabled in the system.</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ActivityLogs;\r\n","\r\nimport React, { useEffect, useState, useCallback, useRef, useMemo } from 'react';\r\nimport { Card, Row, Col, Divider, Skeleton, Empty, Form, Select, DatePicker, Space, Typography, Checkbox, Drawer, Button, Switch, Modal, message, Alert, Dropdown } from 'antd';\r\nimport { DownOutlined } from '@ant-design/icons';\r\nimport { QueryClient, QueryClientProvider, useQueries } from '@tanstack/react-query';\r\nimport { Pie, Bar, Line, Area } from '@ant-design/charts';\r\nimport { axiosInstance } from '../../services/api';\r\nimport type { Moment } from 'moment'; // Add this import at the top if using moment\r\nimport jsPDF from 'jspdf';\r\n\r\nconst { RangePicker } = DatePicker;\r\nconst { Option } = Select;\r\n\r\n// Chart definitions (top-level so hooks depending on them stay stable)\r\n// Only include charts backed by server endpoints to avoid 404s\r\nconst CHARTS: Record<string, { title: string; chartType: 'pie'|'bar'|'line'|'area'; endpoint: string; colors?: string[] }> = {\r\n  gender: { title: 'Sex Distribution', chartType: 'pie', endpoint: '/analytics/gender', colors: ['#1890ff', '#00bcd4', '#888888'] },\r\n  age: { title: 'Age Groups', chartType: 'bar', endpoint: '/analytics/age', colors: ['#1890ff'] },\r\n  'civil-status': { title: 'Civil Status', chartType: 'bar', endpoint: '/analytics/civil-status', colors: ['#1890ff'] },\r\n  education: { title: 'Education', chartType: 'bar', endpoint: '/analytics/education', colors: ['#13c2c2'] },\r\n  'documents-monthly': { title: 'Monthly Document Requests', chartType: 'line', endpoint: '/analytics/documents-monthly', colors: ['#722ed1'] },\r\n};\r\n\r\n// stable array of chart ids (top-level so it's stable across renders)\r\nconst CHART_IDS = Object.keys(CHARTS);\r\n\r\n// default QueryClient shared for this module\r\nconst defaultQueryClient = new QueryClient({ defaultOptions: { queries: { retry: 2, staleTime: 60_000, refetchOnWindowFocus: false } } });\r\n\r\nconst StatisticsInner: React.FC = () => {\r\n  const [loadingSummary, setLoadingSummary] = useState(true);\r\n  const [summary, setSummary] = useState<any>(null);\r\n\r\n  // chart data keyed by chart id\r\n  const [chartData, setChartData] = useState<Record<string, any[]>>({});\r\n  const [chartLoading, setChartLoading] = useState<Record<string, boolean>>({});\r\n\r\n  // (removed unused genderCounts state)\r\n\r\n  const [filters, setFilters] = useState<{ dateRange: Moment[]; residentType: string }>({ dateRange: [], residentType: '' });\r\n\r\n  // selected chart ids\r\n  const [selectedCharts, setSelectedCharts] = useState<string[]>(['gender', 'age', 'occupation', 'education', 'civil-status']);\r\n  // Toggle: when enabled, automatically show only charts that have data\r\n  const [autoEnableWhenData, setAutoEnableWhenData] = useState<boolean>(false);\r\n  // store previous selection to restore when toggle is disabled\r\n  const prevSelectionRef = useRef<string[] | null>(null);\r\n  // Chart settings persisted in localStorage\r\n  const [settingsOpen, setSettingsOpen] = useState(false);\r\n  const [chartSettings, setChartSettings] = useState<Record<string, any>>(() => {\r\n    try {\r\n      const raw = localStorage.getItem('statsChartSettings');\r\n      return raw ? JSON.parse(raw) : {};\r\n    } catch (e) {\r\n      return {};\r\n    }\r\n  });\r\n  const [settingsChartId, setSettingsChartId] = useState<string>('gender');\r\n  // Dropdown controlled open state and pending selection for Apply/Cancel behavior\r\n  const [chartsDropdownOpen, setChartsDropdownOpen] = useState<boolean>(false);\r\n  const [pendingSelectedCharts, setPendingSelectedCharts] = useState<string[]>(selectedCharts);\r\n\r\n  const fetchSummary = useCallback(async () => {\r\n    setLoadingSummary(true);\r\n    try {\r\n      const res = await axiosInstance.get('/analytics/summary', {\r\n        params: {\r\n          startDate: filters.dateRange?.[0]?.format?.('YYYY-MM-DD'),\r\n          endDate: filters.dateRange?.[1]?.format?.('YYYY-MM-DD'),\r\n          residentType: filters.residentType,\r\n        }\r\n      });\r\n      setSummary(res.data || null);\r\n    } catch (err) {\r\n      setSummary(null);\r\n    } finally {\r\n      setLoadingSummary(false);\r\n    }\r\n  }, [filters]);\r\n\r\n  // call summary on mount and whenever filters change (fetchSummary is stable via useCallback)\r\n  useEffect(() => {\r\n    void fetchSummary();\r\n  }, [fetchSummary]);\r\n\r\n  // Fetch gender distribution separately\r\n  // We'll fetch gender via the unified endpoints below when needed\r\n\r\n  // Fetch server-side pre-bucketed age groups\r\n  // pre-bucketed age groups handled via the /age endpoint\r\n\r\n  // Fetch age distributions and bucket them into age groups for the Age Groups chart\r\n  // age bucketing will be performed by server-side /api/analytics/age endpoint\r\n\r\n  \r\n\r\n\r\n  // Fetch one chart's data\r\n  const fetchChart = useCallback(async (chartId: string) => {\r\n    const def = CHARTS[chartId];\r\n    if (!def) return;\r\n    setChartLoading(c => ({ ...c, [chartId]: true }));\r\n    try {\r\n      // choose date range from chart-specific settings if provided, otherwise use global filters\r\n      const cs = chartSettings[chartId] || {};\r\n      const start = cs.dateRange?.[0]?.format?.('YYYY-MM-DD') || filters.dateRange?.[0]?.format?.('YYYY-MM-DD');\r\n      const end = cs.dateRange?.[1]?.format?.('YYYY-MM-DD') || filters.dateRange?.[1]?.format?.('YYYY-MM-DD');\r\n      const res = await axiosInstance.get(def.endpoint, { params: { startDate: start, endDate: end } });\r\n      let payload = res.data?.data || [];\r\n      // server returns { name, value } for sex endpoint; map to { type, value } expected by charts\r\n      if (chartId === 'gender') {\r\n        payload = payload.map((p: any) => ({ type: p.name ?? p.type ?? 'N/A', value: p.value ?? 0 }));\r\n      }\r\n      setChartData(d => ({ ...d, [chartId]: payload }));\r\n      // (removed unused genderCounts population)\r\n    } catch (err) {\r\n      console.error('Error fetching chart', chartId, err);\r\n      setChartData(d => ({ ...d, [chartId]: [] }));\r\n    } finally {\r\n      setChartLoading(c => ({ ...c, [chartId]: false }));\r\n    }\r\n  }, [filters, chartSettings]);\r\n\r\n  // persist chartSettings to localStorage whenever they change\r\n  useEffect(() => {\r\n    try {\r\n      localStorage.setItem('statsChartSettings', JSON.stringify(chartSettings));\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n  }, [chartSettings]);\r\n\r\n  // When selection changes, trigger refetch for selected charts (chartQueriesMap is memoized below)\r\n  // NOTE: effect is declared later after chartQueriesMapMemo is created to avoid using it before initialization\r\n\r\n  // Example data mapping (adjust to your backend response)\r\n  // Prefer explicit totalResidents from analytics/gender endpoint if present, otherwise fall back to monthly aggregation\r\n  const totalResidents = summary?.totalResidents ?? 0;\r\n  const totalDocuments = summary?.totalDocumentRequests ?? 0;\r\n\r\n  const ageBarData = chartData['age'] || [];\r\n  const ageMax = ageBarData && ageBarData.length ? Math.max(...ageBarData.map((d: any) => Number(d.value) || 0)) : 0;\r\n  const ageAxisMax = Math.ceil(ageMax / 5) * 5 || 5;\r\n\r\n  const monthlyDocData = chartData['documents-monthly'] || [];\r\n\r\n  // ChartCard component\r\n  const ChartCard: React.FC<{ id?: string; title: string; chartType: 'pie'|'bar'|'line'|'area'; data?: any[]; loading?: boolean; colors?: string[] }> = ({ id, title, chartType, data = [], loading, colors }) => {\r\n    const hasData = Array.isArray(data) && data.length > 0;\r\n    // apply per-chart settings overrides\r\n    const cs = id ? (chartSettings[id] || {}) : {};\r\n    const effectiveChartType = cs.chartType || chartType;\r\n    const showLabels = cs.showLabels ?? true;\r\n    const showTooltips = cs.showTooltips ?? true;\r\n    const showLegend = cs.showLegend ?? true;\r\n\r\n    return (\r\n      <Card\r\n        title={title}\r\n        style={{ borderRadius: 12, boxShadow: '0 8px 24px rgba(15,15,15,0.06)' }}\r\n        styles={{ body: { padding: 16 } }}\r\n      >\r\n        {loading ? <Skeleton active /> : hasData ? (\r\n          effectiveChartType === 'pie' ? (\r\n            <div ref={(el) => { if (id) chartRefs.current[id] = el; }} style={{ background: '#ffffff' }}>\r\n              {\r\n                // normalize pie data to fixed fields to avoid AntV passing wrapper objects without type/value\r\n              }\r\n              {(() => {\r\n                const pieData = (data || []).map((d: any) => {\r\n                  const rawLabel = (d?.type ?? d?.name ?? d?.group ?? d?._id ?? 'Unknown').toString();\r\n                  const norm = rawLabel.trim();\r\n                  return { label: norm, valueNumber: Number(d?.value ?? d?.count ?? 0) };\r\n                });\r\n                return (\r\n                  <Pie\r\n                    data={pieData}\r\n                    angleField=\"valueNumber\"\r\n                    colorField=\"label\"\r\n                    radius={0.9}\r\n                    label={showLabels ? { formatter: (datum: any) => {\r\n                      const p = datum?.data || datum || {};\r\n                      const label = p?.label ?? p?.type ?? 'Unknown';\r\n                      const val = Number(p?.valueNumber ?? p?.value ?? p?.count ?? 0) || 0;\r\n                      return `${label} (${val})`;\r\n                    } } : false}\r\n                    tooltip={showTooltips ? { formatter: (datum: any) => {\r\n                      const p = datum?.data || datum || {};\r\n                      return { name: p?.label ?? p?.type ?? 'Unknown', value: Number(p?.valueNumber ?? p?.value ?? p?.count ?? 0) || 0 };\r\n                    } } : false}\r\n                    color={colors}\r\n                    statistic={{ title: { formatter: () => title }, content: { formatter: () => `${(pieData || []).reduce((s: number, d: any) => s + (Number(d.valueNumber) || 0), 0)} total` } }}\r\n                    legend={showLegend ? { position: 'bottom', formatter: (text: any) => {\r\n                      // append count to legend label\r\n                      const item = (pieData || []).find((p: any) => p.label === text);\r\n                      const val = item ? Number(item.valueNumber || 0) : 0;\r\n                      return `${text} (${val})`;\r\n                    } } : false}\r\n                    height={220}\r\n                  />\r\n                );\r\n              })()}\r\n            </div>\r\n          ) : effectiveChartType === 'bar' ? (\r\n            <div ref={(el) => { if (id) chartRefs.current[id] = el; }} style={{ background: '#ffffff' }}>\r\n              <Bar data={data} xField=\"type\" yField=\"value\" color={colors && colors[0]} label={showLabels ? undefined : false} legend={showLegend ? undefined : false} tooltip={showTooltips ? undefined : false} yAxis={{ min: 0, max: ageAxisMax, tickInterval: 5 }} height={220} />\r\n            </div>\r\n          ) : effectiveChartType === 'line' ? (\r\n            <div ref={(el) => { if (id) chartRefs.current[id] = el; }} style={{ background: '#ffffff' }}>\r\n              <Line data={data} xField=\"type\" yField=\"value\" legend={showLegend ? undefined : false} tooltip={showTooltips ? undefined : false} height={220} />\r\n            </div>\r\n          ) : (\r\n            <div ref={(el) => { if (id) chartRefs.current[id] = el; }} style={{ background: '#ffffff' }}>\r\n              <Area data={data} xField=\"type\" yField=\"value\" legend={showLegend ? undefined : false} tooltip={showTooltips ? undefined : false} height={220} />\r\n            </div>\r\n          )\r\n        ) : <Empty description=\"No data\" />}\r\n      </Card>\r\n    );\r\n  };\r\n\r\n\r\n  // refs for chart containers to capture DOM for PDF\r\n  const chartRefs = useRef<Record<string, HTMLDivElement | null>>({});\r\n  // ref for the whole dashboard area\r\n  const dashboardRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  const chartIds = Object.keys(CHARTS);\r\n\r\n  // create queries for each chart using useQueries (keeps hooks rules safe)\r\n  const chartQueryResults = useQueries({\r\n    queries: chartIds.map((id) => {\r\n      return {\r\n        queryKey: [\r\n          'chart',\r\n          id,\r\n          filters.dateRange?.[0]?.format?.('YYYY-MM-DD') || null,\r\n          filters.dateRange?.[1]?.format?.('YYYY-MM-DD') || null,\r\n          (chartSettings[id]?.dateRange?.[0]?.format?.('YYYY-MM-DD')) || null,\r\n          (chartSettings[id]?.dateRange?.[1]?.format?.('YYYY-MM-DD')) || null,\r\n          filters.residentType || null\r\n        ],\r\n        queryFn: async () => {\r\n          const cs = chartSettings[id] || {};\r\n          const start = cs.dateRange?.[0]?.format?.('YYYY-MM-DD') || filters.dateRange?.[0]?.format?.('YYYY-MM-DD');\r\n          const end = cs.dateRange?.[1]?.format?.('YYYY-MM-DD') || filters.dateRange?.[1]?.format?.('YYYY-MM-DD');\r\n          const res = await axiosInstance.get(CHARTS[id].endpoint, { params: { startDate: start, endDate: end, residentType: filters.residentType } });\r\n          return res.data?.data || [];\r\n        },\r\n        retry: 2\r\n      };\r\n    })\r\n  });\r\n  // build a stable key from query result data to use in deps and memoization\r\n  const chartQueryDataKey = chartQueryResults.map(r => JSON.stringify(r?.data || '')).join('|');\r\n\r\n  // `chartQueryDataKey` is a stable fingerprint derived from `chartQueryResults`' data\r\n  // Include `chartQueryResults` explicitly to satisfy the hook dependency analyzer.\r\n  const chartQueriesMapMemo = useMemo(() => {\r\n    const m: Record<string, any> = {};\r\n    CHART_IDS.forEach((id, idx) => { m[id] = chartQueryResults[idx]; });\r\n    return m;\r\n  }, [chartQueryResults]);\r\n\r\n  // sync query results into local chartData / loading state for compatibility with existing code paths\r\n  useEffect(() => {\r\n    const newData: Record<string, any[]> = {};\r\n    const newLoading: Record<string, boolean> = {};\r\n    chartIds.forEach((id) => {\r\n      const q = chartQueriesMapMemo[id];\r\n      // debug: inspect query result for gender\r\n      if (id === 'gender') {\r\n        // eslint-disable-next-line no-console\r\n        console.debug('chart query gender raw data:', q?.data);\r\n      }\r\n      // map server-side name/value into chart-friendly type/value for sex distribution\r\n      if (id === 'gender') {\r\n        // Normalize server-provided gender labels to canonical Male/Female/Other\r\n        newData[id] = (q?.data || []).map((p: any) => {\r\n          const rawType = (p?.name ?? p?.type ?? p?._id ?? '').toString().trim();\r\n          const lower = (rawType || '').toLowerCase();\r\n          let norm = 'Other';\r\n          if (/^m/.test(lower)) norm = 'Male';\r\n          else if (/^f/.test(lower)) norm = 'Female';\r\n          return { type: norm, value: Number(p?.value ?? p?.count ?? 0) };\r\n        })\r\n        // Aggregate any duplicate normalized labels (in case server returned multiple spellings)\r\n        .reduce((acc: any[], cur: any) => {\r\n          const found = acc.find(a => a.type === cur.type);\r\n          if (found) found.value += cur.value; else acc.push({ ...cur });\r\n          return acc;\r\n        }, [] as any[]);\r\n      } else {\r\n        newData[id] = q?.data || [];\r\n      }\r\n      newLoading[id] = q?.isFetching || q?.isLoading || false;\r\n    });\r\n    setChartData(newData);\r\n    setChartLoading(newLoading);\r\n  }, [chartQueryDataKey, chartQueriesMapMemo, chartIds]);\r\n\r\n  // When selection changes, trigger refetch for selected charts (chartQueriesMap is memoized above)\r\n  useEffect(() => {\r\n    if (!selectedCharts || !selectedCharts.length) return;\r\n    selectedCharts.forEach(id => chartQueriesMapMemo[id]?.refetch && chartQueriesMapMemo[id].refetch());\r\n  }, [selectedCharts, chartQueriesMapMemo]);\r\n\r\n  // compute which charts currently have non-empty data\r\n  const chartsWithData = useMemo(() => {\r\n    const keys = Object.keys(chartData || {}).filter(k => Array.isArray(chartData[k]) && chartData[k].length > 0);\r\n    return new Set(keys);\r\n  }, [chartData]);\r\n\r\n  // When autoEnableWhenData is turned on, reduce selectedCharts to only those with data.\r\n  useEffect(() => {\r\n    if (autoEnableWhenData) {\r\n      // save previous selection\r\n      prevSelectionRef.current = selectedCharts;\r\n      const available = Array.from(chartsWithData);\r\n      // keep the ordering of CHART_IDS but filter\r\n      const newSel = CHART_IDS.filter(id => available.includes(id)).slice(0, 6); // limit to 6 by default\r\n      if (newSel.length) setSelectedCharts(newSel);\r\n    } else {\r\n      // restore previous selection if present\r\n      if (prevSelectionRef.current) {\r\n        setSelectedCharts(prevSelectionRef.current);\r\n        prevSelectionRef.current = null;\r\n      }\r\n    }\r\n  }, [autoEnableWhenData, chartsWithData, selectedCharts]);\r\n\r\n  // Report generation\r\n  const [reportModalOpen, setReportModalOpen] = useState(false);\r\n  const [reportText, setReportText] = useState('');\r\n  // responsive helper to make action buttons stack on small screens\r\n  const [isMobile, setIsMobile] = useState<boolean>(() => typeof window !== 'undefined' ? window.innerWidth < 700 : false);\r\n\r\n  useEffect(() => {\r\n    const onResize = () => setIsMobile(window.innerWidth < 700);\r\n    try {\r\n      window.addEventListener('resize', onResize);\r\n    } catch (e) {}\r\n    return () => { try { window.removeEventListener('resize', onResize); } catch (e) {} };\r\n  }, []);\r\n\r\n  // (removed unused helper 'median')\r\n\r\n  const generateNarrativeReport = (state: { summary?: any; charts?: Record<string, any[]> }) => {\r\n    const s = state.summary || summary || {};\r\n    const charts = state.charts || chartData || {};\r\n\r\n    const totalResidents = Number(s.totalResidents ?? 0);\r\n    const gender = charts['gender'] || [];\r\n    const age = charts['age'] || [];\r\n    const cs = charts['civil-status'] || [];\r\n    const ed = charts['education'] || [];\r\n    const monthly = charts['documents-monthly'] || [];\r\n  const occupation = charts['occupation'] || [];\r\n  const nationality = charts['nationality'] || [];\r\n  const bloodType = charts['bloodType'] || [];\r\n  const disability = charts['disability'] || [];\r\n  const children = charts['children'] || [];\r\n  const businessType = charts['businessType'] || [];\r\n  const businessSize = charts['businessSize'] || [];\r\n  const incomeBrackets = charts['incomeBrackets'] || [];\r\n\r\n    // Gender counts\r\n    const maleCount = Number(gender.find((g:any) => (g.type||'').toLowerCase().startsWith('m'))?.value || 0);\r\n    const femaleCount = Number(gender.find((g:any) => (g.type||'').toLowerCase().startsWith('f'))?.value || 0);\r\n    const otherCount = Math.max(0, (gender || []).reduce((sum:number, g:any) => sum + (Number(g.value)||0), 0) - maleCount - femaleCount);\r\n\r\n    // Top age group\r\n    let topAgeGroup = '';\r\n    if (age.length) {\r\n      const sorted = [...age].sort((a:any,b:any) => (Number(b.value)||0) - (Number(a.value)||0));\r\n      topAgeGroup = sorted[0]?.type || sorted[0]?.group || '';\r\n    }\r\n\r\n    // civil and education top items\r\n    const topCivil = cs.length ? cs.slice(0,3).map((c:any) => `${c.type} (${c.value})`).join(', ') : '';\r\n    const topEducation = ed.length ? ed.slice(0,3).map((c:any) => `${c.type} (${c.value})`).join(', ') : '';\r\n\r\n    // monthly totals and peak\r\n    const monthlyTotal = monthly.length ? monthly.reduce((sum:number,m:any) => sum + (Number(m.value)||0), 0) : 0;\r\n    let peakMonth = '';\r\n    let peakVal = 0;\r\n    if (monthly.length) {\r\n      const peak = monthly.reduce((best:any, m:any) => (Number(m.value)||0) > (Number(best.value)||0) ? m : best, monthly[0]);\r\n      peakMonth = peak?.type || '';\r\n      peakVal = Number(peak?.value || 0);\r\n    }\r\n\r\n    // Build templated sentences with conditionals\r\n    const parts: string[] = [];\r\n\r\n    if (totalResidents > 0) {\r\n      const genderPart = (maleCount || femaleCount || otherCount)\r\n        ? `There are currently ${totalResidents} residents, with ${maleCount} males, ${femaleCount} females${otherCount ? `, and ${otherCount} identifying as other` : ''}.`\r\n        : `There are currently ${totalResidents} residents.`;\r\n      parts.push(genderPart);\r\n    } else {\r\n      parts.push('Resident count is not available.');\r\n    }\r\n\r\n    if (topAgeGroup) {\r\n      parts.push(`The most common age group is ${topAgeGroup}.`);\r\n    } else if (age.length) {\r\n      parts.push('Age distribution is available but no dominant age group could be determined.');\r\n    } else {\r\n      parts.push('Age distribution data is not available.');\r\n    }\r\n\r\n    // Occupation summary\r\n    if (occupation.length) {\r\n      const topOcc = occupation.slice().sort((a:any,b:any) => Number(b.value||0) - Number(a.value||0)).slice(0,3).map((o:any) => `${o.type || o.name} (${o.value})`).join(', ');\r\n      parts.push(`Top occupations: ${topOcc}.`);\r\n    } else {\r\n      parts.push('Occupation distribution is not available.');\r\n    }\r\n\r\n    // Nationality summary\r\n    if (nationality.length) {\r\n      const topNat = nationality.slice().sort((a:any,b:any) => Number(b.value||0) - Number(a.value||0)).slice(0,3).map((n:any) => `${n.type || n.name} (${n.value})`).join(', ');\r\n      parts.push(`Nationality distribution (top): ${topNat}.`);\r\n    }\r\n\r\n    if (topCivil) {\r\n      parts.push(`Civil status (top): ${topCivil}.`);\r\n    } else {\r\n      parts.push('Civil status breakdown is not available.');\r\n    }\r\n\r\n    // Blood type and disability\r\n    if (bloodType.length) {\r\n      const bt = bloodType.map((b:any) => `${b.type || b.name} (${b.value})`).join(', ');\r\n      parts.push(`Blood type breakdown: ${bt}.`);\r\n    }\r\n    if (disability.length) {\r\n      const disabledCount = disability.reduce((s:number, d:any) => s + (Number(d.value)||0), 0);\r\n      parts.push(`Disability reported for ${disabledCount} residents.`);\r\n    }\r\n\r\n    if (topEducation) {\r\n      parts.push(`Educational attainment (top): ${topEducation}.`);\r\n    } else {\r\n      parts.push('Educational attainment data is not available.');\r\n    }\r\n\r\n    // Children distribution\r\n    if (children.length) {\r\n      // children chart should be buckets like 0,1,2,3+\r\n      const avgChildren = children.reduce((sum:any, c:any, idx:any) => sum + (Number(c.value)||0) * (Number(c.type) || idx), 0) / Math.max(1, children.reduce((sum:any, c:any) => sum + (Number(c.value)||0), 0));\r\n      parts.push(`Average reported children per household (approx): ${Number(avgChildren).toFixed(2)}.`);\r\n    }\r\n\r\n    if (monthly.length) {\r\n      parts.push(`During the selected period there were ${monthlyTotal} document requests. The busiest month was ${peakMonth} with ${peakVal} requests.`);\r\n    } else {\r\n      parts.push('Document request trends are not available for the selected period.');\r\n    }\r\n\r\n    // Business stats\r\n    if (businessType.length) {\r\n      const topBiz = businessType.slice().sort((a:any,b:any) => Number(b.value||0) - Number(a.value||0)).slice(0,3).map((b:any) => `${b.type || b.name} (${b.value})`).join(', ');\r\n      parts.push(`Top business types: ${topBiz}.`);\r\n    }\r\n    if (businessSize.length) {\r\n      const totalBusinesses = businessSize.reduce((s:any, b:any) => s + (Number(b.value)||0), 0);\r\n      parts.push(`Business size distribution available for ${totalBusinesses} businesses.`);\r\n    }\r\n\r\n    // Income summary\r\n    if (incomeBrackets.length) {\r\n      const totalReported = incomeBrackets.reduce((s:any, b:any) => s + (Number(b.value)||0), 0);\r\n      const topBracket = incomeBrackets.slice().sort((a:any,b:any) => Number(b.value||0) - Number(a.value||0))[0];\r\n      if (topBracket) parts.push(`Most residents fall into the ${topBracket.type || topBracket.name} income bracket (${topBracket.value}). Total reported incomes: ${totalReported}.`);\r\n    }\r\n\r\n    return parts.join(' ');\r\n  };\r\n\r\n  const openReport = () => {\r\n    const text = generateNarrativeReport({ summary, charts: chartData });\r\n    setReportText(text);\r\n    setReportModalOpen(true);\r\n  };\r\n\r\n  const copyReport = async () => {\r\n    try {\r\n      await navigator.clipboard.writeText(reportText);\r\n      message.success('Report copied to clipboard');\r\n    } catch (e) {\r\n      message.error('Failed to copy');\r\n    }\r\n  };\r\n\r\n  const downloadPdf = async () => {\r\n    const doc = new jsPDF({ orientation: 'portrait' });\r\n    const title = 'Analytics Report';\r\n    doc.setFontSize(16);\r\n    doc.text(title, 14, 20);\r\n    doc.setFontSize(11);\r\n    const split = doc.splitTextToSize(reportText, 180);\r\n    doc.text(split, 14, 30);\r\n    \r\n    // Try to capture currently visible charts and append images\r\n    try {\r\n      const html2canvas = (await import('html2canvas')).default;\r\n      let y = 40 + (split.length * 6);\r\n      for (const id of selectedCharts) {\r\n        const el = chartRefs.current[id];\r\n        if (!el) continue;\r\n        // capture element to canvas\r\n        // @ts-ignore\r\n        const canvas = await html2canvas(el, { background: '#ffffff' });\r\n        const imgData = canvas.toDataURL('image/png');\r\n        const imgWidth = canvas.width;\r\n        const imgHeight = canvas.height;\r\n        const pdfWidth = doc.internal.pageSize.getWidth() - 28; // margins\r\n        const pdfHeight = (imgHeight * pdfWidth) / imgWidth;\r\n        if (y + pdfHeight > doc.internal.pageSize.getHeight() - 20) {\r\n          doc.addPage();\r\n          y = 20;\r\n        }\r\n        doc.addImage(imgData, 'PNG', 14, y, pdfWidth, pdfHeight);\r\n        y += pdfHeight + 8;\r\n      }\r\n    } catch (err) {\r\n      console.warn('html2canvas not available or capture failed, exporting text only', err);\r\n      message.warning('Chart capture failed; exporting text-only PDF. To include images, install html2canvas.');\r\n    }\r\n    \r\n    doc.save('analytics-report.pdf');\r\n  };\r\n\r\n  // Download full analytics (dashboard + narrative) as styled A4 PDF\r\n  const downloadFullAnalytics = async () => {\r\n    if (!dashboardRef.current) {\r\n      message.error('Dashboard not available for capture');\r\n      return;\r\n    }\r\n\r\n    message.loading({ content: 'Preparing full report...', key: 'report' });\r\n\r\n    try {\r\n      const html2canvas = (await import('html2canvas')).default;\r\n      // capture the dashboard DOM\r\n      const el = dashboardRef.current;\r\n  // increase scale for better resolution\r\n  const canvas = await html2canvas(el, { background: '#ffffff' });\r\n      const imgData = canvas.toDataURL('image/png');\r\n\r\n      // A4 dimensions in pt at 72 DPI: 595.28 x 841.89; jsPDF default unit is 'pt'\r\n      const pdf = new jsPDF({ unit: 'pt', format: 'a4', orientation: 'portrait' });\r\n\r\n      // cover page\r\n      const title = 'Barangay Analytics Report';\r\n      pdf.setFontSize(24);\r\n      pdf.text(title, 40, 80);\r\n      pdf.setFontSize(12);\r\n      pdf.text(`Generated: ${new Date().toLocaleString()}`, 40, 110);\r\n      pdf.addPage();\r\n\r\n      // add dashboard image scaling to page width with margins\r\n      const pageWidth = pdf.internal.pageSize.getWidth();\r\n      const pageHeight = pdf.internal.pageSize.getHeight();\r\n      const margin = 40;\r\n      const usableWidth = pageWidth - margin * 2;\r\n      // compute image size in PDF points based on natural image dimensions\r\n      const tmpImg = new Image();\r\n      tmpImg.src = imgData;\r\n      await new Promise((res) => (tmpImg.onload = res));\r\n\r\n      const imgWidthPts = usableWidth; // target width in PDF points\r\n      const imgHeightPts = (tmpImg.height * imgWidthPts) / tmpImg.width;\r\n\r\n      // convert pixels to PDF points ratio\r\n      const pxPerPt = tmpImg.height / imgHeightPts; // pixels per PDF point\r\n      const sliceHeightPt = pageHeight - margin * 2; // available height in PDF points\r\n      const sliceHeightPx = Math.floor(sliceHeightPt * pxPerPt);\r\n\r\n      // draw the full image into offscreen canvas at natural size, then slice vertically\r\n      const offCanvas = document.createElement('canvas');\r\n      offCanvas.width = tmpImg.width;\r\n      offCanvas.height = tmpImg.height;\r\n      const ctx = offCanvas.getContext('2d');\r\n      if (!ctx) throw new Error('Canvas not supported');\r\n      ctx.fillStyle = '#ffffff';\r\n      ctx.fillRect(0,0,offCanvas.width, offCanvas.height);\r\n      ctx.drawImage(tmpImg, 0, 0);\r\n\r\n      let yOffset = 0;\r\n      while (yOffset < offCanvas.height) {\r\n        const sliceCanvas = document.createElement('canvas');\r\n        sliceCanvas.width = offCanvas.width;\r\n        sliceCanvas.height = Math.min(sliceHeightPx, offCanvas.height - yOffset);\r\n        const sctx = sliceCanvas.getContext('2d');\r\n        if (!sctx) break;\r\n        sctx.fillStyle = '#ffffff';\r\n        sctx.fillRect(0,0,sliceCanvas.width, sliceCanvas.height);\r\n        sctx.drawImage(offCanvas, 0, yOffset, sliceCanvas.width, sliceCanvas.height, 0, 0, sliceCanvas.width, sliceCanvas.height);\r\n        const sliceData = sliceCanvas.toDataURL('image/png');\r\n        const drawHeightPts = sliceCanvas.height / pxPerPt; // convert slice pixels back to PDF points\r\n        pdf.addImage(sliceData, 'PNG', margin, margin, imgWidthPts, drawHeightPts);\r\n        yOffset += sliceHeightPx;\r\n        if (yOffset < offCanvas.height) pdf.addPage();\r\n      }\r\n\r\n      pdf.save('barangay-analytics-report.pdf');\r\n      message.success({ content: 'Report ready', key: 'report' });\r\n    } catch (err) {\r\n      console.error('Full report export failed', err);\r\n      message.error({ content: 'Failed to export full report (see console).', key: 'report' });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Card\r\n      title={<Typography.Title level={4} style={{ margin: 0 }}>Statistics & Analytics</Typography.Title>}\r\n      style={{ borderRadius: 16, boxShadow: '0 2px 16px #40c9ff11' }}\r\n      styles={{ body: { padding: 24 } }}\r\n    >\r\n      <div ref={dashboardRef} style={{ background: '#ffffff', padding: 8 }}>\r\n      {/* Filters */}\r\n  <Form layout={isMobile ? \"vertical\" : \"inline\"} style={{ marginBottom: 24, width: '100%', boxSizing: 'border-box' }}>\r\n        <Form.Item label=\"Date Range\">\r\n          <RangePicker\r\n            value={filters.dateRange as any}\r\n            onChange={dates => setFilters(f => ({ ...f, dateRange: (dates ? dates.filter(Boolean) : []) as Moment[] }))}\r\n            allowClear\r\n          />\r\n        </Form.Item>\r\n        <Form.Item label=\"Resident Type\">\r\n          <Select\r\n            value={filters.residentType}\r\n            onChange={val => setFilters(f => ({ ...f, residentType: val }))}\r\n            style={{ minWidth: 140 }}\r\n            allowClear\r\n            placeholder=\"All Types\"\r\n          >\r\n            <Option value=\"\">All</Option>\r\n            <Option value=\"active\">Active</Option>\r\n            <Option value=\"inactive\">Inactive</Option>\r\n          </Select>\r\n        </Form.Item>\r\n\r\n        <Form.Item label=\"Charts\">\r\n          <Dropdown\r\n            open={chartsDropdownOpen}\r\n            onOpenChange={(open) => {\r\n              if (open) {\r\n                // initialize pending selection from current selection\r\n                setPendingSelectedCharts(selectedCharts.slice());\r\n              } else {\r\n                // when closing without apply, reset pending to current\r\n                setPendingSelectedCharts(selectedCharts.slice());\r\n              }\r\n              setChartsDropdownOpen(open);\r\n            }}\r\n            popupRender={() => (\r\n              <div style={{ padding: 12, background: '#fff', borderRadius: 8, boxShadow: '0 6px 20px rgba(0,0,0,0.08)', minWidth: 340 }}>\r\n                {/* Tidy vertical list with scroll when content overflows */}\r\n                <div style={{ maxHeight: 260, overflowY: 'auto', paddingRight: 8 }} onWheel={(e) => { /* allow native wheel scrolling */ }}>\r\n                  <div style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>\r\n                    {Object.keys(CHARTS).map(k => {\r\n                      const checked = (pendingSelectedCharts || []).includes(k);\r\n                      return (\r\n                        <Checkbox key={k} checked={checked} onChange={(ev) => {\r\n                          const next = new Set(pendingSelectedCharts || []);\r\n                          if ((ev.target as HTMLInputElement).checked) next.add(k); else next.delete(k);\r\n                          setPendingSelectedCharts(Array.from(next));\r\n                        }}>\r\n                          <span style={{ fontSize: 13 }}>{CHARTS[k].title}</span>\r\n                        </Checkbox>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n                <div style={{ display: 'flex', justifyContent: 'flex-end', gap: 8, marginTop: 12 }}>\r\n                  <Button size=\"small\" onClick={() => { setPendingSelectedCharts(selectedCharts.slice()); setChartsDropdownOpen(false); }}>Cancel</Button>\r\n                  <Button size=\"small\" type=\"primary\" onClick={() => { setSelectedCharts(pendingSelectedCharts.slice()); setChartsDropdownOpen(false); }}>Apply</Button>\r\n                </div>\r\n              </div>\r\n            )}\r\n            trigger={['click']}\r\n          >\r\n            <Button>\r\n              Charts <DownOutlined />\r\n            </Button>\r\n          </Dropdown>\r\n        </Form.Item>\r\n        <Form.Item style={{ width: '100%', boxSizing: 'border-box' }}>\r\n          {/* Use a wrapping flex container so buttons stack/wrap on narrow screens */}\r\n          <div style={{ display: 'flex', flexWrap: 'wrap', gap: 8, alignItems: 'center', width: '100%', boxSizing: 'border-box' }}>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: 8, minWidth: 200 }}>\r\n              <Switch checked={autoEnableWhenData} onChange={v => setAutoEnableWhenData(!!v)} />\r\n              <span style={{ fontSize: 13 }}>Enable when data exists</span>\r\n            </div>\r\n            {/* Buttons container: on mobile take full row so buttons don't overflow */}\r\n            <div style={{ display: 'flex', gap: 8, flexWrap: 'wrap', flex: isMobile ? '0 0 100%' : '0 1 auto', alignItems: 'center', width: isMobile ? '100%' : undefined, boxSizing: 'border-box', paddingRight: 8 }}>\r\n              <Button onClick={() => { setSettingsOpen(true); setSettingsChartId(selectedCharts[0] || 'gender'); }} block={isMobile} style={isMobile ? { width: '100%', marginBottom: 8 } : undefined}>Chart Settings</Button>\r\n              <Button type=\"primary\" onClick={openReport} block={isMobile} style={isMobile ? { width: '100%', marginBottom: 8 } : undefined}>Generate Report</Button>\r\n              <Button onClick={async () => { await downloadFullAnalytics(); }} block={isMobile} style={isMobile ? { width: '100%' } : undefined}>Download Full Analytics</Button>\r\n            </div>\r\n          </div>\r\n        </Form.Item>\r\n      </Form>\r\n\r\n      <Drawer title=\"Chart Settings\" placement=\"right\" onClose={() => setSettingsOpen(false)} open={settingsOpen} width={420}>\r\n        <Form layout=\"vertical\">\r\n          <Form.Item label=\"Select chart\">\r\n            <Select value={settingsChartId} onChange={(v) => setSettingsChartId(v)}>\r\n              {Object.keys(CHARTS).map(k => <Select.Option key={k} value={k}>{CHARTS[k].title}</Select.Option>)}\r\n            </Select>\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"Chart type\">\r\n            <Select value={(chartSettings[settingsChartId] && chartSettings[settingsChartId].chartType) || CHARTS[settingsChartId].chartType} onChange={(val) => setChartSettings(s => ({ ...s, [settingsChartId]: { ...(s[settingsChartId] || {}), chartType: val } }))}>\r\n              <Select.Option value=\"pie\">Pie</Select.Option>\r\n              <Select.Option value=\"bar\">Bar</Select.Option>\r\n              <Select.Option value=\"line\">Line</Select.Option>\r\n              <Select.Option value=\"area\">Area</Select.Option>\r\n            </Select>\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"Date range for this chart\">\r\n            <RangePicker value={(chartSettings[settingsChartId] && chartSettings[settingsChartId].dateRange) || filters.dateRange} onChange={(dates) => setChartSettings(s => ({ ...s, [settingsChartId]: { ...(s[settingsChartId] || {}), dateRange: dates ? dates.filter(Boolean) : [] } }))} allowClear />\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"Show labels\">\r\n            <Switch checked={(chartSettings[settingsChartId] && chartSettings[settingsChartId].showLabels) ?? true} onChange={(v) => setChartSettings(s => ({ ...s, [settingsChartId]: { ...(s[settingsChartId] || {}), showLabels: v } }))} />\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"Show tooltips\">\r\n            <Switch checked={(chartSettings[settingsChartId] && chartSettings[settingsChartId].showTooltips) ?? true} onChange={(v) => setChartSettings(s => ({ ...s, [settingsChartId]: { ...(s[settingsChartId] || {}), showTooltips: v } }))} />\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"Show legend\">\r\n            <Switch checked={(chartSettings[settingsChartId] && chartSettings[settingsChartId].showLegend) ?? true} onChange={(v) => setChartSettings(s => ({ ...s, [settingsChartId]: { ...(s[settingsChartId] || {}), showLegend: v } }))} />\r\n          </Form.Item>\r\n\r\n          <Form.Item>\r\n            <Space>\r\n              <Button type=\"primary\" onClick={() => { setSettingsOpen(false); fetchChart(settingsChartId); }}>Apply</Button>\r\n              <Button onClick={() => { setChartSettings(s => ({ ...s, [settingsChartId]: {} })); }}>Reset</Button>\r\n            </Space>\r\n          </Form.Item>\r\n        </Form>\r\n      </Drawer>\r\n\r\n      <Modal title=\"Analytics Report\" open={reportModalOpen} onCancel={() => setReportModalOpen(false)} footer={[\r\n        <Button key=\"copy\" onClick={copyReport}>Copy</Button>,\r\n        <Button key=\"download\" type=\"primary\" onClick={downloadPdf}>Download as PDF</Button>\r\n      ]}>\r\n        <Typography.Paragraph>{reportText || 'No data available for report.'}</Typography.Paragraph>\r\n      </Modal>\r\n\r\n      {/* Top Metrics */}\r\n      <Row gutter={[24, 24]} style={{ marginBottom: 24 }}>\r\n        <Col xs={24} sm={12} md={8}>\r\n          <Card variant=\"borderless\" style={{ borderRadius: 12, boxShadow: '0 8px 20px rgba(15,15,15,0.04)', textAlign: 'left' }} styles={{ body: { padding: 16 } }}>\r\n            {loadingSummary ? <Skeleton active paragraph={false} /> : (\r\n              <div>\r\n                <Typography.Text type=\"secondary\" style={{ display: 'block', fontSize: 12 }}>Total Residents</Typography.Text>\r\n                <Typography.Title level={3} style={{ margin: 0 }}>{totalResidents}</Typography.Title>\r\n              </div>\r\n            )}\r\n          </Card>\r\n        </Col>\r\n\r\n        <Col xs={24} sm={12} md={8}>\r\n          <Card variant=\"borderless\" style={{ borderRadius: 12, boxShadow: '0 8px 20px rgba(15,15,15,0.04)', textAlign: 'left' }} styles={{ body: { padding: 16 } }}>\r\n            {loadingSummary ? <Skeleton active paragraph={false} /> : (\r\n              <div>\r\n                <Typography.Text type=\"secondary\" style={{ display: 'block', fontSize: 12 }}>Total Documents</Typography.Text>\r\n                <Typography.Title level={3} style={{ margin: 0 }}>{totalDocuments}</Typography.Title>\r\n              </div>\r\n            )}\r\n          </Card>\r\n        </Col>\r\n\r\n        <Col xs={24} sm={24} md={8}>\r\n          <Card style={{ borderRadius: 12, boxShadow: '0 8px 20px rgba(15,15,15,0.04)', textAlign: 'left' }} styles={{ body: { padding: 16 } }}>\r\n            {loadingSummary ? <Skeleton active paragraph={false} /> : (\r\n              <div>\r\n                <Typography.Text type=\"secondary\" style={{ display: 'block', fontSize: 12 }}>Requests (selected period)</Typography.Text>\r\n                <Typography.Title level={3} style={{ margin: 0 }}>{monthlyDocData ? monthlyDocData.reduce((s:any,m:any)=>s + (Number(m.value)||0), 0) : 0}</Typography.Title>\r\n                <Typography.Text type=\"secondary\" style={{ display: 'block', fontSize: 12, marginTop: 6 }}>{monthlyDocData && monthlyDocData.length ? `Latest: ${monthlyDocData[monthlyDocData.length-1].type} (${monthlyDocData[monthlyDocData.length-1].value})` : ''}</Typography.Text>\r\n              </div>\r\n            )}\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      <Divider />\r\n      {/* Charts */}\r\n      {/* Show Alerts for failed chart queries */}\r\n      {chartIds.map(id => {\r\n    const q = chartQueriesMapMemo[id];\r\n        if (q?.isError) {\r\n          return (\r\n            <Alert\r\n              key={`alert-${id}`}\r\n              message={`Failed to load ${CHARTS[id].title}`}\r\n              description={<div>{String(q.error?.message || q.error)} <Button size=\"small\" onClick={() => q.refetch()}>Retry</Button></div>}\r\n              type=\"error\"\r\n              showIcon\r\n              style={{ marginBottom: 12 }}\r\n            />\r\n          );\r\n        }\r\n        return null;\r\n      })}\r\n      <Row gutter={[24, 24]}>\r\n        {selectedCharts.includes('gender') && (\r\n          <Col xs={24} md={12} lg={12}>\r\n            <ChartCard id=\"gender\" title={CHARTS['gender'].title} chartType={CHARTS['gender'].chartType} data={chartData['gender']} loading={chartLoading['gender']} colors={CHARTS['gender'].colors} />\r\n          </Col>\r\n        )}\r\n\r\n        {selectedCharts.includes('age') && (\r\n          <Col xs={24} md={12} lg={12}>\r\n            <ChartCard id=\"age\" title={CHARTS['age'].title} chartType={CHARTS['age'].chartType} data={chartData['age']} loading={chartLoading['age']} colors={CHARTS['age'].colors} />\r\n          </Col>\r\n        )}\r\n\r\n        {selectedCharts.includes('documents-monthly') && (\r\n          <Col xs={24} md={12} lg={12}>\r\n            <ChartCard id=\"documents-monthly\" title={CHARTS['documents-monthly'].title} chartType={CHARTS['documents-monthly'].chartType} data={chartData['documents-monthly']} loading={chartLoading['documents-monthly']} colors={CHARTS['documents-monthly'].colors} />\r\n          </Col>\r\n        )}\r\n\r\n        {selectedCharts.includes('civil-status') && (\r\n          <Col xs={24} md={12} lg={12}>\r\n            <ChartCard id=\"civil-status\" title={CHARTS['civil-status'].title} chartType={CHARTS['civil-status'].chartType} data={chartData['civil-status']} loading={chartLoading['civil-status']} colors={CHARTS['civil-status'].colors} />\r\n          </Col>\r\n        )}\r\n\r\n        {selectedCharts.includes('education') && (\r\n          <Col xs={24} md={12} lg={12}>\r\n            <ChartCard id=\"education\" title={CHARTS['education'].title} chartType={CHARTS['education'].chartType} data={chartData['education']} loading={chartLoading['education']} colors={CHARTS['education'].colors} />\r\n          </Col>\r\n        )}\r\n      </Row>\r\n      \r\n      </div>\r\n  </Card>\r\n  );\r\n};\r\n\r\nconst Statistics: React.FC = () => {\r\n  return (\r\n    <QueryClientProvider client={defaultQueryClient}>\r\n      <StatisticsInner />\r\n    </QueryClientProvider>\r\n  );\r\n};\r\n\r\nexport default Statistics;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Modal, Button, TextField, Box, CircularProgress, Snackbar, Alert } from '@mui/material';\r\nimport { adminAPI } from '../services/api';\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  contactEmail?: string;\r\n}\r\n\r\nconst TestEmailModal: React.FC<Props> = ({ open, onClose, contactEmail }) => {\r\n  const [to, setTo] = useState(contactEmail || '');\r\n  const [sending, setSending] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setTo(contactEmail || '');\r\n  }, [contactEmail, open]);\r\n\r\n  const [snackOpen, setSnackOpen] = useState(false);\r\n  const [snackMessage, setSnackMessage] = useState('');\r\n  const [snackSeverity, setSnackSeverity] = useState<'success' | 'error'>('success');\r\n\r\n  const handleSend = async () => {\r\n    try {\r\n      setSending(true);\r\n      // Check SMTP settings first to provide a clearer error if not configured\r\n      try {\r\n        const settings: any = await adminAPI.getSystemSettings();\r\n        if (!settings || !settings.smtp || !settings.smtp.host) {\r\n          setSnackMessage('SMTP is not configured. Please configure SMTP settings before sending a test email.');\r\n          setSnackSeverity('error');\r\n          setSnackOpen(true);\r\n          setSending(false);\r\n          return;\r\n        }\r\n      } catch (e) {\r\n        // couldn't fetch settings; continue and let testSmtp surface server message\r\n      }\r\n\r\n      const res = await adminAPI.testSmtp(to);\r\n      const message = res && res.message ? res.message : 'Test email sent successfully';\r\n      setSnackMessage(message);\r\n      setSnackSeverity('success');\r\n      setSnackOpen(true);\r\n      setSending(false);\r\n      // close modal shortly after showing success\r\n      setTimeout(() => {\r\n        setSnackOpen(false);\r\n        onClose();\r\n      }, 900);\r\n    } catch (err: any) {\r\n      setSending(false);\r\n      const message = err?.response?.data?.message || err?.response?.data?.error || err?.message || 'Failed to send test email';\r\n      setSnackMessage(message);\r\n      setSnackSeverity('error');\r\n      setSnackOpen(true);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Modal open={open} onClose={() => { if (!sending) onClose(); }}>\r\n        <Box sx={{ position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', width: 420, bgcolor: 'background.paper', boxShadow: 24, p: 3 }}>\r\n          <h3>Send Test Email</h3>\r\n          <TextField\r\n            label=\"Recipient Email\"\r\n            type=\"email\"\r\n            value={to}\r\n            onChange={(e) => setTo(e.target.value)}\r\n            fullWidth\r\n            margin=\"normal\"\r\n          />\r\n\r\n          <Box sx={{ display: 'flex', justifyContent: 'flex-end', gap: 2, mt: 2 }}>\r\n            <Button onClick={onClose} disabled={sending}>Cancel</Button>\r\n            <Button variant=\"contained\" onClick={handleSend} disabled={sending || !to}>\r\n              {sending ? <CircularProgress size={20} /> : 'Send Test Email'}\r\n            </Button>\r\n          </Box>\r\n        </Box>\r\n      </Modal>\r\n      <Snackbar open={snackOpen} autoHideDuration={4000} onClose={() => setSnackOpen(false)}>\r\n        <Alert onClose={() => setSnackOpen(false)} severity={snackSeverity} sx={{ width: '100%' }}>\r\n          {snackMessage}\r\n        </Alert>\r\n      </Snackbar>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default TestEmailModal;\r\n","const defaultSystemSettings = {\r\n  siteName: 'Barangay Portal',\r\n  barangayName: 'Barangay Uno',\r\n  barangayAddress: '123 Main St, City, Province',\r\n  contactEmail: 'info@barangayuno.local',\r\n  contactPhone: '+63 912 345 6789',\r\n  maintainanceMode: false,\r\n  allowNewRegistrations: true,\r\n  requireEmailVerification: true,\r\n  // Default: resident verifications are disabled by default. Admins can enable from System Settings.\r\n  enableVerifications: false,\r\n  maxDocumentRequests: 5,\r\n  documentProcessingDays: 3,\r\n  // Allow creation of multiple accounts from the same IP and the maximum allowed\r\n  allowMultipleAccountsPerIP: false,\r\n  maxAccountsPerIP: 1,\r\n  systemNotice: '',\r\n  smtp: {\r\n    host: '',\r\n    port: 587,\r\n    user: '',\r\n    password: '',\r\n  },\r\n};\r\n\r\nexport default defaultSystemSettings;\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport {\r\n  Box,\r\n  Paper,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  FormControlLabel,\r\n  Switch,\r\n  Divider,\r\n  Alert,\r\n  CircularProgress,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n} from '@mui/material';\r\nimport TestEmailModal from '../TestEmailModal';\r\nimport { adminAPI } from '../../services/api';\r\nimport axios from 'axios';\r\nimport { API_URL } from '../../services/api';\r\nimport { UploadOutlined, UsergroupAddOutlined, DeleteOutlined } from '@ant-design/icons';\r\nimport { Upload as AntdUpload, message as antdMessage } from 'antd';\r\nimport AppAvatar from '../AppAvatar';\r\n// framer-motion removed to avoid dependency conflicts; use CSS transitions for preview\r\nimport defaultSystemSettings from '../../config/defaultSystemSettings';\r\nimport getOfficialPhotoSrc from '../../utils/officials';\r\n\r\ninterface SystemSettingsData {\r\n  siteName: string;\r\n  barangayName: string;\r\n  barangayAddress: string;\r\n  contactEmail: string;\r\n  contactPhone: string;\r\n  maintainanceMode: boolean;\r\n  allowNewRegistrations: boolean;\r\n  requireEmailVerification: boolean;\r\n  enableVerifications?: boolean;\r\n  maxDocumentRequests: number;\r\n  documentProcessingDays: number;\r\n  // new rate-limiting settings\r\n  allowMultipleAccountsPerIP?: boolean;\r\n  maxAccountsPerIP?: number;\r\n  systemNotice: string;\r\n  smtp?: {\r\n    host?: string;\r\n    port?: number;\r\n    user?: string;\r\n    password?: string;\r\n  };\r\n}\r\n\r\ninterface Official {\r\n  _id?: string;\r\n  name: string;\r\n  title: string;\r\n  term: string;\r\n  photoUrl?: string;\r\n  photoPath?: string;\r\n  previewUrl?: string; // client-side temporary preview for selected file\r\n}\r\n\r\nconst SystemSettings: React.FC = () => {\r\n  const [settings, setSettings] = useState<SystemSettingsData>(() => ({ ...defaultSystemSettings } as SystemSettingsData));\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [confirmDisableOpen, setConfirmDisableOpen] = useState(false);\r\n  const [, setSuccess] = useState(false);\r\n  const [, setError] = useState<string | null>(null);\r\n  const [testModalOpen, setTestModalOpen] = useState(false);\r\n  // Officials state\r\n  const [officials, setOfficials] = useState<Official[]>([]);\r\n  const [officialsLoading, setOfficialsLoading] = useState(false);\r\n  const [savingOfficials, setSavingOfficials] = useState(false);\r\n  const [manualSaveError, setManualSaveError] = useState<string | null>(null);\r\n  const autoSaveTimers = useRef<Record<string, number>>({});\r\n  // officialSaveStatus state removed (not referenced)\r\n  const previewUrlsRef = useRef<Record<string, string>>({});\r\n  const previewContainerRef = useRef<HTMLDivElement | null>(null);\r\n  const prevOfficialsCountRef = useRef(0);\r\n  const [highlightedIds, setHighlightedIds] = useState<string[]>([]);\r\n  const highlightTimeouts = useRef<Record<string, number>>({});\r\n  const originalSettingsRef = useRef<SystemSettingsData | null>(null);\r\n  const [, setDirty] = useState(false);\r\n\r\n  // helper to make MUI InputLabel shrink when the field has content or a non-empty value\r\n  // (removed unused helper to silence lint)\r\n\r\n  useEffect(() => {\r\n    const ac = new AbortController();\r\n    fetchSettings(ac.signal);\r\n    // capture a snapshot of preview URLs now so cleanup uses a stable reference\r\n    const currentPreviewUrls = previewUrlsRef.current;\r\n    return () => {\r\n      // cancel pending fetch\r\n      try { ac.abort(); } catch (e) {}\r\n      // revoke any created object URLs captured at effect execution time\r\n      try {\r\n        Object.values(currentPreviewUrls).forEach(u => {\r\n          try { URL.revokeObjectURL(u); } catch (e) {}\r\n        });\r\n      } catch (e) {}\r\n    };\r\n  }, []);\r\n\r\n  // Scroll preview container to the right when items are appended\r\n  useEffect(() => {\r\n    try {\r\n      const container = previewContainerRef.current;\r\n      if (!container) return;\r\n      if (officials.length > prevOfficialsCountRef.current) {\r\n        container.scrollTo({ left: container.scrollWidth, behavior: 'smooth' });\r\n      }\r\n      prevOfficialsCountRef.current = officials.length;\r\n    } catch (e) {}\r\n  }, [officials.length]);\r\n\r\n  // Detect newly added temp officials and highlight them briefly\r\n  useEffect(() => {\r\n    try {\r\n      const newTemp = officials.filter(o => o._id && o._id.toString().startsWith('new-')).map(o => o._id as string);\r\n      // highlight any temp ids that are new and not already highlighted\r\n      newTemp.forEach(id => {\r\n        if (!highlightedIds.includes(id)) {\r\n          setHighlightedIds(prev => [...prev, id]);\r\n          // remove highlight after 2.5s\r\n          const t = window.setTimeout(() => {\r\n            setHighlightedIds(prev => prev.filter(x => x !== id));\r\n            delete highlightTimeouts.current[id];\r\n          }, 2500);\r\n          highlightTimeouts.current[id] = t;\r\n        }\r\n      });\r\n    } catch (e) {}\r\n    // cleanup when unmounting\r\n    return () => {\r\n      Object.values(highlightTimeouts.current).forEach((tid) => { try { clearTimeout(tid); } catch (e) {} });\r\n      highlightTimeouts.current = {};\r\n    };\r\n  }, [officials, highlightedIds]);\r\n\r\n  // Accept an optional AbortSignal so caller can cancel when unmounting\r\n  const fetchSettings = async (signal?: AbortSignal) => {\r\n    setLoading(true);\r\n    try {\r\n      // primary attempt using adminAPI (uses axiosInstance and auth interceptors)\r\n      let sys: SystemSettingsData | null = null;\r\n      try {\r\n        sys = await adminAPI.getSystemSettings();\r\n      } catch (err) {\r\n        // fallback: call backend directly at configured API_URL (avoid client origin)\r\n        try {\r\n          const res = await axios.get(`${API_URL}/admin/settings`, { withCredentials: true, signal } as any);\r\n          if (res?.data) sys = res.data;\r\n        } catch (err2) {\r\n          console.warn('Failed to load system settings via adminAPI and API_URL fallback', err, err2);\r\n        }\r\n      }\r\n      if (sys) {\r\n        setSettings(sys);\r\n        originalSettingsRef.current = sys;\r\n      }\r\n\r\n      // officials: try adminAPI then API_URL fallback\r\n      setOfficialsLoading(true);\r\n      try {\r\n        const offs = await adminAPI.getOfficials();\r\n        if (Array.isArray(offs)) {\r\n          setOfficials(offs);\r\n        } else {\r\n          const r = await axios.get(`${API_URL}/admin/officials`, { withCredentials: true, signal } as any);\r\n          if (r?.data) setOfficials(r.data);\r\n        }\r\n      } catch (err) {\r\n        try {\r\n          const r = await axios.get(`${API_URL}/admin/officials`, { withCredentials: true, signal } as any);\r\n          if (r?.data) setOfficials(r.data);\r\n        } catch (err2) {\r\n          console.warn('Failed to load officials via adminAPI and API_URL fallback', err, err2);\r\n        }\r\n      } finally {\r\n        setOfficialsLoading(false);\r\n      }\r\n    } catch (err) {\r\n      if ((err as any)?.name === 'CanceledError' || (err as any)?.name === 'AbortError') {\r\n        // fetch canceled, ignore\r\n        return;\r\n      }\r\n      console.error('Unexpected error in fetchSettings', err);\r\n      antdMessage.error('Unexpected error while loading settings');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Save system settings (used by Save Changes button)\r\n  // Internal save implementation (performs actual API call)\r\n  const performSave = async () => {\r\n    try {\r\n      setSaving(true);\r\n      setError(null);\r\n      // Normalize numeric fields and map client keys to server-side field names\r\n      const payload: any = {\r\n        ...settings,\r\n        // compatibility: server uses 'maintenanceMode' while client uses 'maintainanceMode' (typo)\r\n        maintenanceMode: (settings as any).maintainanceMode,\r\n        // server expects allowRegistrations and maxDocumentRequestsPerUser\r\n        allowRegistrations: (settings as any).allowNewRegistrations,\r\n        maxDocumentRequestsPerUser: Number((settings as any).maxDocumentRequests) || 1,\r\n        documentProcessingDays: Number(settings.documentProcessingDays) || 1,\r\n        ...(typeof (settings as any).maxAccountsPerIP !== 'undefined'\r\n          ? { maxAccountsPerIP: Number((settings as any).maxAccountsPerIP) || 1 }\r\n          : {}),\r\n      } as SystemSettingsData;\r\n\r\n      await adminAPI.updateSystemSettings(payload);\r\n      // optimistic: update original copy and clear dirty flag\r\n      originalSettingsRef.current = payload;\r\n      setDirty(false);\r\n      setSuccess(true);\r\n      antdMessage.success('Settings saved');\r\n    } catch (err) {\r\n      console.error('Failed to save settings', err);\r\n      setError('Failed to save settings');\r\n      antdMessage.error('Failed to save settings');\r\n    } finally {\r\n      setSaving(false);\r\n      window.setTimeout(() => setSuccess(false), 2000);\r\n    }\r\n  };\r\n\r\n  // Public handler invoked by Save button. If the admin is disabling verifications\r\n  // (enableVerifications toggled from true -> false), show a confirmation dialog\r\n  // to prevent accidental destructive cleanup on the server.\r\n  const handleSave = async () => {\r\n    try {\r\n      // Determine if we are flipping enableVerifications from true -> false\r\n      const prev = originalSettingsRef.current;\r\n      const prevEnabled = prev ? Boolean((prev as any).enableVerifications) : true;\r\n      const nowEnabled = Boolean((settings as any).enableVerifications);\r\n      if (prevEnabled && nowEnabled === false) {\r\n        // Show confirmation dialog\r\n        setConfirmDisableOpen(true);\r\n        return;\r\n      }\r\n      // Otherwise proceed directly\r\n      await performSave();\r\n    } catch (e) {\r\n      console.error('handleSave error', e);\r\n    }\r\n  };\r\n\r\n  const confirmAndSave = async () => {\r\n    setConfirmDisableOpen(false);\r\n    await performSave();\r\n  };\r\n\r\n  // Manual save for officials (fallback)\r\n  const handleManualSaveOfficials = async () => {\r\n    if (!officials || officials.length === 0) return;\r\n    setSavingOfficials(true);\r\n    setManualSaveError(null);\r\n    try {\r\n      const updatedOfficials: Official[] = [];\r\n      for (const off of officials) {\r\n        if (!off._id || off._id.toString().startsWith('new-')) {\r\n          // create\r\n          const created = await adminAPI.createOfficial({ name: off.name, title: off.title, term: off.term });\r\n          updatedOfficials.push(created);\r\n        } else {\r\n          try {\r\n            const updated = await adminAPI.updateOfficial(off._id!, { name: off.name, title: off.title, term: off.term });\r\n            updatedOfficials.push(updated);\r\n          } catch (e) {\r\n            // if update failed, keep local copy so user can retry\r\n            updatedOfficials.push(off);\r\n          }\r\n        }\r\n      }\r\n      // replace list with refreshed items from server if possible\r\n      try {\r\n        const refreshed = await adminAPI.getOfficials();\r\n        if (Array.isArray(refreshed)) setOfficials(refreshed);\r\n        else setOfficials(updatedOfficials);\r\n      } catch (e) {\r\n        setOfficials(updatedOfficials);\r\n      }\r\n      antdMessage.success('Officials saved');\r\n    } catch (err) {\r\n      console.error('Manual save officials failed', err);\r\n      setManualSaveError('Manual save failed');\r\n      antdMessage.error('Manual save failed');\r\n    } finally {\r\n      setSavingOfficials(false);\r\n    }\r\n  }\r\n\r\n  // Combined save used by floating action button: save system settings first, then officials\r\n  const saveAll = async () => {\r\n    // prefer existing saving flags inside the individual handlers\r\n    try {\r\n      await handleSave();\r\n    } catch (e) {\r\n      // handleSave already logs and reports errors\r\n    }\r\n    try {\r\n      await handleManualSaveOfficials();\r\n    } catch (e) {\r\n      // manual save already reports errors\r\n    }\r\n  }\r\n\r\n  // Track whether settings are different from the original copy loaded from server\r\n  useEffect(() => {\r\n    try {\r\n      if (!originalSettingsRef.current) {\r\n        setDirty(false);\r\n        return;\r\n      }\r\n      setDirty(JSON.stringify(originalSettingsRef.current) !== JSON.stringify(settings));\r\n    } catch (e) {\r\n      setDirty(false);\r\n    }\r\n  }, [settings]);\r\n\r\n  const handleDeleteOfficial = async (id?: string) => {\r\n    if (!id) return;\r\n    setSavingOfficials(true);\r\n    try {\r\n      await adminAPI.deleteOfficial(id);\r\n      setOfficials(prev => prev.filter(p => p._id !== id));\r\n      antdMessage.success('Official deleted');\r\n    } catch (err) {\r\n      console.error('Delete official failed', err);\r\n      antdMessage.error('Failed to delete official');\r\n    } finally {\r\n      setSavingOfficials(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Box sx={{\r\n      // ensure content is pushed below the app header which writes its height to --app-header-height\r\n      pt: 'calc(var(--app-header-height, 64px) + 24px)',\r\n      px: 3,\r\n      pb: 3,\r\n    }}>\r\n      <Paper sx={{ p: 3 }}>\r\n        {/* Barangay Information */}\r\n        <Typography variant=\"subtitle1\" gutterBottom>\r\n          Barangay Information\r\n        </Typography>\r\n        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2, mb: 3 }}>\r\n          <TextField\r\n            label=\"Site Name\"\r\n            value={settings.siteName}\r\n            onChange={(e) => setSettings({ ...settings, siteName: e.target.value })}\r\n            variant=\"outlined\"\r\n            InputLabelProps={{ shrink: true }}\r\n            fullWidth\r\n          />\r\n          <TextField\r\n            label=\"Barangay Name\"\r\n            value={settings.barangayName}\r\n            onChange={(e) => setSettings({ ...settings, barangayName: e.target.value })}\r\n            variant=\"outlined\"\r\n            InputLabelProps={{ shrink: true }}\r\n            fullWidth\r\n          />\r\n          <TextField\r\n            label=\"Barangay Address\"\r\n            value={settings.barangayAddress}\r\n            onChange={(e) => setSettings({ ...settings, barangayAddress: e.target.value })}\r\n            variant=\"outlined\"\r\n            InputLabelProps={{ shrink: true }}\r\n            fullWidth\r\n            multiline\r\n            rows={2}\r\n          />\r\n        </Box>\r\n\r\n        <Divider sx={{ my: 3 }} />\r\n        {/* SMTP / Email Settings */}\r\n        <Typography variant=\"subtitle1\" gutterBottom>\r\n          SMTP / Email Settings\r\n        </Typography>\r\n        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2, mb: 3 }}>\r\n          <TextField\r\n            label=\"SMTP Host\"\r\n            value={(settings as any).smtp?.host || ''}\r\n            onChange={(e) => setSettings((prev) => ({ ...(prev as any), smtp: { ...(prev as any).smtp, host: e.target.value } }) as SystemSettingsData)}\r\n            variant=\"outlined\"\r\n            InputLabelProps={{ shrink: true }}\r\n            fullWidth\r\n          />\r\n          <TextField\r\n            label=\"SMTP Port\"\r\n            type=\"number\"\r\n            value={(settings as any).smtp?.port || ''}\r\n            onChange={(e) => setSettings((prev) => ({ ...(prev as any), smtp: { ...(prev as any).smtp, port: parseInt(e.target.value || '0') } }) as SystemSettingsData)}\r\n            variant=\"outlined\"\r\n            InputLabelProps={{ shrink: true }}\r\n            fullWidth\r\n          />\r\n          <TextField\r\n            label=\"SMTP User\"\r\n            value={(settings as any).smtp?.user || ''}\r\n            onChange={(e) => setSettings((prev) => ({ ...(prev as any), smtp: { ...(prev as any).smtp, user: e.target.value } }) as SystemSettingsData)}\r\n            variant=\"outlined\"\r\n            InputLabelProps={{ shrink: true }}\r\n            fullWidth\r\n          />\r\n          <Box sx={{ display: 'flex', gap: 2 }}>\r\n            <Button variant=\"outlined\" onClick={() => setTestModalOpen(true)}>Send Test Email</Button>\r\n            <Button variant=\"text\" onClick={() => setSettings((prev) => ({ ...(prev as any), smtp: { ...(prev as any).smtp, password: '' } }) as SystemSettingsData)}>Clear SMTP Password</Button>\r\n          </Box>\r\n        </Box>\r\n\r\n        <TestEmailModal open={testModalOpen} onClose={() => setTestModalOpen(false)} contactEmail={settings.contactEmail} />\r\n\r\n          <Divider sx={{ my: 3 }} />\r\n          {/* Verification Settings */}\r\n          <Typography variant=\"subtitle1\" gutterBottom>\r\n            Resident Verifications\r\n          </Typography>\r\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, mb: 2 }}>\r\n            <FormControlLabel\r\n              control={\r\n                <Switch\r\n                  checked={Boolean((settings as any).enableVerifications)}\r\n                  onChange={(e) => setSettings((prev) => ({ ...(prev as any), enableVerifications: e.target.checked } as any))}\r\n                />\r\n              }\r\n              label=\"Enable Resident Verifications\"\r\n            />\r\n            <Button variant=\"text\" onClick={() => antdMessage.info('When disabled, all pending verification requests will be deleted on the server.')}>More info</Button>\r\n          </Box>\r\n          {(settings as any).enableVerifications === false && (\r\n            <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}> \r\n              <Alert severity=\"warning\">Disabling verifications will permanently delete pending verification requests and uploaded files when you save changes.</Alert>\r\n              {/* If settings haven't been loaded from server yet, indicate the default state */}\r\n              {!loading && !originalSettingsRef.current && (\r\n                <Alert severity=\"info\">Resident verifications are currently disabled by default. Enable them to allow residents to submit verification requests.</Alert>\r\n              )}\r\n            </Box>\r\n          )}\r\n\r\n          <Divider sx={{ my: 3 }} />\r\n          {/* Barangay Officials Section */}\r\n          <Typography variant=\"subtitle1\" gutterBottom>\r\n            Barangay Officials\r\n          </Typography>\r\n          <Box sx={{ display: 'flex', gap: 3, alignItems: 'flex-start', mb: 3, flexDirection: { xs: 'column', md: 'row' } }}>\r\n            {/* Left column: header + scrollable list */}\r\n            <Box sx={{ flex: 1, width: '100%' }}>\r\n              <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 2 }}>\r\n                <Typography variant=\"body1\">Manage officials (auto-saves changes)</Typography>\r\n                <Button onClick={() => {\r\n                  // add new (append to end so preview shows on the right)\r\n                  const temp: Official = { _id: `new-${Date.now()}`, name: '', title: '', term: '' };\r\n                  setOfficials(prev => [...prev, temp]);\r\n                }} startIcon={<UsergroupAddOutlined />}>Add Official</Button>\r\n              </Box>\r\n\r\n              {/* Scrollable list area */}\r\n              <Box sx={{ maxHeight: 420, overflowY: 'auto', pr: 1, border: '1px solid rgba(0,0,0,0.04)', borderRadius: 1, boxShadow: 'inset 0 1px 0 rgba(255,255,255,0.6)' }}>\r\n                {officialsLoading ? <CircularProgress size={24} /> : (\r\n                  <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\r\n                    {officials.map((off, idx) => (\r\n                      <Paper key={off._id || idx} sx={{ p: 2, display: 'flex', gap: 2, alignItems: 'center' }}>\r\n                      <Box sx={{ width: 72, height: 72, borderRadius: '50%', overflow: 'hidden', flexShrink: 0, border: '3px solid rgba(0,0,0,0.04)', boxShadow: '0 1px 6px rgba(0,0,0,0.06)' }}>\r\n                        <img\r\n                          src={getOfficialPhotoSrc(off as any)}\r\n                          alt={off.name || 'photo'}\r\n                          style={{ width: '100%', height: '100%', objectFit: 'cover', transition: 'transform .2s', display: 'block' }}\r\n                        />\r\n                      </Box>\r\n                      <Box sx={{ flex: 1 }}>\r\n                        <TextField label=\"Full name\" value={off.name} onChange={(e) => {\r\n                          const v = e.target.value;\r\n                          setOfficials(prev => prev.map(o => o._id === off._id ? { ...o, name: v } : o));\r\n                          // schedule autosave\r\n                          if (autoSaveTimers.current[off._id || '']) clearTimeout(autoSaveTimers.current[off._id || '']);\r\n                          autoSaveTimers.current[off._id || ''] = window.setTimeout(async () => {\r\n                            try {\r\n                              setSavingOfficials(true);\r\n                              if (off._id && !off._id.toString().startsWith('new-')) {\r\n                                await adminAPI.updateOfficial(off._id, { ...off, name: v });\r\n                              } else {\r\n                                const created = await adminAPI.createOfficial({ ...off, name: v });\r\n                                setOfficials(prev => prev.map(p => p._id === off._id ? created : p));\r\n                              }\r\n                              setManualSaveError(null);\r\n                            } catch (err) {\r\n                              console.error('auto-save failed', err);\r\n                              setManualSaveError('Auto-save failed');\r\n                            } finally {\r\n                              setSavingOfficials(false);\r\n                            }\r\n                          }, 900);\r\n                        }} fullWidth size=\"small\" sx={{ mb: 1 }} variant=\"outlined\" InputLabelProps={{ shrink: true }} />\r\n                        <TextField label=\"Title/Position\" value={off.title} onChange={(e) => {\r\n                          const v = e.target.value;\r\n                          setOfficials(prev => prev.map(o => o._id === off._id ? { ...o, title: v } : o));\r\n                          if (autoSaveTimers.current[off._id || '']) clearTimeout(autoSaveTimers.current[off._id || '']);\r\n                          autoSaveTimers.current[off._id || ''] = window.setTimeout(async () => {\r\n                            try {\r\n                              setSavingOfficials(true);\r\n                              if (off._id && !off._id.toString().startsWith('new-')) {\r\n                                await adminAPI.updateOfficial(off._id, { ...off, title: v });\r\n                              } else {\r\n                                const created = await adminAPI.createOfficial({ ...off, title: v });\r\n                                setOfficials(prev => prev.map(p => p._id === off._id ? created : p));\r\n                              }\r\n                              setManualSaveError(null);\r\n                            } catch (err) {\r\n                              console.error('auto-save failed', err);\r\n                              setManualSaveError('Auto-save failed');\r\n                            } finally {\r\n                              setSavingOfficials(false);\r\n                            }\r\n                          }, 900);\r\n                        }} fullWidth size=\"small\" sx={{ mb: 1 }} variant=\"outlined\" InputLabelProps={{ shrink: true }} />\r\n                        <TextField label=\"Term\" value={off.term} onChange={(e) => {\r\n                          const v = e.target.value;\r\n                          setOfficials(prev => prev.map(o => o._id === off._id ? { ...o, term: v } : o));\r\n                          if (autoSaveTimers.current[off._id || '']) clearTimeout(autoSaveTimers.current[off._id || '']);\r\n                          autoSaveTimers.current[off._id || ''] = window.setTimeout(async () => {\r\n                            try {\r\n                              setSavingOfficials(true);\r\n                              if (off._id && !off._id.toString().startsWith('new-')) {\r\n                                await adminAPI.updateOfficial(off._id, { ...off, term: v });\r\n                              } else {\r\n                                const created = await adminAPI.createOfficial({ ...off, term: v });\r\n                                setOfficials(prev => prev.map(p => p._id === off._id ? created : p));\r\n                              }\r\n                              setManualSaveError(null);\r\n                            } catch (err) {\r\n                              console.error('auto-save failed', err);\r\n                              setManualSaveError('Auto-save failed');\r\n                            } finally {\r\n                              setSavingOfficials(false);\r\n                            }\r\n                          }, 900);\r\n                        }} fullWidth size=\"small\" variant=\"outlined\" InputLabelProps={{ shrink: true }} />\r\n                        <Box sx={{ display: 'flex', gap: 1, mt: 1 }}>\r\n                          <AntdUpload showUploadList={false} beforeUpload={(file) => {\r\n                            // Client-side file size limit: 2MB (match server multer limit)\r\n                            const MAX_BYTES = 2 * 1024 * 1024;\r\n                            if (file.size > MAX_BYTES) {\r\n                              antdMessage.warning('File is too large. Maximum allowed size is 2 MB.');\r\n                              return false;\r\n                            }\r\n                            // create local preview immediately\r\n                            try {\r\n                              const url = URL.createObjectURL(file);\r\n                              previewUrlsRef.current[off._id || `temp-${Date.now()}`] = url;\r\n                              setOfficials(prev => prev.map(o => o._id === off._id ? { ...o, previewUrl: url } : o));\r\n                            } catch (e) {}\r\n\r\n                            // upload file\r\n                            (async () => {\r\n                              try {\r\n                                if (!off._id || off._id.toString().startsWith('new-')) {\r\n                                  antdMessage.warning('Please save official first by entering name/title/term');\r\n                                  return;\r\n                                }\r\n                                await adminAPI.uploadOfficialPhoto(off._id, file as File);\r\n                                // refresh list\r\n                                const refreshed = await adminAPI.getOfficials();\r\n                                setOfficials(Array.isArray(refreshed) ? refreshed : officials);\r\n                                antdMessage.success('Photo uploaded');\r\n                                // revoke preview for this official if any\r\n                                try {\r\n                                  const key = off._id || '';\r\n                                  const u = previewUrlsRef.current[key];\r\n                                  if (u) { URL.revokeObjectURL(u); delete previewUrlsRef.current[key]; }\r\n                                } catch (e) {}\r\n                              } catch (err) {\r\n                                console.error('upload failed', err);\r\n                                antdMessage.error('Upload failed');\r\n                              }\r\n                            })();\r\n                            return false; }}>\r\n\r\n                            <Button startIcon={<UploadOutlined />}>Upload Photo</Button>\r\n                          </AntdUpload>\r\n                          <Button color=\"error\" startIcon={<DeleteOutlined />} onClick={() => {\r\n                            if (off._id && !off._id.toString().startsWith('new-')) {\r\n                              handleDeleteOfficial(off._id);\r\n                            } else {\r\n                              setOfficials(prev => prev.filter(p => p._id !== off._id));\r\n                            }\r\n                          }}>Delete</Button>\r\n                        </Box>\r\n                      </Box>\r\n                    </Paper>\r\n                  ))}\r\n                </Box>\r\n              )}\r\n            </Box>\r\n          </Box>\r\n\r\n            <Box sx={{ width: { xs: '100%', md: 360 }, position: { xs: 'relative', md: 'sticky' }, top: { md: 24 }, alignSelf: 'flex-start', mt: { xs: 2, md: 0 } }}>\r\n              <Typography variant=\"body2\" sx={{ mb: 1 }}>Officials Preview</Typography>\r\n              <Box sx={{ background: 'white', borderRadius: 2, p: 2 }}>\r\n                {officials.length === 0 ? (\r\n                  <Typography variant=\"body2\" color=\"text.secondary\">No officials to preview</Typography>\r\n                ) : (\r\n                  (() => {\r\n                    const stable = officials.filter(o => !(o._id && o._id.toString().startsWith('new-')));\r\n                    const newly = officials.filter(o => o._id && o._id.toString().startsWith('new-'));\r\n                    const previewOrder = [...stable, ...newly];\r\n                    return (\r\n                      <div\r\n                        ref={previewContainerRef}\r\n                        style={{ display: 'flex', gap: 12, overflowX: 'auto', padding: '6px 4px', scrollSnapType: 'x mandatory' }}\r\n                        aria-label=\"Officials preview\"\r\n                      >\r\n                        {previewOrder.map(off => {\r\n                          const id = off._id || '';\r\n                          const isHighlighted = highlightedIds.includes(id);\r\n                          return (\r\n                            <div\r\n                              key={id || Math.random()}\r\n                              style={{\r\n                                minWidth: 140,\r\n                                textAlign: 'center',\r\n                                padding: 8,\r\n                                scrollSnapAlign: 'center' as const,\r\n                                transition: 'box-shadow .25s, transform .18s',\r\n                                boxShadow: isHighlighted ? '0 10px 30px rgba(25,118,210,0.18)' : undefined,\r\n                                transform: isHighlighted ? 'translateY(-4px)' : undefined,\r\n                                borderRadius: 8,\r\n                                background: isHighlighted ? 'linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,255,0.98))' : undefined,\r\n                                flex: '0 0 auto'\r\n                              }}\r\n                            >\r\n                              <AppAvatar size={80} src={getOfficialPhotoSrc(off as any)} style={{ margin: '0 auto', boxShadow: '0 6px 18px rgba(0,0,0,0.06)' }} />\r\n                              <div style={{ marginTop: 8 }}>\r\n                                <div style={{ fontWeight: 600, fontSize: 14 }}>{off.name || ''}</div>\r\n                                <div style={{ color: '#888', fontSize: 12 }}>{off.title}</div>\r\n                                <div style={{ color: '#888', fontSize: 12 }}>{off.term}</div>\r\n                              </div>\r\n                            </div>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                    );\r\n                  })()\r\n                )}\r\n              </Box>\r\n            </Box>\r\n          </Box>\r\n\r\n          {/* Manual Save handled via floating action button  errors still shown inline */}\r\n          {manualSaveError && <Typography color=\"error\" sx={{ mt: 1 }}>{manualSaveError}</Typography>}\r\n\r\n        {/* Contact Information */}\r\n        <Typography variant=\"subtitle1\" gutterBottom>\r\n          Contact Information\r\n        </Typography>\r\n        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2, mb: 3 }}>\r\n          <TextField\r\n            label=\"Contact Email\"\r\n            type=\"email\"\r\n            value={settings.contactEmail}\r\n            onChange={(e) => setSettings({ ...settings, contactEmail: e.target.value })}\r\n            variant=\"outlined\"\r\n            InputLabelProps={{ shrink: true }}\r\n            fullWidth\r\n          />\r\n          <TextField\r\n            label=\"Contact Phone\"\r\n            value={settings.contactPhone}\r\n            onChange={(e) => setSettings({ ...settings, contactPhone: e.target.value })}\r\n            variant=\"outlined\"\r\n            InputLabelProps={{ shrink: true }}\r\n            fullWidth\r\n          />\r\n        </Box>\r\n\r\n        <Divider sx={{ my: 3 }} />\r\n\r\n        {/* System Configuration */}\r\n        <Typography variant=\"subtitle1\" gutterBottom>\r\n          System Configuration\r\n        </Typography>\r\n        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2, mb: 3 }}>\r\n          <FormControlLabel\r\n            control={\r\n              <Switch\r\n                checked={settings.maintainanceMode}\r\n                onChange={(e) => setSettings({ ...settings, maintainanceMode: e.target.checked })}\r\n              />\r\n            }\r\n            label=\"Maintenance Mode\"\r\n          />\r\n          <FormControlLabel\r\n            control={\r\n              <Switch\r\n                checked={settings.allowNewRegistrations}\r\n                onChange={(e) => setSettings({ ...settings, allowNewRegistrations: e.target.checked })}\r\n              />\r\n            }\r\n            label=\"Allow New Registrations\"\r\n          />\r\n          {/* Allow multiple accounts per IP toggle and limit */}\r\n          <Box>\r\n            <FormControlLabel\r\n              control={\r\n                <Switch\r\n                  checked={(settings as any).allowMultipleAccountsPerIP}\r\n                  onChange={(e) => setSettings({ ...settings, allowMultipleAccountsPerIP: e.target.checked } as SystemSettingsData)}\r\n                />\r\n              }\r\n              label=\"Allow multiple accounts per IP\"\r\n            />\r\n            <Box sx={{ mt: 1, ml: 4, display: 'flex', alignItems: 'center', gap: 2 }}>\r\n              <TextField\r\n                label=\"Max accounts per IP\"\r\n                type=\"number\"\r\n                size=\"small\"\r\n                value={(settings as any).maxAccountsPerIP ?? 1}\r\n                onChange={(e) => setSettings({ ...settings, maxAccountsPerIP: parseInt(e.target.value || '1') } as SystemSettingsData)}\r\n                variant=\"outlined\"\r\n                InputLabelProps={{ shrink: true }}\r\n                inputProps={{ min: 1, max: 100 }}\r\n                sx={{ width: 140 }}\r\n              />\r\n              <Typography variant=\"caption\" color=\"text.secondary\">\r\n                Current limit: {(settings as any).maxAccountsPerIP ?? 1}\r\n              </Typography>\r\n            </Box>\r\n          </Box>\r\n          <FormControlLabel\r\n            control={\r\n              <Switch\r\n                checked={settings.requireEmailVerification}\r\n                onChange={(e) => setSettings({ ...settings, requireEmailVerification: e.target.checked })}\r\n              />\r\n            }\r\n            label=\"Require Email Verification\"\r\n          />\r\n          <TextField\r\n            label=\"Maximum Document Requests per User\"\r\n            type=\"number\"\r\n            value={settings.maxDocumentRequests}\r\n            onChange={(e) => setSettings({ ...settings, maxDocumentRequests: parseInt(e.target.value) })}\r\n            variant=\"outlined\"\r\n            InputLabelProps={{ shrink: true }}\r\n            inputProps={{ min: 1, max: 20 }}\r\n          />\r\n          <TextField\r\n            label=\"Document Processing Days\"\r\n            type=\"number\"\r\n            value={settings.documentProcessingDays}\r\n            onChange={(e) => setSettings({ ...settings, documentProcessingDays: parseInt(e.target.value) })}\r\n            variant=\"outlined\"\r\n            InputLabelProps={{ shrink: true }}\r\n            inputProps={{ min: 1, max: 30 }}\r\n            helperText=\"Standard number of days to process document requests\"\r\n          />\r\n        </Box>\r\n\r\n        <Divider sx={{ my: 3 }} />\r\n\r\n        {/* System Notice */}\r\n        <Typography variant=\"subtitle1\" gutterBottom>\r\n          System Notice\r\n        </Typography>\r\n        <Box sx={{ mb: 3 }}>\r\n          <TextField\r\n            label=\"System-wide Notice\"\r\n            value={settings.systemNotice}\r\n            onChange={(e) => setSettings({ ...settings, systemNotice: e.target.value })}\r\n            variant=\"outlined\"\r\n            InputLabelProps={{ shrink: true }}\r\n            fullWidth\r\n            multiline\r\n            rows={3}\r\n            helperText=\"This notice will be displayed to all users\"\r\n          />\r\n        </Box>\r\n\r\n        {/* Save button relocated to floating action button */}\r\n\r\n        {/* Floating Manual Save button (bottom-right) */}\r\n        <Box sx={{\r\n          position: 'fixed',\r\n          right: 24,\r\n          bottom: 24,\r\n          zIndex: 1300,\r\n        }}>\r\n          <Button\r\n            variant=\"contained\"\r\n            onClick={() => saveAll()}\r\n            disabled={saving || savingOfficials}\r\n            sx={{\r\n              width: 64,\r\n              height: 64,\r\n              borderRadius: '50%',\r\n              minWidth: 64,\r\n              boxShadow: '0 8px 24px rgba(25,118,210,0.24)',\r\n              backgroundColor: '#1976d2',\r\n              color: '#fff',\r\n              '&:hover': {\r\n                boxShadow: '0 12px 32px rgba(25,118,210,0.32)',\r\n                backgroundColor: '#1565c0',\r\n              },\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              fontWeight: 600,\r\n            }}\r\n            aria-label=\"Save Settings and Officials\"\r\n          >\r\n            {(saving || savingOfficials) ? '...' : 'Save'}\r\n          </Button>\r\n        </Box>\r\n      </Paper>\r\n      <Dialog open={confirmDisableOpen} onClose={() => setConfirmDisableOpen(false)}>\r\n        <DialogTitle>Disable Resident Verifications?</DialogTitle>\r\n        <DialogContent>\r\n          <Typography>\r\n            Disabling resident verifications will permanently delete all pending verification requests and their uploaded files on the server. This action cannot be undone. Are you sure you want to proceed?\r\n          </Typography>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setConfirmDisableOpen(false)} disabled={saving}>Cancel</Button>\r\n          <Button onClick={() => confirmAndSave()} color=\"error\" disabled={saving}>Yes, disable and save</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default SystemSettings;\r\n","import React, { useEffect, useState } from 'react';\r\nimport './DocumentRequestForm.css';\r\nimport { documentsAPI } from '../services/api';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { FileWordOutlined, MoreOutlined, EyeOutlined, DownloadOutlined } from '@ant-design/icons';\r\nimport { \r\n  Card, \r\n  Row, \r\n  Col, \r\n  Typography, \r\n  Input, \r\n  Select, \r\n  Dropdown, \r\n  Button, \r\n  Space,\r\n  Breadcrumb,\r\n  \r\n  message,\r\n  Modal,\r\n  Form,\r\n  Empty,\r\n  DatePicker\r\n} from 'antd';\r\n// upload icon already imported above\r\n\r\nconst { Title, Text } = Typography;\r\nconst { Search } = Input;\r\n\r\ninterface FormValues {\r\n  purpose: string;\r\n  // fields may contain strings or date objects (dayjs) before serialization\r\n  fields: Record<string, any>;\r\n}\r\n\r\ninterface FileData {\r\n  _id: string;\r\n  filename: string;\r\n  length: number;\r\n  uploadDate: string;\r\n  category?: string;\r\n}\r\n\r\nconst DocumentRequestForm: React.FC = () => {\r\n  // State management\r\n  const [files, setFiles] = useState<FileData[]>([]);\r\n  const [selectedFields, setSelectedFields] = useState<string[]>([]);\r\n  const [modalOpen, setModalOpen] = useState(false);\r\n  const [modalDocName, setModalDocName] = useState('');\r\n  const [fieldValues, setFieldValues] = useState<Record<string, string>>({});\r\n  \r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedCategory, setSelectedCategory] = useState('all');\r\n  const [sortBy, setSortBy] = useState<'name' | 'date' | 'type'>('name');\r\n  const [loading, setLoading] = useState(false);\r\n  const [submitLoading, setSubmitLoading] = useState(false);\r\n  \r\n\r\n  const { user: authUser } = useAuth();\r\n  // currentUser will be resolved inside handlers when needed\r\n\r\n  // Verification popups disabled while the feature is paused\r\n\r\n  useEffect(() => {\r\n    const fetchFiles = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const data = await documentsAPI.listFiles();\r\n        setFiles(data);\r\n      } catch (error) {\r\n        message.error('Failed to fetch document templates');\r\n        setFiles([]);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchFiles();\r\n    // pending verification checks are disabled while feature is paused\r\n  }, []);\r\n\r\n  const handleCardClick = async (file: FileData) => {\r\n    // If resident and not verified, normally we'd prompt for verification.\r\n    // That behavior is currently disabled while verification is paused.\r\n    setModalDocName(file.filename.replace(/\\.docx$/i, ''));\r\n    try {\r\n      const api = await import('../services/api');\r\n      const res = await api.axiosPublic.get(`/documents/preview/${file._id}`, { params: { format: 'html' }, responseType: 'text' });\r\n      const html = res && res.data ? res.data : '';\r\n      const regex = /\\{(.*?)\\}/g;\r\n      const fields: string[] = [];\r\n      let match;\r\n      while ((match = regex.exec(html)) !== null) {\r\n        fields.push(match[1].trim());\r\n      }\r\n      // Hide QR field from the request form  it is generated server-side\r\n      const visibleFields = fields.filter(f => f && f.toLowerCase() !== 'qr');\r\n      setSelectedFields(visibleFields);\r\n      const initialValues: Record<string, string> = {};\r\n      // compute current date parts\r\n      const now = new Date();\r\n      const day = now.getDate();\r\n      const monthNum = now.getMonth() + 1;\r\n      const monthName = now.toLocaleString(undefined, { month: 'long' });\r\n      const year = now.getFullYear();\r\n      const mm = String(monthNum).padStart(2, '0');\r\n      const dd = String(day).padStart(2, '0');\r\n      const currentDateFormatted = `${mm}/${dd}/${year}`;\r\n\r\n      visibleFields.forEach(f => {\r\n        // default empty\r\n        initialValues[f] = '';\r\n        // auto-fill common \"current\" fields\r\n        if (/^current(day|dayof)?$/i.test(f) || /currentday/i.test(f)) {\r\n          initialValues[f] = String(day);\r\n        } else if (/current(month)?$/i.test(f) || /currentmonth/i.test(f)) {\r\n          // put human-readable month name\r\n          initialValues[f] = monthName;\r\n        } else if (/current(year)?$/i.test(f) || /currentyear/i.test(f)) {\r\n          initialValues[f] = String(year);\r\n        } else if (/currentdate|current_date|current date|dateofrequest|requesteddate/i.test(f)) {\r\n          // unified date field\r\n          initialValues[f] = currentDateFormatted;\r\n        }\r\n      });\r\n      setFieldValues(initialValues);\r\n      setModalOpen(true);\r\n    } catch (error) {\r\n      message.error('Failed to load document preview');\r\n      setSelectedFields([]);\r\n      setFieldValues({});\r\n    }\r\n  };\r\n\r\n  // Minimal action menu for each document card\r\n  const getActionMenu = (file: FileData) => [\r\n    { key: 'view', icon: <EyeOutlined />, label: 'View' },\r\n    { key: 'download', icon: <DownloadOutlined />, label: 'Download' },\r\n  ];\r\n\r\n  // Filter and sort files for display\r\n  const filteredFiles = files\r\n    .filter(file => {\r\n      // Hide generated/processed copies from the templates list so only\r\n      // the canonical templates are shown in the UI. Generated files saved\r\n      // by the server often use names like `filled_<id>.docx` or a\r\n      // transaction-code-style name that starts with the year (e.g. `2025-...`).\r\n      // Exclude those patterns here so generated copies remain only in the\r\n      // `processed_documents` bucket and don't appear in the templates grid.\r\n      const fname = file.filename || '';\r\n      // Exclude obvious filled/generate file names\r\n      if (/^filled_/i.test(fname)) return false;\r\n      // Exclude filenames that start with a year-like transaction code\r\n      if (/^\\d{4}-/.test(fname)) return false;\r\n\r\n      const name = fname.toLowerCase();\r\n      const search = searchTerm.toLowerCase();\r\n      const categoryMatch = selectedCategory === 'all' || file.category === selectedCategory;\r\n      return name.includes(search) && categoryMatch;\r\n    })\r\n    .sort((a, b) => {\r\n      switch (sortBy) {\r\n        case 'date':\r\n          return new Date(b.uploadDate).getTime() - new Date(a.uploadDate).getTime();\r\n        case 'type':\r\n          return a.filename.split('.').pop()?.localeCompare(b.filename.split('.').pop() || '') || 0;\r\n        default:\r\n          return a.filename.localeCompare(b.filename);\r\n      }\r\n    });\r\n\r\n  return (\r\n    <div style={{ padding: '24px', minHeight: '80vh', background: '#f0f2f5' }}>\r\n      {/* Header Section */}\r\n      <Row justify=\"start\" align=\"middle\" style={{ marginBottom: 24 }}>\r\n        <Col style={{ textAlign: 'left' }}>\r\n          <Breadcrumb style={{ marginBottom: 8 }}>\r\n            <Breadcrumb.Item>Home</Breadcrumb.Item>\r\n            <Breadcrumb.Item>Documents</Breadcrumb.Item>\r\n            <Breadcrumb.Item>Request</Breadcrumb.Item>\r\n          </Breadcrumb>\r\n          <Title level={2} style={{ margin: 0, textAlign: 'left' }}>Request Document</Title>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Filters Section */}\r\n      <Row gutter={16} justify=\"center\" style={{ marginBottom: 24 }}>\r\n        <Col xs={24} sm={16} md={10} lg={8}>\r\n          <Search\r\n            placeholder=\"Search documents...\"\r\n            value={searchTerm}\r\n            onChange={e => setSearchTerm(e.target.value)}\r\n            style={{ width: '100%' }}\r\n          />\r\n        </Col>\r\n        <Col xs={24} sm={16} md={10} lg={8}>\r\n          <div className=\"filter-controls\">\r\n            <Select\r\n              defaultValue=\"all\"\r\n              className=\"filter-select category-select\"\r\n              style={{ width: 220 }}\r\n              onChange={value => setSelectedCategory(value)}\r\n            >\r\n              <Select.Option value=\"all\">All Categories</Select.Option>\r\n              <Select.Option value=\"personal\">Personal Documents</Select.Option>\r\n              <Select.Option value=\"business\">Business Documents</Select.Option>\r\n              <Select.Option value=\"certificates\">Certificates</Select.Option>\r\n            </Select>\r\n            <Select\r\n              defaultValue=\"name\"\r\n              className=\"filter-select sort-select\"\r\n              style={{ width: 160 }}\r\n              onChange={value => setSortBy(value as 'name' | 'date' | 'type')}\r\n            >\r\n              <Select.Option value=\"name\">Sort by Name</Select.Option>\r\n              <Select.Option value=\"date\">Sort by Date</Select.Option>\r\n              <Select.Option value=\"type\">Sort by Type</Select.Option>\r\n            </Select>\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Documents Grid */}\r\n      <Row gutter={[16, 16]}>\r\n        {loading ? (\r\n          <Col span={24} style={{ textAlign: 'center', padding: '40px' }}>\r\n            Loading documents...\r\n          </Col>\r\n        ) : filteredFiles.length === 0 ? (\r\n          <Col span={24} style={{ textAlign: 'center', padding: '40px' }}>\r\n            No documents found\r\n          </Col>\r\n        ) : (\r\n          filteredFiles.map((file) => (\r\n            <Col xs={24} sm={12} md={8} lg={6} key={file._id}>\r\n              <Card\r\n                hoverable\r\n                style={{ \r\n                  transition: 'all 0.3s ease',\r\n                  borderRadius: 8\r\n                }}\r\n                styles={{ body: { padding: 16 } }}\r\n                onClick={() => handleCardClick(file)}\r\n              >\r\n                <div style={{ display: 'flex', alignItems: 'flex-start', marginBottom: 12 }}>\r\n                  <FileWordOutlined style={{ fontSize: 24, color: '#1890ff', marginRight: 12, marginTop: 4 }} />\r\n                  <div style={{ flex: 1, minWidth: 0 }}>\r\n                    <Text strong style={{ \r\n                      display: 'block',\r\n                      overflow: 'hidden',\r\n                      textOverflow: 'ellipsis',\r\n                      whiteSpace: 'nowrap'\r\n                    }}>\r\n                      {file.filename.replace(/\\.docx$/i, '')}\r\n                    </Text>\r\n                    <Text type=\"secondary\" style={{ fontSize: 12 }}>\r\n                      {new Date(file.uploadDate).toLocaleDateString()}  {Math.round(file.length / 1024)} KB\r\n                    </Text>\r\n                  </div>\r\n                  <Dropdown menu={{ items: getActionMenu(file) }} trigger={['click']}>\r\n                    <Button type=\"text\" icon={<MoreOutlined />} onClick={e => e.stopPropagation()} />\r\n                  </Dropdown>\r\n                </div>\r\n              </Card>\r\n            </Col>\r\n          ))\r\n        )}\r\n      </Row>\r\n\r\n      {/* Document Request Modal */}\r\n      <Modal\r\n        open={modalOpen}\r\n        onCancel={() => setModalOpen(false)}\r\n        width={800}\r\n        footer={null}\r\n      >\r\n        {selectedFields.length === 0 ? (\r\n          <Empty description=\"No fields found in this template\" />\r\n        ) : (\r\n          <Form\r\n            layout=\"vertical\"\r\n            initialValues={{ fields: fieldValues }}\r\n            onFinish={async (values: FormValues) => {\r\n              setSubmitLoading(true);\r\n              try {\r\n                const processedFields: Record<string, any> = { ...values.fields };\r\n                Object.entries(processedFields).forEach(([k, v]) => {\r\n                  if (v && typeof (v as any).format === 'function') {\r\n                    try { processedFields[k] = (v as any).format('MM/DD/YYYY'); } catch (e) { processedFields[k] = String(v); }\r\n                  }\r\n                });\r\n\r\n                const payload = {\r\n                  type: modalDocName,\r\n                  documentType: modalDocName,\r\n                  purpose: values.purpose,\r\n                  fileId: files.find((f) => f.filename.replace(/\\.docx$/i, '') === modalDocName)?._id,\r\n                  fieldValues: processedFields,\r\n                  username: (authUser && authUser.username) || undefined,\r\n                  barangayID: (authUser && authUser.barangayID) || undefined\r\n                };\r\n                await documentsAPI.requestDocument(payload);\r\n                message.success('Request submitted successfully!');\r\n                setModalOpen(false);\r\n              } catch (err) {\r\n                message.error('Failed to submit request.');\r\n              } finally {\r\n                setSubmitLoading(false);\r\n              }\r\n            }}\r\n          >\r\n            <Row gutter={[16, 16]}>\r\n              <Col span={24}>\r\n                <Form.Item\r\n                  name=\"purpose\"\r\n                  label=\"Purpose\"\r\n                  rules={[{ required: true, message: 'Please enter the purpose' }]}\r\n                >\r\n                  <Input.TextArea rows={4} placeholder=\"Enter the purpose of your request\" />\r\n                </Form.Item>\r\n              </Col>\r\n\r\n              {selectedFields.map((field, idx) => (\r\n                <Col xs={24} sm={12} key={idx}>\r\n                  <Form.Item\r\n                    name={['fields', field]}\r\n                    label={field}\r\n                    rules={[{ required: true, message: `Please enter ${field}` }]}\r\n                  >\r\n                    { /date|dob|birth|issued/i.test(field) ? <DatePicker style={{ width: '100%' }} format=\"MM/DD/YYYY\" /> : <Input placeholder={`Enter ${field}`} /> }\r\n                  </Form.Item>\r\n                </Col>\r\n              ))}\r\n\r\n              <Col span={24} style={{ textAlign: 'right' }}>\r\n                <Space>\r\n                  <Button onClick={() => setModalOpen(false)}>Cancel</Button>\r\n                  <Button type=\"primary\" htmlType=\"submit\" loading={submitLoading}>Submit Request</Button>\r\n                </Space>\r\n              </Col>\r\n            </Row>\r\n          </Form>\r\n        )}\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DocumentRequestForm;","import React, { useState } from 'react';\r\nimport type { FormInstance } from 'antd';\r\nimport {\r\n  Form,\r\n  Select,\r\n  Input,\r\n  Button,\r\n  Typography,\r\n  message as antdMessage,\r\n  Card,\r\n  Alert,\r\n  Upload,\r\n  Row,\r\n  Col,\r\n  Steps,\r\n  Tooltip,\r\n  Modal,\r\n  Descriptions,\r\n} from 'antd';\r\nimport { UploadOutlined, InfoCircleOutlined, SendOutlined, ReloadOutlined, MailOutlined } from '@ant-design/icons';\r\nimport './InquiryForm.css';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { contactAPI } from '../services/api';\r\n\r\nconst { TextArea } = Input;\r\n\r\n// We will use grouped options for the Inquiry Type select\r\nconst inquiryTypeGroups = [\r\n  {\r\n    label: 'Requests',\r\n    options: [\r\n      { value: 'DOCUMENT_REQUEST', label: 'Document Request' },\r\n      { value: 'SCHEDULE_APPOINTMENT', label: 'Schedule Appointment' },\r\n      { value: 'CERTIFICATE_REQUEST', label: 'Certificate Request' },\r\n    ],\r\n  },\r\n  {\r\n    label: 'Concerns',\r\n    options: [\r\n      { value: 'COMPLAINT', label: 'Complaint' },\r\n      { value: 'ASSISTANCE', label: 'Assistance' },\r\n    ],\r\n  },\r\n];\r\n\r\nconst InquiryForm: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const [loading, setLoading] = useState(false);\r\n  const [showSuccess, setShowSuccess] = useState(false);\r\n  const [form] = Form.useForm();\r\n  const formRef = React.useRef<FormInstance | null>(null);\r\n  React.useEffect(() => { formRef.current = form; }, [form]);\r\n  const [subjectCount, setSubjectCount] = React.useState(0);\r\n  const [messageCount, setMessageCount] = React.useState(0);\r\n  const SUBJECT_MAX = 100;\r\n  const MESSAGE_MAX = 500;\r\n  const [currentStep, setCurrentStep] = React.useState(0);\r\n  const [fileListState, setFileListState] = React.useState<any[]>([]);\r\n  const [previewModalVisible, setPreviewModalVisible] = React.useState(false);\r\n  const [previewValues, setPreviewValues] = React.useState<any>(null);\r\n  const LOCALSTORAGE_KEY = 'inquiryFormDraft_v1';\r\n\r\n  // Load draft from localStorage on mount\r\n  React.useEffect(() => {\r\n    try {\r\n      const raw = localStorage.getItem(LOCALSTORAGE_KEY);\r\n      if (raw) {\r\n        const parsed = JSON.parse(raw);\r\n        if (parsed) {\r\n          const { type, assignedRole, subject, message, attachments } = parsed;\r\n          formRef.current?.setFieldsValue({ type, assignedRole, subject, message });\r\n          if (subject) setSubjectCount(subject.length);\r\n          if (message) setMessageCount(message.length);\r\n          if (attachments && Array.isArray(attachments) && attachments.length) {\r\n            // create placeholder file entries (no preview available)\r\n            const restored = attachments.map((name: string, idx: number) => ({ uid: `restored-${idx}`, name }));\r\n            setFileListState(restored);\r\n            formRef.current?.setFieldsValue({ attachment: restored });\r\n          }\r\n          // set step based on restored values\r\n          if (subject && message && (assignedRole || type)) setCurrentStep(2);\r\n          else if (attachments && attachments.length) setCurrentStep(1);\r\n          else setCurrentStep(0);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      // ignore parse errors\r\n      console.warn('Failed to load inquiry draft', err);\r\n    }\r\n  }, []);\r\n\r\n  // Autosave draft every 5 seconds\r\n  React.useEffect(() => {\r\n    const saveDraft = () => {\r\n      try {\r\n        const values = formRef.current?.getFieldsValue(true) || {};\r\n        const draft = {\r\n          type: values.type || null,\r\n          assignedRole: values.assignedRole || null,\r\n          subject: values.subject || '',\r\n          message: values.message || '',\r\n          attachments: (fileListState || []).map((f: any) => f.name || (f.originFileObj && f.originFileObj.name) || ''),\r\n          updatedAt: new Date().toISOString(),\r\n        };\r\n        localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(draft));\r\n      } catch (err) {\r\n        console.warn('Failed to save draft', err);\r\n      }\r\n    };\r\n\r\n    const id = setInterval(saveDraft, 5000);\r\n    // also save on unload\r\n    const onUnload = () => saveDraft();\r\n    window.addEventListener('beforeunload', onUnload);\r\n    return () => {\r\n      clearInterval(id);\r\n      window.removeEventListener('beforeunload', onUnload);\r\n      // final save\r\n      try {\r\n        const values = formRef.current?.getFieldsValue(true) || {};\r\n        const draft = {\r\n          type: values.type || null,\r\n          assignedRole: values.assignedRole || null,\r\n          subject: values.subject || '',\r\n          message: values.message || '',\r\n          attachments: (fileListState || []).map((f: any) => f.name || (f.originFileObj && f.originFileObj.name) || ''),\r\n          updatedAt: new Date().toISOString(),\r\n        };\r\n        localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(draft));\r\n      } catch (err) {\r\n        // ignore\r\n      }\r\n    };\r\n  }, [fileListState]);\r\n\r\n  const formatBytes = (bytes: number) => {\r\n    if (bytes === 0) return '0 B';\r\n    const k = 1024;\r\n    const sizes = ['B', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n  };\r\n\r\n  const onFinish = async (values: any) => {\r\n    setLoading(true);\r\n    setShowSuccess(false);\r\n    try {\r\n      // Extract uploaded files if any and send as multipart/form-data\r\n      let files: any[] = [];\r\n      if (values.attachment) {\r\n        if (Array.isArray(values.attachment)) files = values.attachment;\r\n        else if (values.attachment.fileList && Array.isArray(values.attachment.fileList)) files = values.attachment.fileList;\r\n      }\r\n      const formData = new FormData();\r\n      formData.append('type', values.type || '');\r\n      formData.append('subject', values.subject || '');\r\n      formData.append('message', values.message || '');\r\n      formData.append('assignedRole', values.assignedRole || 'staff');\r\n      formData.append('username', user?.username || '');\r\n      formData.append('barangayID', user?.barangayID || '');\r\n      if (values.assignedTo && Array.isArray(values.assignedTo)) {\r\n        for (const id of values.assignedTo) formData.append('assignedTo[]', id);\r\n      }\r\n      // Append each file's originFileObj (Upload component stores the file under originFileObj)\r\n      for (const f of files) {\r\n        if (f.originFileObj) formData.append('attachments', f.originFileObj, f.name || (f.originFileObj && f.originFileObj.name));\r\n      }\r\n\r\n      await contactAPI.submitInquiry(formData);\r\n\r\n      setShowSuccess(true);\r\n      form.resetFields();\r\n      setFileListState([]);\r\n      localStorage.removeItem(LOCALSTORAGE_KEY);\r\n      antdMessage.success('Your inquiry has been submitted!');\r\n    } catch (err) {\r\n      console.error(err);\r\n      antdMessage.error('Failed to submit inquiry.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const onFinishFailed = (_errorInfo: any) => {\r\n    antdMessage.error('Please complete all required fields');\r\n  };\r\n\r\n  // Note: Upload components use `beforeUpload={() => false}` inline to prevent auto upload.\r\n\r\n  return (\r\n    <div style={{ maxWidth: 900, margin: '32px auto', padding: '0 12px' }}>\r\n      <Card\r\n        style={{ borderRadius: 18, boxShadow: '0 4px 24px 0 rgba(64,201,255,0.10)', padding: 0, background: '#fff' }}\r\n        headStyle={{\r\n          borderRadius: '18px 18px 0 0',\r\n          background: 'linear-gradient(90deg, rgba(64,169,255,0.08) 0%, rgba(146,84,222,0.06) 100%)',\r\n          padding: '16px 24px',\r\n        }}\r\n        styles={{ body: { padding: 24 } }}\r\n        bordered={false}\r\n        title={\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>\r\n            <MailOutlined style={{ fontSize: 28, color: '#1890ff' }} />\r\n            <div style={{ lineHeight: 1 }}>\r\n              <Typography.Title level={4} style={{ margin: 0, color: '#1890ff', fontWeight: 700, fontFamily: 'Poppins, Arial, sans-serif' }}>\r\n                Submit an Inquiry\r\n              </Typography.Title>\r\n              <div style={{ fontSize: 12, color: '#6c757d', marginTop: 4 }}>\r\n                Fill out the form below and our staff will get back to you.\r\n              </div>\r\n            </div>\r\n          </div>\r\n        }\r\n      >\r\n        {showSuccess && (\r\n          <Alert\r\n            type=\"success\"\r\n            showIcon\r\n            message={<span style={{ fontWeight: 600 }}><span role=\"img\" aria-label=\"success\"></span> Your inquiry has been submitted!</span>}\r\n            style={{ marginBottom: 16, borderRadius: 8 }}\r\n            banner\r\n          />\r\n        )}\r\n\r\n        <Form\r\n          form={form}\r\n          layout=\"vertical\"\r\n          onFinish={onFinish}\r\n          onFinishFailed={onFinishFailed}\r\n          autoComplete=\"off\"\r\n          onFieldsChange={() => showSuccess && setShowSuccess(false)}\r\n          onValuesChange={(_, allValues) => {\r\n            // Determine step: 0 = Details (type/subject), 1 = Attachments (attachments added), 2 = Review\r\n            if (allValues && (allValues.attachment && allValues.attachment.length > 0)) {\r\n              setCurrentStep(1);\r\n            } else if (allValues && allValues.message && allValues.message.length > 0) {\r\n              setCurrentStep(0);\r\n            }\r\n            // If subject, message, and either assigned role exist, go to review step\r\n            if (\r\n              allValues &&\r\n              allValues.subject &&\r\n              allValues.message &&\r\n              (allValues.assignedRole || allValues.type)\r\n            ) {\r\n              setCurrentStep(2);\r\n            }\r\n          }}\r\n        >\r\n          <div style={{ marginBottom: 16 }}>\r\n            <Steps current={currentStep} size=\"small\">\r\n              <Steps.Step title=\"Details\" />\r\n              <Steps.Step title=\"Attachments\" />\r\n              <Steps.Step title=\"Review & Submit\" />\r\n            </Steps>\r\n          </div>\r\n          <Row gutter={16}>\r\n            <Col xs={24} sm={12}>\r\n              <Form.Item\r\n                name=\"type\"\r\n                label={\r\n                  <span>\r\n                    Inquiry Type <span style={{ color: 'red' }}>*</span>{' '}\r\n                    <Tooltip title=\"Choose the category that best describes your issue.\">\r\n                      <InfoCircleOutlined style={{ marginLeft: 6, color: '#8c8c8c' }} />\r\n                    </Tooltip>\r\n                  </span>\r\n                }\r\n                rules={[{ required: true, message: 'Please select an inquiry type' }]}\r\n              >\r\n                <Select placeholder=\"Select inquiry type\" className=\"inquiry-rounded-input\">\r\n                  {inquiryTypeGroups.map(group => (\r\n                    <Select.OptGroup key={group.label} label={group.label}>\r\n                      {group.options.map(opt => (\r\n                        <Select.Option key={opt.value} value={opt.value}>{opt.label}</Select.Option>\r\n                      ))}\r\n                    </Select.OptGroup>\r\n                  ))}\r\n                </Select>\r\n              </Form.Item>\r\n\r\n              <Form.Item\r\n                name=\"assignedRole\"\r\n                label={\r\n                  <span>\r\n                    Assign to Role <span style={{ color: 'red' }}>*</span>{' '}\r\n                    <Tooltip title=\"Select which role should handle your inquiry.\">\r\n                      <InfoCircleOutlined style={{ marginLeft: 6, color: '#8c8c8c' }} />\r\n                    </Tooltip>\r\n                  </span>\r\n                }\r\n                initialValue=\"staff\"\r\n                rules={[{ required: true, message: 'Please select a role to assign' }]}\r\n              >\r\n                <Select options={[{ value: 'staff', label: 'Staff' }, { value: 'admin', label: 'Admin' }]} placeholder=\"Assign to role\" className=\"inquiry-rounded-input\" />\r\n              </Form.Item>\r\n\r\n              <Form.Item\r\n                name=\"subject\"\r\n                label={\r\n                  <span>\r\n                    Subject <span style={{ color: 'red' }}>*</span>{' '}\r\n                    <Tooltip title=\"Enter a short subject line.\">\r\n                      <InfoCircleOutlined style={{ marginLeft: 6, color: '#8c8c8c' }} />\r\n                    </Tooltip>\r\n                  </span>\r\n                }\r\n                rules={[\r\n                  { required: true, message: 'Please enter a subject' },\r\n                  { min: 5, message: 'Subject must be at least 5 characters' },\r\n                  { max: SUBJECT_MAX, message: `Subject must be at most ${SUBJECT_MAX} characters` },\r\n                ]}\r\n              >\r\n                <div>\r\n                  <Input\r\n                    placeholder=\"Enter subject\"\r\n                    className=\"inquiry-rounded-input\"\r\n                    maxLength={SUBJECT_MAX + 20} // allow typing beyond limit but show error\r\n                    onChange={(e) => setSubjectCount(e.target.value.length)}\r\n                  />\r\n                  <div style={{ display: 'flex', justifyContent: 'flex-end', marginTop: 6 }}>\r\n                    <small style={{ color: subjectCount > SUBJECT_MAX ? 'red' : '#8c8c8c' }}>{subjectCount}/{SUBJECT_MAX}</small>\r\n                  </div>\r\n                </div>\r\n              </Form.Item>\r\n            </Col>\r\n\r\n            <Col xs={24} sm={12}>\r\n              <Form.Item\r\n                name=\"message\"\r\n                label={\r\n                  <span>\r\n                    Message <span style={{ color: 'red' }}>*</span>{' '}\r\n                    <Tooltip title=\"Provide details about your inquiry.\">\r\n                      <InfoCircleOutlined style={{ marginLeft: 6, color: '#8c8c8c' }} />\r\n                    </Tooltip>\r\n                  </span>\r\n                }\r\n                rules={[\r\n                  { required: true, message: 'Please enter your message' },\r\n                  { min: 10, message: 'Message must be at least 10 characters' },\r\n                  { max: MESSAGE_MAX, message: `Message must be at most ${MESSAGE_MAX} characters` },\r\n                ]}\r\n              >\r\n                <div>\r\n                  <TextArea\r\n                    rows={4}\r\n                    placeholder=\"Enter your message\"\r\n                    className=\"inquiry-rounded-input inquiry-large-textarea\"\r\n                    maxLength={MESSAGE_MAX + 50}\r\n                    onChange={(e) => setMessageCount(e.target.value.length)}\r\n                  />\r\n                  <div style={{ display: 'flex', justifyContent: 'flex-end', marginTop: 6 }}>\r\n                    <small style={{ color: messageCount > MESSAGE_MAX ? 'red' : '#8c8c8c' }}>{messageCount}/{MESSAGE_MAX}</small>\r\n                  </div>\r\n                </div>\r\n              </Form.Item>\r\n\r\n              <Form.Item\r\n                name=\"attachment\"\r\n                label={\r\n                  <span>\r\n                    Attachments{' '}\r\n                    <Tooltip title=\"Attach supporting documents (PDF, JPG, PNG).\">\r\n                      <InfoCircleOutlined style={{ marginLeft: 6, color: '#8c8c8c' }} />\r\n                    </Tooltip>\r\n                  </span>\r\n                }\r\n                valuePropName=\"fileList\"\r\n                getValueFromEvent={(e: any) => (Array.isArray(e) ? e : e && e.fileList)}\r\n                extra=\"Allowed: PDF, JPG, PNG. Max 5MB each.\"\r\n              >\r\n                <Upload.Dragger\r\n                  multiple\r\n                  accept=\".pdf,.jpg,.jpeg,.png\"\r\n                  fileList={fileListState}\r\n                  beforeUpload={() => false}\r\n                  onChange={(info) => {\r\n                    const incoming = info.fileList || [];\r\n                    const nextList: any[] = [];\r\n                    incoming.forEach((f: any) => {\r\n                      const file = f.originFileObj || f;\r\n                      const isAllowedType = ['application/pdf', 'image/jpeg', 'image/png'].includes(file.type) || (file.name && /\\.(pdf|jpe?g|png)$/i.test(file.name));\r\n                      const isLt5M = (file.size || 0) / 1024 / 1024 < 5;\r\n                      if (!isAllowedType) {\r\n                        antdMessage.error(`${file.name} is not a supported file type`);\r\n                        return;\r\n                      }\r\n                      if (!isLt5M) {\r\n                        antdMessage.error(`${file.name} must be smaller than 5MB`);\r\n                        return;\r\n                      }\r\n\r\n                      // create preview for images\r\n                      if (file.type && file.type.startsWith('image/') && !f.url && !f.preview) {\r\n                        try {\r\n                          // originFileObj exists for newly selected files\r\n                          const preview = URL.createObjectURL(file);\r\n                          f.preview = preview;\r\n                        } catch (e) {\r\n                          // ignore\r\n                        }\r\n                      }\r\n\r\n                      nextList.push(f);\r\n                    });\r\n\r\n                    setFileListState(nextList);\r\n                    // sync with form value\r\n                    form.setFieldsValue({ attachment: nextList });\r\n                  }}\r\n                  onPreview={async (file) => {\r\n                    // open image preview or PDF in new tab\r\n                    const f: any = file;\r\n                    const url = f.url || f.preview || (f.originFileObj && URL.createObjectURL(f.originFileObj));\r\n                    if (url) window.open(url, '_blank');\r\n                  }}\r\n                  showUploadList={false}\r\n                >\r\n                  <p className=\"ant-upload-drag-icon\">\r\n                    <UploadOutlined />\r\n                  </p>\r\n                  <p className=\"ant-upload-text\">Drag files here or click to upload</p>\r\n                  <p className=\"ant-upload-hint\">Support for multiple files. Each must be PDF, JPG, or PNG, and under 5MB.</p>\r\n                </Upload.Dragger>\r\n\r\n                {/* Custom file list with preview, icons and remove */}\r\n                {fileListState && fileListState.length > 0 && (\r\n                  <div style={{ marginTop: 12 }}>\r\n                    {fileListState.map((f: any) => {\r\n                      const name = f.name || (f.originFileObj && f.originFileObj.name) || 'file';\r\n                      const size = (f.size || (f.originFileObj && f.originFileObj.size) || 0);\r\n                      const isImage = (f.type && f.type.startsWith('image/')) || /\\.(jpe?g|png)$/i.test(name);\r\n                      const isPdf = (f.type === 'application/pdf') || /\\.pdf$/i.test(name);\r\n                      return (\r\n                        <div key={f.uid || f.name} className=\"inquiry-file-item\" style={{ display: 'flex', alignItems: 'center', gap: 12, padding: '8px 12px', border: '1px solid #f0f0f0', borderRadius: 8, marginBottom: 8 }}>\r\n                          <div className=\"inquiry-file-thumb\" style={{ width: 48, height: 48, display: 'flex', alignItems: 'center', justifyContent: 'center', background: '#fafafa', borderRadius: 6 }}>\r\n                            {isImage ? (\r\n                              <img src={f.preview || (f.originFileObj && URL.createObjectURL(f.originFileObj))} alt={name} style={{ maxWidth: 44, maxHeight: 44, borderRadius: 4 }} />\r\n                            ) : isPdf ? (\r\n                              <div style={{ fontSize: 20, color: '#ff4d4f' }}>PDF</div>\r\n                            ) : (\r\n                              <div style={{ fontSize: 20 }}>FILE</div>\r\n                            )}\r\n                          </div>\r\n                          <div style={{ flex: 1 }}>\r\n                            <div style={{ fontWeight: 600 }}>{name}</div>\r\n                            <div style={{ color: '#8c8c8c', fontSize: 12 }}>{formatBytes(size)}</div>\r\n                          </div>\r\n                          <div className=\"inquiry-file-actions\" style={{ display: 'flex', gap: 8 }}>\r\n                            <Button type=\"link\" onClick={() => {\r\n                              // preview\r\n                              const url = f.url || f.preview || (f.originFileObj && URL.createObjectURL(f.originFileObj));\r\n                              if (url) window.open(url, '_blank');\r\n                            }}>Preview</Button>\r\n                            <Button type=\"link\" danger onClick={() => {\r\n                              const next = fileListState.filter(x => x.uid !== f.uid && x.name !== f.name);\r\n                              setFileListState(next);\r\n                              form.setFieldsValue({ attachment: next });\r\n                            }}>Remove</Button>\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                )}\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n\r\n          <Form.Item>\r\n            <Row justify=\"end\" gutter={[8, 8]}>\r\n              <Col xs={24} sm=\"auto\" style={{ display: 'flex', justifyContent: 'flex-end' }}>\r\n                <Button\r\n                  type=\"default\"\r\n                  onClick={() => {\r\n                    form.resetFields();\r\n                    setSubjectCount(0);\r\n                    setMessageCount(0);\r\n                    setFileListState([]);\r\n                    localStorage.removeItem(LOCALSTORAGE_KEY);\r\n                  }}\r\n                  block\r\n                  icon={<ReloadOutlined />}\r\n                  style={{ borderRadius: 8, minWidth: 120 }}\r\n                >\r\n                  Reset\r\n                </Button>\r\n              </Col>\r\n              <Col xs={24} sm=\"auto\" style={{ display: 'flex', justifyContent: 'flex-end' }}>\r\n                <Button\r\n                  type=\"primary\"\r\n                  loading={loading}\r\n                  className=\"inquiry-gradient-btn\"\r\n                  block\r\n                  icon={<SendOutlined />}\r\n                  style={{ borderRadius: 8, fontWeight: 600, fontSize: 16, minWidth: 160 }}\r\n                  onClick={async () => {\r\n                    try {\r\n                      // validate fields before showing preview\r\n                      const values = await form.validateFields();\r\n                      setPreviewValues(values);\r\n                      setPreviewModalVisible(true);\r\n                    } catch (err) {\r\n                      onFinishFailed(err);\r\n                    }\r\n                  }}\r\n                >\r\n                  Submit Inquiry\r\n                </Button>\r\n              </Col>\r\n            </Row>\r\n          </Form.Item>\r\n        </Form>\r\n        <Modal\r\n          title=\"Review your inquiry\"\r\n          open={previewModalVisible}\r\n          onCancel={() => setPreviewModalVisible(false)}\r\n          footer={[\r\n            <Button key=\"edit\" onClick={() => setPreviewModalVisible(false)}>Edit</Button>,\r\n            <Button key=\"confirm\" type=\"primary\" onClick={async () => {\r\n              // call submit with previewValues\r\n              setPreviewModalVisible(false);\r\n              await onFinish(previewValues);\r\n            }}>\r\n              Confirm & Submit\r\n            </Button>\r\n          ]}\r\n        >\r\n          {previewValues && (\r\n            <Descriptions column={1} bordered>\r\n              <Descriptions.Item label=\"Inquiry Type\">{previewValues.type}</Descriptions.Item>\r\n              <Descriptions.Item label=\"Assign to Role\">{previewValues.assignedRole}</Descriptions.Item>\r\n              <Descriptions.Item label=\"Subject\">{previewValues.subject}</Descriptions.Item>\r\n              <Descriptions.Item label=\"Message\">{previewValues.message}</Descriptions.Item>\r\n              <Descriptions.Item label=\"Attachments\">{(fileListState || []).map((f: any) => f.name || (f.originFileObj && f.originFileObj.name)).join(', ')}</Descriptions.Item>\r\n            </Descriptions>\r\n          )}\r\n        </Modal>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InquiryForm;\r\n","import React from 'react';\r\nimport { Button } from 'antd';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst Goodbye: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  return (\r\n    <div style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', background: '#f4f6fa' }}>\r\n      <h1 style={{ color: '#722ed1', fontWeight: 700, fontSize: 32 }}>You have been logged out</h1>\r\n      <p style={{ fontSize: 18, margin: '16px 0 32px' }}>Thank you for using the Barangay Information System.</p>\r\n      <Button type=\"primary\" size=\"large\" onClick={() => navigate('/login', { replace: true })}>\r\n        Log In Again\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Goodbye;\r\n","import React, { useEffect } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst Logout: React.FC = () => {\r\n  const { logout } = useAuth();\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    logout();\r\n    navigate('/login', { replace: true });\r\n  }, [logout, navigate]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default Logout;\r\n","import React, { useEffect, useState, useMemo } from 'react';\r\nimport { Table, Spin, Empty, Tag, Typography, notification, DatePicker, Select, Space, Button } from 'antd';\r\nimport { contactAPI } from '../services/api';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { formatDate } from '../utils/formatDate';\r\n\r\nconst getStatusTag = (status?: string) => {\r\n  const statusColors: { [k: string]: string } = {\r\n    'pending': 'gold',\r\n    'open': 'gold',\r\n    'approved': 'success',\r\n    'resolved': 'green',\r\n    'rejected': 'error'\r\n  };\r\n  const s = (status || '').toString().toLowerCase();\r\n  return <Tag color={statusColors[s] || 'default'}>{(status || '').toUpperCase() || 'UNKNOWN'}</Tag>;\r\n};\r\n\r\nconst InquiryTracker: React.FC = () => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [inquiries, setInquiries] = useState<any[]>([]);\r\n  const [statusFilter, setStatusFilter] = useState<string | null>(null);\r\n  const [typeFilter, setTypeFilter] = useState<string | null>(null);\r\n  const [dateRange, setDateRange] = useState<any[] | null>(null);\r\n  const navigate = useNavigate();\r\n\r\n  const fetch = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await contactAPI.getAllInquiries();\r\n      setInquiries(Array.isArray(res) ? res : (res && res.items) ? res.items : []);\r\n    } catch (err) {\r\n      console.error('Failed to load inquiries', err);\r\n      notification.error({ message: 'Failed to load inquiries' });\r\n      setInquiries([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => { fetch(); }, []);\r\n\r\n  const types = useMemo(() => {\r\n    return Array.from(new Set(inquiries.map(i => (i.type || 'General'))));\r\n  }, [inquiries]);\r\n\r\n  const filtered = useMemo(() => {\r\n    return (inquiries || []).filter((i: any) => {\r\n      if (statusFilter && (!i.status || i.status.toString().toLowerCase() !== statusFilter.toLowerCase())) return false;\r\n      const t = (i.type || 'General');\r\n      if (typeFilter && t.toString().toLowerCase() !== typeFilter.toString().toLowerCase()) return false;\r\n      if (dateRange && dateRange[0] && dateRange[1] && i.createdAt) {\r\n        try {\r\n          const start = dateRange[0].toDate ? dateRange[0].toDate() : new Date(dateRange[0]);\r\n          const end = dateRange[1].toDate ? dateRange[1].toDate() : new Date(dateRange[1]);\r\n          const d = new Date(i.createdAt);\r\n          if (d < start || d > end) return false;\r\n        } catch (e) {\r\n          // ignore parsing errors\r\n        }\r\n      }\r\n      return true;\r\n    });\r\n  }, [inquiries, statusFilter, typeFilter, dateRange]);\r\n\r\n  return (\r\n    <div>\r\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: 12 }}>\r\n        <Typography.Title level={4} style={{ margin: 0 }}>Inquiry Tracker</Typography.Title>\r\n        <Typography.Text type=\"secondary\">Showing {inquiries.length} records</Typography.Text>\r\n      </div>\r\n\r\n      <Spin spinning={loading}>\r\n        <div style={{ marginBottom: 12, display: 'flex', justifyContent: 'flex-end' }}>\r\n          <Space>\r\n            <Select allowClear placeholder=\"Status\" style={{ width: 160 }} value={statusFilter ?? undefined} onChange={(v) => setStatusFilter(v || null)}>\r\n              <Select.Option value=\"open\">Open</Select.Option>\r\n              <Select.Option value=\"in-progress\">In Progress</Select.Option>\r\n              <Select.Option value=\"resolved\">Resolved</Select.Option>\r\n            </Select>\r\n            <Select allowClear placeholder=\"Type\" style={{ width: 180 }} value={typeFilter ?? undefined} onChange={(v) => setTypeFilter(v || null)}>\r\n              {types.map(t => <Select.Option key={t} value={t}>{t}</Select.Option>)}\r\n            </Select>\r\n            <DatePicker.RangePicker onChange={(vals) => setDateRange(vals ? vals.filter(Boolean) : null)} />\r\n            <Button onClick={() => { setStatusFilter(null); setTypeFilter(null); setDateRange(null); }}>Reset</Button>\r\n          </Space>\r\n        </div>\r\n\r\n        {filtered.length === 0 && !loading ? (\r\n          <Empty description=\"No inquiries\" />\r\n        ) : (\r\n          <Table\r\n            dataSource={filtered.slice().sort((a,b) => (new Date(b.createdAt).getTime() || 0) - (new Date(a.createdAt).getTime() || 0))}\r\n            rowKey={(r:any) => r._id}\r\n            pagination={{ pageSize: 12 }}\r\n            onRow={(record) => ({\r\n              onClick: () => {\r\n                // go to staff inbox and open the thread\r\n                navigate('/staff/inbox', { state: { openInquiryId: record._id } });\r\n              }\r\n            })}\r\n          >\r\n            <Table.Column title=\"Name\" dataIndex=\"username\" key=\"username\" render={(v:any,r:any)=> v || r.residentName || r.subject || 'Unknown'} />\r\n            <Table.Column title=\"Type of Inquiry\" dataIndex=\"type\" key=\"type\" render={(t:any)=> t ? String(t) : 'General'} />\r\n            <Table.Column title=\"Status\" dataIndex=\"status\" key=\"status\" render={(s:any)=> getStatusTag(s)} />\r\n            <Table.Column title=\"Date Inquired\" dataIndex=\"createdAt\" key=\"createdAt\" render={(d:any)=> formatDate(d)} />\r\n            <Table.Column title=\"Date Resolved\" dataIndex=\"updatedAt\" key=\"updatedAt\" render={(d:any, r:any) => (r.status && r.status.toString().toLowerCase() === 'resolved' ? formatDate(d) : '')} />\r\n          </Table>\r\n        )}\r\n      </Spin>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InquiryTracker;\r\n","import React from 'react';\r\nimport { Modal, Form, Input, message } from 'antd';\r\nimport { axiosInstance } from '../services/api';\r\n\r\ninterface Props {\r\n  visible: boolean;\r\n  onClose: () => void;\r\n  onCreated: (resident: any) => void;\r\n  defaultBarangayID?: string | null;\r\n  defaultUsername?: string | null;\r\n  defaultEmail?: string | null;\r\n}\r\n\r\nconst ResidentCreateModal: React.FC<Props> = ({ visible, onClose, onCreated, defaultBarangayID, defaultUsername, defaultEmail }) => {\r\n  const [form] = Form.useForm();\r\n  const [submitting, setSubmitting] = React.useState(false);\r\n\r\n  React.useEffect(() => {\r\n    if (visible) {\r\n      form.setFieldsValue({\r\n        barangayID: defaultBarangayID || undefined,\r\n        username: defaultUsername || undefined,\r\n        email: defaultEmail || undefined\r\n      });\r\n    } else {\r\n      form.resetFields();\r\n    }\r\n  // only when modal open/close or defaults change\r\n  }, [visible, defaultBarangayID, defaultUsername, defaultEmail, form]);\r\n\r\n  const handleOk = async () => {\r\n    try {\r\n      const values = await form.validateFields();\r\n      setSubmitting(true);\r\n      // Minimal payload expected by server to create resident container\r\n      const payload: any = {\r\n        firstName: values.firstName,\r\n        lastName: values.lastName,\r\n        barangayID: defaultBarangayID || values.barangayID || '',\r\n        username: defaultUsername || values.username || '',\r\n        email: defaultEmail || values.email || ''\r\n      };\r\n  const resp = await axiosInstance.put('/resident/personal-info', payload);\r\n      message.success('Resident container created');\r\n      onCreated(resp.data);\r\n      form.resetFields();\r\n      onClose();\r\n    } catch (err: any) {\r\n      console.error('Failed to create resident container', err);\r\n      if (err?.response?.data?.message) message.error(err.response.data.message);\r\n      else message.error('Failed to create resident container');\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      title=\"Create Resident Info\"\r\n      open={visible}\r\n      onOk={handleOk}\r\n      onCancel={() => { form.resetFields(); onClose(); }}\r\n      confirmLoading={submitting}\r\n    >\r\n      <Form form={form} layout=\"vertical\">\r\n        <Form.Item name=\"firstName\" label=\"First name\" rules={[{ required: true, message: 'First name is required' }]}>\r\n          <Input />\r\n        </Form.Item>\r\n        <Form.Item name=\"lastName\" label=\"Last name\" rules={[{ required: true, message: 'Last name is required' }]}>\r\n          <Input />\r\n        </Form.Item>\r\n        <Form.Item name=\"barangayID\" label=\"Barangay ID\">\r\n          <Input disabled />\r\n        </Form.Item>\r\n        <Form.Item name=\"username\" label=\"Username\">\r\n          <Input disabled />\r\n        </Form.Item>\r\n        <Form.Item name=\"email\" label=\"Email\" rules={[{ type: 'email', message: 'Invalid email' }]}>\r\n          <Input disabled />\r\n        </Form.Item>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default ResidentCreateModal;\r\n","import React, { useEffect, useState, useRef } from 'react';\r\nimport './ResidentPortal.css';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { residentPersonalInfoAPI, axiosInstance } from '../services/api';\r\nimport { AxiosResponse } from 'axios';\r\nimport { Form, Input, Button, Select, Typography, Row, Col, Card, Space, message, Upload, Alert, Tooltip, Progress } from 'antd';\r\nimport { UploadOutlined, InfoCircleOutlined } from '@ant-design/icons';\r\nimport ResidentCreateModal from './ResidentCreateModal';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport AvatarImage from './AvatarImage';\r\n\r\ninterface ResidentProfile {\r\n\t_id: string;\r\n\tusername: string;\r\n\temail: string;\r\n\taddress: string;\r\n\tcontactNumber: string;\r\n\tbarangayID: string;\r\n\trole: string;\r\n\t// Optional display name provided by the user (used to derive first/last name)\r\n\tfullName?: string;\r\n}\r\n// Personal info fields (example, adjust as needed)\r\ninterface PersonalInfo {\r\n\tbarangayID?: string;\r\n\tspouseMiddleName?: string;\r\n\tspouseLastName?: string;\r\n\tmiddleName?: string;\r\n\tnationality?: string;\r\n\tplaceOfBirth?: string;\r\n\treligion?: string;\r\n\tmaritalStatus?: string;\r\n\tpassportNumber?: string;\r\n\tgovernmentIdNumber?: string;\r\n\tbloodType?: string;\r\n\tdisabilityStatus?: string;\r\n\toccupation?: string;\r\n\teducationalAttainment?: string;\r\n\t// Family Information\r\n\tnumberOfChildren?: number;\r\n\tchildrenNames?: string;\r\n\tchildrenAges?: string;\r\n\tspouseNationality?: string;\r\n\tspouseContactNumber?: string;\r\n\temergencyContactName?: string;\r\n\temergencyContactRelationship?: string;\r\n\t// Business Information\r\n\tbusinessName?: string;\r\n\tbusinessType?: string;\r\n\tnatureOfBusiness?: string;\r\n\tbusinessAddress?: string;\r\n\tdateEstablished?: string;\r\n\ttin?: string;\r\n\tregistrationNumber?: string;\r\n\tbusinessPermitNumber?: string;\r\n\tbarangayClearanceNumber?: string;\r\n\tnumberOfEmployees?: number;\r\n\tcapitalInvestment?: number;\r\n\tannualGrossIncome?: number;\r\n\tbusinessContactPerson?: string;\r\n\tbusinessContactNumber?: string;\r\n\tbusinessEmail?: string;\r\n\tfirstName: string;\r\n\tlastName: string;\r\n\tage?: number;\r\n\tbirthDate?: string;\r\n\tdateOfResidency?: string;\r\n\tsex?: string;\r\n\tcivilStatus?: string;\r\n\tfacebook?: string;\r\n\temail?: string;\r\n\tcontactNumber?: string;\r\n\temergencyContact?: string;\r\n\tlandlineNumber?: string;\r\n\tspouseName?: string;\r\n\tspouseAge?: number;\r\n\tspouseBirthDate?: string;\r\n\tspouseOccupation?: string;\r\n\tspouseStatus?: string;\r\n\tmotherName?: string;\r\n\tmotherAge?: number;\r\n\tmotherBirthDate?: string;\r\n\tmotherOccupation?: string;\r\n\tmotherStatus?: string;\r\n\tfatherName?: string;\r\n\tfatherAge?: number;\r\n\tfatherBirthDate?: string;\r\n\tfatherOccupation?: string;\r\n\tfatherStatus?: string;\r\n\t// Add more as needed\r\n}\r\n\r\ninterface DocumentRequest {\r\n\t_id: string;\r\n\ttype: string;\r\n\tstatus: string;\r\n\tdateRequested: string;\r\n\tnotes?: string;\r\n}\r\n\r\nexport default function ResidentPortal() {\r\n\tconst [avatarPreview, setAvatarPreview] = useState<string | null>(null);\r\n\tconst [residentMissing, setResidentMissing] = useState(false);\r\n\tconst [showCreateModal, setShowCreateModal] = useState(false);\r\n\r\n\t// Verification upload state\r\n\tconst [proofFile, setProofFile] = useState<File | null>(null);\r\n\tconst [govIdFile, setGovIdFile] = useState<File | null>(null);\r\n\tconst [selfieFile, setSelfieFile] = useState<File | null>(null);\r\n\tconst [proofList, setProofList] = useState<any[]>([]);\r\n\tconst [govIdList, setGovIdList] = useState<any[]>([]);\r\n\tconst [selfieList, setSelfieList] = useState<any[]>([]);\r\n\tconst [verificationUploading, setVerificationUploading] = useState(false);\r\n\tconst [verificationProgress, setVerificationProgress] = useState<number>(0);\r\n\tconst previewUrlsRef = useRef<Set<string>>(new Set());\r\n\r\n\t// autoCreateResident removed (unused in this component)\r\n\r\n\tconst { setUser } = useAuth();\r\n\t// handle avatar upload for resident portal banner\r\n\tconst handleBannerAvatarUpload = async (file: File | null) => {\r\n\t\tif (!file) return;\r\n\t\tconst reader = new FileReader();\r\n\t\treader.onload = e => setAvatarPreview(e.target?.result as string);\r\n\t\treader.readAsDataURL(file);\r\n\t\tconst form = new FormData();\r\n\t\tform.append('avatar', file);\r\n\t\ttry {\r\n\t\t\tconst resp = await axiosInstance.post('/resident/personal-info/avatar', form, { headers: { 'Content-Type': 'multipart/form-data' } });\r\n\t\t\t// server returns { message, resident, user }\r\n\t\t\tconst updated = resp.data?.resident;\r\n\t\t\tconst returnedUser = resp.data?.user;\r\n\t\t\tif (updated) {\r\n\t\t\t\t// Update resident container state so the picture is saved in the resident container\r\n\t\t\t\tsetPersonalInfo(updated);\r\n\t\t\t\tsetPersonalForm(updated);\r\n\t\t\t\tif (updated.profileImage) {\r\n\t\t\t\t\tconst url = updated.profileImage.startsWith('http') ? updated.profileImage : `${window.location.origin}${updated.profileImage}`;\r\n\t\t\t\t\tsetAvatarPreview(url);\r\n\t\t\t\t}\r\n\t\t\t\tsetResidentMissing(false);\r\n\t\t\t\tmessage.success('Profile image updated');\r\n\t\t\t} else {\r\n\t\t\t\tmessage.success('Profile image updated');\r\n\t\t\t}\r\n\t\t\t// If server returned an updated user, update AuthContext/localStorage\r\n\t\t\tif (returnedUser) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof setUser === 'function') setUser(returnedUser);\r\n\t\t\t\t\telse localStorage.setItem('userProfile', JSON.stringify(returnedUser));\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\t// ignore\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst ev = new CustomEvent('userProfileUpdated', { detail: returnedUser });\r\n\t\t\t\t\twindow.dispatchEvent(ev);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\t// ignore\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tmessage.error('Failed to upload avatar');\r\n\t\t}\r\n\t};\r\n\t// ...existing code...\r\n\tconst handleRegisterResident = async () => {\r\n\t\ttry {\r\n\t\t\t// Use form (user info) and personalForm (resident info)\r\n\t\t\tconst payload = {\r\n\t\t\t\tbarangayID: form?.barangayID || '',\r\n\t\t\t\tusername: form?.username || '',\r\n\t\t\t\t...personalForm\r\n\t\t\t};\r\n\t\t\tawait axiosInstance.post('/resident', payload);\r\n\t\t\talert('Resident registered successfully!');\r\n\t\t} catch (error) {\r\n\t\t\talert('Failed to register resident.');\r\n\t\t}\r\n\t};\r\n\tconst { t } = useTranslation();\r\n\tconst [profile, setProfile] = useState<ResidentProfile | null>(null);\r\n\tconst [, setRequests] = useState<DocumentRequest[]>([]);\r\n  \r\n\tconst [form, setForm] = useState<ResidentProfile | null>(null);\r\n\tconst [staffRequestSent, setStaffRequestSent] = useState(false);\r\n\tconst [requesting, setRequesting] = useState(false);\r\n\tconst [editingUser, setEditingUser] = useState(false);\r\n\tconst [editingPersonal, setEditingPersonal] = useState(false);\r\n\tconst [personalInfo, setPersonalInfo] = useState<PersonalInfo | null>(null);\r\n\tconst [personalForm, setPersonalForm] = useState<PersonalInfo | null>(null);\r\n\tconst [currentTime, setCurrentTime] = useState<string>('');\r\n\r\n\tuseEffect(() => {\r\n\t// Fetch resident profile and requests\r\n\taxiosInstance.get('/resident/profile').then((res: AxiosResponse<any>) => {\r\n\t\tsetProfile(res.data);\r\n\t\tsetForm(res.data);\r\n\t\tif (res.data?.profileImage) {\r\n\t\t\tconst url = res.data.profileImage.startsWith('http') ? res.data.profileImage : `${window.location.origin}${res.data.profileImage}`;\r\n\t\t\tsetAvatarPreview(url);\r\n\t\t}\r\n\t});\r\n    residentPersonalInfoAPI.getPersonalInfo()\r\n      .then((data: any) => {\r\n        setPersonalInfo(data);\r\n        setPersonalForm(data);\r\n\t\t\t\tif (data?.profileImage) {\r\n\t\t\t\t\t\tconst url = data.profileImage.startsWith('http') ? data.profileImage : `${window.location.origin}${data.profileImage}`;\r\n\t\t\t\t\t\tsetAvatarPreview(url);\r\n\t\t\t\t}\r\n      })\r\n\t\t\t.catch((err: any) => {\r\n\t\t\t\tif (err.response && err.response.status === 404) {\r\n\t\t\t\t\t// No personal info yet, show empty form and flag missing\r\n\t\t\t\t\tsetResidentMissing(true);\r\n\t\t\t\t\tsetPersonalInfo(null);\r\n\t\t\t\t\tsetPersonalForm({\r\n            firstName: '',\r\n            lastName: '',\r\n            age: undefined,\r\n            birthDate: '',\r\n            dateOfResidency: '',\r\n            sex: '',\r\n            civilStatus: '',\r\n            facebook: '',\r\n            email: '',\r\n            contactNumber: '',\r\n            emergencyContact: '',\r\n            landlineNumber: '',\r\n            spouseName: '',\r\n            spouseAge: undefined,\r\n            spouseBirthDate: '',\r\n            spouseOccupation: '',\r\n            spouseStatus: '',\r\n            motherName: '',\r\n            motherAge: undefined,\r\n            motherBirthDate: '',\r\n            motherOccupation: '',\r\n            motherStatus: '',\r\n            fatherName: '',\r\n            fatherAge: undefined,\r\n            fatherBirthDate: '',\r\n            fatherOccupation: '',\r\n            fatherStatus: '',\r\n          });\r\n        }\r\n      });\r\n\taxiosInstance.get('/resident/requests').then((res: AxiosResponse<any>) => {\r\n\t\tsetRequests(res.data);\r\n\t});\r\n}, []);\r\n\r\n// Cleanup any created object URLs for upload previews when component unmounts\r\nuseEffect(() => {\r\n\tconst urls = previewUrlsRef.current;\r\n\treturn () => {\r\n\t\ttry {\r\n\t\t\turls.forEach((u) => {\r\n\t\t\t\ttry { URL.revokeObjectURL(u); } catch (e) {}\r\n\t\t\t});\r\n\t\t} catch (err) {}\r\n\t\ttry { urls.clear(); } catch (e) {}\r\n\t};\r\n}, []);\r\n\r\n\t// Handler to upload verification documents (proof, id, selfie)\r\n\tconst handleVerificationUpload = async () => {\r\n\t\tif (!proofFile && !govIdFile && !selfieFile) {\r\n\t\t\tmessage.warning('Please select at least one document to upload');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsetVerificationUploading(true);\r\n\t\tsetVerificationProgress(0);\r\n\t\ttry {\r\n\t\t\tconst formData = new FormData();\r\n\t\t\tif (proofFile) formData.append('ids', proofFile, proofFile.name);\r\n\t\t\tif (govIdFile) formData.append('ids', govIdFile, govIdFile.name);\r\n\t\t\tif (selfieFile) formData.append('ids', selfieFile, selfieFile.name);\r\n\t\t\t// include uploader barangayID so GridFS file metadata and request document can record it\r\n\t\t\tconst brgy = form?.barangayID || profile?.barangayID || '';\r\n\t\t\tif (brgy) formData.append('barangayID', brgy);\r\n\t\t\tawait axiosInstance.post('/verification/upload', formData, {\r\n\t\t\t\theaders: { 'Content-Type': 'multipart/form-data' },\r\n\t\t\t\tonUploadProgress: (ev: any) => {\r\n\t\t\t\t\tconst loaded = typeof ev?.loaded === 'number' ? ev.loaded : 0;\r\n\t\t\t\t\tconst total = typeof ev?.total === 'number' ? ev.total : 0;\r\n\t\t\t\t\tif (total > 0) {\r\n\t\t\t\t\t\tconst pct = Math.min(100, Math.round((loaded / total) * 100));\r\n\t\t\t\t\t\tsetVerificationProgress(pct);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tmessage.success('Verification documents uploaded');\r\n\t\t\t// clear selected files\r\n\t\t\tsetProofFile(null); setGovIdFile(null); setSelfieFile(null);\r\n\t\t\tsetProofList([]); setGovIdList([]); setSelfieList([]);\r\n\t\t\tsetVerificationProgress(100);\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('Verification upload failed', err);\r\n\t\t\tmessage.error('Failed to upload verification documents');\r\n\t\t} finally {\r\n\t\t\tsetVerificationUploading(false);\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tconst updateTime = () => {\r\n\t\t\tconst now = new Date();\r\n\t\t\tconst formatted = now.toLocaleString('en-US', {\r\n\t\t\t\tyear: 'numeric', month: '2-digit', day: '2-digit',\r\n\t\t\t\thour: '2-digit', minute: '2-digit', second: '2-digit',\r\n\t\t\t\thour12: false\r\n\t\t\t}).replace(/,/g, '');\r\n\t\t\tsetCurrentTime(formatted);\r\n\t\t};\r\n\t\tupdateTime();\r\n\t\tconst interval = setInterval(updateTime, 1000);\r\n\t\treturn () => clearInterval(interval);\r\n\t}, []);\r\n\r\n\t// User info edit logic\r\n\tconst handleEditUser = () => setEditingUser(true);\r\n\tconst handleCancelUser = () => {\r\n\t\tsetEditingUser(false);\r\n\t\tsetForm(profile);\r\n\t};\r\n\tconst handleChangeUser = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tif (!form) return;\r\n\t\tsetForm({ ...form, [e.target.name]: e.target.value });\r\n\t};\r\n\tconst handleSaveUser = async () => {\r\n\t\tif (!form) return;\r\n\t\ttry {\r\n\t\t\t// Build a minimal payload containing only allowed fields the server expects\r\n\t\t\tconst deriveNames = () => {\r\n\t\t\t\tlet first = (form as any).firstName || '';\r\n\t\t\t\tlet last = (form as any).lastName || '';\r\n\t\t\t\tif ((!first || !last) && profile && (profile as any).fullName) {\r\n\t\t\t\t\tconst parts = (profile as any).fullName.trim().split(' ');\r\n\t\t\t\t\tfirst = first || parts[0] || '';\r\n\t\t\t\t\tlast = last || (parts.length > 1 ? parts.slice(1).join(' ') : '');\r\n\t\t\t\t}\r\n\t\t\t\t// Fallback to username/email if still missing\r\n\t\t\t\tfirst = first || profile?.username || profile?.email || 'Resident';\r\n\t\t\t\tlast = last || 'User';\r\n\t\t\t\treturn { first, last };\r\n\t\t\t};\r\n\t\t\tconst names = deriveNames();\r\n\t\t\tconst payload: any = {\r\n\t\t\t\tfirstName: names.first,\r\n\t\t\t\tlastName: names.last,\r\n\t\t\t\tbarangayID: form?.barangayID || profile?.barangayID || '',\r\n\t\t\t\temail: form?.email || profile?.email || '',\r\n\t\t\t\tcontactNumber: form?.contactNumber || profile?.contactNumber || '',\r\n\t\t\t\taddress: form?.address || profile?.address || ''\r\n\t\t\t};\r\n\t\t\tconst resp = await axiosInstance.put('/resident/personal-info', payload);\r\n\t\t\t// Update local profile with returned resident/user fields when available\r\n\t\t\tif (resp && resp.data) {\r\n\t\t\t\tsetProfile({ ...profile, ...resp.data });\r\n\t\t\t} else {\r\n\t\t\t\tsetProfile({ ...profile, ...payload } as any);\r\n\t\t\t}\r\n\t\t\tsetEditingUser(false);\r\n\t\t\tmessage.success('Profile saved');\r\n\t\t} catch (err: any) {\r\n\t\t\tconsole.error('Failed to save user info:', err);\r\n\t\t\tif (err?.response && err.response.data) {\r\n\t\t\t\tconst data = err.response.data;\r\n\t\t\t\tif (data.errors) {\r\n\t\t\t\t\t// Validation errors\r\n\t\t\t\t\tconst msgs = Object.values(data.errors).map((v: any) => v.toString()).join('; ');\r\n\t\t\t\t\tmessage.error(msgs || data.message || 'Validation error');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmessage.error(data.message || 'Failed to save');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tmessage.error('Failed to save user info');\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Personal info edit logic\r\n\tconst handleEditPersonal = () => setEditingPersonal(true);\r\n\tconst handleCancelPersonal = () => {\r\n\t\tsetEditingPersonal(false);\r\n\t\tsetPersonalForm(personalInfo);\r\n\t};\r\n\tconst handleChangePersonal = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n\t\tif (!personalForm) return;\r\n\t\tsetPersonalForm({ ...personalForm, [e.target.name]: e.target.value });\r\n\t};\r\n\tconst handleSavePersonal = async () => {\r\n\t\tif (!personalForm || !profile?._id) return;\r\n\t\t// Overwrite the existing record for the displayed user\r\n\t\tawait residentPersonalInfoAPI.updatePersonalInfo({ ...personalForm, userId: profile._id });\r\n\t\tsetPersonalInfo(personalForm);\r\n\t\tsetEditingPersonal(false);\r\n\t};\r\n\r\n\tconst handleRequestStaff = async () => {\r\n\t\tsetRequesting(true);\r\n\t\ttry {\r\n\t\t\tconst resp = await axiosInstance.post('/resident/request-staff-access');\r\n\t\t\tconst serverMsg = resp?.data?.message || 'Request sent to admin for staff access';\r\n\t\t\tif (resp && (resp.status === 200 || resp.status === 201)) {\r\n\t\t\t\tmessage.success(serverMsg);\r\n\t\t\t\tsetStaffRequestSent(true);\r\n\t\t\t} else {\r\n\t\t\t\tmessage.info(serverMsg);\r\n\t\t\t}\r\n \t\t} catch (err) {\r\n \t\t\tconsole.error('Request staff access failed:', err);\r\n \t\t\tconst e: any = err;\r\n \t\t\tconst serverMsg = e?.response?.data?.message || e?.message || 'Failed to send staff access request';\r\n \t\t\tmessage.error(serverMsg);\r\n \t\t} finally {\r\n\t\t\tsetRequesting(false);\r\n\t\t}\r\n\t};\r\n\r\n\t\t// Feedback form state\r\n\t// ...existing code...\r\n\r\n\t\t\treturn (\r\n\t\t\t\t\t<div className=\"max-w-3xl mx-auto p-6\">\r\n\t\t\t\t\t\t{/* Resident Portal Banner -> avatar + upload */}\r\n\t\t\t\t\t\t<Card\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\tbackground: 'linear-gradient(90deg, #f7f8fa 0%, #e0e7ff 100%)',\r\n\t\t\t\t\t\t\t\tborderRadius: 16,\r\n\t\t\t\t\t\t\t\tboxShadow: '0 4px 24px #40c9ff22',\r\n\t\t\t\t\t\t\t\tmarginBottom: 32,\r\n\t\t\t\t\t\t\t\tborder: 'none',\r\n\t\t\t\t\t\t\t\tpadding: 0,\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tbodyStyle={{ padding: '24px 32px', display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}\r\n\t\t\t\t\t\t\t\tbordered={false}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div style={{ display: 'flex', alignItems: 'center', gap: 18 }}>\r\n\t\t\t\t\t\t\t\t<Upload\r\n\t\t\t\t\t\t\t\t\tshowUploadList={false}\r\n\t\t\t\t\t\t\t\t\taccept=\"image/*\"\r\n\t\t\t\t\t\t\t\t\tcustomRequest={async (opts: any) => {\r\n\t\t\t\t\t\t\t\t\t\tconst { file, onSuccess, onError } = opts || {};\r\n\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\tawait handleBannerAvatarUpload(file as File | null);\r\n\t\t\t\t\t\t\t\t\t\t\tif (typeof onSuccess === 'function') onSuccess('ok');\r\n\t\t\t\t\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (typeof onError === 'function') onError(err as any);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"resident-banner-avatar clickable\"\r\n\t\t\t\t\t\t\t\t\t\trole=\"button\"\r\n\t\t\t\t\t\t\t\t\t\ttabIndex={0}\r\n\t\t\t\t\t\t\t\t\t\taria-label=\"Upload profile picture\"\r\n\t\t\t\t\t\t\t\t\t\ttitle=\"Upload profile picture\"\r\n\t\t\t\t\t\t\t\t\t\tonKeyDown={(e: React.KeyboardEvent<HTMLDivElement>) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconst key = (e && (e as React.KeyboardEvent).key) || '';\r\n\t\t\t\t\t\t\t\t\t\t\tif (key === 'Enter' || key === ' ') {\r\n\t\t\t\t\t\t\t\t\t\t\t\t(e.target as HTMLElement).click();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{avatarPreview ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<img src={avatarPreview} alt=\"avatar\" className=\"resident-banner-avatar__img\" />\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<AvatarImage user={(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet displayUser = profile;\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (!displayUser) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst stored = localStorage.getItem('userProfile');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (stored) displayUser = JSON.parse(stored);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} catch (err) {}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn displayUser;\r\n\t\t\t\t\t\t\t\t\t\t\t})()} size={96} className=\"resident-banner-avatar__img\" />\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</Upload>\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{ margin: 0, fontWeight: 800 }}>{profile?.username || profile?.email || 'Resident'}</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t<Typography.Text type=\"secondary\">Barangay ID: {profile?.barangayID || 'N/A'}</Typography.Text>\r\n\t\t\t\t\t\t\t\t\t\t<div style={{ marginTop: 8 }}><Typography.Text type=\"secondary\">{currentTime}</Typography.Text></div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Card>\r\n\r\n\t\t\t\t\t\t{/* Verification Uploads Section (styled like User Info) */}\r\n\t\t\t\t\t\t<Card\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\tbackground: 'linear-gradient(135deg, #f8fafc 0%, #e3e6f3 40%, #f6f1f7 100%)',\r\n\t\t\t\t\t\t\t\tborderRadius: 20,\r\n\t\t\t\t\t\t\t\tboxShadow: '0 8px 32px #bfc7d6cc',\r\n\t\t\t\t\t\t\t\tmarginBottom: 32,\r\n\t\t\t\t\t\t\t\tborder: 'none',\r\n\t\t\t\t\t\t\t\tbackdropFilter: 'blur(2px)',\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tbodyStyle={{ padding: 40 }}\r\n\t\t\t\t\t\t\t\tbordered={false}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div style={{ maxWidth: 900, margin: '0 auto' }}>\r\n\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{\r\n\t\t\t\t\t\t\t\t\tfontWeight: 900,\r\n\t\t\t\t\t\t\t\t\tmarginBottom: 24,\r\n\t\t\t\t\t\t\t\t\tletterSpacing: 1,\r\n\t\t\t\t\t\t\t\t\ttextAlign: 'left',\r\n\t\t\t\t\t\t\t\t\tfontSize: 28,\r\n\t\t\t\t\t\t\t\t\tbackground: 'linear-gradient(90deg, #40c9ff, #e81cff)',\r\n\t\t\t\t\t\t\t\t\tWebkitBackgroundClip: 'text',\r\n\t\t\t\t\t\t\t\t\tWebkitTextFillColor: 'transparent',\r\n\t\t\t\t\t\t\t\t}}>Verification Documents</Typography.Title>\r\n\t\t\t\t\t\t\t\t<Form layout=\"vertical\">\r\n\t\t\t\t\t\t\t\t\t<Row gutter={24}>\r\n\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Form.Item label={<div style={{display: 'flex', alignItems: 'center', gap: 8}}>Proof of Residency<Tooltip title=\"Upload a document showing your address (e.g., utility bill, lease, or bank statement).\"><InfoCircleOutlined style={{ color: '#888' }} /></Tooltip></div>}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Upload\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taccept=\"image/*,application/pdf\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfileList={proofList}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbeforeUpload={(file: File) => false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(info: any) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst fileList = info?.fileList || [];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// revoke existing previews for this slot\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tproofList.forEach((pf: any) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (pf && pf.thumbUrl) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttry { URL.revokeObjectURL(String(pf.thumbUrl)); } catch (e) {}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpreviewUrlsRef.current.delete(String(pf.thumbUrl));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst list = (fileList || []).slice(-1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlist.forEach((f: any) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (f.originFileObj && !f.thumbUrl && f.type && f.type.startsWith('image/')) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst url = URL.createObjectURL(f.originFileObj);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tf.thumbUrl = url;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpreviewUrlsRef.current.add(url);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetProofList(list as any[]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetProofFile((list[0] && (list[0].originFileObj as File)) || null);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlistType=\"picture-card\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowUploadList={{ showPreviewIcon: true, showRemoveIcon: true }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmaxCount={1}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ display: 'flex', alignItems: 'center', gap: 8 }}><UploadOutlined /> <span style={{ fontWeight: 600 }}>Select Proof</span></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Upload>\r\n\t\t\t\t\t\t\t\t\t\t\t</Form.Item>\r\n\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Form.Item label={<div style={{display: 'flex', alignItems: 'center', gap: 8}}>Government-issued ID<Tooltip title=\"Upload a government-issued ID such as passport, driver's license, or national ID.\"><InfoCircleOutlined style={{ color: '#888' }} /></Tooltip></div>}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Upload\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taccept=\"image/*,application/pdf\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfileList={govIdList}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbeforeUpload={(file: File) => false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(info: any) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst fileList = info?.fileList || [];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// revoke existing previews for this slot\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tgovIdList.forEach((gf: any) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (gf && gf.thumbUrl) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttry { URL.revokeObjectURL(String(gf.thumbUrl)); } catch (e) {}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpreviewUrlsRef.current.delete(String(gf.thumbUrl));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst list = (fileList || []).slice(-1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlist.forEach((f: any) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (f.originFileObj && !f.thumbUrl && f.type && f.type.startsWith('image/')) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst url = URL.createObjectURL(f.originFileObj);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tf.thumbUrl = url;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpreviewUrlsRef.current.add(url);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetGovIdList(list as any[]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetGovIdFile((list[0] && (list[0].originFileObj as File)) || null);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlistType=\"picture-card\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowUploadList={{ showPreviewIcon: true, showRemoveIcon: true }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmaxCount={1}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ display: 'flex', alignItems: 'center', gap: 8 }}><UploadOutlined /> <span style={{ fontWeight: 600 }}>Select ID</span></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Upload>\r\n\t\t\t\t\t\t\t\t\t\t\t</Form.Item>\r\n\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Form.Item label={<div style={{display: 'flex', alignItems: 'center', gap: 8}}>Selfie with ID<Tooltip title=\"Take a clear photo of yourself holding your government ID next to your face.\"><InfoCircleOutlined style={{ color: '#888' }} /></Tooltip></div>}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Upload\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taccept=\"image/*\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfileList={selfieList}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbeforeUpload={(file: File) => false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(info: any) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst fileList = info?.fileList || [];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// revoke existing previews for this slot\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tselfieList.forEach((sf: any) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (sf && sf.thumbUrl) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttry { URL.revokeObjectURL(String(sf.thumbUrl)); } catch (e) {}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpreviewUrlsRef.current.delete(String(sf.thumbUrl));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst list = (fileList || []).slice(-1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlist.forEach((f: any) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (f.originFileObj && !f.thumbUrl && f.type && f.type.startsWith('image/')) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst url = URL.createObjectURL(f.originFileObj);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tf.thumbUrl = url;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpreviewUrlsRef.current.add(url);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelfieList(list as any[]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelfieFile((list[0] && (list[0].originFileObj as File)) || null);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlistType=\"picture-card\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowUploadList={{ showPreviewIcon: true, showRemoveIcon: true }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmaxCount={1}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ display: 'flex', alignItems: 'center', gap: 8 }}><UploadOutlined /> <span style={{ fontWeight: 600 }}>Select Selfie</span></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Upload>\r\n\t\t\t\t\t\t\t\t\t\t\t</Form.Item>\r\n\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t<Row gutter={24} style={{ marginTop: 16 }}>\r\n\t\t\t\t\t\t\t\t\t\t<Col span={24} style={{ display: 'flex', justifyContent: 'flex-end', gap: 12 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Button type=\"dashed\" onClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t// revoke all current preview URLs for verification files\r\n\t\t\t\t\t\t\t\t\t\t\t\t[ ...proofList, ...govIdList, ...selfieList ].forEach((f: any) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (f && f.thumbUrl) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttry { URL.revokeObjectURL(String(f.thumbUrl)); } catch (e) {}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpreviewUrlsRef.current.delete(String(f.thumbUrl));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetProofFile(null); setGovIdFile(null); setSelfieFile(null); setProofList([]); setGovIdList([]); setSelfieList([]);\r\n\t\t\t\t\t\t\t\t\t\t\t}}>Clear</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t<Button type=\"primary\" loading={verificationUploading} disabled={!(proofFile && govIdFile && selfieFile)} onClick={handleVerificationUpload}>Upload Verification Documents</Button>\r\n\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{(verificationUploading || verificationProgress > 0) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row gutter={24} style={{ marginTop: 12 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col span={24}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ flex: 1 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Progress percent={verificationProgress} status={verificationProgress < 100 ? 'active' : 'success'} strokeColor={{ '0%': '#e81cff', '100%': '#40c9ff' }} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ minWidth: 110 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Text type=\"secondary\">{verificationUploading ? `Uploading (${verificationProgress}%)` : verificationProgress === 100 ? 'Upload complete' : ''}</Typography.Text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Prompt to create resident info if missing */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{residentMissing && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ marginBottom: 16 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Alert\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessage=\"Your resident profile is incomplete\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdescription={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p>We couldn't find your resident information. Please create your resident profile so you can upload documents and profile pictures.</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button type=\"primary\" onClick={() => setShowCreateModal(true)}>Create Resident Info</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowIcon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ResidentCreateModal\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvisible={showCreateModal}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClose={() => setShowCreateModal(false)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonCreated={(resident: any) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetPersonalInfo(resident);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetPersonalForm(resident);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetResidentMissing(false);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultBarangayID={profile?.barangayID || ''}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultUsername={profile?.username || ''}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultEmail={profile?.email || ''}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Resident Tool Tips moved to Dashboard */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* User Info Section */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Card\r\n\t\t\t\t\t\t\t\t\t\t\t\t   style={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   background: 'linear-gradient(135deg, #f8fafc 0%, #e3e6f3 40%, #f6f1f7 100%)',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   borderRadius: 20,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   boxShadow: '0 8px 32px #bfc7d6cc',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   marginBottom: 32,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   border: 'none',\r\n\t\t\t\t\t\t\t\t\t\t\t\t   \tbackdropFilter: 'blur(2px)',\r\n\t\t\t\t\t\t\t\t\t\t\t\t   \t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t   \tbodyStyle={{ padding: 40 }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t   \tbordered={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t   \t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <div style={{ maxWidth: 900, margin: '0 auto' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 900,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmarginBottom: 24,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: 1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttextAlign: 'left',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: 28,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackground: 'linear-gradient(90deg, #40c9ff, #e81cff)',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitBackgroundClip: 'text',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitTextFillColor: 'transparent',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}>{t('userInformation')}</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t {form && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Form layout=\"vertical\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Row gutter={24}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Col xs={24} sm={12}><Form.Item label={t('username')}><Input name=\"username\" value={form?.username || ''} onChange={handleChangeUser} disabled={!editingUser} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Col xs={24} sm={12}><Form.Item label={t('email')}><Input name=\"email\" value={form?.email || ''} onChange={handleChangeUser} disabled={!editingUser} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Row gutter={24}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Col xs={24} sm={12}><Form.Item label={t('address')}><Input name=\"address\" value={form?.address || ''} onChange={handleChangeUser} disabled={!editingUser} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Col xs={24} sm={12}><Form.Item label={t('contactNumber')}><Input name=\"contactNumber\" value={form?.contactNumber || ''} onChange={handleChangeUser} disabled={!editingUser} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Row gutter={24}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Col xs={24} sm={12}><Form.Item label={t('barangayID') || 'Barangay ID'}><Input name=\"barangayID\" value={form?.barangayID || ''} disabled /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Col xs={24} sm={12}><Form.Item label={t('role') || 'Role'}><Input name=\"role\" value={form?.role || ''} disabled /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Space style={{ marginTop: 24 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t {editingUser ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Button type=\"primary\" onClick={handleSaveUser} style={{ background: 'linear-gradient(90deg, #43e97b 0%, #38f9d7 100%)', border: 'none', fontWeight: 600 }}>Save</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Button onClick={handleCancelUser}>Cancel</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t </>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t ) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Button onClick={handleEditUser} style={{ fontWeight: 600 }}>Edit</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  )}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t <Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t type=\"dashed\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t onClick={handleRequestStaff}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t disabled={staffRequestSent || requesting}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t style={{ color: '#341f97', borderColor: '#341f97', fontWeight: 600 }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t {staffRequestSent ? 'Request Sent' : 'Request Staff Access'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t </Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t </Space>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t </Form>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t )}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t </div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Card>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t{/* Personal Info Section */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t   {personalForm && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Card\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   style={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   background: 'linear-gradient(135deg, #f8fafc 0%, #e3e6f3 40%, #f6f1f7 100%)',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   borderRadius: 20,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   boxShadow: '0 8px 32px #bfc7d6cc',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   marginBottom: 32,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   border: 'none',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   backdropFilter: 'blur(2px)',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   bodyStyle={{ padding: 40 }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   bordered={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Form layout=\"vertical\" style={{ maxWidth: 900, margin: '0 auto' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   {/* Resident Info Main Title */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Title level={2} style={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 900,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmarginBottom: 24,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: 1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttextAlign: 'left',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: 34,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackground: 'linear-gradient(90deg, #40c9ff, #e81cff)',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitBackgroundClip: 'text',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitTextFillColor: 'transparent',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}>Resident Information</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   {/* Personal Info Subcategory */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 900,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmarginBottom: 16,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: 1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttextAlign: 'left',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: 24,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackground: 'linear-gradient(90deg, #ffb347, #ff4e50)',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitBackgroundClip: 'text',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitTextFillColor: 'transparent',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}>Personal Information</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row gutter={24}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"First Name\"><Input name=\"firstName\" value={personalForm?.firstName || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Middle Name\"><Input name=\"middleName\" value={personalForm?.middleName || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Last Name\"><Input name=\"lastName\" value={personalForm?.lastName || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Age\"><Input name=\"age\" type=\"number\" value={personalForm?.age || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Birth Date\"><Input name=\"birthDate\" type=\"date\" value={personalForm.birthDate || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Place of Birth\"><Input name=\"placeOfBirth\" value={personalForm.placeOfBirth || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Nationality\"><Input name=\"nationality\" value={personalForm.nationality || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Religion\"><Input name=\"religion\" value={personalForm.religion || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Date of Residency\"><Input name=\"dateOfResidency\" type=\"date\" value={personalForm.dateOfResidency || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Sex\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={personalForm.sex || ''}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(value: string) => setPersonalForm(prev => prev ? { ...prev, sex: value } : prev)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={!editingPersonal}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"\">Select</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Male\">Male</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Female\">Female</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Other\">Other</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Blood Type\"><Input name=\"bloodType\" value={personalForm.bloodType || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Disability Status\"><Input name=\"disabilityStatus\" value={personalForm.disabilityStatus || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Passport Number\"><Input name=\"passportNumber\" value={personalForm.passportNumber || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Government ID Number\"><Input name=\"governmentIdNumber\" value={personalForm.governmentIdNumber || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Occupation\"><Input name=\"occupation\" value={personalForm.occupation || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={12} md={6}><Form.Item label=\"Educational Attainment\"><Input name=\"educationalAttainment\" value={personalForm.educationalAttainment || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Form.Item label=\"Civil Status\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   value={personalForm.civilStatus || ''}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   onChange={(value: string) => setPersonalForm(prev => prev ? { ...prev, civilStatus: value } : prev)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   disabled={!editingPersonal}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"\">Select</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Single\">Single</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Married\">Married</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Widowed\">Widowed</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Divorced\">Divorced</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Separated\">Separated</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Annulled\">Annulled</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Domestic Partnership\">Domestic Partnership</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Other\">Other</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Select>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Form.Item>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   {/* Social Media Info Subcategory */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 900,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmarginBottom: 16,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: 1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttextAlign: 'left',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: 24,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackground: 'linear-gradient(90deg, #ffb347, #ff4e50)',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitBackgroundClip: 'text',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitTextFillColor: 'transparent',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}>Social Media Information</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={24} lg={8}><Form.Item label=\"Facebook\"><Input name=\"facebook\" value={personalForm.facebook || ''} onChange={handleChangePersonal} disabled={!editingPersonal} placeholder=\"Facebook profile/link\" /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={24} lg={8}><Form.Item label=\"Valid Email\"><Input name=\"email\" type=\"email\" value={personalForm.email || ''} onChange={handleChangePersonal} disabled={!editingPersonal} placeholder=\"Email address\" /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={24} lg={8}><Form.Item label=\"Contact Number\"><Input name=\"contactNumber\" type=\"number\" value={personalForm.contactNumber || ''} onChange={handleChangePersonal} disabled={!editingPersonal} placeholder=\"Contact No.\" /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={24} lg={12}><Form.Item label=\"Emergency Contact\"><Input name=\"emergencyContact\" type=\"number\" value={personalForm.emergencyContact || ''} onChange={handleChangePersonal} disabled={!editingPersonal} placeholder=\"Emergency contact number\" /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={24} lg={12}><Form.Item label=\"Landline Number\"><Input name=\"landlineNumber\" type=\"number\" value={personalForm.landlineNumber || ''} onChange={handleChangePersonal} disabled={!editingPersonal} placeholder=\"Landline number\" /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   {/* Family Info Subcategory */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 900,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmarginBottom: 16,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: 1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttextAlign: 'left',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: 24,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackground: 'linear-gradient(90deg, #ffb347, #ff4e50)',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitBackgroundClip: 'text',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitTextFillColor: 'transparent',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}>Family Information</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Spouse Name\"><Input name=\"spouseName\" value={personalForm.spouseName || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Spouse Middle Name\"><Input name=\"spouseMiddleName\" value={personalForm.spouseMiddleName || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Spouse Last Name\"><Input name=\"spouseLastName\" value={personalForm.spouseLastName || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Spouse Age\"><Input name=\"spouseAge\" type=\"number\" value={personalForm.spouseAge || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Spouse Birthdate\"><Input name=\"spouseBirthDate\" type=\"date\" value={personalForm.spouseBirthDate || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Spouse Nationality\"><Input name=\"spouseNationality\" value={personalForm.spouseNationality || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Spouse Occupation\"><Input name=\"spouseOccupation\" value={personalForm.spouseOccupation || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Spouse Contact Number\"><Input name=\"spouseContactNumber\" value={personalForm.spouseContactNumber || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Spouse Status\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   value={personalForm.spouseStatus || ''}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   onChange={(value: string) => setPersonalForm(prev => prev ? { ...prev, spouseStatus: value } : prev)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   disabled={!editingPersonal}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"\">Select status</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Alive\">Alive</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Deceased\">Deceased</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Unknown\">Unknown</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Missing\">Missing</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Abroad\">Abroad</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"With Family\">With Family</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Separated\">Separated</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Other\">Other</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Select>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Number of Children\"><Input name=\"numberOfChildren\" type=\"number\" value={personalForm.numberOfChildren || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Children's Names\"><Input name=\"childrenNames\" value={personalForm.childrenNames || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Children's Ages\"><Input name=\"childrenAges\" value={personalForm.childrenAges || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Emergency Contact Name\"><Input name=\"emergencyContactName\" value={personalForm.emergencyContactName || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={12} md={6}><Form.Item label=\"Emergency Contact Relationship\"><Input name=\"emergencyContactRelationship\" value={personalForm.emergencyContactRelationship || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Mother's Name\"><Input name=\"motherName\" value={personalForm.motherName || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Mother's Age\"><Input name=\"motherAge\" type=\"number\" value={personalForm.motherAge || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Mother's Birthdate\"><Input name=\"motherBirthDate\" type=\"date\" value={personalForm.motherBirthDate || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Mother's Occupation\"><Input name=\"motherOccupation\" value={personalForm.motherOccupation || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Form.Item label=\"Mother's Status\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={personalForm.motherStatus || ''}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(value: string) => setPersonalForm(prev => prev ? { ...prev, motherStatus: value } : prev)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={!editingPersonal}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"\">Select status</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Alive\">Alive</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Deceased\">Deceased</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Unknown\">Unknown</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Missing\">Missing</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Abroad\">Abroad</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"With Family\">With Family</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Separated\">Separated</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Other\">Other</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Form.Item>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Father's Name\"><Input name=\"fatherName\" value={personalForm.fatherName || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Father's Age\"><Input name=\"fatherAge\" type=\"number\" value={personalForm.fatherAge || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Father's Birthdate\"><Input name=\"fatherBirthDate\" type=\"date\" value={personalForm.fatherBirthDate || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Father's Occupation\"><Input name=\"fatherOccupation\" value={personalForm.fatherOccupation || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Col xs={24} sm={24} md={12} lg={8}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Form.Item label=\"Father's Status\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={personalForm.fatherStatus || ''}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(value: string) => setPersonalForm(prev => prev ? { ...prev, fatherStatus: value } : prev)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={!editingPersonal}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"\">Select status</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Alive\">Alive</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Deceased\">Deceased</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Unknown\">Unknown</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Missing\">Missing</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Abroad\">Abroad</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"With Family\">With Family</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Separated\">Separated</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Select.Option value=\"Other\">Other</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Form.Item>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   {/* Business Info Subcategory */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Typography.Title level={3} style={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 900,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmarginBottom: 16,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: 1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttextAlign: 'left',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: 24,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackground: 'linear-gradient(90deg, #ffb347, #ff4e50)',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitBackgroundClip: 'text',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWebkitTextFillColor: 'transparent',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}>Business Information</Typography.Title>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Business Name\"><Input name=\"businessName\" value={personalForm.businessName || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Business Type\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select value={personalForm.businessType || ''} onChange={(value: string) => setPersonalForm(prev => prev ? { ...prev, businessType: value } : prev)} disabled={!editingPersonal}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"\">Select</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Sole Proprietorship\">Sole Proprietorship</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Partnership\">Partnership</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Corporation\">Corporation</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Cooperative\">Cooperative</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Select.Option value=\"Other\">Other</Select.Option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Select>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Nature of Business\"><Input name=\"natureOfBusiness\" value={personalForm.natureOfBusiness || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Business Address\"><Input name=\"businessAddress\" value={personalForm.businessAddress || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Date Established\"><Input name=\"dateEstablished\" type=\"date\" value={personalForm.dateEstablished || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"TIN\"><Input name=\"tin\" value={personalForm.tin || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"DTI/SEC/CDA Registration No.\"><Input name=\"registrationNumber\" value={personalForm.registrationNumber || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Business Permit No.\"><Input name=\"businessPermitNumber\" value={personalForm.businessPermitNumber || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Barangay Clearance No.\"><Input name=\"barangayClearanceNumber\" value={personalForm.barangayClearanceNumber || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Number of Employees\"><Input name=\"numberOfEmployees\" type=\"number\" value={personalForm.numberOfEmployees || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Capital Investment\"><Input name=\"capitalInvestment\" type=\"number\" value={personalForm.capitalInvestment || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Annual Gross Income\"><Input name=\"annualGrossIncome\" type=\"number\" value={personalForm.annualGrossIncome || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Row gutter={16}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Contact Person\"><Input name=\"businessContactPerson\" value={personalForm.businessContactPerson || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Contact Number\"><Input name=\"businessContactNumber\" value={personalForm.businessContactNumber || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Col xs={24} sm={24} md={12} lg={8}><Form.Item label=\"Email Address\"><Input name=\"businessEmail\" type=\"email\" value={personalForm.businessEmail || ''} onChange={handleChangePersonal} disabled={!editingPersonal} /></Form.Item></Col>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Row>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <div style={{ display: 'flex', gap: 8, marginTop: 16 }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   {editingPersonal ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Button type=\"primary\" onClick={handleSavePersonal} style={{ fontWeight: 600 }}>Save</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Button onClick={handleCancelPersonal}>Cancel</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   ) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   <Button onClick={handleEditPersonal} style={{ fontWeight: 600, marginRight: 8 }}>Edit</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   {personalInfo && personalInfo.barangayID ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button type=\"primary\" disabled style={{ fontWeight: 600, background: '#b2bec3', border: 'none' }}>Registered</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button type=\"primary\" style={{ fontWeight: 600 }} onClick={handleRegisterResident}>Register</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   )}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   )}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   </Form>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   </Card>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t</div>\r\n\t\t);\r\n}\r\n\r\n\r\n\r\n","import React from 'react';\r\nimport './LandingPage.css';\r\nimport './responsive-system-title.css';\r\n\r\nconst LandingPage: React.FC = () => {\r\n  return (\r\n    <div className=\"landing-bg\" style={{\r\n      minHeight: '100vh',\r\n      background: 'linear-gradient(135deg, #40c9ff 0%, #e81cff 100%)',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      fontFamily: 'Segoe UI, Roboto, Helvetica Neue, Arial, sans-serif',\r\n    }}>\r\n      <div className=\"floating-box\" style={{\r\n        background: 'rgba(255,255,255,0.95)',\r\n        boxShadow: '0 8px 32px 0 rgba(64,201,255,0.15)',\r\n        borderRadius: 24,\r\n        padding: '48px 32px',\r\n        textAlign: 'center',\r\n        maxWidth: 420,\r\n        width: '100%',\r\n        animation: 'float 2s infinite ease-in-out alternate',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n      }}>\r\n  <img src={`${process.env.PUBLIC_URL}/logo-parian2.png`} alt=\"Barangay Logo\" style={{ width: 80, marginBottom: 24 }} />\r\n        <h1\r\n          className=\"responsive-system-title\"\r\n          style={{\r\n            fontSize: '1.7rem',\r\n            marginBottom: 24,\r\n            fontWeight: 800,\r\n            background: 'linear-gradient(90deg, #40c9ff, #e81cff)',\r\n            WebkitBackgroundClip: 'text',\r\n            WebkitTextFillColor: 'transparent',\r\n            letterSpacing: 1,\r\n            maxWidth: '100%',\r\n            overflow: 'hidden',\r\n            textOverflow: 'ellipsis',\r\n            whiteSpace: 'pre-line',\r\n            wordBreak: 'break-word',\r\n            textAlign: 'center',\r\n          }}\r\n        >\r\n          Welcome to\r\n          <br />\r\n          Barangay Information Management System\r\n          <br />\r\n          Parian\r\n        </h1>\r\n        <button\r\n          className=\"get-started-btn\"\r\n          style={{\r\n            background: 'linear-gradient(90deg, #e81cff 0%, #40c9ff 100%)',\r\n            color: '#fff',\r\n            border: 'none',\r\n            borderRadius: 8,\r\n            padding: '14px 40px',\r\n            fontSize: '1.15rem',\r\n            fontWeight: 700,\r\n            cursor: 'pointer',\r\n            boxShadow: '0 2px 8px #e81cff44',\r\n            marginTop: 8,\r\n            transition: 'background 0.2s',\r\n          }}\r\n          onClick={() => window.location.href = '/login'}\r\n          onMouseOver={e => (e.currentTarget.style.background = 'linear-gradient(90deg, #40c9ff 0%, #e81cff 100%)')}\r\n          onMouseOut={e => (e.currentTarget.style.background = 'linear-gradient(90deg, #e81cff 0%, #40c9ff 100%)')}\r\n        >\r\n          Get Started\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LandingPage;\r\n","import React, { useState } from 'react';\r\nimport { Form, Input, Button, Card, Typography, notification, Radio } from 'antd';\r\nimport { axiosPublic } from '../services/api';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst ForgotPassword: React.FC = () => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [sent, setSent] = useState(false);\r\n  const [mode, setMode] = useState<'link' | 'otp'>('link');\r\n  const [submittedEmail, setSubmittedEmail] = useState<string | null>(null);\r\n  const [code, setCode] = useState('');\r\n  const [verifying, setVerifying] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  const onFinish = async (values: { email: string }) => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await axiosPublic.post('/auth/forgot-password', { email: values.email, mode });\r\n      // server returns generic success message\r\n      notification.success({ message: 'Request sent', description: res.data?.message || 'Check your email for instructions.' });\r\n      setSent(true);\r\n      setSubmittedEmail(values.email);\r\n    } catch (err: any) {\r\n      const msg = err?.response?.data?.message || err.message || 'Failed to send reset email';\r\n      notification.error({ message: 'Error', description: msg });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDigit = (d: string) => {\r\n    if (code.length >= 6) return;\r\n    setCode(prev => prev + d);\r\n  };\r\n  const handleBackspace = () => setCode(prev => prev.slice(0, -1));\r\n  const handleClear = () => setCode('');\r\n\r\n  const submitOtp = async () => {\r\n    if (code.length !== 6) {\r\n      notification.error({ message: 'Enter code', description: 'Please enter the 6-digit code.' });\r\n      return;\r\n    }\r\n    setVerifying(true);\r\n    try {\r\n      // send token to server; server will email a temporary password if token is valid\r\n      const payload: any = { token: code };\r\n      if (submittedEmail) payload.email = submittedEmail;\r\n      const res = await axiosPublic.post('/auth/verify-otp', payload);\r\n      notification.success({ message: 'If valid', description: res.data?.message || 'Check your email for the new temporary password.' });\r\n      // clear input and allow user to go back to login\r\n      setCode('');\r\n      setSent(false);\r\n      setSubmittedEmail(null);\r\n      navigate('/login');\r\n    } catch (err: any) {\r\n      const msg = err?.response?.data?.message || err.message || 'Failed to verify code';\r\n      notification.error({ message: 'Error', description: msg });\r\n    } finally {\r\n      setVerifying(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ minHeight: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center', padding: 24 }}>\r\n      <Card style={{ width: 420, borderRadius: 12 }}>\r\n        <Typography.Title level={3} style={{ textAlign: 'center' }}>Forgot Password</Typography.Title>\r\n        {!sent ? (\r\n          <Form layout=\"vertical\" onFinish={onFinish} requiredMark={false}>\r\n            <Form.Item label=\"Choose how to receive reset instructions\">\r\n              <Radio.Group value={mode} onChange={(e) => setMode(e.target.value)}>\r\n                <Radio value=\"link\">Send reset link (email)</Radio>\r\n                <Radio value=\"otp\">Send 6-digit code (email)</Radio>\r\n              </Radio.Group>\r\n            </Form.Item>\r\n            <Form.Item\r\n              label=\"Email\"\r\n              name=\"email\"\r\n              rules={[{ required: true, message: 'Please input your email' }, { type: 'email', message: 'Please enter a valid email' }]}\r\n            >\r\n              <Input placeholder=\"you@example.com\" size=\"large\" />\r\n            </Form.Item>\r\n            <Form.Item>\r\n              <Button type=\"primary\" htmlType=\"submit\" block loading={loading}>\r\n                {loading ? 'Sending...' : mode === 'otp' ? 'Send code' : 'Send reset link'}\r\n              </Button>\r\n            </Form.Item>\r\n            <Button type=\"link\" block onClick={() => navigate('/login')}>Back to login</Button>\r\n          </Form>\r\n        ) : (\r\n          <div>\r\n            {mode === 'otp' ? (\r\n              <div>\r\n                <Typography.Paragraph>\r\n                  Enter the 6-digit code sent to <strong>{submittedEmail}</strong>\r\n                </Typography.Paragraph>\r\n                <div style={{ display: 'flex', justifyContent: 'center', marginBottom: 12 }}>\r\n                  {Array.from({ length: 6 }).map((_, i) => (\r\n                    <div key={i} style={{ width: 40, height: 48, margin: 4, border: '1px solid #ddd', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: 18 }}>\r\n                      {code[i] || ''}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: 8, maxWidth: 300, margin: '0 auto 12px' }}>\r\n                  {['1','2','3','4','5','6','7','8','9','0'].map(d => (\r\n                    <Button key={d} onClick={() => handleDigit(d)} disabled={verifying}>{d}</Button>\r\n                  ))}\r\n                  <Button onClick={handleBackspace} disabled={verifying}></Button>\r\n                  <Button onClick={handleClear} disabled={verifying}>Clear</Button>\r\n                  <Button type=\"primary\" onClick={submitOtp} loading={verifying} disabled={verifying}>Verify</Button>\r\n                </div>\r\n                <Button type=\"link\" block onClick={() => { setSent(false); setSubmittedEmail(null); }}>Back</Button>\r\n              </div>\r\n            ) : (\r\n              <div>\r\n                <Typography.Paragraph>\r\n                  Check your email for password reset instructions.\r\n                </Typography.Paragraph>\r\n                <Button type=\"primary\" block onClick={() => navigate('/login')}>Back to login</Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ForgotPassword;\r\n","import React, { useState } from 'react';\r\nimport { Form, Input, Button, Card, Typography, notification, Progress } from 'antd';\r\nimport { useParams, useNavigate, useLocation } from 'react-router-dom';\r\nimport { axiosPublic } from '../services/api';\r\n\r\nconst ResetPassword: React.FC = () => {\r\n  const { token } = useParams<{ token: string }>();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const search = new URLSearchParams(location.search);\r\n  const mode = search.get('mode'); // 'otp' if user is using code flow\r\n  const [loading, setLoading] = useState(false);\r\n  const [strengthScore, setStrengthScore] = useState<number | null>(null);\r\n  const [strengthLabel, setStrengthLabel] = useState<string>('');\r\n\r\n  const evaluateStrength = (pwd: string) => {\r\n    if (!pwd) {\r\n      setStrengthScore(null);\r\n      setStrengthLabel('');\r\n      return;\r\n    }\r\n    // simple regex-based scoring\r\n    let score = 0;\r\n    if (pwd.length >= 8) score += 2;\r\n    if (/[A-Z]/.test(pwd)) score += 1;\r\n    if (/[a-z]/.test(pwd)) score += 1;\r\n    if (/\\d/.test(pwd)) score += 1;\r\n    if (/[^A-Za-z0-9]/.test(pwd)) score += 1;\r\n    // map to 0..4\r\n    const mapped = Math.min(4, Math.floor((score / 6) * 5));\r\n    const pct = mapped * 20;\r\n    const labels = ['Very weak', 'Weak', 'Fair', 'Good', 'Strong'];\r\n    setStrengthScore(pct);\r\n    setStrengthLabel(labels[mapped] || '');\r\n  };\r\n\r\n  const onFinish = async (values: { password: string; confirm: string; code?: string }) => {\r\n    if (values.password !== values.confirm) {\r\n      notification.error({ message: 'Passwords do not match' });\r\n      return;\r\n    }\r\n    // enforce client-side minimal complexity consistent with server\r\n    const strongPwdRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[^A-Za-z0-9]).{8,}$/;\r\n    if (!strongPwdRegex.test(values.password)) {\r\n      notification.error({ message: 'Password does not meet complexity requirements. Use 8+ chars, mixed case, numbers and symbols.' });\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    try {\r\n      let res;\r\n      // If token is present in URL, use the legacy link endpoint\r\n      if (token) {\r\n        res = await axiosPublic.post(`/auth/reset-password/${token}`, { password: values.password });\r\n      } else if (mode === 'otp') {\r\n        // OTP flow: code is provided by user in a field; submit token in body\r\n        if (!values.code) {\r\n          notification.error({ message: 'Please enter the 6-digit code sent to your email' });\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        res = await axiosPublic.post(`/auth/reset-password`, { token: values.code, password: values.password });\r\n      } else {\r\n        // fallback: attempt body token\r\n        res = await axiosPublic.post(`/auth/reset-password`, { token: values.code || '', password: values.password });\r\n      }\r\n      notification.success({ message: 'Password reset', description: res.data?.message || 'Your password has been reset. Please log in.' });\r\n      navigate('/login');\r\n    } catch (err: any) {\r\n      const msg = err?.response?.data?.message || err.message || 'Failed to reset password';\r\n      notification.error({ message: 'Error', description: msg });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ minHeight: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center', padding: 24 }}>\r\n      <Card style={{ width: 420, borderRadius: 12 }}>\r\n        <Typography.Title level={3} style={{ textAlign: 'center' }}>Reset Password</Typography.Title>\r\n        <Form layout=\"vertical\" onFinish={onFinish} requiredMark={false}>\r\n          {mode === 'otp' && !token && (\r\n            <Form.Item\r\n              label=\"6-digit code\"\r\n              name=\"code\"\r\n              rules={[{ required: true, message: 'Please input the 6-digit code sent to your email' }, { len: 6, message: 'Code must be 6 digits' }]}\r\n            >\r\n              <Input placeholder=\"123456\" size=\"large\" />\r\n            </Form.Item>\r\n          )}\r\n          <Form.Item\r\n              label=\"New password\"\r\n              name=\"password\"\r\n              rules={[{ required: true, message: 'Please input your new password' }, { min: 6, message: 'Password must be at least 6 characters' }]}\r\n            >\r\n              <Input.Password size=\"large\" onChange={(e) => evaluateStrength(e.target.value)} />\r\n            </Form.Item>\r\n          {strengthScore !== null && (\r\n            <div style={{ marginBottom: 12 }}>\r\n              <Progress percent={strengthScore} size=\"small\" status={strengthScore < 40 ? 'exception' : 'normal'} />\r\n              <div style={{ textAlign: 'right', fontSize: 12, color: '#666' }}>{strengthLabel}</div>\r\n            </div>\r\n          )}\r\n          <Form.Item\r\n            label=\"Confirm password\"\r\n            name=\"confirm\"\r\n            rules={[{ required: true, message: 'Please confirm your new password' }]}\r\n          >\r\n            <Input.Password size=\"large\" />\r\n          </Form.Item>\r\n          <Form.Item>\r\n            <Button type=\"primary\" htmlType=\"submit\" block loading={loading}>\r\n              {loading ? 'Resetting...' : 'Reset password'}\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ResetPassword;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { Card, List, Typography, Spin, Button, Space } from 'antd';\r\nimport AppAvatar from '../AppAvatar';\r\nimport { BellOutlined, CheckCircleOutlined, ArrowLeftOutlined } from '@ant-design/icons';\r\nimport { getInbox, axiosInstance } from '../../services/api';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst { Title, Text } = Typography;\r\n\r\nconst MessageInbox: React.FC = () => {\r\n  // now use messages (inbox) which includes verification request messages\r\n  const [messages, setMessages] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  const fetchNotifications = async () => {\r\n    setLoading(true);\r\n    try {\r\n  const resp = await getInbox();\r\n  const data = resp && resp.data ? resp.data : [];\r\n  setMessages(Array.isArray(data) ? data : []);\r\n    } catch (err) {\r\n      console.error('Failed to fetch inbox messages', err);\r\n      setMessages([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchNotifications();\r\n  }, []);\r\n\r\n  const handleMarkAsRead = async (msg: any) => {\r\n    if (!msg._id || msg.status === 'read') return;\r\n    setLoading(true);\r\n    try {\r\n      // mark the message as read via messages endpoint\r\n      await axiosInstance.patch(`/messages/${msg._id}/read`);\r\n      await fetchNotifications();\r\n    } catch (err) {\r\n      // Optionally show error\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Spin spinning={loading}>\r\n      <div style={{ padding: 24, backgroundColor: '#f0f2f5', minHeight: '100vh' }}>\r\n        <Space style={{ marginBottom: 24 }}>\r\n          <Button type=\"default\" icon={<ArrowLeftOutlined />} onClick={() => navigate('/admin/dashboard')}>\r\n            Back to Dashboard\r\n          </Button>\r\n          <Title level={4} style={{ marginBottom: 0 }}>Message Inbox</Title>\r\n        </Space>\r\n        <Card>\r\n          <List\r\n            dataSource={Array.isArray(messages) ? messages : []}\r\n            renderItem={notification => (\r\n              <List.Item\r\n                actions={[\r\n                  notification.status === 'unread' && (\r\n                    <Button\r\n                      size=\"small\"\r\n                      icon={<CheckCircleOutlined />}\r\n                      onClick={() => handleMarkAsRead(notification)}\r\n                    >Mark Read</Button>\r\n                  )\r\n                ].filter(Boolean)}\r\n              >\r\n                <List.Item.Meta\r\n                  avatar={<AppAvatar icon={<BellOutlined />} style={{ backgroundColor: notification.status === 'read' ? '#8c8c8c' : '#1890ff' }} />}\r\n                  title={<Text strong>{notification.subject}</Text>}\r\n                  description={\r\n                    <div>\r\n                      <Text type=\"secondary\">{new Date(notification.createdAt).toLocaleString()}</Text>\r\n                      {/* Show body for verification requests */}\r\n                      {notification.subject === 'New Verification Request' && (\r\n                        <div style={{ marginTop: 8 }}>\r\n                          <Text strong>Verification request submitted.</Text>\r\n                          <div>{notification.body}</div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  }\r\n                />\r\n              </List.Item>\r\n            )}\r\n            locale={{ emptyText: 'No notifications' }}\r\n          />\r\n        </Card>\r\n      </div>\r\n    </Spin>\r\n  );\r\n};\r\n\r\nexport default MessageInbox;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"DocumentHistory_wrapper__wG25f\",\"title\":\"DocumentHistory_title__PIqwU\",\"cardList\":\"DocumentHistory_cardList__W2DZc\",\"card\":\"DocumentHistory_card__QUFJm\",\"cardRow\":\"DocumentHistory_cardRow__sZB+d\",\"cardCol\":\"DocumentHistory_cardCol__6blUh\",\"cardLabel\":\"DocumentHistory_cardLabel__ZBwA9\",\"cardValue\":\"DocumentHistory_cardValue__YzdP1\",\"rejected\":\"DocumentHistory_rejected__31K2d\",\"completed\":\"DocumentHistory_completed__ULnvi\"};","import React, { useEffect, useState } from 'react';\r\nimport { Table, Typography, Spin, Card } from 'antd';\r\nimport { documentsAPI } from '../services/api';\r\nimport { formatDate as formatDateUtil } from '../utils/formatDate';\r\nimport styles from './DocumentHistory.module.css';\r\n\r\nconst DocumentHistory: React.FC = () => {\r\n  const [history, setHistory] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isMobile, setIsMobile] = useState<boolean>(false);\r\n\r\n  useEffect(() => {\r\n    const onResize = () => setIsMobile(window.innerWidth <= 720);\r\n    onResize();\r\n    window.addEventListener('resize', onResize);\r\n    return () => window.removeEventListener('resize', onResize);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    const fetchHistory = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const res = await (documentsAPI as any).getDocumentRecords();\r\n        if (mounted) setHistory(Array.isArray(res) ? res : []);\r\n      } catch (err) {\r\n        console.error('Failed to load document history', err);\r\n        if (mounted) setHistory([]);\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    };\r\n    fetchHistory();\r\n    return () => { mounted = false; };\r\n  }, []);\r\n\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      <Typography.Title level={3} className={styles.title}>Document History</Typography.Title>\r\n      {loading ? <Spin /> : (\r\n        isMobile ? (\r\n          <div className={styles.cardList}>\r\n            {history.map(h => (\r\n              <Card key={h._id} className={styles.card}>\r\n                <div className={styles.cardRow}>\r\n                  <div className={styles.cardCol}>\r\n                    <div className={styles.cardLabel}>Requester</div>\r\n                    <div className={styles.cardValue}>{h.username || 'Unknown'}</div>\r\n                  </div>\r\n                  <div className={styles.cardCol}>\r\n                    <div className={styles.cardLabel}>Type</div>\r\n                    <div className={styles.cardValue}>{h.type || 'Unknown'}</div>\r\n                  </div>\r\n                </div>\r\n                <div className={styles.cardRow}>\r\n                  <div className={styles.cardCol}>\r\n                    <div className={styles.cardLabel}>Txn ID</div>\r\n                    <div className={styles.cardValue}>{h.transactionCode || ''}</div>\r\n                  </div>\r\n                  <div className={styles.cardCol}>\r\n                    <div className={styles.cardLabel}>Date Approved</div>\r\n                    <div className={styles.cardValue}>{(h.completedAt || h.dateApproved || h.approvedAt) ? formatDateUtil(h.completedAt || h.dateApproved || h.approvedAt) : ''}</div>\r\n                  </div>\r\n                </div>\r\n                <div style={{ marginTop: 8 }}>\r\n                  {h.status && h.status.toString().toLowerCase() === 'rejected' ? (\r\n                    <div className={styles.rejected}>Rejected</div>\r\n                  ) : (\r\n                    <div className={styles.completed}>Completed</div>\r\n                  )}\r\n                </div>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <Table\r\n            dataSource={history}\r\n            rowKey=\"_id\"\r\n            pagination={{ pageSize: 8 }}\r\n            columns={[\r\n              { title: 'Requester Name', dataIndex: 'username', key: 'username', render: (text: string) => text || 'Unknown' },\r\n              { title: 'Transactional ID', dataIndex: 'transactionCode', key: 'transactionCode', render: (text: string) => text || '' },\r\n              { title: 'Type', dataIndex: 'type', key: 'type', render: (text: string) => text || 'Unknown' },\r\n              { title: 'Date Approved', dataIndex: 'completedAt', key: 'completedAt', render: (text: string, record: any) => {\r\n                  const date = text || record.dateApproved || record.completedAt || record.approvedAt || null;\r\n                  if (!date) return '';\r\n                  try {\r\n                    return formatDateUtil(date);\r\n                  } catch {\r\n                    return String(date);\r\n                  }\r\n                }\r\n              },\r\n              { title: 'Status', dataIndex: 'status', key: 'status', render: (text: string, record: any) => {\r\n                  const staffName = record.processedBy?.fullName || record.processedBy?.username || 'Unknown';\r\n                  const staffBarangayID = record.processedBy?.barangayID || 'Unknown';\r\n                  if (text && text.toLowerCase() === 'rejected') {\r\n                    return <span style={{ color: '#FF3B3B', fontWeight: 600 }}>Rejected by: {staffName} ({staffBarangayID})</span>;\r\n                  } else if (text && (text.toLowerCase() === 'completed' || text.toLowerCase() === 'approved')) {\r\n                    return <span style={{ color: '#43D96B', fontWeight: 600 }}>Completed by: {staffName} ({staffBarangayID})</span>;\r\n                  } else {\r\n                    return <span>{text}</span>;\r\n                  }\r\n                }\r\n              }\r\n            ]}\r\n          />\r\n        )\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DocumentHistory;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { Card, Input, Upload, Button, message, Typography, List, Popconfirm, Image, Modal, Tooltip } from 'antd';\r\nimport { UploadOutlined, CheckCircleOutlined, CloseCircleOutlined, DeleteOutlined, EyeOutlined, EditOutlined } from '@ant-design/icons';\r\nimport { adminAPI, getAbsoluteApiUrl } from '../../services/api';\r\n\r\nconst { TextArea } = Input;\r\n\r\nconst Announcements: React.FC = () => {\r\n  const [text, setText] = useState('');\r\n  const [file, setFile] = useState<File | null>(null);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [anns, setAnns] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [viewing, setViewing] = useState<any | null>(null);\r\n  const [editing, setEditing] = useState<any | null>(null);\r\n  const [editText, setEditText] = useState('');\r\n  const [editFile, setEditFile] = useState<File | null>(null);\r\n\r\n  const { user } = useAuth();\r\n\r\n  const loadAnns = React.useCallback(async () => {\r\n    // Avoid calling admin endpoint when user isn't admin or no token available\r\n    if (!user || user.role !== 'admin') return;\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      // No token - likely not logged in yet\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    try {\r\n      const data = await adminAPI.listAdminAnnouncements();\r\n      setAnns(Array.isArray(data) ? data : []);\r\n    } catch (err: any) {\r\n      // Handle 401 explicitly\r\n      if (err?.response?.status === 401) {\r\n        message.error('Not authorized. Please sign in as an admin.');\r\n      } else {\r\n        console.error('Failed to load announcements', err);\r\n        message.error('Failed to load announcements');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user]);\r\n\r\n  // Load admin announcements only when we have an authenticated admin user\r\n  useEffect(() => {\r\n    if (user?.role === 'admin') {\r\n      loadAnns();\r\n    }\r\n  }, [loadAnns, user?.role]);\r\n\r\n  const beforeUpload = (f: File) => {\r\n    // accept only images\r\n    const isImage = f.type.startsWith('image/');\r\n    if (!isImage) {\r\n      message.error('Only image files are allowed');\r\n      return Upload.LIST_IGNORE;\r\n    }\r\n    // keep single file\r\n    setFile(f);\r\n    return Upload.LIST_IGNORE; // Prevent auto upload\r\n  };\r\n\r\n  const removeFile = () => setFile(null);\r\n\r\n  const beforeEditUpload = (f: File) => {\r\n    const isImage = f.type.startsWith('image/');\r\n    if (!isImage) {\r\n      message.error('Only image files are allowed');\r\n      return Upload.LIST_IGNORE;\r\n    }\r\n    setEditFile(f);\r\n    return Upload.LIST_IGNORE;\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (!text || text.trim() === '') return message.warning('Announcement text cannot be empty');\r\n    setSubmitting(true);\r\n    try {\r\n      const form = new FormData();\r\n      form.append('text', text.trim());\r\n      if (file) form.append('image', file, file.name);\r\n      // POST to admin announcements endpoint\r\n      await adminAPI.createAnnouncement(form);\r\n      message.success('Announcement posted');\r\n      setText('');\r\n      setFile(null);\r\n    } catch (err: any) {\r\n      console.error('Failed to post announcement', err);\r\n      message.error(err?.response?.data?.message || 'Failed to post announcement');\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const openView = (item: any) => setViewing(item);\r\n\r\n  const openEdit = (item: any) => {\r\n    setEditing(item);\r\n    setEditText(item.text || '');\r\n    setEditFile(null);\r\n  };\r\n\r\n  const handleEditSave = async () => {\r\n    if (!editing) return;\r\n    try {\r\n      const form = new FormData();\r\n      form.append('text', editText.trim());\r\n      if (editFile) form.append('image', editFile, editFile.name);\r\n      await adminAPI.updateAnnouncement(editing._id, form);\r\n      message.success('Updated');\r\n      setEditing(null);\r\n      setEditFile(null);\r\n      setEditText('');\r\n      loadAnns();\r\n    } catch (err) {\r\n      console.error(err);\r\n      message.error('Update failed');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Card title={<Typography.Title level={4} style={{ margin: 0 }}>{user?.role === 'admin' ? 'Post Announcement' : 'Announcements'}</Typography.Title>}>\r\n        <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>\r\n          {/* Show create form only to admins */}\r\n          {user?.role === 'admin' && (\r\n            <>\r\n              <TextArea value={text} onChange={e => setText(e.target.value)} rows={6} placeholder=\"Write your announcement here\" />\r\n\r\n              <Upload beforeUpload={beforeUpload} onRemove={removeFile} accept=\"image/*\" maxCount={1} showUploadList={{ showPreviewIcon: false }}>\r\n                <Button icon={<UploadOutlined />}>Upload Image (optional)</Button>\r\n              </Upload>\r\n\r\n              {/* Image upload confirmation */}\r\n              {file && (\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 8, color: '#237804' }}>\r\n                  <CheckCircleOutlined style={{ color: '#52c41a' }} />\r\n                  <span style={{ fontWeight: 600 }}>Image uploaded:</span>\r\n                  <span style={{ marginLeft: 6 }}>{file.name}</span>\r\n                  <Button type=\"text\" icon={<CloseCircleOutlined />} onClick={removeFile} style={{ marginLeft: 8 }} />\r\n                </div>\r\n              )}\r\n\r\n              <div style={{ display: 'flex', justifyContent: 'flex-end' }}>\r\n                <Button type=\"primary\" onClick={handleSubmit} loading={submitting} disabled={!text.trim()}>\r\n                  Post Announcement\r\n                </Button>\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          <div style={{ marginTop: 12 }}>\r\n            <Typography.Title level={5} style={{ marginBottom: 8 }}>Existing Announcements</Typography.Title>\r\n            <List\r\n              loading={loading}\r\n              dataSource={anns}\r\n              renderItem={item => (\r\n                <List.Item actions={\r\n                  [\r\n                    <Tooltip key=\"view\" title=\"View\" placement=\"top\">\r\n                      <Button shape=\"circle\" size=\"small\" icon={<EyeOutlined />} onClick={() => openView(item)} aria-label={`View announcement ${item._id}`} />\r\n                    </Tooltip>,\r\n                    user?.role === 'admin' ? (\r\n                      <Tooltip key=\"edit\" title=\"Edit\" placement=\"top\">\r\n                        <Button shape=\"circle\" size=\"small\" icon={<EditOutlined />} onClick={() => openEdit(item)} aria-label={`Edit announcement ${item._id}`} />\r\n                      </Tooltip>\r\n                    ) : null,\r\n                    user?.role === 'admin' ? (\r\n                      <Popconfirm key=\"del\" title=\"Delete announcement?\" onConfirm={async () => {\r\n                        try {\r\n                          await adminAPI.deleteAnnouncement(item._id);\r\n                          message.success('Deleted');\r\n                          loadAnns();\r\n                        } catch (err) {\r\n                          console.error(err);\r\n                          message.error('Delete failed');\r\n                        }\r\n                      }}>\r\n                        <Tooltip title=\"Delete\" placement=\"top\">\r\n                          <Button danger shape=\"circle\" size=\"small\" icon={<DeleteOutlined />} aria-label={`Delete announcement ${item._id}`} />\r\n                        </Tooltip>\r\n                      </Popconfirm>\r\n                    ) : null\r\n                  ].filter(Boolean) as any\r\n                }>\r\n                  <List.Item.Meta title={new Date(item.createdAt).toLocaleString()} description={item.text} />\r\n                  {item.imagePath && <Image className=\"rounded-img\" width={80} src={getAbsoluteApiUrl(`/announcements/${item._id}/image`)} />}\r\n                </List.Item>\r\n              )}\r\n            />\r\n          </div>\r\n        </div>\r\n      </Card>\r\n\r\n      {/* View Modal */}\r\n      <Modal\r\n        title={viewing ? `Announcement - ${new Date(viewing.createdAt).toLocaleString()}` : 'Announcement'}\r\n        open={!!viewing}\r\n        onCancel={() => setViewing(null)}\r\n        footer={[<Button key=\"close\" onClick={() => setViewing(null)}>Close</Button>]}\r\n      >\r\n        {viewing && (\r\n          <div>\r\n            <p>{viewing.text}</p>\r\n            {viewing.imagePath && <Image className=\"rounded-img rounded-img-lg\" src={getAbsoluteApiUrl(`/announcements/${viewing._id}/image`)} width={320} />}\r\n          </div>\r\n        )}\r\n      </Modal>\r\n\r\n      {/* Edit Modal */}\r\n      <Modal\r\n        title={`Edit Announcement`}\r\n        open={!!editing}\r\n        onCancel={() => { setEditing(null); setEditFile(null); setEditText(''); }}\r\n        onOk={handleEditSave}\r\n        okText=\"Save\"\r\n      >\r\n        <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>\r\n          <TextArea value={editText} onChange={e => setEditText(e.target.value)} rows={6} />\r\n          <Upload beforeUpload={beforeEditUpload} onRemove={() => setEditFile(null)} accept=\"image/*\" maxCount={1} showUploadList={{ showPreviewIcon: false }}>\r\n            <Button icon={<UploadOutlined />}>Replace Image</Button>\r\n          </Upload>\r\n          {editFile && (\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: 8, color: '#237804' }}>\r\n              <CheckCircleOutlined style={{ color: '#52c41a' }} />\r\n              <span style={{ fontWeight: 600 }}>New image selected:</span>\r\n              <span style={{ marginLeft: 6 }}>{editFile?.name}</span>\r\n              <Button type=\"text\" icon={<CloseCircleOutlined />} onClick={() => setEditFile(null)} style={{ marginLeft: 8 }} />\r\n            </div>\r\n          )}\r\n        </div>\r\n      </Modal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Announcements;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { Card, List, Typography, Modal, Image, Empty } from 'antd';\r\nimport { contactAPI, getAbsoluteApiUrl } from '../services/api';\r\n\r\nconst { Title, Paragraph } = Typography;\r\n\r\nconst AnnouncementsList: React.FC = () => {\r\n  const [anns, setAnns] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [selected, setSelected] = useState<any | null>(null);\r\n\r\n  const fetch = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const data = await contactAPI.getAnnouncements();\r\n      setAnns(Array.isArray(data) ? data : []);\r\n    } catch (err) {\r\n      console.error('Failed to load announcements', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => { fetch(); }, []);\r\n\r\n  return (\r\n    <Card title={<Title level={4} style={{ margin: 0 }}>Announcements</Title>}>\r\n      {anns.length === 0 ? (\r\n        <Empty description=\"No announcements\" />\r\n      ) : (\r\n        <List\r\n          loading={loading}\r\n          dataSource={anns}\r\n          renderItem={item => (\r\n            <List.Item style={{ cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'space-between' }} onClick={() => setSelected(item)}>\r\n              <div style={{ flex: 1, minWidth: 0 }}>\r\n                <List.Item.Meta\r\n                  title={<div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                    <span>{new Date(item.createdAt).toLocaleString()}</span>\r\n                  </div>}\r\n                  description={<Paragraph ellipsis={{ rows: 2 }}>{item.text}</Paragraph>}\r\n                />\r\n              </div>\r\n              {item.imagePath && (\r\n                <div style={{ marginLeft: 12, width: 80, display: 'flex', justifyContent: 'flex-end' }}>\r\n                  <Image className=\"rounded-img\" width={72} height={48} src={getAbsoluteApiUrl(`/announcements/${item._id}/image`)} alt=\"announcement\" preview={false} />\r\n                </div>\r\n              )}\r\n            </List.Item>\r\n          )}\r\n        />\r\n      )}\r\n\r\n      <Modal open={!!selected} onCancel={() => setSelected(null)} footer={null} title=\"Announcement\">\r\n            {selected && (\r\n              <div>\r\n                <Paragraph>{selected.text}</Paragraph>\r\n                {selected.imagePath && (\r\n                  <Image className=\"rounded-img rounded-img-lg\" src={getAbsoluteApiUrl(`/announcements/${selected._id}/image`)} alt=\"announcement\" />\r\n                )}\r\n              </div>\r\n            )}\r\n      </Modal>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default AnnouncementsList;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { Table, Button, Space, Tag, message, Spin } from 'antd';\r\nimport { verificationAPI, getAbsoluteApiUrl } from '../../services/api';\r\n\r\ninterface IVReq {\r\n  _id: string;\r\n  userId: any;\r\n  files: string[];\r\n  gridFileIds: string[];\r\n  status: string;\r\n  createdAt: string;\r\n}\r\n\r\nconst VerificationRequests: React.FC = () => {\r\n  const [data, setData] = useState<IVReq[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const load = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await verificationAPI.getRequests();\r\n      setData(Array.isArray(res) ? res : []);\r\n    } catch (err) {\r\n      console.error(err);\r\n      message.error('Failed to load verification requests');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => { load(); }, []);\r\n\r\n  const approve = async (userId: string) => {\r\n    setLoading(true);\r\n    try {\r\n      await verificationAPI.verifyUser(userId, true);\r\n      message.success('User verified');\r\n      await load();\r\n    } catch (err) {\r\n      console.error(err);\r\n      message.error('Failed to verify user');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const reject = async (record: IVReq) => {\r\n    setLoading(true);\r\n    try {\r\n      // Try to call rejectRequest if request id available, then flip user's verified flag\r\n      if (record && record._id) {\r\n        try { await verificationAPI.rejectRequest(record._id); } catch (e) { /* best-effort */ }\r\n      }\r\n      const userId = record.userId?._id || record.userId;\r\n      if (userId) await verificationAPI.verifyUser(userId, false);\r\n      message.success('Verification request rejected');\r\n      await load();\r\n    } catch (err) {\r\n      console.error(err);\r\n      message.error('Failed to reject verification');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      title: 'Resident',\r\n      dataIndex: 'userId',\r\n      key: 'user',\r\n      render: (u: any) => u ? (u.fullName || u.username || u.email) : 'Unknown'\r\n    },\r\n    { title: 'Status', dataIndex: 'status', key: 'status', render: (s: string) => <Tag color={s === 'pending' ? 'orange' : s === 'approved' ? 'green' : 'red'}>{s}</Tag> },\r\n    { title: 'Submitted', dataIndex: 'createdAt', key: 'createdAt', render: (d: string) => new Date(d).toLocaleString() },\r\n    { title: 'Files', dataIndex: 'gridFileIds', key: 'files', render: (ids: string[]) => (\r\n      <Space>\r\n        {ids && ids.map((id: string) => (\r\n          <Button key={id} type=\"link\" href={getAbsoluteApiUrl(`/verification/file/${id}`)} target=\"_blank\">Open</Button>\r\n        ))}\r\n      </Space>\r\n    ) },\r\n    { title: 'Action', key: 'action', render: (_: any, record: IVReq) => (\r\n      <Space>\r\n        <Button onClick={() => approve(record.userId._id || record.userId)} type=\"primary\">Verify</Button>\r\n        <Button danger onClick={() => reject(record)}>Reject</Button>\r\n        <Button type=\"link\" href={getAbsoluteApiUrl(`/verification/file/${(record.gridFileIds && record.gridFileIds[0]) || ''}`)} target=\"_blank\">Check ID</Button>\r\n      </Space>\r\n    ) }\r\n  ];\r\n\r\n  return (\r\n    <div style={{ padding: 24 }}>\r\n      <h2>Verification Requests</h2>\r\n      <Spin spinning={loading}>\r\n        <Table rowKey=\"_id\" loading={loading} dataSource={data} columns={columns as any} />\r\n      </Spin>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VerificationRequests;\r\n","import { createTheme } from '@mui/material/styles';\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      main: '#1976d2',\r\n      light: '#42a5f5',\r\n      dark: '#1565c0',\r\n    },\r\n    secondary: {\r\n      main: '#9c27b0',\r\n      light: '#ba68c8',\r\n      dark: '#7b1fa2',\r\n    },\r\n  },\r\n  typography: {\r\n    fontFamily: [\r\n      '-apple-system',\r\n      'BlinkMacSystemFont',\r\n      '\"Segoe UI\"',\r\n      'Roboto',\r\n      '\"Helvetica Neue\"',\r\n      'Arial',\r\n      'sans-serif',\r\n    ].join(','),\r\n  },\r\n  components: {\r\n    MuiButton: {\r\n      styleOverrides: {\r\n        root: {\r\n          textTransform: 'none',\r\n        },\r\n      },\r\n    },\r\n    MuiPaper: {\r\n      styleOverrides: {\r\n        root: {\r\n          borderRadius: 8,\r\n        },\r\n      },\r\n    },\r\n  },\r\n});\r\n\r\nexport default theme;\r\n","import Inbox from './pages/inbox';\nimport type { FC } from 'react';\nimport React from 'react';\nimport TemplatesManager from './components/TemplatesManager';\nimport StaffInbox from './pages/staffInbox';\nimport { BrowserRouter as Router, Route, Routes, Navigate } from 'react-router-dom';\nimport { ThemeProvider } from '@mui/material/styles';\nimport CssBaseline from '@mui/material/CssBaseline';\nimport { ConfigProvider } from 'antd';\nimport { AuthProvider, useAuth } from './contexts/AuthContext';\nimport Layout from './components/Layout';\nimport PrivateRoute from './components/PrivateRoute';\nimport StaffRoute from './components/StaffRoute';\nimport AdminRoute from './components/AdminRoute';\n// MinimalChart unused  import removed to satisfy ESLint\n\n// Pages\nimport LoginForm from './components/LoginForm';\nimport RegisterForm from './components/RegisterForm';\nimport Dashboard from './components/Dashboard';\nimport GuestDashboard from './components/GuestDashboard';\nimport StaffDashboard from './components/StaffDashboard';\nimport AdminDashboard from './components/admin/AdminDashboard';\nimport UserManagement from './components/admin/UserManagement';\nimport ActivityLogs from './components/admin/ActivityLogs';\nimport Statistics from './components/admin/Statistics';\nimport SystemSettings from './components/admin/SystemSettings';\nimport DocumentRequestForm from './components/DocumentRequestForm';\nimport InquiryForm from './components/InquiryForm';\nimport Goodbye from './components/Goodbye';\nimport Logout from './components/Logout';\nimport InquiryTracker from './pages/InquiryTracker';\nimport ResidentPortal from './components/ResidentPortal';\nimport LandingPage from './components/LandingPage';\nimport ForgotPassword from './pages/ForgotPassword';\nimport ResetPassword from './pages/ResetPassword';\nimport MessageInbox from './components/admin/MessageInbox';\nimport DocumentHistory from './components/DocumentHistory';\nimport Announcements from './components/admin/Announcements';\nimport AnnouncementsList from './components/AnnouncementsList';\nimport VerificationRequests from './components/admin/VerificationRequests';\nimport theme from './theme';\n\nconst RootRedirect: React.FC = () => {\n  const { user } = useAuth();\n  if (!user) {\n    return <Navigate to=\"/login\" replace />;\n  }\n  if (user.role === 'admin') {\n    return <Navigate to=\"/admin/dashboard\" replace />;\n  }\n  if (user.role === 'staff') {\n    return <Navigate to=\"/staff-dashboard\" replace />;\n  }\n  return <Navigate to=\"/dashboard\" replace />;\n};\n\ninterface AppProps {}\n\nconst App: FC<AppProps> = () => {\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      <ConfigProvider>\n        <Router>\n          <AuthProvider>\n            <Routes>\n              {/* Landing Page as root */}\n              <Route path=\"/\" element={<LandingPage />} />\n              <Route path=\"/redirect\" element={<RootRedirect />} />\n              {/* Public Routes */}\n              <Route path=\"/login\" element={<LoginForm />} />\n              <Route path=\"/forgot-password\" element={<ForgotPassword />} />\n              <Route path=\"/reset-password/:token\" element={<ResetPassword />} />\n              <Route path=\"/register\" element={<RegisterForm />} />\n              <Route path=\"/goodbye\" element={<Goodbye />} />\n              <Route path=\"/logout\" element={<Logout />} />\n              {/* Protected Routes (with Layout) */}\n              <Route element={<Layout />}>\n                {/* Added for sidebar navigation */}\n                <Route path=\"/home\" element={<PrivateRoute><Dashboard /></PrivateRoute>} />\n                <Route path=\"/request\" element={<PrivateRoute><DocumentRequestForm /></PrivateRoute>} />\n                <Route path=\"/dashboard\" element={<PrivateRoute><Dashboard /></PrivateRoute>} />\n                <Route path=\"/guest/dashboard\" element={<PrivateRoute><GuestDashboard /></PrivateRoute>} />\n                <Route path=\"/request-document\" element={<PrivateRoute><DocumentRequestForm /></PrivateRoute>} />\n                <Route path=\"/contact\" element={<PrivateRoute><InquiryForm /></PrivateRoute>} />\n                <Route path=\"/inquiries\" element={<PrivateRoute><InquiryForm /></PrivateRoute>} />\n                <Route path=\"/inquiry-tracker\" element={<StaffRoute><InquiryTracker /></StaffRoute>} />\n                {/* Staff Routes */}\n                <Route path=\"/staff-dashboard\" element={<StaffRoute><StaffDashboard /></StaffRoute>} />\n                <Route path=\"/document-processing\" element={<StaffRoute>{React.createElement(require('./components/DocumentProcessing').default)}</StaffRoute>} />\n                <Route path=\"/templates-manager\" element={<StaffRoute><TemplatesManager /></StaffRoute>} />\n                <Route path=\"/staff/inbox\" element={<StaffRoute><StaffInbox /></StaffRoute>} />\n                {/* Admin Routes */}\n                <Route path=\"/admin/dashboard\" element={<AdminRoute><AdminDashboard /></AdminRoute>} />\n                <Route path=\"/admin/messages\" element={<AdminRoute><MessageInbox /></AdminRoute>} />\n                <Route path=\"/admin/verification-requests\" element={<AdminRoute><VerificationRequests /></AdminRoute>} />\n                {/* Announcements listing for residents/staff */}\n                <Route path=\"/announcements\" element={<PrivateRoute><AnnouncementsList /></PrivateRoute>} />\n                {/* Admin-only announcement compose page */}\n                <Route path=\"/admin/announcements\" element={<AdminRoute><Announcements /></AdminRoute>} />\n                <Route path=\"/admin\" element={<Navigate to=\"/admin/dashboard\" replace />} />\n                <Route path=\"/admin/users\" element={<AdminRoute><UserManagement /></AdminRoute>} />\n                <Route path=\"/admin/activity\" element={<AdminRoute><ActivityLogs /></AdminRoute>} />\n                <Route path=\"/admin/statistics\" element={<AdminRoute><Statistics /></AdminRoute>} />\n                <Route path=\"/admin/settings\" element={<AdminRoute><SystemSettings /></AdminRoute>} />\n                {/* Resident Profile Route */}\n                <Route path=\"/profile\" element={<PrivateRoute><ResidentPortal /></PrivateRoute>} />\n                <Route path=\"/document-history\" element={<PrivateRoute><DocumentHistory /></PrivateRoute>} />\n                <Route path=\"/inbox\" element={<PrivateRoute><Inbox /></PrivateRoute>} />\n              </Route>\n            </Routes>\n          </AuthProvider>\n        </Router>\n      </ConfigProvider>\n    </ThemeProvider>\n  );\n};\n\nexport type { AppProps };\nexport default App;\n","import dayjs from 'dayjs';\r\n\r\n/**\r\n * Format a date (string|Date|number) into MM/DD/YYYY or MM/DD/YYYY h:mm:ss A\r\n */\r\nexport function formatDate(d?: string | Date | number | null, includeTime = false): string {\r\n  if (!d) return '';\r\n  try {\r\n    const dt = dayjs(d);\r\n    if (!dt.isValid()) return String(d);\r\n    return includeTime ? dt.format('MM/DD/YYYY h:mm:ss A') : dt.format('MM/DD/YYYY');\r\n  } catch (e) {\r\n    return String(d);\r\n  }\r\n}\r\n","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"DocumentProcessing_wrapper__pfVPn\",\"pageTitle\":\"DocumentProcessing_pageTitle__D8GpE\",\"loadingWrap\":\"DocumentProcessing_loadingWrap__xlSQ5\",\"controls\":\"DocumentProcessing_controls__u0Sob\",\"controlInput\":\"DocumentProcessing_controlInput__-hbBH\",\"controlSelect\":\"DocumentProcessing_controlSelect__nZaI2\",\"controlDate\":\"DocumentProcessing_controlDate__m+Df+\",\"mobileList\":\"DocumentProcessing_mobileList__u5S-F\",\"mobileCard\":\"DocumentProcessing_mobileCard__X+Bdw\",\"mobileCardRow\":\"DocumentProcessing_mobileCardRow__G0Y4m\",\"mobileMeta\":\"DocumentProcessing_mobileMeta__nv7Sk\",\"iconWrap\":\"DocumentProcessing_iconWrap__ZBZeq\",\"mobileTitleWrap\":\"DocumentProcessing_mobileTitleWrap__hPpzX\",\"mobileTitle\":\"DocumentProcessing_mobileTitle__qbZm1\",\"mobileSubtitle\":\"DocumentProcessing_mobileSubtitle__5tgj9\",\"mobileActions\":\"DocumentProcessing_mobileActions__YP+6O\",\"statusTag\":\"DocumentProcessing_statusTag__8gEac\",\"actionButtons\":\"DocumentProcessing_actionButtons__wO1pV\",\"uploadDate\":\"DocumentProcessing_uploadDate__2r7Ac\",\"modalContent\":\"DocumentProcessing_modalContent__t0wT7\",\"previewWrapper\":\"DocumentProcessing_previewWrapper__ZvIzx\",\"previewPane\":\"DocumentProcessing_previewPane__hKjGX\",\"requestPane\":\"DocumentProcessing_requestPane__QS8mv\",\"previewHtml\":\"DocumentProcessing_previewHtml__VWJy5\",\"previewFooter\":\"DocumentProcessing_previewFooter__2dLJh\",\"generateButton\":\"DocumentProcessing_generateButton__RBIQS\"};","import { useRef } from 'react';\r\nimport React, { useEffect, useState } from 'react';\r\nimport './DocumentProcessingHighlight.css';\r\nimport styles from './DocumentProcessing.module.css';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport { Card, Typography, Modal, Spin, Table, Input, Tooltip, Tag, Space, Button, Radio, Select, DatePicker, notification } from 'antd';\r\nimport { SearchOutlined } from '@ant-design/icons';\r\nimport { FileWordOutlined, FilePdfOutlined, FileImageOutlined, EyeOutlined } from '@ant-design/icons';\r\nimport { documentsAPI, API_URL } from '../services/api';\r\nimport { formatDate as formatDateUtil } from '../utils/formatDate';\r\nimport { generateFilledDocx } from '../services/generateFilledDocx';\r\n\r\nconst DocumentProcessing: React.FC = () => {\r\n  const [files, setFiles] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  const [selectedFile, setSelectedFile] = useState<any | null>(null);\r\n  const [requestedTypes, setRequestedTypes] = useState<string[]>([]);\r\n  const [fileRequestMap, setFileRequestMap] = useState<Record<string, any>>({});\r\n  const [previewVisible, setPreviewVisible] = useState(false);\r\n  const [previewHtml, setPreviewHtml] = useState('');\r\n  const [previewLoading, setPreviewLoading] = useState(false);\r\n  const [previewRequests, setPreviewRequests] = useState<any[]>([]);\r\n  const [previewTemplateHtml, setPreviewTemplateHtml] = useState<string>('');\r\n  const [previewSelectedRequestId, setPreviewSelectedRequestId] = useState<string | null>(null);\r\n  const [showPreviewRequests, setShowPreviewRequests] = useState<boolean>(true);\r\n  const rowRefs = useRef<Record<string, HTMLDivElement | null>>({});\r\n  const [prioritizeModalVisible, setPrioritizeModalVisible] = useState(false);\r\n  const [prioritizeCandidates] = useState<any[]>([]);\r\n  const [selectedPriorityRequest, setSelectedPriorityRequest] = useState<string | null>(null);\r\n  const [prioritizeTargetFileId, setPrioritizeTargetFileId] = useState<string | null>(null);\r\n  const [generatedCopyId, setGeneratedCopyId] = useState<string | null>(null);\r\n  const [generatedModalVisible, setGeneratedModalVisible] = useState(false);\r\n  const [processedDocId, setProcessedDocId] = useState<string | null>(null);\r\n  const [isMobile, setIsMobile] = useState<boolean>(false);\r\n  const [filterQuery, setFilterQuery] = useState<string>('');\r\n  const [filterType, setFilterType] = useState<string | null>(null);\r\n  const [filterStatus, setFilterStatus] = useState<string | null>(null);\r\n  const [filterRange, setFilterRange] = useState<any | null>(null);\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const openRequestIdFromNav = (location && (location.state as any) && (location.state as any).openRequestId) ? (location.state as any).openRequestId : null;\r\n\r\n  // Helpers to work with fileRequestMap which stores arrays per file id\r\n  const getRequestsForFile = React.useCallback((fileId: string) => {\r\n    const v = fileRequestMap[fileId];\r\n    if (!v) return [];\r\n    return Array.isArray(v) ? v : [v];\r\n  }, [fileRequestMap]);\r\n\r\n  const getPrimaryRequest = (fileId: string) => {\r\n    const arr = getRequestsForFile(fileId);\r\n    return arr.length ? arr[0] : null;\r\n  };\r\n\r\n  const getPrioritizedRequest = React.useCallback((fileId: string) => {\r\n    const arr = getRequestsForFile(fileId);\r\n    if (!arr || !arr.length) return null;\r\n    const found = arr.find((r: any) => ((r.notes && r.notes.toString().toLowerCase().includes('priority')) || r.priority === true));\r\n    return found || arr[0];\r\n  }, [getRequestsForFile]);\r\n\r\n  // refs for functions used by earlier effects to avoid use-before-define lint warnings\r\n  const handleProcessClickRef = useRef<((file: any) => Promise<void>) | null>(null);\r\n  const renderPreviewForRequestRef = useRef<((id: string) => Promise<void>) | null>(null);\r\n  // Fetch files and requests and build fileRequestMap. Extracted so we can call it after prioritization.\r\n  const fetchFilesAndRequests = async () => {\r\n    setLoading(true);\r\n    try {\r\n      // Fetch all GridFS files\r\n      const fileList = await documentsAPI.listFiles();\r\n      // Fetch document requests (all, for staff/admin; use getMyDocuments for user)\r\n      const requests = await documentsAPI.getDocumentRecords();\r\n      // Extract unique requested types (normalize to lowercase for matching)\r\n      const types: string[] = Array.from(new Set((requests || []).map((r: any) => (r.type || '').toLowerCase()).filter(Boolean)));\r\n      setRequestedTypes(types);\r\n      // Map files to their matching requests (by type in filename)\r\n      // We store an array per file id to support multiple requests for the same template/file\r\n      const fileRequestMapLocal: Record<string, any> = {};\r\n      // Helper to normalize strings: remove all non-alphanumeric chars, lowercase\r\n      const normalize = (str: string) => (str || '').replace(/[^a-zA-Z0-9]/g, '').toLowerCase();\r\n      fileList.forEach((file: any) => {\r\n        if (!file || !file.filename) return;\r\n        const normalizedFilename = normalize(file.filename);\r\n        // Find all requests whose type matches filename (robust normalization)\r\n        const matchedRequests = (requests || []).filter((req: any) =>\r\n          req.type && normalizedFilename.includes(normalize(req.type))\r\n        );\r\n        if (matchedRequests && matchedRequests.length) fileRequestMapLocal[file._id] = matchedRequests;\r\n      });\r\n      // Filter files to only those matching requested types\r\n      const filteredFiles = fileList.filter((file: any) => {\r\n        if (!file || !file.filename) return false;\r\n        if (types.length === 0) return true; // If no requests, show all\r\n        const normalizedFilename = file.filename.replace(/[_\\s]/g, '').toLowerCase();\r\n        return types.some((type: string) => normalizedFilename.includes(type.replace(/[_\\s]/g, '')));\r\n      });\r\n      setFiles(filteredFiles);\r\n      setFileRequestMap(fileRequestMapLocal);\r\n    } catch (err) {\r\n      setFileRequestMap({});\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchFilesAndRequests();\r\n    const onResize = () => setIsMobile(window.innerWidth <= 720);\r\n    onResize();\r\n    window.addEventListener('resize', onResize);\r\n    return () => window.removeEventListener('resize', onResize);\r\n  }, []);\r\n\r\n  // After files and mapping are fetched, if navigation included an openRequestId, open the preview\r\n  useEffect(() => {\r\n    if (!openRequestIdFromNav) return;\r\n    // Find the file that contains this request\r\n    const fileId = Object.keys(fileRequestMap).find(fid => {\r\n      const arr = Array.isArray(fileRequestMap[fid]) ? fileRequestMap[fid] : (fileRequestMap[fid] ? [fileRequestMap[fid]] : []);\r\n      return arr.some((r: any) => (r._id || r.requestId) === openRequestIdFromNav);\r\n    });\r\n    if (fileId) {\r\n      const file = files.find(f => f._id === fileId);\r\n      if (file) {\r\n        // open preview for that file and request\r\n        setSelectedFile(file);\r\n        // call via refs to avoid use-before-define issues\r\n        (async () => {\r\n          try {\r\n            await handleProcessClickRef.current?.(file);\r\n            setPreviewSelectedRequestId(openRequestIdFromNav);\r\n            await renderPreviewForRequestRef.current?.(openRequestIdFromNav as string);\r\n            setPreviewVisible(true);\r\n          } catch (e) {}\r\n        })();\r\n      }\r\n    }\r\n    else {\r\n      // No matching file found in the mapping. Try fetching the request directly and open a lightweight preview\r\n      (async () => {\r\n        try {\r\n          if ((documentsAPI as any).getDocumentById) {\r\n            const req = await (documentsAPI as any).getDocumentById(openRequestIdFromNav);\r\n            if (req) {\r\n              // Ensure previewRequests contains this request and open the preview modal\r\n              setPreviewRequests([req]);\r\n              setPreviewSelectedRequestId(openRequestIdFromNav);\r\n              // Build a simple previewHtml from the request.fieldValues if template HTML isn't available\r\n              try {\r\n                const fieldValues = req.fieldValues || {};\r\n                const keys = Object.keys(fieldValues);\r\n                if (keys.length) {\r\n                  const tableHtml = `\r\n                    <table style=\"width:100%;border-collapse:collapse;\">\r\n                      <thead>\r\n                        <tr>\r\n                          <th style='border:1px solid #ccc;padding:8px;text-align:left;'>Field</th>\r\n                          <th style='border:1px solid #ccc;padding:8px;text-align:left;'>Submitted Value</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody>\r\n                        ${keys.map(k => `<tr><td style='border:1px solid #ccc;padding:8px;'>${k}</td><td style='border:1px solid #ccc;padding:8px;'>${(fieldValues[k] || '')}</td></tr>`).join('')}\r\n                      </tbody>\r\n                    </table>\r\n                    // when we open a preview for a request that wasn't tied to a specific file in mapping,\r\n                    // attempt to scroll to and highlight the request's entry if present in the UI\r\n                    setTimeout(() => {\r\n                      try {\r\n                        const el = rowRefs.current[openRequestIdFromNav];\r\n                        if (el && el.scrollIntoView) {\r\n                          el.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n                          el.classList.add('cv-highlight');\r\n                          if (highlightTimeoutRef.current) window.clearTimeout(highlightTimeoutRef.current);\r\n                          // remove highlight after 2s\r\n                          // @ts-ignore - window.setTimeout returns number in browser\r\n                          highlightTimeoutRef.current = window.setTimeout(() => el.classList.remove('cv-highlight'), 2000);\r\n                        }\r\n                      } catch (e) {}\r\n                    }, 120);\r\n                  `;\r\n                  setPreviewHtml(tableHtml);\r\n                } else {\r\n                  setPreviewHtml('<div style=\"color:#666\">No submitted field values available.</div>');\r\n                }\r\n              } catch (e) {\r\n                setPreviewHtml('<div style=\"color:red\">Failed to build preview.</div>');\r\n              }\r\n              setPreviewVisible(true);\r\n            }\r\n          }\r\n        } catch (e) {\r\n          // ignore  best effort\r\n        }\r\n      })();\r\n    }\r\n    // clear navigation state so it doesn't re-open repeatedly\r\n    try { navigate(location.pathname, { replace: true, state: {} }); } catch (e) {}\r\n  }, [fileRequestMap, files, navigate, location.pathname, openRequestIdFromNav]);\r\n\r\n  // handleCardClick removed (unused)\r\n\r\n  // openPrioritizeModal removed (unused)\r\n\r\n  const confirmPrioritize = async () => {\r\n    if (!selectedPriorityRequest) {\r\n      alert('Select a request to prioritize');\r\n      return;\r\n    }\r\n    try {\r\n      if ((documentsAPI as any).prioritize) {\r\n        await (documentsAPI as any).prioritize(selectedPriorityRequest);\r\n      } else if (documentsAPI.updateDocumentStatus) {\r\n        // updateDocumentStatus requires a status; use current request status or 'pending' and add notes flag\r\n        let currentReq: any = null;\r\n        for (const v of Object.values(fileRequestMap)) {\r\n          const arr = Array.isArray(v) ? v : [v];\r\n          const found = arr.find((r: any) => (r._id || r.requestId) === selectedPriorityRequest);\r\n          if (found) {\r\n            currentReq = found;\r\n            break;\r\n          }\r\n        }\r\n        const currentStatus = currentReq?.status || 'pending';\r\n        await documentsAPI.updateDocumentStatus(selectedPriorityRequest, { status: currentStatus, notes: 'PRIORITY' });\r\n      }\r\n\r\n      setPrioritizeModalVisible(false);\r\n      // Refresh files and request mapping so UI reflects priority changes\r\n      await fetchFilesAndRequests();\r\n\r\n      // Update only the specific file mapping if possible\r\n      if (prioritizeTargetFileId) {\r\n        try {\r\n          const refreshed = getRequestsForFile(prioritizeTargetFileId);\r\n          let updated: any = refreshed.find((r: any) => (r._id || r.requestId) === selectedPriorityRequest) || null;\r\n\r\n          if (!updated && (documentsAPI as any).getDocumentById) {\r\n            try {\r\n              const fetched = await (documentsAPI as any).getDocumentById(selectedPriorityRequest);\r\n              updated = fetched;\r\n            } catch (e) {\r\n              updated = null;\r\n            }\r\n          }\r\n\r\n          if (updated) {\r\n            setFileRequestMap(prev => {\r\n              const cloned: Record<string, any> = { ...prev };\r\n              cloned[prioritizeTargetFileId] = Array.isArray(refreshed) ? refreshed : (refreshed ? [refreshed] : []);\r\n              return cloned;\r\n            });\r\n          } else {\r\n            // fallback: mark the selected request as prioritized in the specific file mapping\r\n            setFileRequestMap(prev => {\r\n              try {\r\n                const cloned: Record<string, any> = { ...prev };\r\n                const v = cloned[prioritizeTargetFileId];\r\n                const arr = Array.isArray(v) ? v.slice() : (v ? [v] : []);\r\n                const idx = arr.findIndex((r: any) => (r._id || r.requestId) === selectedPriorityRequest);\r\n                if (idx !== -1) {\r\n                  arr[idx] = { ...arr[idx], priority: true, notes: (arr[idx].notes || '') + ' PRIORITY' };\r\n                }\r\n                cloned[prioritizeTargetFileId] = arr;\r\n                return cloned;\r\n              } catch (e) {\r\n                return prev;\r\n              }\r\n            });\r\n          }\r\n        } catch (e) {\r\n          // ignore and leave UI refreshed from fetchFilesAndRequests\r\n        }\r\n      }\r\n\r\n      // If preview modal is open for this file, update previewRequests and selection so modal reflects the change\r\n      if (selectedFile && prioritizeTargetFileId && selectedFile._id === prioritizeTargetFileId) {\r\n        const updatedRequests = getRequestsForFile(prioritizeTargetFileId);\r\n        setPreviewRequests(updatedRequests);\r\n        setPreviewSelectedRequestId(selectedPriorityRequest);\r\n        // re-render preview for the newly prioritized request\r\n        if (selectedPriorityRequest) {\r\n          await renderPreviewForRequest(selectedPriorityRequest);\r\n        }\r\n      }\r\n\r\n      alert('Prioritization saved');\r\n      setPrioritizeTargetFileId(null);\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Failed to prioritize');\r\n    }\r\n  };\r\n\r\n  const handleProcessClick = React.useCallback(async (file: any) => {\r\n    setPreviewVisible(true);\r\n    setPreviewLoading(true);\r\n    setPreviewHtml('');\r\n    try {\r\n      // Populate preview-related state: all requests for file and template HTML\r\n  const requests = getRequestsForFile(file._id) || [];\r\n  // Only show pending requests in the preview selector\r\n  const pendingRequests = requests.filter((r: any) => ((r.status || '').toString().toLowerCase() === 'pending'));\r\n  setPreviewRequests(pendingRequests);\r\n  const prioritized = getPrioritizedRequest(file._id);\r\n  // Prefer prioritized request if it is pending, otherwise fall back to the first pending request\r\n  const firstPending = pendingRequests[0] || null;\r\n  const prioritizedPending = prioritized && ((prioritized.status || '').toString().toLowerCase() === 'pending') ? prioritized : null;\r\n  setPreviewSelectedRequestId(prioritizedPending ? (prioritizedPending._id || prioritizedPending.requestId) : (firstPending?._id || firstPending?.requestId || null));\r\n      // Fetch template preview HTML once for this file\r\n      const previewResp = await (await import('../services/api')).axiosPublic.get(`/documents/preview/${file._id}`, { params: { format: 'html' }, responseType: 'text' });\r\n      const html = previewResp && previewResp.data ? previewResp.data : '';\r\n      setPreviewTemplateHtml(html);\r\n      // Render preview for the selected/prioritized request\r\n  const selectedReqId = prioritizedPending ? (prioritizedPending._id || prioritizedPending.requestId) : (firstPending?._id || firstPending?.requestId || null);\r\n      if (selectedReqId) await renderPreviewForRequestRef.current?.(selectedReqId);\r\n    } catch (err) {\r\n      setPreviewHtml('<div style=\"color:red\">Failed to load preview.</div>');\r\n    }\r\n    setPreviewLoading(false);\r\n  }, [getRequestsForFile, getPrioritizedRequest]);\r\n\r\n  // assign refs so earlier effects can call the latest implementations\r\n  handleProcessClickRef.current = handleProcessClick;\r\n\r\n  // Render previewHtml for a specific request id using cached previewTemplateHtml\r\n  const renderPreviewForRequest = React.useCallback(async (requestId: string) => {\r\n    try {\r\n      const req = Object.values(fileRequestMap).flat().find((r: any) => (r._id || r.requestId) === requestId) || null;\r\n  const fieldValues = req?.fieldValues || {};\r\n      // If template html not present, nothing to render\r\n      const html = previewTemplateHtml || '';\r\n      const regex = /\\{(.*?)\\}/g;\r\n      let match;\r\n      const fields: string[] = [];\r\n      while ((match = regex.exec(html)) !== null) {\r\n        fields.push(match[1].trim());\r\n      }\r\n      if (fields.length > 0) {\r\n        const tableHtml = `\r\n          <table style=\"width:100%;border-collapse:collapse;\">\r\n            <thead>\r\n              <tr>\r\n                <th style='border:1px solid #ccc;padding:8px;text-align:left;'>Field</th>\r\n                <th style='border:1px solid #ccc;padding:8px;text-align:left;'>Submitted Value</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              ${fields.map(f => {\r\n                const value = fieldValues[f] || '';\r\n                return `<tr><td style='border:1px solid #ccc;padding:8px;'>${f}</td><td style='border:1px solid #ccc;padding:8px;'>${value}</td></tr>`;\r\n              }).join('')}\r\n            </tbody>\r\n          </table>\r\n        `;\r\n        setPreviewHtml(tableHtml);\r\n      } else {\r\n        setPreviewHtml('<div style=\"color:red\">No { ... } content found.</div>');\r\n      }\r\n    } catch (err) {\r\n      setPreviewHtml('<div style=\"color:red\">Failed to load preview.</div>');\r\n    }\r\n  }, [fileRequestMap, previewTemplateHtml]);\r\n\r\n  // assign ref for preview renderer\r\n  renderPreviewForRequestRef.current = renderPreviewForRequest;\r\n\r\n  // Open preview for a selected record (used by table Actions)\r\n  const openPreview = async (record: any) => {\r\n    setSelectedFile(record);\r\n    await handleProcessClick(record);\r\n  };\r\n\r\n  // (Removed download and status update helpers  preview-only workflow)\r\n \r\n  if (loading) {\r\n    return (\r\n      <div className={styles.loadingWrap}>\r\n        <Spin size=\"large\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      <Typography.Title level={3} className={styles.pageTitle}></Typography.Title>\r\n      {/* Document Processing Table */}\r\n      <Card title=\"Document Processing\" extra={\r\n        <div className={styles.controls}>\r\n          <Input\r\n            prefix={<SearchOutlined />}\r\n            placeholder=\"Search documents\"\r\n            className={styles.controlInput}\r\n            value={filterQuery}\r\n            onChange={(e) => setFilterQuery(e.target.value)}\r\n            onPressEnter={() => {}}\r\n          />\r\n          <Select allowClear placeholder=\"Document Type\" className={styles.controlSelect} value={filterType} onChange={(v) => setFilterType(v)}>\r\n            {requestedTypes.map((t) => <Select.Option key={t} value={t}>{t}</Select.Option>)}\r\n          </Select>\r\n          <Select allowClear placeholder=\"Status\" className={styles.controlSelect} value={filterStatus} onChange={(v) => setFilterStatus(v)}>\r\n            <Select.Option value=\"pending\">Pending</Select.Option>\r\n            <Select.Option value=\"approved\">Approved</Select.Option>\r\n            <Select.Option value=\"rejected\">Rejected</Select.Option>\r\n          </Select>\r\n          <DatePicker.RangePicker className={styles.controlDate} onChange={(vals) => setFilterRange(vals)} />\r\n        </div>\r\n      }>\r\n        {isMobile ? (\r\n          <div className={styles.mobileList}>\r\n            {files.filter((file: any) => {\r\n              // client-side filtering\r\n              if (filterQuery && !(file.filename || '').toLowerCase().includes(filterQuery.toLowerCase())) return false;\r\n              if (filterType && ((file.type || '').toLowerCase() !== filterType.toLowerCase())) return false;\r\n              const primary = getPrimaryRequest(file._id);\r\n              const status = primary?.status || '';\r\n              if (filterStatus && status.toLowerCase() !== filterStatus.toLowerCase()) return false;\r\n              if (filterRange && filterRange[0] && filterRange[1] && file.uploadDate) {\r\n                const d = new Date(file.uploadDate);\r\n                const start = filterRange[0].toDate();\r\n                const end = filterRange[1].toDate();\r\n                if (d < start || d > end) return false;\r\n              }\r\n              return true;\r\n            }).map((file: any) => {\r\n              const name = file.filename || '';\r\n              const ext = (name.split('.').pop() || '').toLowerCase();\r\n              let icon = <FileWordOutlined style={{ color: '#2B6CB0', fontSize: 20 }} />;\r\n              if (ext === 'pdf') icon = <FilePdfOutlined style={{ color: '#E53E3E', fontSize: 20 }} />;\r\n              if (['png', 'jpg', 'jpeg', 'gif', 'svg', 'bmp'].includes(ext)) icon = <FileImageOutlined style={{ color: '#319795', fontSize: 20 }} />;\r\n              const primary = getPrimaryRequest(file._id);\r\n              const status = primary?.status || '';\r\n              return (\r\n                  <Card key={file._id} size=\"small\" className={styles.mobileCard} ref={(el: any) => { /* mobile cards keyed by primary request id if exists */\r\n                    const primary = getPrimaryRequest(file._id);\r\n                    const rid = primary && (primary._id || primary.requestId);\r\n                    if (rid) rowRefs.current[rid] = el;\r\n                  }}>\r\n                    <div className={styles.mobileCardRow}>\r\n                      <div className={styles.mobileMeta}>\r\n                        <div className={styles.iconWrap}>{icon}</div>\r\n                        <div className={styles.mobileTitleWrap}>\r\n                          <Tooltip title={name}><div className={styles.mobileTitle}>{name.replace(/\\.docx$/i, '')}</div></Tooltip>\r\n                          <div className={styles.mobileSubtitle}>{file.type || 'Unknown'}</div>\r\n                        </div>\r\n                      </div>\r\n                      <div className={styles.mobileActions}>\r\n                        <Tag className={styles.statusTag} color={status === 'pending' ? 'orange' : status === 'approved' ? 'green' : status === 'rejected' ? 'red' : 'default'}>{(status || '').toUpperCase()}</Tag>\r\n                        <div className={styles.actionButtons}><Button size=\"small\" icon={<EyeOutlined />} onClick={() => openPreview(file)}>{isMobile ? null : 'Preview'}</Button></div>\r\n                        <div className={styles.uploadDate}>{file.uploadDate ? formatDateUtil(file.uploadDate) : ''}</div>\r\n                      </div>\r\n                    </div>\r\n                  </Card>\r\n                );\r\n            })}\r\n            </div>\r\n        ) : (\r\n          <Table\r\n            rowKey={(record) => record._id}\r\n            dataSource={files.filter((file: any) => {\r\n              if (filterQuery && !(file.filename || '').toLowerCase().includes(filterQuery.toLowerCase())) return false;\r\n              if (filterType && ((file.type || '').toLowerCase() !== filterType.toLowerCase())) return false;\r\n              const primary = getPrimaryRequest(file._id);\r\n              const status = primary?.status || '';\r\n              if (filterStatus && status.toLowerCase() !== filterStatus.toLowerCase()) return false;\r\n              if (filterRange && filterRange[0] && filterRange[1] && file.uploadDate) {\r\n                const d = new Date(file.uploadDate);\r\n                const start = filterRange[0].toDate();\r\n                const end = filterRange[1].toDate();\r\n                if (d < start || d > end) return false;\r\n              }\r\n              return true;\r\n            })}\r\n            pagination={{ pageSize: 10 }}\r\n            columns={[\r\n              {\r\n                title: 'File',\r\n                dataIndex: 'filename',\r\n                key: 'filename',\r\n                sorter: (a: any, b: any) => (a.filename || '').localeCompare(b.filename || ''),\r\n                render: (text: string, rec: any) => {\r\n                  // derive icon by extension\r\n                  const name = text || '';\r\n                  const ext = (name.split('.').pop() || '').toLowerCase();\r\n                  let icon = <FileWordOutlined style={{ color: '#2B6CB0' }} />;\r\n                  if (ext === 'pdf') icon = <FilePdfOutlined style={{ color: '#E53E3E' }} />;\r\n                  if (['png', 'jpg', 'jpeg', 'gif', 'svg', 'bmp'].includes(ext)) icon = <FileImageOutlined style={{ color: '#319795' }} />;\r\n                      return (\r\n                    <Tooltip title={name}>\r\n                      <span style={{ maxWidth: 280, display: 'inline-block', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>\r\n                        <Space align=\"center\">\r\n                          {icon}\r\n                          <span>{name.replace(/\\.docx$/i, '')}</span>\r\n                        </Space>\r\n                      </span>\r\n                    </Tooltip>\r\n                  );\r\n                }\r\n              },\r\n              // Type column removed per request\r\n              {\r\n                title: 'Status',\r\n                dataIndex: 'status',\r\n                key: 'status',\r\n                render: (_: any, record: any) => {\r\n                  // Show document availability (online/offline) based on GridFS file metadata\r\n                  // Prefer explicit flags if present, otherwise infer from contentType/length\r\n                  const file = record || {};\r\n                  const isOnline = (file.metadata && file.metadata.online === true) || (typeof file.length === 'number' ? file.length > 0 : Boolean(file.contentType));\r\n                  const label = isOnline ? 'ONLINE' : 'OFFLINE';\r\n                  const color = isOnline ? 'green' : 'red';\r\n                  return (<Tag color={color}>{label}</Tag>);\r\n                }\r\n              },\r\n              {\r\n                title: 'Uploaded On',\r\n                dataIndex: 'uploadDate',\r\n                key: 'uploadDate',\r\n                sorter: (a: any, b: any) => new Date(a.uploadDate).getTime() - new Date(b.uploadDate).getTime(),\r\n                render: (d: any) => d ? formatDateUtil(d) : ''\r\n              },\r\n              {\r\n                title: 'Actions',\r\n                key: 'actions',\r\n                render: (_: any, record: any) => (\r\n                  <Space>\r\n                    <Button size=\"small\" icon={<EyeOutlined />} onClick={() => openPreview(record)}>Preview</Button>\r\n                  </Space>\r\n                )\r\n              }\r\n            ]}\r\n            // Attach a rowClassName and onRow so we can populate rowRefs for direct scrolling/highlighting\r\n            rowClassName={(record) => ''}\r\n            onRow={(record) => {\r\n              const primary = getPrimaryRequest(record._id);\r\n              const rid = primary && (primary._id || primary.requestId);\r\n              return {\r\n                ref: (el: HTMLDivElement | null) => {\r\n                  if (rid) rowRefs.current[rid] = el;\r\n                }\r\n              } as any;\r\n            }}\r\n          />\r\n        )}\r\n      </Card>\r\n\r\n      <Modal\r\n        title={selectedFile ? selectedFile.filename.replace(/\\.docx$/i, '') : ''}\r\n        open={modalVisible}\r\n        onCancel={() => setModalVisible(false)}\r\n        footer={null}\r\n        width={800}\r\n      >\r\n        {selectedFile ? (\r\n          <div className={styles.modalContent}>\r\n            <Table\r\n              dataSource={[\r\n                      {\r\n                        ...selectedFile,\r\n                        requesterName: getPrimaryRequest(selectedFile._id)?.username || getPrimaryRequest(selectedFile._id)?.requesterName || 'Unknown',\r\n                        barangayID: getPrimaryRequest(selectedFile._id)?.barangayID || 'Unknown',\r\n                        status: getPrimaryRequest(selectedFile._id)?.status || 'Unknown',\r\n                      },\r\n              ]}\r\n              pagination={false}\r\n              rowKey=\"_id\"\r\n              columns={[\r\n                {\r\n                  title: 'Requester Name',\r\n                  dataIndex: 'requesterName',\r\n                  key: 'requesterName',\r\n                  render: (text: string) => text || 'Unknown',\r\n                },\r\n                {\r\n                  title: 'Barangay ID',\r\n                  dataIndex: 'barangayID',\r\n                  key: 'barangayID',\r\n                  render: (text: string) => text || 'Unknown',\r\n                },\r\n                {\r\n                  title: 'Status',\r\n                  dataIndex: 'status',\r\n                  key: 'status',\r\n                  render: (text: string) => text || 'Unknown',\r\n                },\r\n                {\r\n                  title: 'Actions',\r\n                  key: 'actions',\r\n                  render: (_: any, record: any) => (\r\n                    <div style={{ display: 'flex', gap: 8 }}>\r\n                      <button\r\n                        style={{ background: '#2196F3', color: '#fff', border: 'none', borderRadius: 6, padding: '4px 12px', cursor: 'pointer', fontWeight: 600 }}\r\n                        onClick={() => handleProcessClick(record)}\r\n                      >Process</button>\r\n                      <button style={{ background: '#43D96B', color: '#fff', border: 'none', borderRadius: 6, padding: '4px 12px', cursor: 'pointer', fontWeight: 600 }}>Complete</button>\r\n                      <button style={{ background: '#FF3B3B', color: '#fff', border: 'none', borderRadius: 6, padding: '4px 12px', cursor: 'pointer', fontWeight: 600 }}>Reject</button>\r\n                    </div>\r\n                  ),\r\n                },\r\n              ]}\r\n            />\r\n          </div>\r\n        ) : (\r\n          <Spin />\r\n        )}\r\n      </Modal>\r\n\r\n      <Modal\r\n        title=\"Generated / Processed Copy Saved\"\r\n        open={generatedModalVisible}\r\n        onCancel={() => setGeneratedModalVisible(false)}\r\n        footer={[\r\n          <Button key=\"close\" onClick={() => setGeneratedModalVisible(false)}>Close</Button>\r\n        ]}\r\n      >\r\n        <div>\r\n          <div style={{ marginBottom: 8 }}>A copy of the generated document was saved.</div>\r\n          {/* Only show generated-documents link when there is no processed copy available */}\r\n          {generatedCopyId && !processedDocId ? (\r\n            <div style={{ marginBottom: 10 }}>\r\n              <div style={{ marginBottom: 6 }}><strong>Generated metadata ID:</strong> <code>{generatedCopyId}</code></div>\r\n              <div>\r\n                <a href={`${API_URL.replace(/\\/$/, '')}/generated-documents/${generatedCopyId}/raw`} target=\"_blank\" rel=\"noreferrer\">Open generated copy (generated_documents)</a>\r\n              </div>\r\n            </div>\r\n          ) : null}\r\n\r\n          {processedDocId ? (\r\n            <div>\r\n              <div style={{ marginBottom: 6 }}><strong>Processed document ID:</strong> <code>{processedDocId}</code></div>\r\n              <div>\r\n                <a href={`${API_URL.replace(/\\/$/, '')}/processed-documents/${processedDocId}/raw`} target=\"_blank\" rel=\"noreferrer\">Open processed copy (processed_documents)</a>\r\n              </div>\r\n            </div>\r\n          ) : null}\r\n\r\n          {(!generatedCopyId && !processedDocId) ? <div>No saved copy id available.</div> : null}\r\n        </div>\r\n      </Modal>\r\n\r\n      {/* Prioritize Modal */}\r\n      <Modal\r\n        title=\"Prioritize Request\"\r\n        open={prioritizeModalVisible}\r\n        onCancel={() => setPrioritizeModalVisible(false)}\r\n        onOk={confirmPrioritize}\r\n        okText=\"Save Priority\"\r\n        cancelText=\"Cancel\"\r\n        okButtonProps={{ disabled: prioritizeCandidates.length === 0 || !selectedPriorityRequest }}\r\n      >\r\n        {prioritizeCandidates.length === 0 ? (\r\n          <div>No other requests found for this document type.</div>\r\n        ) : (\r\n          <Radio.Group\r\n            onChange={(e) => setSelectedPriorityRequest(e.target.value)}\r\n            value={selectedPriorityRequest}\r\n            style={{ display: 'flex', flexDirection: 'column', gap: 8 }}\r\n          >\r\n            {prioritizeCandidates.map((c: any) => (\r\n              <Radio key={c.requestId || c.fileId} value={c.requestId || c.fileId} style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                <div style={{ display: 'flex', flexDirection: 'column' }}>\r\n                  <strong>{c.requesterName}</strong>\r\n                  <small style={{ color: '#666' }}>{c.createdAt ? formatDateUtil(c.createdAt) : ''}</small>\r\n                </div>\r\n                <div style={{ marginLeft: 12 }}>\r\n                  {/* show a small hint if this candidate is currently selected as priority */}\r\n                  {selectedPriorityRequest === (c.requestId || c.fileId) ? <Tag color=\"red\">Selected</Tag> : null}\r\n                </div>\r\n              </Radio>\r\n            ))}\r\n          </Radio.Group>\r\n        )}\r\n      </Modal>\r\n\r\n      {/* Preview Modal for Process */}\r\n      <Modal\r\n        title={selectedFile ? `Preview: ${selectedFile.filename.replace(/\\.docx$/i, '')}` : 'Preview'}\r\n        open={previewVisible}\r\n        onCancel={() => setPreviewVisible(false)}\r\n        footer={null}\r\n        width={isMobile ? '100%' : 900}\r\n        styles={{ body: { padding: isMobile ? 10 : undefined } }}\r\n      >\r\n        {previewLoading ? (\r\n          <Spin />\r\n        ) : (\r\n          <>\r\n            {/* Mobile toggle to show/hide the request selector to give more space to preview */}\r\n            {isMobile ? (\r\n              <div style={{ display: 'flex', justifyContent: 'flex-end', marginBottom: 8 }}>\r\n                <Button size=\"small\" onClick={() => setShowPreviewRequests((s) => !s)}>{showPreviewRequests ? 'Hide Requests' : 'Show Requests'}</Button>\r\n              </div>\r\n            ) : null}\r\n\r\n            <div className={styles.previewWrapper}>\r\n              <div className={styles.previewPane}>\r\n                <div className={styles.previewHtml} dangerouslySetInnerHTML={{ __html: previewHtml }} />\r\n              </div>\r\n\r\n              {showPreviewRequests ? (\r\n                <div className={styles.requestPane}>\r\n                  <div style={{ marginTop: isMobile ? 6 : 12, padding: 8, border: '1px solid #eee', borderRadius: 6 }}>\r\n                    <div style={{ marginBottom: 8, fontWeight: 600 }}>Select Request to Preview</div>\r\n                    <div style={{ maxHeight: 300, overflowY: 'auto', paddingRight: 6 }}>\r\n                      <Radio.Group\r\n                        value={previewSelectedRequestId}\r\n                        onChange={async (e) => {\r\n                          const newId = e.target.value as string;\r\n                          setPreviewSelectedRequestId(newId);\r\n                          // re-render preview for selected request\r\n                          await renderPreviewForRequest(newId);\r\n                        }}\r\n                        style={{ display: 'flex', flexDirection: 'column', gap: 8 }}\r\n                      >\r\n                        {previewRequests && previewRequests.length ? previewRequests.map((r: any) => (\r\n                          <Radio key={(r._id || r.requestId)} value={(r._id || r.requestId)}>\r\n                            <div style={{ display: 'flex', justifyContent: 'space-between', width: '100%' }}>\r\n                              <div>\r\n                                <div style={{ fontWeight: 600 }}>{r.username || r.requesterName || 'Unknown'}</div>\r\n                                <div style={{ fontSize: 12, color: '#666' }}>{r.createdAt ? formatDateUtil(r.createdAt) : ''}</div>\r\n                              </div>\r\n                              <div style={{ alignSelf: 'center' }}>{(r.notes && r.notes.toString().toLowerCase().includes('priority')) || r.priority ? <Tag color=\"red\">PRIORITY</Tag> : null}</div>\r\n                            </div>\r\n                          </Radio>\r\n                        )) : <div style={{ color: '#666' }}>No pending requests available for this file.</div>}\r\n                      </Radio.Group>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ) : null}\r\n            </div>\r\n\r\n            <div className={styles.previewFooter}>\r\n              {/* Complete button removed; Generate will also mark request complete after successful generation */}\r\n              <button\r\n                className={styles.generateButton}\r\n                onClick={async () => {\r\n                  if (!selectedFile) return;\r\n                  try {\r\n                    // Prefer the currently previewed request if available\r\n                    let request: any = null;\r\n                    if (previewSelectedRequestId) {\r\n                      // find in mapping\r\n                      const requestsForFile = getRequestsForFile(selectedFile._id);\r\n                      request = requestsForFile.find((r: any) => (r._id || r.requestId) === previewSelectedRequestId) || null;\r\n                    }\r\n                    // fallback to prioritized or primary\r\n                    if (!request) request = getPrioritizedRequest(selectedFile._id) || getPrimaryRequest(selectedFile._id);\r\n\r\n                    if (!request || !request.fieldValues) {\r\n                      alert('No document request or field values found for this file.');\r\n                      return;\r\n                    }\r\n\r\n                    // Generate filled docx via server endpoint (returns blob). Server may save the generated file and return X-Filled-File-Id header.\r\n                    const result = await generateFilledDocx(selectedFile._id, request.fieldValues, (request._id || request.requestId));\r\n                    const blob = result.blob;\r\n                    // Use the transaction/request id as the downloaded filename when available.\r\n                    // Prefer explicit transaction identifiers if present to avoid using resident/user ids.\r\n                    // Prefer transactionCode fields (server uses 'transactionCode'), fallback to older keys and finally server headers/ids\r\n                    const txId = (request && (request.transactionCode || request.transactionId || request.txId || request.transaction_id || request._id || request.requestId)) || result.transactionCode || result.generatedCopyId || result.processedDocId || null;\r\n                    const safeId = txId ? String(txId).replace(/[^a-zA-Z0-9-_.]/g, '_') : null;\r\n                    // Prefer transactionCode (returned in header) for filename, then request.transactionCode, then server filename, then safe id, then fallback\r\n                    const preferredCode = result.transactionCode || (request && request.transactionCode) || safeId || null;\r\n                    const serverFilename = preferredCode ? `${String(preferredCode).replace(/[^a-zA-Z0-9-_.]/g, '_')}.docx` : (result.filename || `filled_${selectedFile.filename || 'document'}.docx`);\r\n\r\n                    // Trigger download using server filename\r\n                    const url = window.URL.createObjectURL(new Blob([blob], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' }));\r\n                    const link = document.createElement('a');\r\n                    link.href = url;\r\n                    link.setAttribute('download', serverFilename);\r\n                    document.body.appendChild(link);\r\n                    link.click();\r\n                    link.parentNode?.removeChild(link);\r\n                    window.URL.revokeObjectURL(url);\r\n\r\n                    // If server returned a saved id header, we assume it's already saved to GridFS; refresh listing\r\n                    const savedId = result.savedId || null;\r\n                    if (savedId) {\r\n                      // Refresh list so uploaded/generated file appears\r\n                      await fetchFilesAndRequests();\r\n                      const processedId = result.processedDocId || null;\r\n                      if (processedId) {\r\n                        notification.open({\r\n                          message: 'Generated copy saved',\r\n                          description: (\r\n                            <div>Saved to processed documents. <a href={`${API_URL.replace(/\\/$/, '')}/processed-documents/${processedId}/raw`} target=\"_blank\" rel=\"noreferrer\">Open processed copy</a></div>\r\n                          ),\r\n                          duration: 8,\r\n                        });\r\n                        setProcessedDocId(processedId);\r\n                        setGeneratedModalVisible(true);\r\n                      } else {\r\n                        notification.open({ message: 'Generated document saved', description: 'Saved to server processed documents.', duration: 6 });\r\n                      }\r\n                      if (result.generatedCopyId) {\r\n                        setGeneratedCopyId(result.generatedCopyId);\r\n                        setGeneratedModalVisible(true);\r\n                      }\r\n                    } else {\r\n                      // Attempt to upload the generated file to the documents endpoint so the backend will store .files and .chunks (GridFS)\r\n                      try {\r\n                        const form = new FormData();\r\n                        form.append('file', new Blob([blob], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' }), serverFilename);\r\n                        // include source metadata if helpful\r\n                        form.append('sourceTemplateId', selectedFile._id || '');\r\n                        form.append('requestId', (request._id || request.requestId) || '');\r\n                        // try a couple of likely endpoints\r\n                        const base = API_URL.replace(/\\/$/, '');\r\n                        let uploaded = false;\r\n                        // Prefer uploading directly into the processed_documents bucket if available on the server\r\n                        const tryUrls = [ `${base}/processed-documents/upload`, `${base}/documents/upload-inline`, `${base}/documents/upload`, `${base}/documents`, `${base}/admin/documents/upload` ];\r\n                        for (const u of tryUrls) {\r\n                          try {\r\n                            const resp = await fetch(u, { method: 'POST', body: form, credentials: 'include' });\r\n                            if (resp.ok) {\r\n                              uploaded = true;\r\n                              break;\r\n                            }\r\n                          } catch (e) {\r\n                            // continue\r\n                          }\r\n                        }\r\n                        if (uploaded) {\r\n                          await fetchFilesAndRequests();\r\n                          // show a non-blocking toast with a direct link to the processed copy when available\r\n                          const processedId = result.processedDocId || null;\r\n                          if (processedId) {\r\n                            notification.open({\r\n                              message: 'Generated copy saved',\r\n                              description: (\r\n                                <div>Saved to processed documents. <a href={`${API_URL.replace(/\\/$/, '')}/processed-documents/${processedId}/raw`} target=\"_blank\" rel=\"noreferrer\">Open processed copy</a></div>\r\n                              ),\r\n                              duration: 8,\r\n                            });\r\n                            setProcessedDocId(processedId);\r\n                            setGeneratedModalVisible(true);\r\n                          } else {\r\n                            notification.open({ message: 'Generated document uploaded', description: 'Uploaded to server processed documents.', duration: 6 });\r\n                          }\r\n                        } else {\r\n                          console.warn('Upload fallback failed; generated file was downloaded but not uploaded to documents collection.');\r\n                          alert('Generated document downloaded. Server-side save not confirmed.');\r\n                        }\r\n                      } catch (uploadErr) {\r\n                        console.error('Upload fallback error', uploadErr);\r\n                        alert('Generated document downloaded but upload to server failed.');\r\n                      }\r\n                    }\r\n                    // After successful generation (and attempted save), also mark the associated request as completed\r\n                    try {\r\n                      // Determine request id to mark as approved\r\n                      let requestId: string | null = previewSelectedRequestId;\r\n                      if (!requestId) {\r\n                        const r = getPrioritizedRequest(selectedFile._id) || getPrimaryRequest(selectedFile._id);\r\n                        requestId = (r && (r._id || r.requestId)) || null;\r\n                      }\r\n                      if (requestId) {\r\n                        if (documentsAPI.updateDocumentStatus) {\r\n                          await documentsAPI.updateDocumentStatus(requestId, { status: 'approved' });\r\n                        } else {\r\n                          await (await import('../services/api')).axiosInstance.patch(`/document-requests/${requestId}/process`);\r\n                        }\r\n                        // Refresh mapping/UI after marking complete\r\n                        await fetchFilesAndRequests();\r\n                        setPreviewVisible(false);\r\n                        alert('Request marked as completed.');\r\n                      }\r\n                    } catch (markErr) {\r\n                      console.warn('Failed to mark request complete after generation', (markErr as any)?.message || markErr);\r\n                    }\r\n                  } catch (err) {\r\n                    console.error('Generation error', err);\r\n                    alert('Failed to generate filled document.');\r\n                  }\r\n                    setPreviewVisible(false);\r\n                }}\r\n              >Generate</button>\r\n            </div>\r\n          </>\r\n        )}\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default DocumentProcessing;\r\n","import { axiosInstance } from './api';\r\n\r\nexport async function generateFilledDocx(fileId: string, fieldValues: Record<string, string>, requestId?: string) {\r\n  const payload: any = { fieldValues };\r\n  if (requestId) payload.requestId = requestId;\r\n  const response = await axiosInstance.post(`/documents/${fileId}/generate-filled`, payload, {\r\n    responseType: 'blob',\r\n  });\r\n  // Parse filename from Content-Disposition header if present\r\n  const contentDisposition = response.headers['content-disposition'] || response.headers['Content-Disposition'];\r\n  let filename = '';\r\n  if (contentDisposition) {\r\n    // Look for filename*=UTF-8''encoded or filename=\"...\" or filename=...\r\n    const fnStarMatch = contentDisposition.match(/filename\\*=(?:UTF-8'')?([^;\\n\\r]+)/i);\r\n    const fnMatch = contentDisposition.match(/filename=\"?([^\";]+)\"?/i);\r\n    if (fnStarMatch && fnStarMatch[1]) {\r\n      try {\r\n        filename = decodeURIComponent(fnStarMatch[1].replace(/^UTF-8''/, ''));\r\n      } catch (e) {\r\n        filename = fnStarMatch[1];\r\n      }\r\n    } else if (fnMatch && fnMatch[1]) {\r\n      filename = fnMatch[1];\r\n    }\r\n  }\r\n  const savedId = response.headers['x-filled-file-id'] || response.headers['X-Filled-File-Id'] || null;\r\n  // Prefer the processed GridFS id if available (server may store generated copies in processed_documents bucket)\r\n  const processedGridFsId = response.headers['x-processed-gridfs-id'] || response.headers['X-Processed-GridFS-Id'] || null;\r\n  const finalSavedId = processedGridFsId || savedId;\r\n  const generatedCopyId = response.headers['x-generated-doc-id'] || response.headers['X-Generated-Doc-Id'] || null;\r\n  const processedDocId = response.headers['x-processed-doc-id'] || response.headers['X-Processed-Doc-Id'] || null;\r\n  const transactionCode = response.headers['x-transaction-code'] || response.headers['X-Transaction-Code'] || null;\r\n\r\n  // Temporary debug: log what filename and transactionCode were returned by the server\r\n  // Remove or comment out this log after debugging in production\r\n  // eslint-disable-next-line no-console\r\n  console.log('[generateFilledDocx] transactionCode=', transactionCode, 'content-disposition filename=', filename);\r\n  return { blob: response.data, filename, savedId: finalSavedId, generatedCopyId, processedDocId, processedGridFsId, transactionCode };\r\n}\r\n"],"names":["LocalDatabase","constructor","db","getInstance","instance","initialize","this","openDB","upgrade","objectStoreNames","contains","createObjectStore","keyPath","createIndex","autoIncrement","addToSyncQueue","operation","collection","data","add","timestamp","Date","now","getAllFromSyncQueue","getAll","clearSyncQueue","tx","transaction","objectStore","clear","saveUser","user","put","getUser","id","get","getAllUsers","deleteUser","delete","saveDocument","document","getDocument","getAllDocuments","deleteDocument","saveSettings","settings","_objectSpread","_id","getSettings","localDB","SyncService","isOnline","navigator","onLine","syncInterval","handleOnline","async","console","log","syncWithServer","handleOffline","setupEventListeners","startSyncInterval","window","addEventListener","setInterval","pendingChanges","length","concat","change","processSyncItem","error","message","item","axiosInstance","post","performOperation","cleanup","clearInterval","removeEventListener","syncService","getTemplateText","type","then","res","text","notificationAPI","getNotifications","response","Array","isArray","err","fallback","err2","approveStaff","userId","notificationId","rejectStaff","reason","markAsRead","staffRegister","runtimeCfg","globalThis","__APP_CONFIG__","API_URL","API_BASE","process","axios","create","baseURL","headers","withCredentials","axiosPublic","getAbsoluteApiUrl","path","cfg","base","root","String","replace","endsWith","p","startsWith","authService","login","email","password","register","userData","logout","getCurrentUser","interceptors","request","use","config","token","localStorage","getItem","Authorization","_error$response","status","currentPath","location","pathname","requestUrl","url","responseURL","isLoginRequest","includes","removeItem","e","warn","sessionStorage","setItem","setTimeout","href","_e","Promise","reject","getInbox","verificationAPI","getRequests","verifyUser","verified","getFileUrl","fileId","approveRequest","requestId","rejectRequest","cancelRequest","getMyRequests","getRequestById","auth","credentials","documentsAPI","getMyDocuments","requestDocument","getDocumentById","catch","_err$response","getDocumentRecords","updateDocumentStatus","patch","processDocument","listFiles","deleteFile","updateFileStatus","getFilledDocument","previewFilledDocument","contact","submitInquiry","FormData","getMyInquiries","username","barangayID","params","undefined","getInquiryById","getAllInquiries","respondToInquiry","resolveInquiry","getAnnouncements","getAnnouncementById","requestsAPI","getAllRequests","getStaffAccessRequests","all","filter","r","toString","toLowerCase","admin","createUser","ev","CustomEvent","detail","dispatchEvent","updateUser","demoteUser","role","getSystemSettings","e1","e2","e3","e4","cached","dbErr","siteName","contactEmail","smtp","passwordSet","updateSystemSettings","resp","fall","testSmtp","to","getUsers","users","updateUserStatus","deleted","getActivityLogs","filters","getSystemStatistics","getStaffApplicants","getUserWithResident","getResidentByBarangayID","encodeURIComponent","getResident","residentId","updateResident","uploadResidentAvatar","file","form","append","getOfficials","resp2","pfall","createOfficial","updateOfficial","deleteOfficial","disableUser","enableUser","uploadOfficialPhoto","fetch","method","body","json","ok","msg","Error","fetchErr","approveStaffApplicant","applicantId","createAnnouncement","formData","listAdminAnnouncements","deleteAnnouncement","updateAnnouncement","residentPersonalInfoAPI","getPersonalInfo","candidates","updatePersonalInfo","authAPI","_ref","src","profileImageId","size","alt","className","style","cacheBust","cacheToken","u","errored","setErrored","useState","imageSrc","profileImage","profilePicture","srcUrl","finalSrc","currentSrc","useEffect","_jsx","fullName","width","height","onError","borderRadius","objectFit","name","trim","avatarUrl","Math","max","min","children","icon","background","color","s","mapSize","hasImage","Boolean","avatar","classes","join","img","AvatarImage","numericStyle","overflow","display","content","toUpperCase","alignItems","justifyContent","fontSize","floor","Option","Select","defaultFilterState","search","Inbox","_selectedInquiry$resp","_selectedInquiry$resp2","loading","setLoading","inquiries","setInquiries","setFilter","category","setCategory","replyLoading","setReplyLoading","selectedInquiry","setSelectedInquiry","setThreadVisible","leftCollapsed","setLeftCollapsed","listFullscreen","setListFullscreen","isMobile","setIsMobile","innerWidth","replyText","setReplyText","setLoadingThread","messagesEndRef","useRef","selectedResponsesLength","responses","current","scrollIntoView","behavior","storedProfile","JSON","parse","contactAPI","antdMessage","finally","onResize","filteredInquiries","inquiry","statusMatch","categoryMatch","searchMatch","residentName","subject","createdAt","toLocaleString","openThread","timeAgo","iso","diff","getTime","mins","hrs","days","MessageComment","author","datetime","align","_jsxs","styles","fontWeight","marginTop","getInitial","val","arguments","charAt","minHeight","padding","fontFamily","position","Card","maxWidth","margin","boxShadow","Row","gutter","marginBottom","Col","xs","sm","value","onChange","Input","Search","placeholder","allowClear","target","onSearch","gap","flex","Button","onClick","v","title","MenuUnfoldOutlined","MenuFoldOutlined","Typography","Title","level","Divider","Spin","Result","InboxOutlined","subTitle","maxHeight","overflowY","flexDirection","paddingTop","map","displayName","createdBy","initial","isSelected","Tooltip","placement","border","cursor","AppAvatar","right","top","zIndex","List","itemLayout","dataSource","renderItem","statusTag","Tag","typeIcon","Item","Text","strong","React","marginLeft","_Fragment","displayNameSelected","textAlign","paddingRight","alignSelf","originalSenderName","originalInitial","Paragraph","attachments","a","i","filename","isImage","contentType","test","rel","round","idx","authorRole","author_role","authorRaw","authorName","author_name","createdByName","createdByFullName","userName","createdById","currentUserId","authorDisplay","staffNameFromAssigned","assignedTo","match","find","staffName","staffFullName","isResidentReply","isCurrentUser","avatarNode","ref","flexShrink","paddingBottom","borderTop","el","scrollHeight","onKeyDown","key","shiftKey","preventDefault","warning","sendingKey","updatedInquiry","prev","success","resize","outline","onMouseOver","currentTarget","opacity","onMouseOut","disabled","SendOutlined","verticalAlign","TemplatesManager","templateList","setTemplateList","previewId","setPreviewId","setError","downloadError","setDownloadError","htmlContent","setHtmlContent","fetchTemplates","EyeOutlined","stopPropagation","responseType","DownloadOutlined","blob","URL","createObjectURL","createElement","download","appendChild","click","remove","revokeObjectURL","danger","DeleteOutlined","resList","dangerouslySetInnerHTML","__html","Upload","accept","showUploadList","customRequest","onSuccess","UploadOutlined","StaffInbox","residentsModalVisible","setResidentsModalVisible","residentsLoading","setResidentsLoading","residents","setResidents","useLocation","state","openId","openInquiryId","found","single","fetchAll","handleSendReply","isNewThread","recipientUsername","residentUsername","recipientBarangayID","residentBarangayID","label","payload","debug","selectedInquirySummary","created","filtered","Tabs","activeKey","k","TabPane","tab","PlusOutlined","list","adminAPI","firstName","lastName","brgy","barangay","Modal","open","onCancel","footer","resident","rn","temp","Meta","minWidth","textOverflow","whiteSpace","j","CheckOutlined","initialState","isAuthenticated","AuthContext","createContext","isStaff","isAdmin","isResident","mode","switchMode","useAuth","useContext","safeDecodeJwt","split","jwtDecode","authReducer","action","AuthProvider","dispatch","useReducer","stored","parsed","decoded","setMode","navigate","useNavigate","exp","_unused","isTokenValid","profile","stringify","handler","updatedUser","setUser","Provider","cookie","_state$user","_state$user2","_state$user3","newMode","DateTimeDisplay","setNow","timer","pad","n","padStart","date","getMonth","getDate","getFullYear","time","getHours","getMinutes","getSeconds","letterSpacing","marginRight","ClockCircleOutlined","Header","Content","Sider","Layout","navConfig","HomeOutlined","FileTextOutlined","MessageOutlined","TeamOutlined","BarChartOutlined","SettingOutlined","FileProtectOutlined","staff","FileDoneOutlined","HistoryOutlined","displayUser","residentImageSrc","setResidentImageSrc","collapsed","setCollapsed","api","origin","d","default","updated","__verifPollId","collapsedWidth","left","borderRight","overflowX","Menu","theme","selectedKeys","inlineCollapsed","items","_ref2","flexWrap","WebkitBackgroundClip","WebkitTextFillColor","Space","_displayUser","NotificationOutlined","UserOutlined","LogoutOutlined","Dropdown","menu","_ref3","trigger","shape","MenuOutlined","AppLayout","Outlet","Navigate","currentUser","extra","off","DEFAULT_PNG","previewUrl","photo","hasPhoto","photoUrl","photoPath","StatsPanel","_stats$filesCount","_users$total","_users$byRole$admin","_users$byRole","_users$byRole$staff","_users$byRole2","_users$byRole$residen","_users$byRole3","_stats$announcementsC","stats","setStats","mounted","filesRes","docRequestsRes","announcementsRes","resStats","statErr","filesCount","docRequestsCount","announcementsCount","total","byRole","CrownOutlined","it","md","lg","Statistic","LoginForm","residentAvatars","setResidentAvatars","avatarsStatus","setAvatarsStatus","guestModalVisible","setGuestModalVisible","emergencyModalVisible","setEmergencyModalVisible","guestForm","Form","useForm","officials","setOfficials","setOfficialsStatus","carouselRef","offs","info","fetchPublicOfficials","adminOffs","mapped","term","justify","variant","LeftOutlined","scrollBy","getOfficialPhotoSrc","t","onerror","RightOutlined","layout","onFinish","raw","values","identifier","respErr","_respErr$data","_respErr$data2","autoComplete","requiredMark","rules","required","prefix","Password","LockOutlined","htmlType","block","RouterLink","resetFields","onOk","vals","validateFields","contactNumber","intent","guestProfile","sessionToken","expiresAt","TextArea","rows","lineHeight","NAME_REGEX","validationSchema","Yup","matches","confirmPassword","oneOf","address","RegisterForm","setSuccess","adminUnlocked","showPassword","setShowPassword","showConfirmPassword","setShowConfirmPassword","fieldErrors","setFieldErrors","proofFile","setProofFile","govIdFile","setGovIdFile","proofList","setProofList","govIdList","setGovIdList","selfieList","setSelfieList","previewUrlsRef","Set","urls","forEach","uploadProgress","setUploadProgress","uploading","setUploading","uploadStatus","setUploadStatus","selfieFile","setSelfieFile","processActive","setProcessActive","processPercent","setProcessPercent","processMessage","setProcessMessage","formik","useFormik","initialValues","middleName","year","chars","rand","random","generateBarangayID","notRequired","validateOnChange","validateOnBlur","onSubmit","setSubmitting","resetForm","formErrors","validateForm","Object","keys","_uRes$data","_eRes$data","_cRes$data","uRes","eRes","cRes","uAvail","available","eAvail","cAvail","fe","checkErr","jsonErr","returnedToken","onUploadProgress","progressEvent","loaded","percentCompleted","uploadErr","errors","keyValue","usernameAvailable","setUsernameAvailable","emailAvailable","setEmailAvailable","checkingUsername","setCheckingUsername","checkingEmail","setCheckingEmail","checkingContact","setCheckingContact","contactAvailable","setContactAvailable","contactTimerRef","usernameTimerRef","emailTimerRef","clearTimeout","_resp$data","_resp$data2","_resp$data3","getPasswordStrength","pwd","score","percent","percentComplete","requiredFields","filled","fileCount","Number","currentStep","renderLabelWithTooltip","tip","InfoCircleOutlined","sanitizeName","Box","sx","py","Container","Paper","elevation","mb","mx","Steps","Step","AntProgress","showInfo","strokeColor","handleSubmit","bottom","TextField","fullWidth","setFieldValue","touched","helperText","handleChange","InputProps","startAdornment","InputAdornment","Person","Email","Lock","endAdornment","tabIndex","VisibilityOff","Visibility","mt","Home","Phone","component","AntUpload","fileList","beforeUpload","pf","thumbUrl","slice","f","originFileObj","listType","showPreviewIcon","showRemoveIcon","maxCount","gf","_ref4","sf","transition","isSubmitting","Alert","severity","entries","_ref5","field","Link","textDecoration","Dashboard","_user$fullName","_user$barangayID","setCurrentTime","documents","setDocuments","setAnnouncementsCount","setAnnouncementsLoading","inquiriesCount","setInquiriesCount","pendingModalVisible","setPendingModalVisible","pendingRequestsList","setPendingRequestsList","pendingLoading","setPendingLoading","approvedModalVisible","setApprovedModalVisible","approvedRequestsList","setApprovedRequestsList","approvedLoading","setApprovedLoading","tipsModalVisible","setTipsModalVisible","hideTips","setHideTips","helpHover","setHelpHover","formatDate","fetchDocuments","data2","url2","tick","count","fetchInquiries","fetchAnnouncements","pendingCount","doc","approvedCount","residentCard","heroRow","avatarContainer","avatarImg","editButton","viewBox","fill","xmlns","userInfo","userMeta","hoverable","onMouseEnter","transform","onMouseLeave","MailOutlined","Badge","offset","Table","rowKey","record","pagination","pageSize","columns","dataIndex","render","fv","_","dateRequested","requestedAt","dateApproved","approvedAt","approvedOn","updatedAt","Checkbox","checked","paddingLeft","QuestionCircleOutlined","GuestDashboard","StaffDashboard","documentRequests","setDocumentRequests","inboxInquiries","setInboxInquiries","viewedInquiryIds","setViewedInquiryIds","arr","markInquiryViewed","next","from","miniAnns","setMiniAnns","miniLoading","setMiniLoading","miniSelected","setMiniSelected","drawerVisible","setDrawerVisible","selectedDocument","setSelectedDocument","manageModalVisible","setManageModalVisible","manageTableData","setManageTableData","responseText","setResponseText","documentStatus","setDocumentStatus","responding","completedModalVisible","setCompletedModalVisible","docsModalVisible","setDocsModalVisible","allDocuments","setAllDocuments","docsLoading","setDocsLoading","previewVisible","setPreviewVisible","previewDoc","setPreviewDoc","docsSearch","setDocsSearch","screens","Grid","useBreakpoint","requestsByCategory","req","docType","push","pendingRequests","totalDocuments","completedRequests","handleDownloadProcessed","normalizeId","$oid","tryIds","nid","rec","ngfid","gridFsFileId","ids","usedId","lastError","finalBlob","finalHeaders","notification","description","cd","m","decodeURIComponent","m2","downloadName","getStatusTag","fetchData","useCallback","docRecords","inq","assignedRole","processedCount","page","limit","fetchMiniAnnouncements","formatDocumentType","word","w","dateString","sortByDateDesc","sort","b","ta","goWithState","go","spinning","bordered","pending","openRequestId","HourglassOutlined","valueStyle","CaretUpOutlined","processedItems","files","processed","fetchAllProcessedDocuments","FolderOutlined","DatabaseOutlined","CheckCircleOutlined","FileSearchOutlined","Collapse","defaultActiveKey","expandIcon","isActive","rotate","requests","categories","SafetyCertificateOutlined","ProfileOutlined","categorizeRequests","_req$status","Panel","header","backgroundColor","_request$status","statusColors","PENDING","bg","APPROVED","REJECTED","DEFAULT","statusStyle","actions","ExclamationCircleOutlined","direction","locale","emptyText","Empty","image","PRESENTED_IMAGE_SIMPLE","suffix","accordion","isOpen","avatarColor","avatarBg","isViewed","has","letter","borderBottom","dot","flexGrow","pointerEvents","WebkitLineClamp","WebkitBoxOrient","imagePath","Drawer","onClose","enterButton","q","transactionCode","transactioncode","uploadedBy","some","c","scroll","x","sourceTemplateName","templateName","responsive","_navigator$clipboard","clipboard","writeText","notes","_navigator$clipboard2","onRow","Column","duration","_err$response2","_err$response2$data","_err$response$data","_rec$requesterId","requesterId","socket","onNotificationEvent","event","on","offNotificationEvent","pieColors","AdminDashboard","totalUsers","activeUsers","unreadMessages","notifications","setNotifications","setStaffAccessNotifs","staffRequests","setStaffRequests","setRecentActivity","verifs","setVerifs","verifsLoading","setVerifsLoading","verifModalVisible","setVerifModalVisible","selectedVerif","setSelectedVerif","usersTrend","requestsByType","documentCategoryData","fetchDashboardData","_statsRes$documents","_statsRes$documents2","_statsRes$users","_statsRes$users2","_statsRes$documents3","statsRes","docs","unreadNotifs","read","staffApprovalNotifs","sreqs","systemPending","systemTotalDocs","directPending","allReqs","totalPending","active","completed","inquiriesRes","activityRes","module","SOCKET_URL","io","transports","autoConnect","initNotificationSocket","pollInterval","loadVerifs","fetchUsersCount","usersAny","interval","handleApproveStaff","_notif$data","notif","UnreadBadge","kpiCards","labelColor","chart","preserveAspectRatio","stroke","strokeWidth","points","barWidth","barHeight","y","rx","reduce","sum","startAngle","angle","endAngle","largeArc","x1","cos","PI","y1","sin","x2","y2","statCardSubtitles","toLocaleDateString","card","BellOutlined","_record$data","nameFromData","nameFromRequestedByName","requestedByName","nameFromRequestedBy","requestedBy","prompt","handleRejectStaff","_item$userId","arg","_arg$userId","reqId","handleApproveVerif","_item$userId2","_arg$userId2","handleRejectVerif","gridFileIds","roleOptions","statusOptions","UserManagement","setUsers","setSearch","roleFilter","setRoleFilter","statusFilter","setStatusFilter","dateRange","setDateRange","setPage","setPageSize","selectedRowKeys","setSelectedRowKeys","drawerOpen","setDrawerOpen","selectedUser","setSelectedUser","selectedResident","setSelectedResident","residentLoading","setResidentLoading","editModalOpen","setEditModalOpen","editUserModalOpen","setEditUserModalOpen","userFormValues","setUserFormValues","uploadPreview","setUploadPreview","pendingUploadRef","editFormValues","setEditFormValues","fetchUsers","lastLogin","barangayId","barangay_id","handleDisableUser","suspendedUntil","handleEnableUser","handleDemoteUser","filteredUsers","matchesSearch","matchesRole","matchesStatus","matchesDate","dayjs","isAfter","isBefore","sorter","localeCompare","sortDirections","fixed","onFilter","format","popupRender","EditOutlined","StopOutlined","confirmText","confirm","currentVerified","handleToggleVerified","ReloadOutlined","MoreOutlined","bulkBar","Popconfirm","onConfirm","okText","cancelText","startIdx","endIdx","Breadcrumb","options","DatePicker","RangePicker","rowSelection","showSizeChanger","pageSizeOptions","onShowSizeChange","_current","showTotal","fetchResidentForUser","sticky","copyable","span","landlineNumber","birthDate","sex","gender","civilStatus","maritalStatus","nationality","occupation","educationalAttainment","passportNumber","governmentIdNumber","tin","barangayClearanceNumber","spouseName","spouseLastName","numberOfChildren","childrenNames","childrenAges","motherName","fatherName","emergencyContactName","emergencyContact","emergencyContactRelationship","spouseContactNumber","businessName","businessType","businessContactNumber","businessAddress","bloodType","disabilityStatus","facebook","instagram","website","twitter","onValuesChange","pattern","updatedUsers","ActivityLogs","CHARTS","chartType","endpoint","colors","age","education","CHART_IDS","defaultQueryClient","QueryClient","defaultOptions","queries","retry","staleTime","refetchOnWindowFocus","StatisticsInner","_summary$totalResiden","_summary$totalDocumen","_ref14","_ref15","_ref16","loadingSummary","setLoadingSummary","summary","setSummary","chartData","setChartData","chartLoading","setChartLoading","setFilters","residentType","selectedCharts","setSelectedCharts","autoEnableWhenData","setAutoEnableWhenData","prevSelectionRef","settingsOpen","setSettingsOpen","chartSettings","setChartSettings","settingsChartId","setSettingsChartId","chartsDropdownOpen","setChartsDropdownOpen","pendingSelectedCharts","setPendingSelectedCharts","fetchSummary","_filters$dateRange","_filters$dateRange$","_filters$dateRange$$f","_filters$dateRange2","_filters$dateRange2$","_filters$dateRange2$$","startDate","call","endDate","fetchChart","def","chartId","_cs$dateRange","_cs$dateRange$","_cs$dateRange$$format","_filters$dateRange3","_filters$dateRange3$","_filters$dateRange3$$","_cs$dateRange2","_cs$dateRange2$","_cs$dateRange2$$forma","_filters$dateRange4","_filters$dateRange4$","_filters$dateRange4$$","_res$data","cs","start","end","_p$name","_p$value","totalResidents","totalDocumentRequests","ageBarData","ageMax","ageAxisMax","ceil","monthlyDocData","ChartCard","_cs$showLabels","_cs$showTooltips","_cs$showLegend","hasData","effectiveChartType","showLabels","showTooltips","showLegend","Skeleton","chartRefs","pieData","_d$type","_ref6","_d$value","group","valueNumber","Pie","angleField","colorField","radius","formatter","datum","_ref7","_p$label","_ref8","_ref9","_p$valueNumber","tooltip","_ref0","_p$label2","_ref1","_ref10","_p$valueNumber2","statistic","legend","Bar","xField","yField","yAxis","tickInterval","Line","Area","dashboardRef","chartIds","chartQueryResults","useQueries","_filters$dateRange5","_filters$dateRange5$","_filters$dateRange5$$","_filters$dateRange6","_filters$dateRange6$","_filters$dateRange6$$","_chartSettings$id","_chartSettings$id$dat","_chartSettings$id$dat2","_chartSettings$id$dat3","_chartSettings$id2","_chartSettings$id2$da","_chartSettings$id2$da2","_chartSettings$id2$da3","queryKey","queryFn","_cs$dateRange3","_cs$dateRange3$","_cs$dateRange3$$forma","_filters$dateRange7","_filters$dateRange7$","_filters$dateRange7$$","_cs$dateRange4","_cs$dateRange4$","_cs$dateRange4$$forma","_filters$dateRange8","_filters$dateRange8$","_filters$dateRange8$$","_res$data2","chartQueryDataKey","chartQueriesMapMemo","useMemo","newData","newLoading","_ref11","_ref12","_p$name2","_ref13","_p$value2","lower","norm","acc","cur","isFetching","isLoading","_chartQueriesMapMemo$","refetch","chartsWithData","newSel","reportModalOpen","setReportModalOpen","reportText","setReportText","boxSizing","dates","onOpenChange","onWheel","DownOutlined","Switch","openReport","_s$totalResidents","_gender$find","_gender$find2","charts","ed","monthly","disability","businessSize","incomeBrackets","maleCount","g","femaleCount","otherCount","topAgeGroup","_sorted$","_sorted$2","sorted","topCivil","topEducation","monthlyTotal","peakMonth","peakVal","peak","best","parts","genderPart","topOcc","o","topNat","bt","disabledCount","avgChildren","toFixed","topBiz","totalBusinesses","totalReported","topBracket","generateNarrativeReport","html2canvas","imgData","toDataURL","pdf","jsPDF","unit","orientation","setFontSize","addPage","pageWidth","internal","getWidth","pageHeight","getHeight","usableWidth","tmpImg","Image","onload","imgWidthPts","imgHeightPts","pxPerPt","sliceHeightPt","sliceHeightPx","offCanvas","ctx","getContext","fillStyle","fillRect","drawImage","yOffset","sliceCanvas","sctx","sliceData","drawHeightPts","addImage","save","downloadFullAnalytics","splitTextToSize","canvas","imgWidth","imgHeight","pdfWidth","pdfHeight","paragraph","_q$error","isError","showIcon","Statistics","QueryClientProvider","client","setTo","sending","setSending","snackOpen","setSnackOpen","snackMessage","setSnackMessage","snackSeverity","setSnackSeverity","bgcolor","host","CircularProgress","Snackbar","autoHideDuration","barangayName","barangayAddress","contactPhone","maintainanceMode","allowNewRegistrations","requireEmailVerification","enableVerifications","maxDocumentRequests","documentProcessingDays","allowMultipleAccountsPerIP","maxAccountsPerIP","systemNotice","port","SystemSettings","_smtp","_smtp2","_smtp3","_maxAccountsPerIP","_maxAccountsPerIP2","setSettings","defaultSystemSettings","saving","setSaving","confirmDisableOpen","setConfirmDisableOpen","testModalOpen","setTestModalOpen","officialsLoading","setOfficialsLoading","savingOfficials","setSavingOfficials","manualSaveError","setManualSaveError","autoSaveTimers","previewContainerRef","prevOfficialsCountRef","highlightedIds","setHighlightedIds","highlightTimeouts","originalSettingsRef","setDirty","ac","AbortController","fetchSettings","signal","currentPreviewUrls","abort","container","scrollTo","scrollWidth","tid","sys","performSave","maintenanceMode","allowRegistrations","maxDocumentRequestsPerUser","saveAll","prevEnabled","nowEnabled","handleSave","updatedOfficials","refreshed","handleManualSaveOfficials","pt","px","pb","gutterBottom","InputLabelProps","shrink","multiline","my","parseInt","TestEmailModal","FormControlLabel","control","startIcon","UsergroupAddOutlined","pr","AntdUpload","handleDeleteOfficial","previewOrder","scrollSnapType","isHighlighted","scrollSnapAlign","ml","inputProps","Dialog","DialogTitle","DialogContent","DialogActions","confirmAndSave","DocumentRequestForm","setFiles","selectedFields","setSelectedFields","modalOpen","setModalOpen","modalDocName","setModalDocName","fieldValues","setFieldValues","searchTerm","setSearchTerm","selectedCategory","setSelectedCategory","sortBy","setSortBy","submitLoading","setSubmitLoading","authUser","fetchFiles","filteredFiles","fname","_a$filename$split$pop","uploadDate","pop","defaultValue","html","regex","fields","exec","visibleFields","day","monthNum","monthName","month","mm","dd","currentDateFormatted","handleCardClick","FileWordOutlined","_files$find","processedFields","documentType","purpose","inquiryTypeGroups","InquiryForm","showSuccess","setShowSuccess","formRef","subjectCount","setSubjectCount","messageCount","setMessageCount","SUBJECT_MAX","MESSAGE_MAX","setCurrentStep","fileListState","setFileListState","previewModalVisible","setPreviewModalVisible","previewValues","setPreviewValues","LOCALSTORAGE_KEY","_formRef$current","setFieldsValue","_formRef$current2","restored","uid","attachment","saveDraft","_formRef$current3","getFieldsValue","draft","toISOString","onUnload","_formRef$current4","formatBytes","bytes","parseFloat","pow","onFinishFailed","_errorInfo","headStyle","banner","onFieldsChange","allValues","OptGroup","opt","initialValue","maxLength","valuePropName","getValueFromEvent","Dragger","multiple","incoming","nextList","isAllowedType","isLt5M","preview","onPreview","isPdf","Descriptions","column","Goodbye","Logout","InquiryTracker","typeFilter","setTypeFilter","types","toDate","visible","onCreated","defaultBarangayID","defaultUsername","defaultEmail","submitting","confirmLoading","ResidentPortal","avatarPreview","setAvatarPreview","residentMissing","setResidentMissing","showCreateModal","setShowCreateModal","verificationUploading","setVerificationUploading","verificationProgress","setVerificationProgress","useTranslation","setProfile","setRequests","setForm","staffRequestSent","setStaffRequestSent","requesting","setRequesting","editingUser","setEditingUser","editingPersonal","setEditingPersonal","personalInfo","setPersonalInfo","personalForm","setPersonalForm","currentTime","dateOfResidency","spouseAge","spouseBirthDate","spouseOccupation","spouseStatus","motherAge","motherBirthDate","motherOccupation","motherStatus","fatherAge","fatherBirthDate","fatherOccupation","fatherStatus","updateTime","formatted","hour","minute","second","hour12","handleChangeUser","handleChangePersonal","bodyStyle","opts","reader","FileReader","_e$target","result","readAsDataURL","returnedUser","handleBannerAvatarUpload","backdropFilter","pct","Progress","ResidentCreateModal","names","deriveNames","first","last","msgs","handleCancelUser","handleEditUser","serverMsg","_e$response","_e$response$data","borderColor","placeOfBirth","religion","spouseMiddleName","spouseNationality","natureOfBusiness","dateEstablished","registrationNumber","businessPermitNumber","numberOfEmployees","capitalInvestment","annualGrossIncome","businessContactPerson","businessEmail","handleCancelPersonal","handleEditPersonal","alert","LandingPage","animation","wordBreak","ForgotPassword","sent","setSent","submittedEmail","setSubmittedEmail","code","setCode","verifying","setVerifying","gridTemplateColumns","handleDigit","handleBackspace","handleClear","Radio","ResetPassword","useParams","URLSearchParams","strengthScore","setStrengthScore","strengthLabel","setStrengthLabel","len","evaluateStrength","MessageInbox","messages","setMessages","fetchNotifications","ArrowLeftOutlined","handleMarkAsRead","DocumentHistory","history","setHistory","fetchHistory","h","completedAt","formatDateUtil","_record$processedBy","_record$processedBy2","_record$processedBy3","processedBy","staffBarangayID","Announcements","setText","setFile","anns","setAnns","viewing","setViewing","editing","setEditing","editText","setEditText","editFile","setEditFile","loadAnns","removeFile","LIST_IGNORE","onRemove","CloseCircleOutlined","openView","openEdit","AnnouncementsList","selected","setSelected","ellipsis","VerificationRequests","setData","load","approve","_record$userId","createTheme","palette","primary","main","light","dark","secondary","typography","components","MuiButton","styleOverrides","textTransform","MuiPaper","RootRedirect","App","ThemeProvider","CssBaseline","ConfigProvider","Router","Routes","Route","element","PrivateRoute","StaffRoute","require","AdminRoute","includeTime","dt","isValid","DocumentProcessing","_getPrimaryRequest","_getPrimaryRequest2","_getPrimaryRequest3","_getPrimaryRequest4","modalVisible","setModalVisible","selectedFile","setSelectedFile","requestedTypes","setRequestedTypes","fileRequestMap","setFileRequestMap","previewHtml","setPreviewHtml","previewLoading","setPreviewLoading","previewRequests","setPreviewRequests","previewTemplateHtml","setPreviewTemplateHtml","previewSelectedRequestId","setPreviewSelectedRequestId","showPreviewRequests","setShowPreviewRequests","rowRefs","prioritizeModalVisible","setPrioritizeModalVisible","prioritizeCandidates","selectedPriorityRequest","setSelectedPriorityRequest","prioritizeTargetFileId","setPrioritizeTargetFileId","generatedCopyId","setGeneratedCopyId","generatedModalVisible","setGeneratedModalVisible","processedDocId","setProcessedDocId","filterQuery","setFilterQuery","filterType","setFilterType","filterStatus","setFilterStatus","filterRange","setFilterRange","openRequestIdFromNav","getRequestsForFile","getPrimaryRequest","getPrioritizedRequest","priority","handleProcessClickRef","renderPreviewForRequestRef","fetchFilesAndRequests","fileRequestMapLocal","normalize","str","normalizedFilename","matchedRequests","fid","_handleProcessClickRe","_renderPreviewForRequ","tableHtml","handleProcessClick","_renderPreviewForRequ2","prioritized","firstPending","prioritizedPending","previewResp","selectedReqId","renderPreviewForRequest","flat","openPreview","SearchOutlined","onPressEnter","ext","FilePdfOutlined","FileImageOutlined","rid","metadata","online","rowClassName","requesterName","prioritize","_currentReq","currentReq","currentStatus","cloned","findIndex","updatedRequests","okButtonProps","newId","_link$parentNode","contentDisposition","fnStarMatch","fnMatch","savedId","processedGridFsId","finalSavedId","generateFilledDocx","txId","transactionId","transaction_id","safeId","preferredCode","serverFilename","Blob","link","setAttribute","parentNode","removeChild","processedId","uploaded","tryUrls","markErr"],"sourceRoot":""}